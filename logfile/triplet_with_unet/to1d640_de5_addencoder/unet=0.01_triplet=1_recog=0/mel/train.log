
=== Using cuda(utils.func). ===

[2023-11-08 09:55:10,097][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-08 09:55:10,103][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640_addencoder                
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0.01                                                       
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_2d_de5_to1d640_addencoder              
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: true                                                             
│         n_mels: 259                                                           
│       ckpt_model_path: null                                                   
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: true                                                             
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.UNetForTriplet_2d_de5_to1d640_addencoder                
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0.01                                                       
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: -1                                                        
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 100                                                         
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       load_using_librosa: false                                               
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_psd_train: 3                                                    
│       seconds_psd_valid: 10                                                   
│       seconds_psd_test: 10                                                    
│       offset_psd_train: 1.5                                                   
│       offset_psd_valid: 5.0                                                   
│       offset_psd_test: 10.0                                                   
│       seconds_triplet_train: 3                                                
│       seconds_triplet_valid: 3                                                
│       offset_triplet_train: 1.5                                               
│       offset_triplet_valid: 1.5                                               
│       seconds_c32_train: 3                                                    
│       seconds_c32_valid: 10                                                   
│       seconds_c32_test: 10                                                    
│       offset_c32_train: 1.5                                                   
│       offset_c32_valid: 5.0                                                   
│       offset_c32_test: 10.0                                                   
│       sr: 44100                                                               
│       mel: true                                                               
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.UNetForTriplet_2d_de5_to1d640_addencoder                  
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0.01                                                         
│       recog_rate: 0                                                           
│       test_psd_mine: false                                                    
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-08 09:55:10,187][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-08 09:55:10,207][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640_addencoder). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-08 09:55:14,252][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpahoa6eti
[2023-11-08 09:55:14,253][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpahoa6eti/_remote_module_non_scriptable.py
UNetForTriplet_2d_de5_to1d640_addencoder(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (adencoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (addto1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=3200, out_features=640, bias=True)
    )
  )
  (linear): Linear(in_features=1280, out_features=640, bias=True)
  (sigmoid): Sigmoid()
)
[2023-11-08 09:55:15,764][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-08 09:55:15,765][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-08 09:55:15,771][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-08 09:55:15,775][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-08 09:55:15,776][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-08 09:55:15,777][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-08 09:55:15,865][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-08 09:55:16,347][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-08 09:55:16,741][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.6385669708251953 sec. *
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:10<00:00,  0.19it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 1: 100%|██████████| 2/2 [00:00<00:00,  4.69it/s]Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 2: 100%|██████████| 2/2 [00:02<00:00,  0.99it/s]Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 3: 100%|██████████| 2/2 [00:00<00:00,  4.41it/s]Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 4: 100%|██████████| 2/2 [00:00<00:00,  4.09it/s]Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 5:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 5: 100%|██████████| 2/2 [00:01<00:00,  1.30it/s]

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.201178, 0.196440, 0.196195, 0.214154
Valid average loss UNet                 (all)                : 0.807966

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.200033, 0.000709, 0.000676
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.200003, 0.000704, 0.000701
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.199989, 0.000690, 0.000701
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.200017, 0.000675, 0.000658
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.199970, 0.000676, 0.000706
Valid average loss all      (Triplet)                 : 0.200004

== Recognize ==
Valid average loss Recognize     : 0.942130
Valid average accuracy drums     : 43.750000 %
Valid average accuracy bass      : 61.718750 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 54.687500 %
Valid average accuracy residuals : 54.687500 %

== Valid average loss all : 0.208083

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 3.0167839527130127 sec. =
Valid knn accuracy drums     : 25.78125%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.302773952484131 sec. =
Valid knn accuracy bass      : 22.65625%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.588411331176758 sec. =
Valid knn accuracy piano     : 53.125%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.247185468673706 sec. =
Valid knn accuracy guitar    : 41.40625%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.2946271896362305 sec. =
Valid knn accuracy residuals : 91.40625%

Valid knn accuracy average   : 46.875%
                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [00:57<05:02,  0.87it/s]Epoch 0:  16%|█▌        | 50/313 [00:57<05:02,  0.87it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.220, Train/loss_recog_step=1.070]Epoch 0:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.603, Train/loss_triplet_all_step=0.220, Train/loss_recog_step=1.070]Epoch 0:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.581, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=1.070]Epoch 0:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.581, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=1.070]Epoch 0:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.609, Train/loss_triplet_all_step=0.219, Train/loss_recog_step=1.200]Epoch 0:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.609, Train/loss_triplet_all_step=0.219, Train/loss_recog_step=1.200]Epoch 0:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.576, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.270]Epoch 0:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.576, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.270]Epoch 0:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=1.120]Epoch 0:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=1.120]Epoch 0:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.120]Epoch 0: 100%|██████████| 313/313 [04:48<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.120]Epoch 0: 100%|██████████| 313/313 [04:48<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=1.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.72it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.96it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.02it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.131711, 0.139163, 0.127499, 0.184862
Valid average loss UNet                 (all)                : 0.583236

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.339870, 0.389940, 0.293838
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.205107, 0.138231, 0.140416
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.204807, 0.170467, 0.179044
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.171816, 0.141521, 0.173321
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.195051, 0.199888, 0.217871
Valid average loss all      (Triplet)                 : 0.208388

== Recognize ==
Valid average loss Recognize     : 1.204956
Valid average accuracy drums     : 43.500000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.214221

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.504892110824585 sec. =
Valid knn accuracy drums     : 33.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.708003997802734 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.330743312835693 sec. =
Valid knn accuracy piano     : 20.1171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.441712856292725 sec. =
Valid knn accuracy guitar    : 16.964285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.829303026199341 sec. =
Valid knn accuracy residuals : 39.09090909090909%

Valid knn accuracy average   : 25.636650374082436%

                                                                      [AEpoch 0: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=1.020, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256]Epoch 0: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=1.020, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.133001, 0.133614, 0.134250, 0.187961
Train average loss UNet                 (all)                : 0.588827

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.150116, 0.282114, 0.419459
Train average loss bass     (Triplet, dist_p, dist_n) : 0.223921, 0.237780, 0.223495
Train average loss piano    (Triplet, dist_p, dist_n) : 0.216223, 0.256050, 0.251796
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.218257, 0.255748, 0.248138
Train average loss residuals(Triplet, dist_p, dist_n) : 0.195777, 0.287423, 0.313510
Train average loss all      (Triplet)                 : 0.201660

== Recognize ==
Train average loss Recognize     : 1.113031
Train average accuracy drums     : 49.785000 %
Train average accuracy bass      : 50.475002 %
Train average accuracy piano     : 50.349998 %
Train average accuracy guitar    : 49.834999 %
Train average accuracy residuals : 50.325001 %

== Train average loss all : 0.207548

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=1.020, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=1.020, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1:  16%|█▌        | 50/313 [00:52<04:36,  0.95it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.570, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=1.020, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1:  16%|█▌        | 50/313 [00:52<04:36,  0.95it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.583, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.080, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.583, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.080, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.586, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=1.290, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.586, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=1.290, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.601, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.090, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1:  64%|██████▍   | 200/313 [03:09<01:47,  1.06it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.601, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.090, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1:  64%|██████▍   | 200/313 [03:09<01:47,  1.06it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.200, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1:  80%|███████▉  | 250/313 [03:52<00:58,  1.07it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.200, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1:  80%|███████▉  | 250/313 [03:52<00:58,  1.07it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=1.280, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1:  96%|█████████▌| 300/313 [04:36<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=1.280, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1:  96%|█████████▌| 300/313 [04:36<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=1.220, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1: 100%|██████████| 313/313 [04:44<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=1.220, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1: 100%|██████████| 313/313 [04:44<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.350, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.575, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.214, Valid/loss_unet_all_epoch=0.583, Valid/loss_triplet_all_epoch=0.208, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.256, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.79it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.96it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.97it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.133943, 0.138673, 0.130224, 0.183773
Valid average loss UNet                 (all)                : 0.586613

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.142311, 0.181340, 0.310670
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.194771, 0.074177, 0.079405
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.184507, 0.157304, 0.174396
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.196386, 0.130296, 0.133909
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.213478, 0.260777, 0.255144
Valid average loss all      (Triplet)                 : 0.185368

== Recognize ==
Valid average loss Recognize     : 1.371543
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.191234

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3518593311309814 sec. =
Valid knn accuracy drums     : 53.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.60939335823059 sec. =
Valid knn accuracy bass      : 16.129032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.555431604385376 sec. =
Valid knn accuracy piano     : 21.484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.087181091308594 sec. =
Valid knn accuracy guitar    : 22.991071428571427%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.643108367919922 sec. =
Valid knn accuracy residuals : 45.0%

Valid knn accuracy average   : 31.816547911240235%

                                                                      [AEpoch 1: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.350, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.589, Train/loss_triplet_all_epoch=0.202, Train/loss_recog_epoch=1.110]Epoch 1: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.350, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.128991, 0.129493, 0.130015, 0.181416
Train average loss UNet                 (all)                : 0.569915

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.113755, 0.192717, 0.425388
Train average loss bass     (Triplet, dist_p, dist_n) : 0.208829, 0.110144, 0.102984
Train average loss piano    (Triplet, dist_p, dist_n) : 0.201870, 0.159335, 0.161470
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.206423, 0.139481, 0.136333
Train average loss residuals(Triplet, dist_p, dist_n) : 0.172560, 0.232576, 0.282495
Train average loss all      (Triplet)                 : 0.181926

== Recognize ==
Train average loss Recognize     : 1.236083
Train average accuracy drums     : 50.505001 %
Train average accuracy bass      : 50.314999 %
Train average accuracy piano     : 50.129997 %
Train average accuracy guitar    : 49.544998 %
Train average accuracy residuals : 50.070000 %

== Train average loss all : 0.187626

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.350, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.350, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.350, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.591, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.250, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2:  32%|███▏      | 100/313 [01:38<03:29,  1.02it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.591, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.250, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2:  32%|███▏      | 100/313 [01:38<03:29,  1.02it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.583, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.340, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2:  48%|████▊     | 150/313 [02:21<02:34,  1.06it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.583, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.340, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2:  48%|████▊     | 150/313 [02:21<02:34,  1.06it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.591, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=1.470, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2:  64%|██████▍   | 200/313 [03:07<01:46,  1.07it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.591, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=1.470, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2:  64%|██████▍   | 200/313 [03:07<01:46,  1.07it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.320, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2:  80%|███████▉  | 250/313 [03:54<00:59,  1.07it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.320, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2:  80%|███████▉  | 250/313 [03:54<00:59,  1.07it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.529, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.710, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2:  96%|█████████▌| 300/313 [04:37<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.529, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.710, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2:  96%|█████████▌| 300/313 [04:37<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.540, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=1.690, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2: 100%|██████████| 313/313 [04:45<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.540, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=1.690, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2: 100%|██████████| 313/313 [04:45<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.460, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.212, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.587, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.370, Valid/knn_avr=0.318, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.86it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.91it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.14it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.79it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.129542, 0.137000, 0.123601, 0.177338
Valid average loss UNet                 (all)                : 0.567481

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.092479, 0.117511, 0.270754
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.191336, 0.040504, 0.049168
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.216783, 0.123932, 0.107149
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.204227, 0.110983, 0.106756
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.166946, 0.153025, 0.197689
Valid average loss all      (Triplet)                 : 0.177509

== Recognize ==
Valid average loss Recognize     : 1.407503
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 56.000000 %

== Valid average loss all : 0.183184

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.270690679550171 sec. =
Valid knn accuracy drums     : 54.347826086956516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.027173280715942 sec. =
Valid knn accuracy bass      : 11.895161290322582%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.429169654846191 sec. =
Valid knn accuracy piano     : 16.9921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.789702653884888 sec. =
Valid knn accuracy guitar    : 15.401785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.442012786865234 sec. =
Valid knn accuracy residuals : 47.95454545454545%

Valid knn accuracy average   : 29.318301209222053%

                                                                      [AEpoch 2: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.460, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.570, Train/loss_triplet_all_epoch=0.182, Train/loss_recog_epoch=1.240]Epoch 2: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.460, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.128031, 0.128649, 0.129150, 0.175207
Train average loss UNet                 (all)                : 0.561036

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.101559, 0.174060, 0.435243
Train average loss bass     (Triplet, dist_p, dist_n) : 0.209226, 0.094210, 0.085594
Train average loss piano    (Triplet, dist_p, dist_n) : 0.201050, 0.143940, 0.146945
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.204391, 0.130783, 0.128448
Train average loss residuals(Triplet, dist_p, dist_n) : 0.163030, 0.226986, 0.294609
Train average loss all      (Triplet)                 : 0.177039

== Recognize ==
Train average loss Recognize     : 1.417482
Train average accuracy drums     : 50.255001 %
Train average accuracy bass      : 50.005001 %
Train average accuracy piano     : 49.875000 %
Train average accuracy guitar    : 50.215000 %
Train average accuracy residuals : 49.805000 %

== Train average loss all : 0.182649

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.460, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.460, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3:  16%|█▌        | 50/313 [00:52<04:36,  0.95it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.460, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3:  16%|█▌        | 50/313 [00:52<04:36,  0.95it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.390, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3:  32%|███▏      | 100/313 [01:37<03:28,  1.02it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.571, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.390, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3:  32%|███▏      | 100/313 [01:37<03:28,  1.02it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.600, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3:  48%|████▊     | 150/313 [02:22<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.600, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3:  48%|████▊     | 150/313 [02:22<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.586, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=1.550, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.586, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=1.550, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.500, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.556, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.500, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.516, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.540, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3:  96%|█████████▌| 300/313 [04:43<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.516, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.540, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3:  96%|█████████▌| 300/313 [04:43<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.529, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=1.340, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.529, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=1.340, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.460, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.542, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.183, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=1.410, Valid/knn_avr=0.293, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.13it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.81it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.71it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.93it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.31it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.130298, 0.137388, 0.125057, 0.180561
Valid average loss UNet                 (all)                : 0.573304

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.125862, 0.159330, 0.325968
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.186293, 0.052424, 0.066131
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.214366, 0.142119, 0.127850
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.177512, 0.093049, 0.115537
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.141796, 0.194318, 0.286172
Valid average loss all      (Triplet)                 : 0.167209

== Recognize ==
Valid average loss Recognize     : 1.490660
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.172942

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.289334535598755 sec. =
Valid knn accuracy drums     : 43.913043478260875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.765042066574097 sec. =
Valid knn accuracy bass      : 14.717741935483872%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.26631784439087 sec. =
Valid knn accuracy piano     : 20.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.986246585845947 sec. =
Valid knn accuracy guitar    : 20.535714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.079002618789673 sec. =
Valid knn accuracy residuals : 46.36363636363636%

Valid knn accuracy average   : 29.16852721261908%

                                                                      [AEpoch 3: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.460, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.561, Train/loss_triplet_all_epoch=0.177, Train/loss_recog_epoch=1.420]Epoch 3: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.460, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.127232, 0.127861, 0.128367, 0.170336
Train average loss UNet                 (all)                : 0.553796

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.093706, 0.171698, 0.467072
Train average loss bass     (Triplet, dist_p, dist_n) : 0.205411, 0.082127, 0.078557
Train average loss piano    (Triplet, dist_p, dist_n) : 0.196233, 0.131743, 0.139662
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.204841, 0.103858, 0.100347
Train average loss residuals(Triplet, dist_p, dist_n) : 0.157058, 0.222376, 0.299479
Train average loss all      (Triplet)                 : 0.172422

== Recognize ==
Train average loss Recognize     : 1.463797
Train average accuracy drums     : 49.680000 %
Train average accuracy bass      : 50.340004 %
Train average accuracy piano     : 49.509998 %
Train average accuracy guitar    : 50.164997 %
Train average accuracy residuals : 49.735001 %

== Train average loss all : 0.177960

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.460, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.460, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.460, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.660, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4:  32%|███▏      | 100/313 [01:37<03:28,  1.02it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=1.660, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4:  32%|███▏      | 100/313 [01:37<03:28,  1.02it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.440, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4:  48%|████▊     | 150/313 [02:23<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.564, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.440, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4:  48%|████▊     | 150/313 [02:23<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.680, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4:  64%|██████▍   | 200/313 [03:08<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.593, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.680, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4:  64%|██████▍   | 200/313 [03:08<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.520, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4:  80%|███████▉  | 250/313 [03:54<00:59,  1.07it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.520, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4:  80%|███████▉  | 250/313 [03:54<00:59,  1.07it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.490, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4:  96%|█████████▌| 300/313 [04:41<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.490, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4:  96%|█████████▌| 300/313 [04:41<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.528, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=1.580, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.528, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=1.580, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.740, Valid/loss_all_step=0.174, Valid/loss_unet_all_step=0.564, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=1.780, Valid/loss_all_epoch=0.173, Valid/loss_unet_all_epoch=0.573, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.490, Valid/knn_avr=0.292, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.52it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.36it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.92it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.131187, 0.137788, 0.125352, 0.172898
Valid average loss UNet                 (all)                : 0.567225

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.118542, 0.139574, 0.355168
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.193380, 0.071864, 0.078485
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.220483, 0.133196, 0.113570
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.187083, 0.098476, 0.115693
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.151638, 0.190664, 0.282222
Valid average loss all      (Triplet)                 : 0.176696

== Recognize ==
Valid average loss Recognize     : 1.582137
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.182368

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.165950536727905 sec. =
Valid knn accuracy drums     : 36.95652173913043%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.026154518127441 sec. =
Valid knn accuracy bass      : 11.895161290322582%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.205183029174805 sec. =
Valid knn accuracy piano     : 19.7265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.089709997177124 sec. =
Valid knn accuracy guitar    : 17.857142857142858%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.187202215194702 sec. =
Valid knn accuracy residuals : 44.09090909090909%

Valid knn accuracy average   : 26.10525949550099%

                                                                      [AEpoch 4: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.740, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.554, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=1.460]Epoch 4: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.740, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.126813, 0.127421, 0.128022, 0.167643
Train average loss UNet                 (all)                : 0.549899

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.087928, 0.159543, 0.478210
Train average loss bass     (Triplet, dist_p, dist_n) : 0.207169, 0.076568, 0.069935
Train average loss piano    (Triplet, dist_p, dist_n) : 0.198249, 0.126549, 0.130945
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.201374, 0.101603, 0.102009
Train average loss residuals(Triplet, dist_p, dist_n) : 0.147955, 0.234578, 0.330356
Train average loss all      (Triplet)                 : 0.169798

== Recognize ==
Train average loss Recognize     : 1.480472
Train average accuracy drums     : 50.260002 %
Train average accuracy bass      : 50.265003 %
Train average accuracy piano     : 49.775002 %
Train average accuracy guitar    : 50.349998 %
Train average accuracy residuals : 50.265003 %

== Train average loss all : 0.175297

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.740, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.740, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.547, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.740, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.575, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.560, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5:  32%|███▏      | 100/313 [01:37<03:27,  1.03it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.575, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.560, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5:  32%|███▏      | 100/313 [01:37<03:27,  1.03it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.543, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.780, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5:  48%|████▊     | 150/313 [02:22<02:34,  1.05it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.543, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.780, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5:  48%|████▊     | 150/313 [02:22<02:34,  1.05it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.584, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=1.730, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5:  64%|██████▍   | 200/313 [03:08<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.584, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=1.730, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5:  64%|██████▍   | 200/313 [03:08<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.570, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5:  80%|███████▉  | 250/313 [03:52<00:58,  1.07it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.570, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5:  80%|███████▉  | 250/313 [03:52<00:58,  1.07it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.290, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5:  96%|█████████▌| 300/313 [04:37<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.154, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.290, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5:  96%|█████████▌| 300/313 [04:37<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.517, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.600, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5: 100%|██████████| 313/313 [04:45<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.517, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.600, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5: 100%|██████████| 313/313 [04:45<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.530, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.520, Valid/loss_all_step=0.203, Valid/loss_unet_all_step=0.520, Valid/loss_triplet_all_step=0.197, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.182, Valid/loss_unet_all_epoch=0.567, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=1.580, Valid/knn_avr=0.261, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.86it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.90it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.93it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.144278, 0.144552, 0.141993, 0.164638
Valid average loss UNet                 (all)                : 0.595461

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.137987, 0.147026, 0.338363
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.196163, 0.062550, 0.066387
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.230874, 0.147232, 0.119208
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.188556, 0.107372, 0.119179
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.174116, 0.239399, 0.287625
Valid average loss all      (Triplet)                 : 0.185416

== Recognize ==
Valid average loss Recognize     : 1.484808
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 56.000000 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.191371

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.544811010360718 sec. =
Valid knn accuracy drums     : 46.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.519395351409912 sec. =
Valid knn accuracy bass      : 14.112903225806454%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.17901062965393 sec. =
Valid knn accuracy piano     : 22.4609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2051427364349365 sec. =
Valid knn accuracy guitar    : 21.205357142857142%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9703528881073 sec. =
Valid knn accuracy residuals : 43.18181818181818%

Valid knn accuracy average   : 29.583507557922445%

                                                                      [AEpoch 5: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.530, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.520, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.550, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.480]Epoch 5: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.530, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.520, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.125956, 0.126656, 0.127168, 0.163851
Train average loss UNet                 (all)                : 0.543632

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.084977, 0.159707, 0.501293
Train average loss bass     (Triplet, dist_p, dist_n) : 0.205859, 0.076218, 0.071098
Train average loss piano    (Triplet, dist_p, dist_n) : 0.195293, 0.130072, 0.138079
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.198239, 0.119612, 0.123932
Train average loss residuals(Triplet, dist_p, dist_n) : 0.148055, 0.232694, 0.326691
Train average loss all      (Triplet)                 : 0.167688

== Recognize ==
Train average loss Recognize     : 1.637297
Train average accuracy drums     : 50.375004 %
Train average accuracy bass      : 49.945000 %
Train average accuracy piano     : 49.294998 %
Train average accuracy guitar    : 49.959999 %
Train average accuracy residuals : 50.050003 %

== Train average loss all : 0.173124

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.530, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.520, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.530, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.520, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.530, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.520, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.710, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.563, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.710, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.539, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.690, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6:  48%|████▊     | 150/313 [02:25<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.539, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.690, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6:  48%|████▊     | 150/313 [02:25<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=1.680, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6:  64%|██████▍   | 200/313 [03:08<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=1.680, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6:  64%|██████▍   | 200/313 [03:08<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.552, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.780, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6:  80%|███████▉  | 250/313 [03:54<00:59,  1.07it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.552, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.780, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6:  80%|███████▉  | 250/313 [03:54<00:59,  1.07it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.880, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6:  96%|█████████▌| 300/313 [04:37<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.880, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6:  96%|█████████▌| 300/313 [04:37<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.690, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6: 100%|██████████| 313/313 [04:45<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.690, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6: 100%|██████████| 313/313 [04:45<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.730, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.220, Valid/loss_recog_step=1.610, Valid/loss_all_epoch=0.191, Valid/loss_unet_all_epoch=0.595, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=1.480, Valid/knn_avr=0.296, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.80it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.89it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.86it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.07it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.05it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.132856, 0.138472, 0.126857, 0.173543
Valid average loss UNet                 (all)                : 0.571727

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.145660, 0.233908, 0.490025
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.201219, 0.099993, 0.098775
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.234941, 0.177413, 0.147153
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.187555, 0.160247, 0.196585
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.181176, 0.303453, 0.358363
Valid average loss all      (Triplet)                 : 0.190230

== Recognize ==
Valid average loss Recognize     : 1.688434
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.195947

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.562032699584961 sec. =
Valid knn accuracy drums     : 71.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.798141241073608 sec. =
Valid knn accuracy bass      : 20.56451612903226%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.106651067733765 sec. =
Valid knn accuracy piano     : 16.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.088470935821533 sec. =
Valid knn accuracy guitar    : 25.44642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.25837779045105 sec. =
Valid knn accuracy residuals : 48.18181818181818%

Valid knn accuracy average   : 36.298131380803625%

                                                                      [AEpoch 6: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.730, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.544, Train/loss_triplet_all_epoch=0.168, Train/loss_recog_epoch=1.640]Epoch 6: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.730, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.125759, 0.126343, 0.126894, 0.162608
Train average loss UNet                 (all)                : 0.541604

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.080998, 0.171035, 0.546530
Train average loss bass     (Triplet, dist_p, dist_n) : 0.203291, 0.092310, 0.090850
Train average loss piano    (Triplet, dist_p, dist_n) : 0.193381, 0.135753, 0.146852
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.197817, 0.125407, 0.131975
Train average loss residuals(Triplet, dist_p, dist_n) : 0.148804, 0.236606, 0.329971
Train average loss all      (Triplet)                 : 0.166069

== Recognize ==
Train average loss Recognize     : 1.694419
Train average accuracy drums     : 49.314999 %
Train average accuracy bass      : 50.139999 %
Train average accuracy piano     : 49.285000 %
Train average accuracy guitar    : 50.825001 %
Train average accuracy residuals : 50.279999 %

== Train average loss all : 0.171486

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.730, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.730, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.730, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.580, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7:  32%|███▏      | 100/313 [01:36<03:25,  1.04it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.569, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.580, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7:  32%|███▏      | 100/313 [01:36<03:25,  1.04it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.760, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.760, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.980, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.980, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.940, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.940, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.890, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7:  96%|█████████▌| 300/313 [04:44<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.890, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7:  96%|█████████▌| 300/313 [04:44<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.600, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7: 100%|██████████| 313/313 [04:52<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.600, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7: 100%|██████████| 313/313 [04:52<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.820, Valid/loss_all_step=0.252, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.196, Valid/loss_unet_all_epoch=0.572, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=1.690, Valid/knn_avr=0.363, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.72it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.31it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.02it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.23it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.129617, 0.136231, 0.124756, 0.178161
Valid average loss UNet                 (all)                : 0.568765

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098143, 0.170683, 0.417948
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.194856, 0.044770, 0.049914
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.199752, 0.136613, 0.138883
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.207038, 0.114415, 0.107377
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.148258, 0.234321, 0.316555
Valid average loss all      (Triplet)                 : 0.174093

== Recognize ==
Valid average loss Recognize     : 1.603181
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.179781

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.280279159545898 sec. =
Valid knn accuracy drums     : 52.17391304347826%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.258835077285767 sec. =
Valid knn accuracy bass      : 16.733870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.395350933074951 sec. =
Valid knn accuracy piano     : 14.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.456801652908325 sec. =
Valid knn accuracy guitar    : 29.464285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.058058023452759 sec. =
Valid knn accuracy residuals : 51.590909090909086%

Valid knn accuracy average   : 32.961345763283%

                                                                      [AEpoch 7: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.820, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.542, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=1.690]Epoch 7: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.820, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.125494, 0.126127, 0.126675, 0.160089
Train average loss UNet                 (all)                : 0.538385

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.080928, 0.171725, 0.550675
Train average loss bass     (Triplet, dist_p, dist_n) : 0.204244, 0.076964, 0.073509
Train average loss piano    (Triplet, dist_p, dist_n) : 0.193854, 0.135842, 0.145364
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.195965, 0.125121, 0.133609
Train average loss residuals(Triplet, dist_p, dist_n) : 0.143589, 0.235769, 0.335909
Train average loss all      (Triplet)                 : 0.164900

== Recognize ==
Train average loss Recognize     : 1.719002
Train average accuracy drums     : 50.475002 %
Train average accuracy bass      : 49.829998 %
Train average accuracy piano     : 49.625000 %
Train average accuracy guitar    : 50.500000 %
Train average accuracy residuals : 49.845001 %

== Train average loss all : 0.170284

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.820, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.820, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.820, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.810, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8:  32%|███▏      | 100/313 [01:36<03:25,  1.03it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.810, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8:  32%|███▏      | 100/313 [01:36<03:25,  1.03it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.541, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=1.630, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8:  48%|████▊     | 150/313 [02:23<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.541, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=1.630, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8:  48%|████▊     | 150/313 [02:23<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.700, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8:  64%|██████▍   | 200/313 [03:08<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.549, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.700, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8:  64%|██████▍   | 200/313 [03:08<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=1.760, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8:  80%|███████▉  | 250/313 [03:53<00:58,  1.07it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=1.760, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8:  80%|███████▉  | 250/313 [03:53<00:58,  1.07it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.513, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.940, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.513, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.940, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.516, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.800, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8: 100%|██████████| 313/313 [04:48<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.516, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.800, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8: 100%|██████████| 313/313 [04:48<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=2.040, Valid/loss_all_step=0.206, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.200, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.180, Valid/loss_unet_all_epoch=0.569, Valid/loss_triplet_all_epoch=0.174, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.330, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.70it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.09it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.131567, 0.136350, 0.125247, 0.171500
Valid average loss UNet                 (all)                : 0.564663

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064177, 0.115760, 0.483267
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.210880, 0.074087, 0.063206
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.205567, 0.145995, 0.146820
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.191872, 0.158191, 0.173571
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.135399, 0.222307, 0.320734
Valid average loss all      (Triplet)                 : 0.166527

== Recognize ==
Valid average loss Recognize     : 1.862341
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.172174

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8320653438568115 sec. =
Valid knn accuracy drums     : 52.391304347826086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.995966196060181 sec. =
Valid knn accuracy bass      : 13.306451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.42919373512268 sec. =
Valid knn accuracy piano     : 17.3828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.496269464492798 sec. =
Valid knn accuracy guitar    : 23.214285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.10755467414856 sec. =
Valid knn accuracy residuals : 43.40909090909091%

Valid knn accuracy average   : 29.94078901682119%

                                                                      [AEpoch 8: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=2.040, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.538, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=1.720]Epoch 8: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=2.040, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.125227, 0.125866, 0.126426, 0.158607
Train average loss UNet                 (all)                : 0.536127

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.079127, 0.174090, 0.568822
Train average loss bass     (Triplet, dist_p, dist_n) : 0.205101, 0.075394, 0.071104
Train average loss piano    (Triplet, dist_p, dist_n) : 0.190243, 0.140913, 0.155255
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.189296, 0.136095, 0.152799
Train average loss residuals(Triplet, dist_p, dist_n) : 0.142092, 0.246557, 0.352153
Train average loss all      (Triplet)                 : 0.162490

== Recognize ==
Train average loss Recognize     : 1.760358
Train average accuracy drums     : 49.360001 %
Train average accuracy bass      : 50.620003 %
Train average accuracy piano     : 50.440002 %
Train average accuracy guitar    : 49.834999 %
Train average accuracy residuals : 50.035000 %

== Train average loss all : 0.167851

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=2.040, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=2.040, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=2.040, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=2.100, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9:  32%|███▏      | 100/313 [01:37<03:26,  1.03it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=2.100, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9:  32%|███▏      | 100/313 [01:37<03:26,  1.03it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.532, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.770, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9:  48%|████▊     | 150/313 [02:21<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.532, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.770, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9:  48%|████▊     | 150/313 [02:21<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.780, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9:  64%|██████▍   | 200/313 [03:06<01:45,  1.07it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.562, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.780, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9:  64%|██████▍   | 200/313 [03:06<01:45,  1.07it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.529, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.840, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9:  80%|███████▉  | 250/313 [03:51<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.157, Train/loss_unet_all_step=0.529, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.840, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9:  80%|███████▉  | 250/313 [03:51<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.610, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9:  96%|█████████▌| 300/313 [04:36<00:11,  1.08it/s, v_num=0, Train/loss_all_step=0.156, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=1.610, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9:  96%|█████████▌| 300/313 [04:36<00:11,  1.08it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.513, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.610, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9: 100%|██████████| 313/313 [04:45<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.513, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.610, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9: 100%|██████████| 313/313 [04:45<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.690, Valid/loss_all_step=0.207, Valid/loss_unet_all_step=0.535, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.172, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=1.860, Valid/knn_avr=0.299, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.65it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  6.01it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.90it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.90it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.36it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.135832, 0.139019, 0.128480, 0.161884
Valid average loss UNet                 (all)                : 0.565215

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087391, 0.182717, 0.567822
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.206492, 0.056709, 0.050217
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.196747, 0.160441, 0.166780
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.189204, 0.163191, 0.192654
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.135819, 0.235610, 0.338959
Valid average loss all      (Triplet)                 : 0.163524

== Recognize ==
Valid average loss Recognize     : 1.545391
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.169176

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8048248291015625 sec. =
Valid knn accuracy drums     : 62.17391304347826%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.806258678436279 sec. =
Valid knn accuracy bass      : 18.548387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.132119178771973 sec. =
Valid knn accuracy piano     : 21.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.517659902572632 sec. =
Valid knn accuracy guitar    : 27.232142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.0454089641571045 sec. =
Valid knn accuracy residuals : 44.09090909090909%

Valid knn accuracy average   : 34.784070417660885%

                                                                      [AEpoch 9: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.690, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.536, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.760]Epoch 9: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.690, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.124929, 0.125580, 0.126138, 0.156906
Train average loss UNet                 (all)                : 0.533553

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.076630, 0.167401, 0.571108
Train average loss bass     (Triplet, dist_p, dist_n) : 0.205347, 0.077086, 0.072419
Train average loss piano    (Triplet, dist_p, dist_n) : 0.188095, 0.152351, 0.171482
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.187156, 0.145387, 0.167548
Train average loss residuals(Triplet, dist_p, dist_n) : 0.139564, 0.253455, 0.369486
Train average loss all      (Triplet)                 : 0.160429

== Recognize ==
Train average loss Recognize     : 1.775271
Train average accuracy drums     : 49.724998 %
Train average accuracy bass      : 50.110001 %
Train average accuracy piano     : 49.505001 %
Train average accuracy guitar    : 50.379997 %
Train average accuracy residuals : 50.234997 %

== Train average loss all : 0.165765

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.690, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.690, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10:  16%|█▌        | 50/313 [00:52<04:35,  0.95it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.690, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10:  16%|█▌        | 50/313 [00:52<04:35,  0.95it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.542, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.850, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10:  32%|███▏      | 100/313 [01:37<03:28,  1.02it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.542, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.850, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10:  32%|███▏      | 100/313 [01:37<03:28,  1.02it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.760, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10:  48%|████▊     | 150/313 [02:21<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.760, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10:  48%|████▊     | 150/313 [02:21<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.770, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.555, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.770, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.542, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=2.080, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10:  80%|███████▉  | 250/313 [03:50<00:58,  1.09it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.542, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=2.080, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10:  80%|███████▉  | 250/313 [03:50<00:58,  1.09it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=2.000, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10:  96%|█████████▌| 300/313 [04:34<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=2.000, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10:  96%|█████████▌| 300/313 [04:34<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.690, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10: 100%|██████████| 313/313 [04:42<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.690, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10: 100%|██████████| 313/313 [04:42<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.660, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.188, Valid/loss_recog_step=1.570, Valid/loss_all_epoch=0.169, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.550, Valid/knn_avr=0.348, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.65it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.57it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.45it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.88it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.131025, 0.134966, 0.124292, 0.166683
Valid average loss UNet                 (all)                : 0.556967

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090353, 0.162100, 0.564290
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.214287, 0.088844, 0.074557
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.199012, 0.158660, 0.163541
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.182245, 0.147077, 0.179329
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.125593, 0.254274, 0.389930
Valid average loss all      (Triplet)                 : 0.164055

== Recognize ==
Valid average loss Recognize     : 1.942636
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.169625

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.318402767181396 sec. =
Valid knn accuracy drums     : 56.739130434782616%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.672749519348145 sec. =
Valid knn accuracy bass      : 21.975806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.37786316871643 sec. =
Valid knn accuracy piano     : 18.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.183711767196655 sec. =
Valid knn accuracy guitar    : 31.919642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.030405521392822 sec. =
Valid knn accuracy residuals : 44.54545454545455%

Valid knn accuracy average   : 34.707881857798576%

                                                                      [AEpoch 10: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.660, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.534, Train/loss_triplet_all_epoch=0.160, Train/loss_recog_epoch=1.780]Epoch 10: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.660, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.124729, 0.125409, 0.125989, 0.155685
Train average loss UNet                 (all)                : 0.531812

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.074085, 0.171028, 0.582171
Train average loss bass     (Triplet, dist_p, dist_n) : 0.204042, 0.080149, 0.077449
Train average loss piano    (Triplet, dist_p, dist_n) : 0.187247, 0.151781, 0.171793
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.181016, 0.148253, 0.182023
Train average loss residuals(Triplet, dist_p, dist_n) : 0.133200, 0.251274, 0.376013
Train average loss all      (Triplet)                 : 0.157240

== Recognize ==
Train average loss Recognize     : 1.795846
Train average accuracy drums     : 49.695000 %
Train average accuracy bass      : 49.790001 %
Train average accuracy piano     : 50.045002 %
Train average accuracy guitar    : 49.430000 %
Train average accuracy residuals : 49.634998 %

== Train average loss all : 0.162558

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.660, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.660, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11:  16%|█▌        | 50/313 [00:51<04:29,  0.98it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.560, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.660, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11:  16%|█▌        | 50/313 [00:51<04:29,  0.98it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.640, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11:  32%|███▏      | 100/313 [01:34<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.146, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.640, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11:  32%|███▏      | 100/313 [01:34<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.780, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.780, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.910, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.153, Train/loss_unet_all_step=0.574, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.910, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.542, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.890, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11:  80%|███████▉  | 250/313 [03:50<00:58,  1.09it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.542, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.890, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11:  80%|███████▉  | 250/313 [03:50<00:58,  1.09it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=1.790, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11:  96%|█████████▌| 300/313 [04:33<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=1.790, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11:  96%|█████████▌| 300/313 [04:33<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.790, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.790, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.630, Valid/loss_all_step=0.186, Valid/loss_unet_all_step=0.554, Valid/loss_triplet_all_step=0.181, Valid/loss_recog_step=2.220, Valid/loss_all_epoch=0.170, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.164, Valid/loss_recog_epoch=1.940, Valid/knn_avr=0.347, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.57it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.82it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.98it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.36it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.27it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.132619, 0.135618, 0.126177, 0.160090
Valid average loss UNet                 (all)                : 0.554504

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055040, 0.146441, 0.564122
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.199712, 0.051321, 0.051609
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.198660, 0.163708, 0.165775
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.142937, 0.128576, 0.195988
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.105681, 0.214514, 0.370144
Valid average loss all      (Triplet)                 : 0.141520

== Recognize ==
Valid average loss Recognize     : 1.607137
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.147065

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3493993282318115 sec. =
Valid knn accuracy drums     : 58.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.679380655288696 sec. =
Valid knn accuracy bass      : 23.18548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.126218557357788 sec. =
Valid knn accuracy piano     : 16.6015625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3239970207214355 sec. =
Valid knn accuracy guitar    : 26.785714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.996946573257446 sec. =
Valid knn accuracy residuals : 36.36363636363637%

Valid knn accuracy average   : 32.19597505623759%

                                                                      [AEpoch 11: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.630, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.163, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.157, Train/loss_recog_epoch=1.800]Epoch 11: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.630, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.124581, 0.125254, 0.125830, 0.156399
Train average loss UNet                 (all)                : 0.532064

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.072216, 0.169307, 0.596580
Train average loss bass     (Triplet, dist_p, dist_n) : 0.204630, 0.080012, 0.076226
Train average loss piano    (Triplet, dist_p, dist_n) : 0.184711, 0.153470, 0.177307
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.178436, 0.141258, 0.177927
Train average loss residuals(Triplet, dist_p, dist_n) : 0.131937, 0.254298, 0.382956
Train average loss all      (Triplet)                 : 0.155649

== Recognize ==
Train average loss Recognize     : 1.777062
Train average accuracy drums     : 49.189999 %
Train average accuracy bass      : 49.974998 %
Train average accuracy piano     : 50.134998 %
Train average accuracy guitar    : 50.169998 %
Train average accuracy residuals : 50.959999 %

== Train average loss all : 0.160969

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.630, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.630, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.550, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.630, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.539, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.920, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.148, Train/loss_unet_all_step=0.539, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.920, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.517, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.800, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12:  48%|████▊     | 150/313 [02:19<02:31,  1.07it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.517, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.800, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12:  48%|████▊     | 150/313 [02:19<02:31,  1.07it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.566, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.750, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12:  64%|██████▍   | 200/313 [03:04<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.566, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.750, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12:  64%|██████▍   | 200/313 [03:04<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.770, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12:  80%|███████▉  | 250/313 [03:51<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.553, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.770, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12:  80%|███████▉  | 250/313 [03:51<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.700, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12:  96%|█████████▌| 300/313 [04:35<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.151, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.700, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12:  96%|█████████▌| 300/313 [04:35<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.514, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=1.720, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12: 100%|██████████| 313/313 [04:43<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.143, Train/loss_unet_all_step=0.514, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=1.720, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12: 100%|██████████| 313/313 [04:43<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.532, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.550, Valid/loss_all_step=0.124, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.630, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.610, Valid/knn_avr=0.322, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  2.00it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.81it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.99it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.148265, 0.148728, 0.148214, 0.173851
Valid average loss UNet                 (all)                : 0.619059

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.157530, 0.213797, 0.408599
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.199301, 0.088027, 0.088726
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.228021, 0.173953, 0.150363
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.157635, 0.190499, 0.259940
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.142338, 0.241481, 0.383362
Valid average loss all      (Triplet)                 : 0.170477

== Recognize ==
Valid average loss Recognize     : 1.733531
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.176668

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2276833057403564 sec. =
Valid knn accuracy drums     : 45.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.308368921279907 sec. =
Valid knn accuracy bass      : 14.919354838709678%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.092307567596436 sec. =
Valid knn accuracy piano     : 15.234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.268041610717773 sec. =
Valid knn accuracy guitar    : 22.544642857142858%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.270511627197266 sec. =
Valid knn accuracy residuals : 46.36363636363636%

Valid knn accuracy average   : 28.942836594506478%

                                                                      [AEpoch 12: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.532, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.550, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.161, Train/loss_unet_all_epoch=0.532, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=1.780]Epoch 12: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.532, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.550, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.124282, 0.124960, 0.125568, 0.154824
Train average loss UNet                 (all)                : 0.529633

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.071764, 0.175108, 0.606698
Train average loss bass     (Triplet, dist_p, dist_n) : 0.202963, 0.084088, 0.082761
Train average loss piano    (Triplet, dist_p, dist_n) : 0.183959, 0.158861, 0.184513
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.174050, 0.157021, 0.204283
Train average loss residuals(Triplet, dist_p, dist_n) : 0.129590, 0.264714, 0.400498
Train average loss all      (Triplet)                 : 0.153580

== Recognize ==
Train average loss Recognize     : 1.813562
Train average accuracy drums     : 49.779999 %
Train average accuracy bass      : 50.269997 %
Train average accuracy piano     : 49.634998 %
Train average accuracy guitar    : 49.805000 %
Train average accuracy residuals : 49.105000 %

== Train average loss all : 0.158876

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.532, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.550, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.532, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.550, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.532, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.550, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.750, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13:  32%|███▏      | 100/313 [01:36<03:25,  1.03it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.548, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.750, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13:  32%|███▏      | 100/313 [01:36<03:25,  1.03it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.860, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13:  48%|████▊     | 150/313 [02:18<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.860, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13:  48%|████▊     | 150/313 [02:18<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=1.940, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13:  64%|██████▍   | 200/313 [03:02<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.568, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=1.940, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13:  64%|██████▍   | 200/313 [03:02<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.529, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.810, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.529, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.810, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.850, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.850, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=2.010, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=2.010, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.523, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.870, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.620, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.619, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.289, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.57it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.21it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.69it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.132197, 0.136478, 0.125474, 0.165614
Valid average loss UNet                 (all)                : 0.559762

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098363, 0.208677, 0.508582
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.198420, 0.050214, 0.051794
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.217624, 0.176791, 0.164452
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.153119, 0.164475, 0.236282
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.120023, 0.234209, 0.364898
Valid average loss all      (Triplet)                 : 0.153890

== Recognize ==
Valid average loss Recognize     : 1.872061
Valid average accuracy drums     : 42.000000 %
Valid average accuracy bass      : 55.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.159487

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.078552484512329 sec. =
Valid knn accuracy drums     : 55.434782608695656%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.005545377731323 sec. =
Valid knn accuracy bass      : 13.911290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.275795698165894 sec. =
Valid knn accuracy piano     : 20.5078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.193538188934326 sec. =
Valid knn accuracy guitar    : 37.276785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.968312978744507 sec. =
Valid knn accuracy residuals : 50.227272727272734%

Valid knn accuracy average   : 35.47158877456695%

                                                                      [AEpoch 13: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.523, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.870, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.159, Train/loss_unet_all_epoch=0.530, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=1.810]Epoch 13: 100%|██████████| 313/313 [05:49<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.523, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.870, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.124154, 0.124764, 0.125414, 0.152982
Train average loss UNet                 (all)                : 0.527314

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.071657, 0.176275, 0.610023
Train average loss bass     (Triplet, dist_p, dist_n) : 0.202224, 0.087225, 0.086373
Train average loss piano    (Triplet, dist_p, dist_n) : 0.179547, 0.169439, 0.201111
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.168877, 0.172726, 0.227452
Train average loss residuals(Triplet, dist_p, dist_n) : 0.127638, 0.262163, 0.401215
Train average loss all      (Triplet)                 : 0.151354

== Recognize ==
Train average loss Recognize     : 1.813789
Train average accuracy drums     : 49.669998 %
Train average accuracy bass      : 49.605000 %
Train average accuracy piano     : 50.405003 %
Train average accuracy guitar    : 49.895000 %
Train average accuracy residuals : 50.150002 %

== Train average loss all : 0.156627

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.523, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.870, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.523, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.870, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.523, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.870, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.920, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.554, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.920, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.700, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.139, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=1.700, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.550, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.561, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.550, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.541, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.760, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14:  80%|███████▉  | 250/313 [03:48<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.541, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.760, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14:  80%|███████▉  | 250/313 [03:48<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.760, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14:  96%|█████████▌| 300/313 [04:31<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.760, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14:  96%|█████████▌| 300/313 [04:31<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.800, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.800, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.536, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.610, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.159, Valid/loss_unet_all_epoch=0.560, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=1.870, Valid/knn_avr=0.355, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.01it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.57it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.38it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.30it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.132113, 0.135648, 0.125025, 0.165399
Valid average loss UNet                 (all)                : 0.558185

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.043126, 0.149115, 0.562085
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.174651, 0.099595, 0.138569
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.202617, 0.209698, 0.216441
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.146570, 0.168411, 0.262797
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.102096, 0.233529, 0.390607
Valid average loss all      (Triplet)                 : 0.129047

== Recognize ==
Valid average loss Recognize     : 1.904031
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.134629

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.14426875114441 sec. =
Valid knn accuracy drums     : 59.56521739130435%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.667099475860596 sec. =
Valid knn accuracy bass      : 4.435483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.119043588638306 sec. =
Valid knn accuracy piano     : 17.7734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.499971866607666 sec. =
Valid knn accuracy guitar    : 35.49107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.421789884567261 sec. =
Valid knn accuracy residuals : 45.45454545454545%

Valid knn accuracy average   : 32.5439511290778%

                                                                      [AEpoch 14: 100%|██████████| 313/313 [05:52<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.536, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.610, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.157, Train/loss_unet_all_epoch=0.527, Train/loss_triplet_all_epoch=0.151, Train/loss_recog_epoch=1.810]Epoch 14: 100%|██████████| 313/313 [05:52<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.536, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.610, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.123589, 0.124201, 0.124835, 0.152156
Train average loss UNet                 (all)                : 0.524782

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.067736, 0.172200, 0.617238
Train average loss bass     (Triplet, dist_p, dist_n) : 0.202331, 0.081388, 0.080368
Train average loss piano    (Triplet, dist_p, dist_n) : 0.176872, 0.174155, 0.209732
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.166256, 0.167222, 0.228093
Train average loss residuals(Triplet, dist_p, dist_n) : 0.123914, 0.273859, 0.423446
Train average loss all      (Triplet)                 : 0.148867

== Recognize ==
Train average loss Recognize     : 1.806514
Train average accuracy drums     : 50.370003 %
Train average accuracy bass      : 50.155003 %
Train average accuracy piano     : 50.690002 %
Train average accuracy guitar    : 49.564999 %
Train average accuracy residuals : 50.015003 %

== Train average loss all : 0.154114

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.536, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.610, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.536, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.610, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.536, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.610, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.670, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.544, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.670, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.760, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.131, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.760, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.920, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15:  64%|██████▍   | 200/313 [03:04<01:44,  1.09it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.557, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.920, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15:  64%|██████▍   | 200/313 [03:04<01:44,  1.09it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.532, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=2.170, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.532, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=2.170, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=2.000, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15:  96%|█████████▌| 300/313 [04:31<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=2.000, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15:  96%|█████████▌| 300/313 [04:31<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.880, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.880, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.840, Valid/loss_all_step=0.113, Valid/loss_unet_all_step=0.526, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=2.260, Valid/loss_all_epoch=0.135, Valid/loss_unet_all_epoch=0.558, Valid/loss_triplet_all_epoch=0.129, Valid/loss_recog_epoch=1.900, Valid/knn_avr=0.325, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.91it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.11it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.21it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.17it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.133437, 0.137588, 0.127425, 0.166054
Valid average loss UNet                 (all)                : 0.564503

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099668, 0.207120, 0.580288
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.176699, 0.061791, 0.088050
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.191590, 0.212317, 0.223184
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.145017, 0.181370, 0.283622
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.134970, 0.238167, 0.343661
Valid average loss all      (Triplet)                 : 0.142967

== Recognize ==
Valid average loss Recognize     : 1.753597
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.148612

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.404172897338867 sec. =
Valid knn accuracy drums     : 56.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.975183010101318 sec. =
Valid knn accuracy bass      : 16.93548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.600006103515625 sec. =
Valid knn accuracy piano     : 13.8671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5008721351623535 sec. =
Valid knn accuracy guitar    : 32.8125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.0483715534210205 sec. =
Valid knn accuracy residuals : 42.27272727272727%

Valid knn accuracy average   : 32.438449293956396%

                                                                      [AEpoch 15: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.840, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.154, Train/loss_unet_all_epoch=0.525, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=1.810]Epoch 15: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.840, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.123378, 0.123964, 0.124645, 0.150177
Train average loss UNet                 (all)                : 0.522164

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.066240, 0.178919, 0.656874
Train average loss bass     (Triplet, dist_p, dist_n) : 0.199664, 0.102555, 0.106474
Train average loss piano    (Triplet, dist_p, dist_n) : 0.176351, 0.186286, 0.223993
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.164304, 0.179085, 0.246176
Train average loss residuals(Triplet, dist_p, dist_n) : 0.124207, 0.280577, 0.431462
Train average loss all      (Triplet)                 : 0.147461

== Recognize ==
Train average loss Recognize     : 1.843350
Train average accuracy drums     : 50.669998 %
Train average accuracy bass      : 50.164997 %
Train average accuracy piano     : 49.980000 %
Train average accuracy guitar    : 49.744999 %
Train average accuracy residuals : 49.915001 %

== Train average loss all : 0.152683

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.840, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.840, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.840, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.539, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.970, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16:  32%|███▏      | 100/313 [01:35<03:23,  1.05it/s, v_num=0, Train/loss_all_step=0.134, Train/loss_unet_all_step=0.539, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.970, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16:  32%|███▏      | 100/313 [01:35<03:23,  1.05it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.528, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.750, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.528, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.750, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.670, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.150, Train/loss_unet_all_step=0.558, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.670, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.536, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.690, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.536, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.690, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=1.700, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16:  96%|█████████▌| 300/313 [04:33<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=1.700, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16:  96%|█████████▌| 300/313 [04:33<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.513, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.680, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.142, Train/loss_unet_all_step=0.513, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.680, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.541, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.710, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.150, Valid/loss_recog_step=1.670, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.565, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=1.750, Valid/knn_avr=0.324, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.67it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.54it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.10it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.43it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.134146, 0.135356, 0.126716, 0.166469
Valid average loss UNet                 (all)                : 0.562687

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.051800, 0.186062, 0.625047
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.170764, 0.090290, 0.124668
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.227222, 0.248260, 0.236508
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.144793, 0.175414, 0.297679
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.091078, 0.239878, 0.405942
Valid average loss all      (Triplet)                 : 0.135982

== Recognize ==
Valid average loss Recognize     : 1.766016
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.141608

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.663336753845215 sec. =
Valid knn accuracy drums     : 55.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.468246459960938 sec. =
Valid knn accuracy bass      : 18.14516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.321421146392822 sec. =
Valid knn accuracy piano     : 14.84375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.219007730484009 sec. =
Valid knn accuracy guitar    : 36.607142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.047844171524048 sec. =
Valid knn accuracy residuals : 37.95454545454545%

Valid knn accuracy average   : 32.553598181271745%

                                                                      [AEpoch 16: 100%|██████████| 313/313 [05:52<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.541, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.710, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.153, Train/loss_unet_all_epoch=0.522, Train/loss_triplet_all_epoch=0.147, Train/loss_recog_epoch=1.840]Epoch 16: 100%|██████████| 313/313 [05:52<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.541, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.710, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.123036, 0.123645, 0.124376, 0.149213
Train average loss UNet                 (all)                : 0.520271

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.065156, 0.182563, 0.660642
Train average loss bass     (Triplet, dist_p, dist_n) : 0.190067, 0.117813, 0.135319
Train average loss piano    (Triplet, dist_p, dist_n) : 0.173099, 0.190999, 0.233367
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.160103, 0.181649, 0.256693
Train average loss residuals(Triplet, dist_p, dist_n) : 0.118874, 0.289603, 0.452661
Train average loss all      (Triplet)                 : 0.142649

== Recognize ==
Train average loss Recognize     : 1.828781
Train average accuracy drums     : 49.744999 %
Train average accuracy bass      : 50.120003 %
Train average accuracy piano     : 49.904999 %
Train average accuracy guitar    : 49.820000 %
Train average accuracy residuals : 50.040001 %

== Train average loss all : 0.147852

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.541, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.710, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.541, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.710, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17:  16%|█▌        | 50/313 [00:51<04:29,  0.97it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.541, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.710, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17:  16%|█▌        | 50/313 [00:51<04:29,  0.97it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.540, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.650, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17:  32%|███▏      | 100/313 [01:35<03:23,  1.05it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.540, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.650, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17:  32%|███▏      | 100/313 [01:35<03:23,  1.05it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.538, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.710, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17:  48%|████▊     | 150/313 [02:20<02:32,  1.07it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.538, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.710, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17:  48%|████▊     | 150/313 [02:20<02:32,  1.07it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.830, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17:  64%|██████▍   | 200/313 [03:04<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.147, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.830, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17:  64%|██████▍   | 200/313 [03:04<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.536, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=1.700, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.111, Train/loss_unet_all_step=0.536, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=1.700, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.830, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.830, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.830, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.830, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.620, Valid/loss_all_step=0.121, Valid/loss_unet_all_step=0.560, Valid/loss_triplet_all_step=0.115, Valid/loss_recog_step=2.030, Valid/loss_all_epoch=0.142, Valid/loss_unet_all_epoch=0.563, Valid/loss_triplet_all_epoch=0.136, Valid/loss_recog_epoch=1.770, Valid/knn_avr=0.326, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.91it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.18it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.79it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.36it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.132081, 0.134923, 0.126484, 0.160382
Valid average loss UNet                 (all)                : 0.553870

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055151, 0.191350, 0.577614
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.173732, 0.100721, 0.139460
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.188685, 0.237542, 0.263027
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.150892, 0.201943, 0.289122
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.096189, 0.217949, 0.379983
Valid average loss all      (Triplet)                 : 0.126000

== Recognize ==
Valid average loss Recognize     : 1.737445
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 44.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.131539

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.275640487670898 sec. =
Valid knn accuracy drums     : 56.086956521739125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.122284412384033 sec. =
Valid knn accuracy bass      : 25.403225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.367882490158081 sec. =
Valid knn accuracy piano     : 19.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.65565037727356 sec. =
Valid knn accuracy guitar    : 39.285714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.0649964809417725 sec. =
Valid knn accuracy residuals : 40.22727272727273%

Valid knn accuracy average   : 36.18500886823555%

                                                                      [AEpoch 17: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.620, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.148, Train/loss_unet_all_epoch=0.520, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=1.830]Epoch 17: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.620, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.122767, 0.123475, 0.124099, 0.148747
Train average loss UNet                 (all)                : 0.519089

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.064503, 0.188613, 0.690044
Train average loss bass     (Triplet, dist_p, dist_n) : 0.187273, 0.120665, 0.143036
Train average loss piano    (Triplet, dist_p, dist_n) : 0.170942, 0.194039, 0.241379
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.155195, 0.186324, 0.272437
Train average loss residuals(Triplet, dist_p, dist_n) : 0.116236, 0.295229, 0.466604
Train average loss all      (Triplet)                 : 0.140008

== Recognize ==
Train average loss Recognize     : 1.761054
Train average accuracy drums     : 49.775002 %
Train average accuracy bass      : 50.209999 %
Train average accuracy piano     : 49.785000 %
Train average accuracy guitar    : 49.665001 %
Train average accuracy residuals : 50.024998 %

== Train average loss all : 0.145198

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.620, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.620, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.124, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.620, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.541, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.520, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.541, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.520, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.640, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.640, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.535, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.610, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18:  64%|██████▍   | 200/313 [03:04<01:44,  1.09it/s, v_num=0, Train/loss_all_step=0.138, Train/loss_unet_all_step=0.535, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.610, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18:  64%|██████▍   | 200/313 [03:04<01:44,  1.09it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.534, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.630, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18:  80%|███████▉  | 250/313 [03:49<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.534, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.630, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18:  80%|███████▉  | 250/313 [03:49<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=1.720, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18:  96%|█████████▌| 300/313 [04:33<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=1.720, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18:  96%|█████████▌| 300/313 [04:33<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.910, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.152, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=1.910, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]Epoch 18: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=1.400, Valid/loss_all_step=0.0818, Valid/loss_unet_all_step=0.545, Valid/loss_triplet_all_step=0.0763, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.132, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.126, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.362, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.70it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.79it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.39it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.84it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.13it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.130469, 0.134539, 0.124195, 0.170001
Valid average loss UNet                 (all)                : 0.559204

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.053805, 0.168793, 0.546214
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.168585, 0.115520, 0.164003
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.191818, 0.254901, 0.288768
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.188962, 0.222937, 0.282705
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.148363, 0.293423, 0.401438
Valid average loss all      (Triplet)                 : 0.146041

== Recognize ==
Valid average loss Recognize     : 1.592174
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.151633

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8045947551727295 sec. =
Valid knn accuracy drums     : 55.434782608695656%
= T-SNE...
T-SNE was finished!
= T-SNE time is 16.63902235031128 sec. =
Valid knn accuracy bass      : 9.879032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.182384729385376 sec. =
Valid knn accuracy piano     : 19.7265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.186536073684692 sec. =
Valid knn accuracy guitar    : 35.714285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.220011949539185 sec. =
Valid knn accuracy residuals : 40.45454545454545%

Valid knn accuracy average   : 32.24184170711827%

                                                                      [AEpoch 18: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=1.400, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.145, Train/loss_unet_all_epoch=0.519, Train/loss_triplet_all_epoch=0.140, Train/loss_recog_epoch=1.760]  Epoch 18: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=1.400, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.122723, 0.123311, 0.124017, 0.148379
Train average loss UNet                 (all)                : 0.518430

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.062658, 0.184952, 0.699020
Train average loss bass     (Triplet, dist_p, dist_n) : 0.182198, 0.129861, 0.160972
Train average loss piano    (Triplet, dist_p, dist_n) : 0.165159, 0.201958, 0.257952
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.151362, 0.193486, 0.286555
Train average loss residuals(Triplet, dist_p, dist_n) : 0.111641, 0.300070, 0.481003
Train average loss all      (Triplet)                 : 0.135792

== Recognize ==
Train average loss Recognize     : 1.706872
Train average accuracy drums     : 49.990002 %
Train average accuracy bass      : 50.445004 %
Train average accuracy piano     : 50.585003 %
Train average accuracy guitar    : 49.845001 %
Train average accuracy residuals : 50.080002 %

== Train average loss all : 0.140976

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=1.400, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=1.400, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.106, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=1.400, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.540, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.630, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.116, Train/loss_unet_all_step=0.540, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.630, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.810, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.130, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=1.810, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.630, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.125, Train/loss_unet_all_step=0.551, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=1.630, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.660, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.660, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=1.870, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=1.870, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.700, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.141, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.700, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.910, Valid/loss_all_step=0.132, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.559, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.590, Valid/knn_avr=0.322, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.69it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.98it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.98it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.132471, 0.135771, 0.126669, 0.161315
Valid average loss UNet                 (all)                : 0.556227

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.104937, 0.232602, 0.644598
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.179559, 0.149592, 0.202265
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.177632, 0.255191, 0.302139
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.184567, 0.293926, 0.361028
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.172128, 0.308802, 0.403361
Valid average loss all      (Triplet)                 : 0.155907

== Recognize ==
Valid average loss Recognize     : 1.732192
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.161469

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.376394987106323 sec. =
Valid knn accuracy drums     : 58.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.104671001434326 sec. =
Valid knn accuracy bass      : 11.693548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.38443660736084 sec. =
Valid knn accuracy piano     : 16.796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.196393251419067 sec. =
Valid knn accuracy guitar    : 42.410714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.012614727020264 sec. =
Valid knn accuracy residuals : 36.81818181818181%

Valid knn accuracy average   : 33.15255955037249%

                                                                      [AEpoch 19: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.910, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.141, Train/loss_unet_all_epoch=0.518, Train/loss_triplet_all_epoch=0.136, Train/loss_recog_epoch=1.710]Epoch 19: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.910, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.122547, 0.123211, 0.123868, 0.147762
Train average loss UNet                 (all)                : 0.517388

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.061118, 0.192871, 0.727881
Train average loss bass     (Triplet, dist_p, dist_n) : 0.180089, 0.134989, 0.168384
Train average loss piano    (Triplet, dist_p, dist_n) : 0.162890, 0.203879, 0.262420
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.149684, 0.196470, 0.296558
Train average loss residuals(Triplet, dist_p, dist_n) : 0.111505, 0.313096, 0.502492
Train average loss all      (Triplet)                 : 0.134120

== Recognize ==
Train average loss Recognize     : 1.697806
Train average accuracy drums     : 50.244999 %
Train average accuracy bass      : 50.860001 %
Train average accuracy piano     : 50.285000 %
Train average accuracy guitar    : 50.215000 %
Train average accuracy residuals : 49.884998 %

== Train average loss all : 0.139294

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.910, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.910, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.910, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.524, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.740, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20:  32%|███▏      | 100/313 [01:34<03:21,  1.05it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.524, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.740, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20:  32%|███▏      | 100/313 [01:34<03:21,  1.05it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.680, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.140, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=1.680, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.524, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.710, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.524, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.710, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.513, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=1.830, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.108, Train/loss_unet_all_step=0.513, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=1.830, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=1.770, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=1.770, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.750, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.137, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=1.750, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.0954, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.0903, Train/loss_recog_step=1.710, Valid/loss_all_step=0.157, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.152, Valid/loss_recog_step=1.840, Valid/loss_all_epoch=0.161, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.730, Valid/knn_avr=0.332, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.77it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.17it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.130575, 0.134898, 0.124292, 0.163006
Valid average loss UNet                 (all)                : 0.552771

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.096642, 0.249035, 0.632524
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.200607, 0.146148, 0.154477
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.174154, 0.227339, 0.277418
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.175459, 0.294923, 0.433279
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.143961, 0.268886, 0.396266
Valid average loss all      (Triplet)                 : 0.148512

== Recognize ==
Valid average loss Recognize     : 1.819337
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 56.000000 %

== Valid average loss all : 0.154040

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.868536472320557 sec. =
Valid knn accuracy drums     : 58.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.044028282165527 sec. =
Valid knn accuracy bass      : 12.298387096774194%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.386279344558716 sec. =
Valid knn accuracy piano     : 16.2109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.240137100219727 sec. =
Valid knn accuracy guitar    : 35.267857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.023855686187744 sec. =
Valid knn accuracy residuals : 42.95454545454545%

Valid knn accuracy average   : 32.95504109100927%

                                                                      [AEpoch 20: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0954, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.0903, Train/loss_recog_step=1.710, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.139, Train/loss_unet_all_epoch=0.517, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=1.700]Epoch 20: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0954, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.0903, Train/loss_recog_step=1.710, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.122394, 0.123111, 0.123757, 0.146939
Train average loss UNet                 (all)                : 0.516200

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.060559, 0.196051, 0.732446
Train average loss bass     (Triplet, dist_p, dist_n) : 0.179209, 0.137716, 0.172925
Train average loss piano    (Triplet, dist_p, dist_n) : 0.160309, 0.212860, 0.277738
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.146110, 0.201266, 0.308765
Train average loss residuals(Triplet, dist_p, dist_n) : 0.107241, 0.315934, 0.512682
Train average loss all      (Triplet)                 : 0.131839

== Recognize ==
Train average loss Recognize     : 1.706264
Train average accuracy drums     : 49.410000 %
Train average accuracy bass      : 50.064999 %
Train average accuracy piano     : 49.869999 %
Train average accuracy guitar    : 50.070000 %
Train average accuracy residuals : 49.990002 %

== Train average loss all : 0.137001

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0954, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.0903, Train/loss_recog_step=1.710, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0954, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.0903, Train/loss_recog_step=1.710, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.0954, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.0903, Train/loss_recog_step=1.710, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.660, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]  Epoch 21:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.660, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.720, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21:  48%|████▊     | 150/313 [02:17<02:28,  1.09it/s, v_num=0, Train/loss_all_step=0.135, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.720, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21:  48%|████▊     | 150/313 [02:17<02:28,  1.09it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.539, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.710, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.539, Train/loss_triplet_all_step=0.115, Train/loss_recog_step=1.710, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.770, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.770, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.800, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.800, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.760, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.132, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.760, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.089, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.0838, Train/loss_recog_step=1.580, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.106, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.154, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.149, Valid/loss_recog_epoch=1.820, Valid/knn_avr=0.330, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.64it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.13it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.26it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.128911, 0.132971, 0.123577, 0.168668
Valid average loss UNet                 (all)                : 0.554127

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097646, 0.248671, 0.641368
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.185671, 0.120859, 0.135952
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.196366, 0.277518, 0.304570
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.148350, 0.251778, 0.407462
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.140807, 0.261292, 0.393489
Valid average loss all      (Triplet)                 : 0.146417

== Recognize ==
Valid average loss Recognize     : 1.739761
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 44.000000 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 54.000004 %

== Valid average loss all : 0.151959

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.567976713180542 sec. =
Valid knn accuracy drums     : 63.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.023234367370605 sec. =
Valid knn accuracy bass      : 18.346774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.289064407348633 sec. =
Valid knn accuracy piano     : 17.96875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.560039043426514 sec. =
Valid knn accuracy guitar    : 31.026785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.110495090484619 sec. =
Valid knn accuracy residuals : 39.77272727272727%

Valid knn accuracy average   : 34.11865961002532%

                                                                      [AEpoch 21: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.089, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.0838, Train/loss_recog_step=1.580, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.137, Train/loss_unet_all_epoch=0.516, Train/loss_triplet_all_epoch=0.132, Train/loss_recog_epoch=1.710]Epoch 21: 100%|██████████| 313/313 [05:48<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.089, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.0838, Train/loss_recog_step=1.580, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.122308, 0.122967, 0.123563, 0.145739
Train average loss UNet                 (all)                : 0.514577

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.060825, 0.200434, 0.750375
Train average loss bass     (Triplet, dist_p, dist_n) : 0.174791, 0.141003, 0.184022
Train average loss piano    (Triplet, dist_p, dist_n) : 0.154456, 0.226318, 0.302165
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.143985, 0.212531, 0.326438
Train average loss residuals(Triplet, dist_p, dist_n) : 0.104289, 0.324109, 0.530149
Train average loss all      (Triplet)                 : 0.128845

== Recognize ==
Train average loss Recognize     : 1.693749
Train average accuracy drums     : 50.365002 %
Train average accuracy bass      : 50.099998 %
Train average accuracy piano     : 49.884998 %
Train average accuracy guitar    : 49.889999 %
Train average accuracy residuals : 49.704998 %

== Train average loss all : 0.133990

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.089, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.0838, Train/loss_recog_step=1.580, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.089, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.0838, Train/loss_recog_step=1.580, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.089, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.0838, Train/loss_recog_step=1.580, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.0999, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.0946, Train/loss_recog_step=1.640, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.0999, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.0946, Train/loss_recog_step=1.640, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.710, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]  Epoch 22:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.710, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.528, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.590, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.136, Train/loss_unet_all_step=0.528, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.590, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.730, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.730, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.750, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.750, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.700, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.700, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.078, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0729, Train/loss_recog_step=1.660, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.554, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.341, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.72it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.77it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.31it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.81it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.132486, 0.134704, 0.125424, 0.163195
Valid average loss UNet                 (all)                : 0.555810

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113908, 0.255691, 0.577561
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.178059, 0.141075, 0.168688
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.175545, 0.256506, 0.313624
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.155054, 0.248088, 0.393964
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.154754, 0.329737, 0.448024
Valid average loss all      (Triplet)                 : 0.144884

== Recognize ==
Valid average loss Recognize     : 1.702854
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.150443

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.777965307235718 sec. =
Valid knn accuracy drums     : 63.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.64645767211914 sec. =
Valid knn accuracy bass      : 26.61290322580645%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.33472990989685 sec. =
Valid knn accuracy piano     : 19.7265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.418023109436035 sec. =
Valid knn accuracy guitar    : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.816675424575806 sec. =
Valid knn accuracy residuals : 38.18181818181819%

Valid knn accuracy average   : 37.681430694568405%

                                                                      [AEpoch 22: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.078, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0729, Train/loss_recog_step=1.660, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.134, Train/loss_unet_all_epoch=0.515, Train/loss_triplet_all_epoch=0.129, Train/loss_recog_epoch=1.690]Epoch 22: 100%|██████████| 313/313 [05:46<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.078, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0729, Train/loss_recog_step=1.660, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.121941, 0.122591, 0.123211, 0.144941
Train average loss UNet                 (all)                : 0.512685

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.057226, 0.202842, 0.773421
Train average loss bass     (Triplet, dist_p, dist_n) : 0.173311, 0.146145, 0.192496
Train average loss piano    (Triplet, dist_p, dist_n) : 0.152595, 0.224453, 0.303119
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.139069, 0.219202, 0.344803
Train average loss residuals(Triplet, dist_p, dist_n) : 0.102073, 0.332891, 0.548010
Train average loss all      (Triplet)                 : 0.125878

== Recognize ==
Train average loss Recognize     : 1.729392
Train average accuracy drums     : 49.974998 %
Train average accuracy bass      : 50.160004 %
Train average accuracy piano     : 50.204998 %
Train average accuracy guitar    : 50.125004 %
Train average accuracy residuals : 50.145000 %

== Train average loss all : 0.131005

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.078, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0729, Train/loss_recog_step=1.660, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.078, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0729, Train/loss_recog_step=1.660, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.078, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0729, Train/loss_recog_step=1.660, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.539, Train/loss_triplet_all_step=0.0954, Train/loss_recog_step=1.480, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23:  32%|███▏      | 100/313 [01:34<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.539, Train/loss_triplet_all_step=0.0954, Train/loss_recog_step=1.480, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23:  32%|███▏      | 100/313 [01:34<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.960, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730] Epoch 23:  48%|████▊     | 150/313 [02:19<02:31,  1.07it/s, v_num=0, Train/loss_all_step=0.155, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.960, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23:  48%|████▊     | 150/313 [02:19<02:31,  1.07it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.536, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=1.580, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.113, Train/loss_unet_all_step=0.536, Train/loss_triplet_all_step=0.107, Train/loss_recog_step=1.580, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=1.750, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=1.750, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=1.680, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23:  96%|█████████▌| 300/313 [04:33<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.121, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=1.680, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23:  96%|█████████▌| 300/313 [04:33<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=1.850, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=1.850, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.0818, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.0769, Train/loss_recog_step=1.530, Valid/loss_all_step=0.112, Valid/loss_unet_all_step=0.568, Valid/loss_triplet_all_step=0.107, Valid/loss_recog_step=1.640, Valid/loss_all_epoch=0.150, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.145, Valid/loss_recog_epoch=1.700, Valid/knn_avr=0.377, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.47it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.20it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.13it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.130897, 0.133052, 0.123306, 0.156678
Valid average loss UNet                 (all)                : 0.543933

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068310, 0.251122, 0.707861
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.187406, 0.162719, 0.177660
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.176504, 0.273338, 0.345354
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.130673, 0.232803, 0.410188
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.113492, 0.299347, 0.473968
Valid average loss all      (Triplet)                 : 0.132021

== Recognize ==
Valid average loss Recognize     : 1.711932
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.137461

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.72933292388916 sec. =
Valid knn accuracy drums     : 55.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.231668710708618 sec. =
Valid knn accuracy bass      : 20.56451612903226%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.13776683807373 sec. =
Valid knn accuracy piano     : 18.5546875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4596030712127686 sec. =
Valid knn accuracy guitar    : 34.375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.995010852813721 sec. =
Valid knn accuracy residuals : 40.909090909090914%

Valid knn accuracy average   : 34.01109369023333%

                                                                      [AEpoch 23: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0818, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.0769, Train/loss_recog_step=1.530, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.131, Train/loss_unet_all_epoch=0.513, Train/loss_triplet_all_epoch=0.126, Train/loss_recog_epoch=1.730]Epoch 23: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0818, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.0769, Train/loss_recog_step=1.530, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.121710, 0.122339, 0.122987, 0.144300
Train average loss UNet                 (all)                : 0.511336

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.057471, 0.208795, 0.780871
Train average loss bass     (Triplet, dist_p, dist_n) : 0.168684, 0.146117, 0.198863
Train average loss piano    (Triplet, dist_p, dist_n) : 0.148073, 0.234287, 0.322524
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.135881, 0.222977, 0.359294
Train average loss residuals(Triplet, dist_p, dist_n) : 0.097787, 0.331420, 0.551733
Train average loss all      (Triplet)                 : 0.122450

== Recognize ==
Train average loss Recognize     : 1.713768
Train average accuracy drums     : 50.120003 %
Train average accuracy bass      : 51.050003 %
Train average accuracy piano     : 49.520000 %
Train average accuracy guitar    : 49.759998 %
Train average accuracy residuals : 50.279999 %

== Train average loss all : 0.127563

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0818, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.0769, Train/loss_recog_step=1.530, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0818, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.0769, Train/loss_recog_step=1.530, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]Epoch 24:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.0818, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.0769, Train/loss_recog_step=1.530, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]Epoch 24:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.0917, Train/loss_unet_all_step=0.517, Train/loss_triplet_all_step=0.0865, Train/loss_recog_step=1.660, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]Epoch 24:  32%|███▏      | 100/313 [01:33<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.0917, Train/loss_unet_all_step=0.517, Train/loss_triplet_all_step=0.0865, Train/loss_recog_step=1.660, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]Epoch 24:  32%|███▏      | 100/313 [01:33<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.490, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]  Epoch 24:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.145, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=1.490, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]Epoch 24:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.630, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]Epoch 24:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=1.630, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]Epoch 24:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.510, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]Epoch 24:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.510, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]Epoch 24:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.910, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]Epoch 24:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=1.910, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]Epoch 24:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.780, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]Epoch 24: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.780, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]Epoch 24: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0723, Train/loss_recog_step=2.060, Valid/loss_all_step=0.0782, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.0728, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.137, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.132, Valid/loss_recog_epoch=1.710, Valid/knn_avr=0.340, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.59it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.15it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.132952, 0.134611, 0.126153, 0.163437
Valid average loss UNet                 (all)                : 0.557153

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.071641, 0.226016, 0.675338
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.183087, 0.153089, 0.179671
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.195250, 0.281689, 0.318905
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.131137, 0.238081, 0.379338
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.163866, 0.320931, 0.447853
Valid average loss all      (Triplet)                 : 0.147294

== Recognize ==
Valid average loss Recognize     : 1.742074
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.152865

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.282153367996216 sec. =
Valid knn accuracy drums     : 58.913043478260875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.005175590515137 sec. =
Valid knn accuracy bass      : 28.62903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.502315759658813 sec. =
Valid knn accuracy piano     : 15.8203125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.358284950256348 sec. =
Valid knn accuracy guitar    : 37.276785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.499981164932251 sec. =
Valid knn accuracy residuals : 39.31818181818182%

Valid knn accuracy average   : 35.99147115375859%

                                                                      [AEpoch 24: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0723, Train/loss_recog_step=2.060, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.128, Train/loss_unet_all_epoch=0.511, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=1.710]  Epoch 24: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0723, Train/loss_recog_step=2.060, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.121446, 0.122074, 0.122703, 0.142982
Train average loss UNet                 (all)                : 0.509204

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.055223, 0.214995, 0.793725
Train average loss bass     (Triplet, dist_p, dist_n) : 0.167291, 0.155426, 0.213009
Train average loss piano    (Triplet, dist_p, dist_n) : 0.142928, 0.244525, 0.342015
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.130217, 0.235551, 0.381367
Train average loss residuals(Triplet, dist_p, dist_n) : 0.092989, 0.345045, 0.584228
Train average loss all      (Triplet)                 : 0.118904

== Recognize ==
Train average loss Recognize     : 1.725641
Train average accuracy drums     : 49.639999 %
Train average accuracy bass      : 50.015003 %
Train average accuracy piano     : 49.559998 %
Train average accuracy guitar    : 50.010002 %
Train average accuracy residuals : 50.365002 %

== Train average loss all : 0.123996

Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0723, Train/loss_recog_step=2.060, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]          Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0723, Train/loss_recog_step=2.060, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]Epoch 25:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0723, Train/loss_recog_step=2.060, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]Epoch 25:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.0995, Train/loss_recog_step=1.640, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730] Epoch 25:  32%|███▏      | 100/313 [01:34<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.105, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.0995, Train/loss_recog_step=1.640, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]Epoch 25:  32%|███▏      | 100/313 [01:34<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.590, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730] Epoch 25:  48%|████▊     | 150/313 [02:19<02:31,  1.07it/s, v_num=0, Train/loss_all_step=0.149, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=1.590, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]Epoch 25:  48%|████▊     | 150/313 [02:19<02:31,  1.07it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.500, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]Epoch 25:  64%|██████▍   | 200/313 [03:04<01:44,  1.09it/s, v_num=0, Train/loss_all_step=0.114, Train/loss_unet_all_step=0.565, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.500, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]Epoch 25:  64%|██████▍   | 200/313 [03:04<01:44,  1.09it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0991, Train/loss_recog_step=1.920, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]Epoch 25:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.104, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0991, Train/loss_recog_step=1.920, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]Epoch 25:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0957, Train/loss_recog_step=1.700, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]Epoch 25:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0957, Train/loss_recog_step=1.700, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]Epoch 25:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.750, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730] Epoch 25: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.126, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.750, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]Epoch 25: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.0551, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=1.560, Valid/loss_all_step=0.137, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.147, Valid/loss_recog_epoch=1.740, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.69it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.13it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.02it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.131400, 0.133379, 0.124279, 0.160915
Valid average loss UNet                 (all)                : 0.549973

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.058735, 0.219593, 0.686146
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.173958, 0.147153, 0.179327
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.208316, 0.283642, 0.309031
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.152383, 0.239596, 0.375456
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.134569, 0.306319, 0.455648
Valid average loss all      (Triplet)                 : 0.141382

== Recognize ==
Valid average loss Recognize     : 1.805186
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 57.500000 %
Valid average accuracy piano     : 58.499996 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.146881

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9618775844573975 sec. =
Valid knn accuracy drums     : 58.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.0126211643219 sec. =
Valid knn accuracy bass      : 25.403225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.226995944976807 sec. =
Valid knn accuracy piano     : 16.40625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.180347442626953 sec. =
Valid knn accuracy guitar    : 35.714285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.257412910461426 sec. =
Valid knn accuracy residuals : 44.31818181818182%

Valid knn accuracy average   : 36.02056258082731%

                                                                      [AEpoch 25: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0551, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=1.560, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.124, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=1.730]Epoch 25: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0551, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=1.560, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.121400, 0.121972, 0.122641, 0.143526
Train average loss UNet                 (all)                : 0.509538

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.053558, 0.226897, 0.828768
Train average loss bass     (Triplet, dist_p, dist_n) : 0.164898, 0.157228, 0.217689
Train average loss piano    (Triplet, dist_p, dist_n) : 0.138621, 0.256804, 0.363609
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.123600, 0.245503, 0.408372
Train average loss residuals(Triplet, dist_p, dist_n) : 0.088355, 0.363001, 0.619918
Train average loss all      (Triplet)                 : 0.115095

== Recognize ==
Train average loss Recognize     : 1.772970
Train average accuracy drums     : 50.070000 %
Train average accuracy bass      : 50.120003 %
Train average accuracy piano     : 50.470001 %
Train average accuracy guitar    : 49.639999 %
Train average accuracy residuals : 50.344997 %

== Train average loss all : 0.120190

Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0551, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=1.560, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]          Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0551, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=1.560, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]Epoch 26:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.0551, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0499, Train/loss_recog_step=1.560, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]Epoch 26:  16%|█▌        | 50/313 [00:50<04:26,  0.99it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.538, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.840, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]  Epoch 26:  32%|███▏      | 100/313 [01:35<03:23,  1.04it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.538, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.840, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]Epoch 26:  32%|███▏      | 100/313 [01:35<03:23,  1.04it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.501, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.920, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]Epoch 26:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.501, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.920, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]Epoch 26:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.537, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=1.820, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]Epoch 26:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.537, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=1.820, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]Epoch 26:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.860, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]Epoch 26:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.860, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]Epoch 26:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.0975, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0927, Train/loss_recog_step=1.750, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]Epoch 26:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.0975, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0927, Train/loss_recog_step=1.750, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]Epoch 26:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=1.880, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]  Epoch 26: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.117, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=1.880, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]Epoch 26: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.056, Train/loss_recog_step=1.700, Valid/loss_all_step=0.119, Valid/loss_unet_all_step=0.540, Valid/loss_triplet_all_step=0.113, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.147, Valid/loss_unet_all_epoch=0.550, Valid/loss_triplet_all_epoch=0.141, Valid/loss_recog_epoch=1.810, Valid/knn_avr=0.360, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.83it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.86it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.02it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.43it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.27it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.130089, 0.133583, 0.123344, 0.155870
Valid average loss UNet                 (all)                : 0.542885

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.071630, 0.293697, 0.837413
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.195084, 0.147612, 0.161753
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.202504, 0.322230, 0.361557
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.143012, 0.271769, 0.442200
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.118744, 0.336750, 0.512649
Valid average loss all      (Triplet)                 : 0.142135

== Recognize ==
Valid average loss Recognize     : 1.784583
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.147564

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.940954923629761 sec. =
Valid knn accuracy drums     : 60.43478260869565%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.308052778244019 sec. =
Valid knn accuracy bass      : 21.16935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.316324234008789 sec. =
Valid knn accuracy piano     : 17.578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.348403692245483 sec. =
Valid knn accuracy guitar    : 36.607142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.053489923477173 sec. =
Valid knn accuracy residuals : 45.0%

Valid knn accuracy average   : 36.15788106090964%

                                                                      [AEpoch 26: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.056, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.120, Train/loss_unet_all_epoch=0.510, Train/loss_triplet_all_epoch=0.115, Train/loss_recog_epoch=1.770]Epoch 26: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.056, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.121217, 0.121849, 0.122502, 0.142965
Train average loss UNet                 (all)                : 0.508534

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.052635, 0.247586, 0.862480
Train average loss bass     (Triplet, dist_p, dist_n) : 0.163028, 0.159559, 0.223414
Train average loss piano    (Triplet, dist_p, dist_n) : 0.132202, 0.265442, 0.384317
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.119443, 0.254824, 0.431752
Train average loss residuals(Triplet, dist_p, dist_n) : 0.083241, 0.378443, 0.653588
Train average loss all      (Triplet)                 : 0.111470

== Recognize ==
Train average loss Recognize     : 1.790576
Train average accuracy drums     : 49.520000 %
Train average accuracy bass      : 50.575001 %
Train average accuracy piano     : 50.454998 %
Train average accuracy guitar    : 49.820000 %
Train average accuracy residuals : 49.610001 %

== Train average loss all : 0.116555

Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.056, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]          Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.056, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.056, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.526, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.810, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27:  32%|███▏      | 100/313 [01:35<03:24,  1.04it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.526, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.810, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27:  32%|███▏      | 100/313 [01:35<03:24,  1.04it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.910, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.129, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.910, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.710, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.120, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.710, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.0964, Train/loss_recog_step=1.750, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.0964, Train/loss_recog_step=1.750, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.0899, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.0851, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27:  96%|█████████▌| 300/313 [04:31<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.0899, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.0851, Train/loss_recog_step=1.700, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27:  96%|█████████▌| 300/313 [04:31<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.0996, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.0947, Train/loss_recog_step=1.580, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.0996, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.0947, Train/loss_recog_step=1.580, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.0681, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.063, Train/loss_recog_step=1.840, Valid/loss_all_step=0.0881, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.0828, Valid/loss_recog_step=1.650, Valid/loss_all_epoch=0.148, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.142, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.362, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.29it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.131605, 0.134203, 0.125069, 0.152385
Valid average loss UNet                 (all)                : 0.543261

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.074324, 0.248513, 0.772883
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.180785, 0.159425, 0.186945
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.200219, 0.324488, 0.338326
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.178565, 0.299166, 0.435586
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.127911, 0.359035, 0.552556
Valid average loss all      (Triplet)                 : 0.146055

== Recognize ==
Valid average loss Recognize     : 1.779014
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.151488

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.407769203186035 sec. =
Valid knn accuracy drums     : 57.391304347826086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.920862197875977 sec. =
Valid knn accuracy bass      : 26.411290322580644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.80225419998169 sec. =
Valid knn accuracy piano     : 19.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.301374435424805 sec. =
Valid knn accuracy guitar    : 35.714285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.101253271102905 sec. =
Valid knn accuracy residuals : 47.04545454545455%

Valid knn accuracy average   : 37.140591986029406%

                                                                      [AEpoch 27: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0681, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.063, Train/loss_recog_step=1.840, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.117, Train/loss_unet_all_epoch=0.509, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=1.790]Epoch 27: 100%|██████████| 313/313 [05:52<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0681, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.063, Train/loss_recog_step=1.840, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.121065, 0.121692, 0.122421, 0.142431
Train average loss UNet                 (all)                : 0.507608

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.049725, 0.258870, 0.914329
Train average loss bass     (Triplet, dist_p, dist_n) : 0.161060, 0.167063, 0.235121
Train average loss piano    (Triplet, dist_p, dist_n) : 0.130922, 0.280584, 0.406902
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.117109, 0.273388, 0.465789
Train average loss residuals(Triplet, dist_p, dist_n) : 0.081041, 0.392516, 0.684184
Train average loss all      (Triplet)                 : 0.109207

== Recognize ==
Train average loss Recognize     : 1.826821
Train average accuracy drums     : 50.269997 %
Train average accuracy bass      : 50.085003 %
Train average accuracy piano     : 49.505001 %
Train average accuracy guitar    : 50.520004 %
Train average accuracy residuals : 49.980000 %

== Train average loss all : 0.114283

Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0681, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.063, Train/loss_recog_step=1.840, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]          Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0681, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.063, Train/loss_recog_step=1.840, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]Epoch 28:  16%|█▌        | 50/313 [00:51<04:29,  0.98it/s, v_num=0, Train/loss_all_step=0.0681, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.063, Train/loss_recog_step=1.840, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]Epoch 28:  16%|█▌        | 50/313 [00:51<04:29,  0.98it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.525, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.930, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830] Epoch 28:  32%|███▏      | 100/313 [01:35<03:24,  1.04it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.525, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=1.930, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]Epoch 28:  32%|███▏      | 100/313 [01:35<03:24,  1.04it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.110, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]Epoch 28:  48%|████▊     | 150/313 [02:19<02:31,  1.07it/s, v_num=0, Train/loss_all_step=0.128, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=2.110, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]Epoch 28:  48%|████▊     | 150/313 [02:19<02:31,  1.07it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.528, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=1.820, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]Epoch 28:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.109, Train/loss_unet_all_step=0.528, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=1.820, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]Epoch 28:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.0905, Train/loss_unet_all_step=0.505, Train/loss_triplet_all_step=0.0854, Train/loss_recog_step=1.920, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]Epoch 28:  80%|███████▉  | 250/313 [03:47<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.0905, Train/loss_unet_all_step=0.505, Train/loss_triplet_all_step=0.0854, Train/loss_recog_step=1.920, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]Epoch 28:  80%|███████▉  | 250/313 [03:47<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.0836, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.079, Train/loss_recog_step=2.030, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830] Epoch 28:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.0836, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.079, Train/loss_recog_step=2.030, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]Epoch 28:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.760, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830] Epoch 28: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.118, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=1.760, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]Epoch 28: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.0505, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.0456, Train/loss_recog_step=1.800, Valid/loss_all_step=0.0774, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.0723, Valid/loss_recog_step=1.800, Valid/loss_all_epoch=0.151, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.780, Valid/knn_avr=0.371, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.21it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.10it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.23it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.30it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.131492, 0.133497, 0.124411, 0.154114
Valid average loss UNet                 (all)                : 0.543515

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090088, 0.284567, 0.762822
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.163463, 0.159971, 0.208480
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.214212, 0.315004, 0.333667
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.138785, 0.278349, 0.464243
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.148321, 0.352861, 0.517102
Valid average loss all      (Triplet)                 : 0.143383

== Recognize ==
Valid average loss Recognize     : 2.028693
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.148818

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8412415981292725 sec. =
Valid knn accuracy drums     : 51.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.052955865859985 sec. =
Valid knn accuracy bass      : 21.16935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.36177110671997 sec. =
Valid knn accuracy piano     : 21.6796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.91017460823059 sec. =
Valid knn accuracy guitar    : 36.607142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.484965085983276 sec. =
Valid knn accuracy residuals : 41.36363636363637%

Valid knn accuracy average   : 34.38135561624561%

                                                                      [AEpoch 28: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0505, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.0456, Train/loss_recog_step=1.800, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.114, Train/loss_unet_all_epoch=0.508, Train/loss_triplet_all_epoch=0.109, Train/loss_recog_epoch=1.830]Epoch 28: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0505, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.0456, Train/loss_recog_step=1.800, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.120919, 0.121562, 0.122252, 0.141437
Train average loss UNet                 (all)                : 0.506170

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.048520, 0.272941, 0.942199
Train average loss bass     (Triplet, dist_p, dist_n) : 0.158842, 0.173895, 0.248098
Train average loss piano    (Triplet, dist_p, dist_n) : 0.123470, 0.291103, 0.430303
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.110960, 0.285616, 0.495385
Train average loss residuals(Triplet, dist_p, dist_n) : 0.075857, 0.406748, 0.714490
Train average loss all      (Triplet)                 : 0.104961

== Recognize ==
Train average loss Recognize     : 1.879508
Train average accuracy drums     : 49.889999 %
Train average accuracy bass      : 50.064999 %
Train average accuracy piano     : 49.790001 %
Train average accuracy guitar    : 49.674999 %
Train average accuracy residuals : 49.855000 %

== Train average loss all : 0.110022

Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0505, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.0456, Train/loss_recog_step=1.800, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]          Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0505, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.0456, Train/loss_recog_step=1.800, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29:  16%|█▌        | 50/313 [00:52<04:35,  0.96it/s, v_num=0, Train/loss_all_step=0.0505, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.0456, Train/loss_recog_step=1.800, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29:  16%|█▌        | 50/313 [00:52<04:35,  0.96it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.930, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]  Epoch 29:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.115, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.930, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.920, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.122, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=1.920, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.516, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.870, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.516, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.870, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=1.870, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=1.870, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0969, Train/loss_recog_step=1.890, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.102, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0969, Train/loss_recog_step=1.890, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0977, Train/loss_recog_step=1.900, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0977, Train/loss_recog_step=1.900, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.0504, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.0455, Train/loss_recog_step=1.980, Valid/loss_all_step=0.0645, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.0592, Valid/loss_recog_step=2.430, Valid/loss_all_epoch=0.149, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.143, Valid/loss_recog_epoch=2.030, Valid/knn_avr=0.344, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.83it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.88it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.21it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.72it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.91it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.129387, 0.132690, 0.122203, 0.153680
Valid average loss UNet                 (all)                : 0.537960

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087067, 0.275367, 0.849172
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.173042, 0.151558, 0.190686
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.240854, 0.440196, 0.421927
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.118584, 0.266627, 0.491208
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.134835, 0.357048, 0.595322
Valid average loss all      (Triplet)                 : 0.146219

== Recognize ==
Valid average loss Recognize     : 1.973615
Valid average accuracy drums     : 44.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.151598

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.926996946334839 sec. =
Valid knn accuracy drums     : 58.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.029177188873291 sec. =
Valid knn accuracy bass      : 27.21774193548387%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.445204973220825 sec. =
Valid knn accuracy piano     : 23.6328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.562688827514648 sec. =
Valid knn accuracy guitar    : 35.9375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.295942068099976 sec. =
Valid knn accuracy residuals : 42.5%

Valid knn accuracy average   : 37.596741321879385%

                                                                      [AEpoch 29: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0504, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.0455, Train/loss_recog_step=1.980, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.110, Train/loss_unet_all_epoch=0.506, Train/loss_triplet_all_epoch=0.105, Train/loss_recog_epoch=1.880]Epoch 29: 100%|██████████| 313/313 [05:47<00:00,  0.90it/s, v_num=0, Train/loss_all_step=0.0504, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.0455, Train/loss_recog_step=1.980, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.120787, 0.121422, 0.122132, 0.140631
Train average loss UNet                 (all)                : 0.504971

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.044108, 0.293162, 1.004040
Train average loss bass     (Triplet, dist_p, dist_n) : 0.155840, 0.183882, 0.267369
Train average loss piano    (Triplet, dist_p, dist_n) : 0.116378, 0.308063, 0.466904
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.103959, 0.291806, 0.524818
Train average loss residuals(Triplet, dist_p, dist_n) : 0.069920, 0.428065, 0.763731
Train average loss all      (Triplet)                 : 0.099526

== Recognize ==
Train average loss Recognize     : 1.881045
Train average accuracy drums     : 49.779999 %
Train average accuracy bass      : 49.704998 %
Train average accuracy piano     : 50.160004 %
Train average accuracy guitar    : 49.564999 %
Train average accuracy residuals : 49.619999 %

== Train average loss all : 0.104575

Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0504, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.0455, Train/loss_recog_step=1.980, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]          Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0504, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.0455, Train/loss_recog_step=1.980, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]Epoch 30:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.0504, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.0455, Train/loss_recog_step=1.980, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]Epoch 30:  16%|█▌        | 50/313 [00:50<04:25,  0.99it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.526, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.900, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]  Epoch 30:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.107, Train/loss_unet_all_step=0.526, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=1.900, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]Epoch 30:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.0952, Train/loss_recog_step=1.960, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]Epoch 30:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.100, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.0952, Train/loss_recog_step=1.960, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]Epoch 30:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.910, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880] Epoch 30:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.119, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.910, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]Epoch 30:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.0981, Train/loss_recog_step=1.940, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]Epoch 30:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.103, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.0981, Train/loss_recog_step=1.940, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]Epoch 30:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.0715, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0667, Train/loss_recog_step=1.990, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]Epoch 30:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.0715, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0667, Train/loss_recog_step=1.990, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]Epoch 30:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.0977, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0928, Train/loss_recog_step=1.960, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]Epoch 30: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.0977, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0928, Train/loss_recog_step=1.960, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]Epoch 30: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.0402, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0352, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0671, Valid/loss_unet_all_step=0.536, Valid/loss_triplet_all_step=0.0618, Valid/loss_recog_step=2.070, Valid/loss_all_epoch=0.152, Valid/loss_unet_all_epoch=0.538, Valid/loss_triplet_all_epoch=0.146, Valid/loss_recog_epoch=1.970, Valid/knn_avr=0.376, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.80it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.30it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.46it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.16it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.31it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.132082, 0.133536, 0.125771, 0.150946
Valid average loss UNet                 (all)                : 0.542335

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.081712, 0.341213, 0.856292
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.158736, 0.181361, 0.251976
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.256422, 0.456651, 0.415505
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.143617, 0.300719, 0.503195
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.133040, 0.420359, 0.658704
Valid average loss all      (Triplet)                 : 0.147593

== Recognize ==
Valid average loss Recognize     : 2.128933
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.153016

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.44429087638855 sec. =
Valid knn accuracy drums     : 60.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.214922189712524 sec. =
Valid knn accuracy bass      : 24.193548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.226792097091675 sec. =
Valid knn accuracy piano     : 26.3671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.289475679397583 sec. =
Valid knn accuracy guitar    : 33.92857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.331298112869263 sec. =
Valid knn accuracy residuals : 42.27272727272727%

Valid knn accuracy average   : 37.526319961157355%

                                                                      [AEpoch 30: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0402, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0352, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.105, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0995, Train/loss_recog_epoch=1.880]Epoch 30: 100%|██████████| 313/313 [05:50<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0402, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0352, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.120756, 0.121425, 0.122127, 0.140522
Train average loss UNet                 (all)                : 0.504830

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.040596, 0.316323, 1.080691
Train average loss bass     (Triplet, dist_p, dist_n) : 0.154046, 0.191061, 0.278833
Train average loss piano    (Triplet, dist_p, dist_n) : 0.110472, 0.318195, 0.491747
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.096992, 0.320200, 0.581818
Train average loss residuals(Triplet, dist_p, dist_n) : 0.067216, 0.443369, 0.796192
Train average loss all      (Triplet)                 : 0.095416

== Recognize ==
Train average loss Recognize     : 1.937148
Train average accuracy drums     : 50.019997 %
Train average accuracy bass      : 50.075001 %
Train average accuracy piano     : 50.470001 %
Train average accuracy guitar    : 48.989998 %
Train average accuracy residuals : 50.145000 %

== Train average loss all : 0.100465

Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0402, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0352, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]          Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0402, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0352, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.0402, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0352, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.0981, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0929, Train/loss_recog_step=2.070, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.0981, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0929, Train/loss_recog_step=2.070, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=2.010, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]  Epoch 31:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.123, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=2.010, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.0957, Train/loss_recog_step=1.790, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.0957, Train/loss_recog_step=1.790, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.0884, Train/loss_unet_all_step=0.501, Train/loss_triplet_all_step=0.0834, Train/loss_recog_step=2.100, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.0884, Train/loss_unet_all_step=0.501, Train/loss_triplet_all_step=0.0834, Train/loss_recog_step=2.100, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.0811, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0763, Train/loss_recog_step=2.040, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0811, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0763, Train/loss_recog_step=2.040, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0871, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.0822, Train/loss_recog_step=1.830, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.0871, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.0822, Train/loss_recog_step=1.830, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.0387, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0537, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.0483, Valid/loss_recog_step=2.700, Valid/loss_all_epoch=0.153, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.375, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.50it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.14it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.23it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.135307, 0.135727, 0.127609, 0.152214
Valid average loss UNet                 (all)                : 0.550857

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.089924, 0.351560, 0.893374
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.194615, 0.218299, 0.253425
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.226101, 0.387605, 0.404273
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.138832, 0.295250, 0.486108
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.159188, 0.479913, 0.650549
Valid average loss all      (Triplet)                 : 0.149536

== Recognize ==
Valid average loss Recognize     : 1.924677
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 56.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.155044

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.724227666854858 sec. =
Valid knn accuracy drums     : 54.130434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.702316761016846 sec. =
Valid knn accuracy bass      : 27.62096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.140703916549683 sec. =
Valid knn accuracy piano     : 17.7734375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.351820230484009 sec. =
Valid knn accuracy guitar    : 37.94642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.198830604553223 sec. =
Valid knn accuracy residuals : 41.590909090909086%

Valid knn accuracy average   : 35.812435537376366%

                                                                      [AEpoch 31: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.0387, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.100, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0954, Train/loss_recog_epoch=1.940]Epoch 31: 100%|██████████| 313/313 [05:43<00:00,  0.91it/s, v_num=0, Train/loss_all_step=0.0387, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.120675, 0.121301, 0.121977, 0.141005
Train average loss UNet                 (all)                : 0.504958

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.040825, 0.330815, 1.095199
Train average loss bass     (Triplet, dist_p, dist_n) : 0.149135, 0.195083, 0.294088
Train average loss piano    (Triplet, dist_p, dist_n) : 0.103482, 0.336204, 0.526605
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.093470, 0.334564, 0.618036
Train average loss residuals(Triplet, dist_p, dist_n) : 0.061069, 0.460687, 0.835067
Train average loss all      (Triplet)                 : 0.091182

== Recognize ==
Train average loss Recognize     : 1.958024
Train average accuracy drums     : 49.895000 %
Train average accuracy bass      : 49.649998 %
Train average accuracy piano     : 50.160004 %
Train average accuracy guitar    : 50.164997 %
Train average accuracy residuals : 50.344997 %

== Train average loss all : 0.096232

Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0387, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]          Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0387, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]Epoch 32:  16%|█▌        | 50/313 [00:49<04:21,  1.00it/s, v_num=0, Train/loss_all_step=0.0387, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0339, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]Epoch 32:  16%|█▌        | 50/313 [00:49<04:21,  1.00it/s, v_num=0, Train/loss_all_step=0.087, Train/loss_unet_all_step=0.530, Train/loss_triplet_all_step=0.0817, Train/loss_recog_step=1.720, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960] Epoch 32:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.087, Train/loss_unet_all_step=0.530, Train/loss_triplet_all_step=0.0817, Train/loss_recog_step=1.720, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]Epoch 32:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.0947, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.0897, Train/loss_recog_step=1.950, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]Epoch 32:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.0947, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.0897, Train/loss_recog_step=1.950, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]Epoch 32:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.0957, Train/loss_recog_step=1.960, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960] Epoch 32:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.101, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.0957, Train/loss_recog_step=1.960, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]Epoch 32:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.0779, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.0728, Train/loss_recog_step=1.980, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]Epoch 32:  80%|███████▉  | 250/313 [03:50<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.0779, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.0728, Train/loss_recog_step=1.980, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]Epoch 32:  80%|███████▉  | 250/313 [03:50<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.0981, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.0933, Train/loss_recog_step=2.080, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]Epoch 32:  96%|█████████▌| 300/313 [04:36<00:11,  1.08it/s, v_num=0, Train/loss_all_step=0.0981, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.0933, Train/loss_recog_step=2.080, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]Epoch 32:  96%|█████████▌| 300/313 [04:36<00:11,  1.08it/s, v_num=0, Train/loss_all_step=0.0835, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.0787, Train/loss_recog_step=2.020, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]Epoch 32: 100%|██████████| 313/313 [04:44<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.0835, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.0787, Train/loss_recog_step=2.020, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]Epoch 32: 100%|██████████| 313/313 [04:44<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0374, Train/loss_recog_step=1.990, Valid/loss_all_step=0.0377, Valid/loss_unet_all_step=0.551, Valid/loss_triplet_all_step=0.0322, Valid/loss_recog_step=1.960, Valid/loss_all_epoch=0.155, Valid/loss_unet_all_epoch=0.551, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=1.920, Valid/knn_avr=0.358, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.58it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.24it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.07it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.81it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.95it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.129088, 0.132174, 0.122945, 0.153198
Valid average loss UNet                 (all)                : 0.537406

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083343, 0.336449, 0.978930
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.173131, 0.184381, 0.234319
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.277296, 0.458752, 0.435386
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.149632, 0.349844, 0.540291
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.136594, 0.473571, 0.677532
Valid average loss all      (Triplet)                 : 0.156152

== Recognize ==
Valid average loss Recognize     : 1.996950
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.161526

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.541972875595093 sec. =
Valid knn accuracy drums     : 54.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.804740190505981 sec. =
Valid knn accuracy bass      : 28.024193548387093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.696138143539429 sec. =
Valid knn accuracy piano     : 13.671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.246428728103638 sec. =
Valid knn accuracy guitar    : 37.723214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.975173234939575 sec. =
Valid knn accuracy residuals : 38.40909090909091%

Valid knn accuracy average   : 34.522196487768895%

                                                                      [AEpoch 32: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0374, Train/loss_recog_step=1.990, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0962, Train/loss_unet_all_epoch=0.505, Train/loss_triplet_all_epoch=0.0912, Train/loss_recog_epoch=1.960]Epoch 32: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0374, Train/loss_recog_step=1.990, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.120445, 0.121143, 0.121834, 0.139565
Train average loss UNet                 (all)                : 0.502988

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.038696, 0.360043, 1.165341
Train average loss bass     (Triplet, dist_p, dist_n) : 0.147560, 0.194960, 0.296406
Train average loss piano    (Triplet, dist_p, dist_n) : 0.097350, 0.351079, 0.563555
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.088210, 0.342395, 0.634186
Train average loss residuals(Triplet, dist_p, dist_n) : 0.057879, 0.483571, 0.881606
Train average loss all      (Triplet)                 : 0.087239

== Recognize ==
Train average loss Recognize     : 2.006078
Train average accuracy drums     : 49.910000 %
Train average accuracy bass      : 50.005001 %
Train average accuracy piano     : 50.279999 %
Train average accuracy guitar    : 50.050003 %
Train average accuracy residuals : 49.404999 %

== Train average loss all : 0.092269

Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0374, Train/loss_recog_step=1.990, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]          Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0374, Train/loss_recog_step=1.990, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33:  16%|█▌        | 50/313 [00:51<04:32,  0.97it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0374, Train/loss_recog_step=1.990, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33:  16%|█▌        | 50/313 [00:51<04:32,  0.97it/s, v_num=0, Train/loss_all_step=0.0735, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.0682, Train/loss_recog_step=1.810, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33:  32%|███▏      | 100/313 [01:35<03:23,  1.05it/s, v_num=0, Train/loss_all_step=0.0735, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.0682, Train/loss_recog_step=1.810, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33:  32%|███▏      | 100/313 [01:35<03:23,  1.05it/s, v_num=0, Train/loss_all_step=0.0915, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0865, Train/loss_recog_step=1.760, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.0915, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0865, Train/loss_recog_step=1.760, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.0872, Train/loss_unet_all_step=0.526, Train/loss_triplet_all_step=0.0819, Train/loss_recog_step=2.100, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.0872, Train/loss_unet_all_step=0.526, Train/loss_triplet_all_step=0.0819, Train/loss_recog_step=2.100, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0719, Train/loss_recog_step=1.950, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33:  80%|███████▉  | 250/313 [03:47<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.0771, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0719, Train/loss_recog_step=1.950, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33:  80%|███████▉  | 250/313 [03:47<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.0834, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0786, Train/loss_recog_step=1.980, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.0834, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0786, Train/loss_recog_step=1.980, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.0712, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0663, Train/loss_recog_step=1.990, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.0712, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0663, Train/loss_recog_step=1.990, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]Epoch 33: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=1.800, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0551, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.162, Valid/loss_unet_all_epoch=0.537, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=2.000, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.84it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.75it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.88it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.91it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.129931, 0.133361, 0.125592, 0.152958
Valid average loss UNet                 (all)                : 0.541842

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088267, 0.383074, 1.028260
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.174899, 0.213198, 0.272753
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.251492, 0.451276, 0.476638
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.166711, 0.389027, 0.592577
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.214475, 0.550306, 0.689452
Valid average loss all      (Triplet)                 : 0.171376

== Recognize ==
Valid average loss Recognize     : 2.106524
Valid average accuracy drums     : 43.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.176795

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.241300344467163 sec. =
Valid knn accuracy drums     : 51.30434782608696%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.342097759246826 sec. =
Valid knn accuracy bass      : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.133344173431396 sec. =
Valid knn accuracy piano     : 19.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.670290470123291 sec. =
Valid knn accuracy guitar    : 37.05357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.014772415161133 sec. =
Valid knn accuracy residuals : 39.31818181818182%

Valid knn accuracy average   : 34.51959521456804%

                                                                      [AEpoch 33: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=1.800, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0923, Train/loss_unet_all_epoch=0.503, Train/loss_triplet_all_epoch=0.0872, Train/loss_recog_epoch=2.010] Epoch 33: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=1.800, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.120392, 0.121023, 0.121747, 0.140601
Train average loss UNet                 (all)                : 0.503764

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.035894, 0.384191, 1.237827
Train average loss bass     (Triplet, dist_p, dist_n) : 0.143731, 0.214818, 0.330401
Train average loss piano    (Triplet, dist_p, dist_n) : 0.090055, 0.372570, 0.606241
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.078105, 0.373743, 0.707912
Train average loss residuals(Triplet, dist_p, dist_n) : 0.052036, 0.515988, 0.955403
Train average loss all      (Triplet)                 : 0.081308

== Recognize ==
Train average loss Recognize     : 2.024332
Train average accuracy drums     : 50.599998 %
Train average accuracy bass      : 49.955002 %
Train average accuracy piano     : 50.355000 %
Train average accuracy guitar    : 50.400002 %
Train average accuracy residuals : 50.260002 %

== Train average loss all : 0.086346

Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=1.800, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]          Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=1.800, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]Epoch 34:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=1.800, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]Epoch 34:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.0854, Train/loss_unet_all_step=0.525, Train/loss_triplet_all_step=0.0802, Train/loss_recog_step=1.910, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]Epoch 34:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.0854, Train/loss_unet_all_step=0.525, Train/loss_triplet_all_step=0.0802, Train/loss_recog_step=1.910, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]Epoch 34:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.0818, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.0767, Train/loss_recog_step=1.840, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]Epoch 34:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.0818, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.0767, Train/loss_recog_step=1.840, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]Epoch 34:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.090, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.0847, Train/loss_recog_step=2.080, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020] Epoch 34:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.090, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.0847, Train/loss_recog_step=2.080, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]Epoch 34:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.0609, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.0557, Train/loss_recog_step=1.990, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]Epoch 34:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0609, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.0557, Train/loss_recog_step=1.990, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]Epoch 34:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.0712, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.0664, Train/loss_recog_step=1.840, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]Epoch 34:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0712, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.0664, Train/loss_recog_step=1.840, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]Epoch 34:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.0808, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.076, Train/loss_recog_step=2.020, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020] Epoch 34: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.0808, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.076, Train/loss_recog_step=2.020, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]Epoch 34: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0471, Train/loss_recog_step=2.050, Valid/loss_all_step=0.101, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0959, Valid/loss_recog_step=2.320, Valid/loss_all_epoch=0.177, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=2.110, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.79it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.04it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.130764, 0.132904, 0.124967, 0.155275
Valid average loss UNet                 (all)                : 0.543909

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.202284, 0.467880, 1.056049
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.187278, 0.214765, 0.257494
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.281942, 0.487480, 0.458973
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.202953, 0.443279, 0.607637
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.232089, 0.548984, 0.647184
Valid average loss all      (Triplet)                 : 0.209784

== Recognize ==
Valid average loss Recognize     : 2.085861
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 57.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.215223

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.550495147705078 sec. =
Valid knn accuracy drums     : 63.69565217391304%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.635349035263062 sec. =
Valid knn accuracy bass      : 26.814516129032256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.258728981018066 sec. =
Valid knn accuracy piano     : 24.0234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.483649015426636 sec. =
Valid knn accuracy guitar    : 37.276785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.308395147323608 sec. =
Valid knn accuracy residuals : 37.72727272727273%

Valid knn accuracy average   : 37.90753284890075%

                                                                      [AEpoch 34: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0471, Train/loss_recog_step=2.050, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0863, Train/loss_unet_all_epoch=0.504, Train/loss_triplet_all_epoch=0.0813, Train/loss_recog_epoch=2.020] Epoch 34: 100%|██████████| 313/313 [05:41<00:00,  0.92it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0471, Train/loss_recog_step=2.050, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.120267, 0.120943, 0.121594, 0.139608
Train average loss UNet                 (all)                : 0.502412

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.033462, 0.389032, 1.248407
Train average loss bass     (Triplet, dist_p, dist_n) : 0.138578, 0.217243, 0.346125
Train average loss piano    (Triplet, dist_p, dist_n) : 0.087302, 0.408268, 0.668021
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.075465, 0.401149, 0.766312
Train average loss residuals(Triplet, dist_p, dist_n) : 0.049678, 0.538278, 0.998926
Train average loss all      (Triplet)                 : 0.078320

== Recognize ==
Train average loss Recognize     : 2.014750
Train average accuracy drums     : 49.794998 %
Train average accuracy bass      : 50.320000 %
Train average accuracy piano     : 49.959999 %
Train average accuracy guitar    : 50.209999 %
Train average accuracy residuals : 50.550003 %

== Train average loss all : 0.083344

Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0471, Train/loss_recog_step=2.050, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]          Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0471, Train/loss_recog_step=2.050, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.052, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0471, Train/loss_recog_step=2.050, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.0422, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.037, Train/loss_recog_step=2.080, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35:  32%|███▏      | 100/313 [01:34<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.0422, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.037, Train/loss_recog_step=2.080, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35:  32%|███▏      | 100/313 [01:34<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.0726, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.0678, Train/loss_recog_step=2.030, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.0726, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.0678, Train/loss_recog_step=2.030, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=2.020, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]  Epoch 35:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.110, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=2.020, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.0584, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.0534, Train/loss_recog_step=2.070, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35:  80%|███████▉  | 250/313 [03:47<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.0584, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.0534, Train/loss_recog_step=2.070, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35:  80%|███████▉  | 250/313 [03:47<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.0721, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.0673, Train/loss_recog_step=2.050, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.0721, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.0673, Train/loss_recog_step=2.050, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.0556, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0506, Train/loss_recog_step=1.830, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.0556, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0506, Train/loss_recog_step=1.830, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.0252, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.0204, Train/loss_recog_step=2.250, Valid/loss_all_step=0.237, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.232, Valid/loss_recog_step=2.160, Valid/loss_all_epoch=0.215, Valid/loss_unet_all_epoch=0.544, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=2.090, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.72it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.91it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.06it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.95it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.134744, 0.136774, 0.130511, 0.152473
Valid average loss UNet                 (all)                : 0.554502

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.129879, 0.464353, 1.157064
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.191232, 0.248186, 0.286863
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.283196, 0.513432, 0.530070
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.151610, 0.426397, 0.631593
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.147238, 0.583962, 0.773485
Valid average loss all      (Triplet)                 : 0.162839

== Recognize ==
Valid average loss Recognize     : 2.139479
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 42.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.168384

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.296914100646973 sec. =
Valid knn accuracy drums     : 68.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.598377704620361 sec. =
Valid knn accuracy bass      : 25.806451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.43874454498291 sec. =
Valid knn accuracy piano     : 21.2890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.635140657424927 sec. =
Valid knn accuracy guitar    : 41.964285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.226304054260254 sec. =
Valid knn accuracy residuals : 41.13636363636364%

Valid knn accuracy average   : 39.647928344884434%

                                                                      [AEpoch 35: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0252, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.0204, Train/loss_recog_step=2.250, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.0833, Train/loss_unet_all_epoch=0.502, Train/loss_triplet_all_epoch=0.0783, Train/loss_recog_epoch=2.010]Epoch 35: 100%|██████████| 313/313 [05:53<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0252, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.0204, Train/loss_recog_step=2.250, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.120121, 0.120801, 0.121430, 0.138323
Train average loss UNet                 (all)                : 0.500676

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.031405, 0.416274, 1.328745
Train average loss bass     (Triplet, dist_p, dist_n) : 0.133061, 0.222230, 0.357914
Train average loss piano    (Triplet, dist_p, dist_n) : 0.075680, 0.416609, 0.706599
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.068248, 0.412360, 0.801133
Train average loss residuals(Triplet, dist_p, dist_n) : 0.044240, 0.550338, 1.034632
Train average loss all      (Triplet)                 : 0.071948

== Recognize ==
Train average loss Recognize     : 2.046566
Train average accuracy drums     : 50.300003 %
Train average accuracy bass      : 49.985001 %
Train average accuracy piano     : 49.860001 %
Train average accuracy guitar    : 50.110001 %
Train average accuracy residuals : 49.439999 %

== Train average loss all : 0.076955

Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0252, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.0204, Train/loss_recog_step=2.250, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]          Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0252, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.0204, Train/loss_recog_step=2.250, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36:  16%|█▌        | 50/313 [00:51<04:29,  0.97it/s, v_num=0, Train/loss_all_step=0.0252, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.0204, Train/loss_recog_step=2.250, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36:  16%|█▌        | 50/313 [00:51<04:29,  0.97it/s, v_num=0, Train/loss_all_step=0.0752, Train/loss_unet_all_step=0.528, Train/loss_triplet_all_step=0.0699, Train/loss_recog_step=2.080, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36:  32%|███▏      | 100/313 [01:37<03:27,  1.03it/s, v_num=0, Train/loss_all_step=0.0752, Train/loss_unet_all_step=0.528, Train/loss_triplet_all_step=0.0699, Train/loss_recog_step=2.080, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36:  32%|███▏      | 100/313 [01:37<03:27,  1.03it/s, v_num=0, Train/loss_all_step=0.0631, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0581, Train/loss_recog_step=2.060, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36:  48%|████▊     | 150/313 [02:22<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.0631, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0581, Train/loss_recog_step=2.060, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36:  48%|████▊     | 150/313 [02:22<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.0704, Train/loss_unet_all_step=0.520, Train/loss_triplet_all_step=0.0652, Train/loss_recog_step=2.090, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36:  64%|██████▍   | 200/313 [03:07<01:46,  1.07it/s, v_num=0, Train/loss_all_step=0.0704, Train/loss_unet_all_step=0.520, Train/loss_triplet_all_step=0.0652, Train/loss_recog_step=2.090, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36:  64%|██████▍   | 200/313 [03:07<01:46,  1.07it/s, v_num=0, Train/loss_all_step=0.0596, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0545, Train/loss_recog_step=2.120, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36:  80%|███████▉  | 250/313 [03:52<00:58,  1.07it/s, v_num=0, Train/loss_all_step=0.0596, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0545, Train/loss_recog_step=2.120, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36:  80%|███████▉  | 250/313 [03:52<00:58,  1.07it/s, v_num=0, Train/loss_all_step=0.0702, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.0654, Train/loss_recog_step=2.100, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.0702, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.0654, Train/loss_recog_step=2.100, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36:  96%|█████████▌| 300/313 [04:39<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.0532, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0484, Train/loss_recog_step=1.900, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36: 100%|██████████| 313/313 [04:47<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.0532, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0484, Train/loss_recog_step=1.900, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]Epoch 36: 100%|██████████| 313/313 [04:47<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.0384, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0335, Train/loss_recog_step=2.130, Valid/loss_all_step=0.0411, Valid/loss_unet_all_step=0.547, Valid/loss_triplet_all_step=0.0356, Valid/loss_recog_step=2.020, Valid/loss_all_epoch=0.168, Valid/loss_unet_all_epoch=0.555, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=2.140, Valid/knn_avr=0.396, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.77it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.31it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.18it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.35it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.131347, 0.134226, 0.126026, 0.161372
Valid average loss UNet                 (all)                : 0.552971

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.082167, 0.475056, 1.244854
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.224073, 0.282323, 0.305734
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.269903, 0.520016, 0.516382
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.215818, 0.426633, 0.586902
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.133373, 0.527129, 0.733619
Valid average loss all      (Triplet)                 : 0.180690

== Recognize ==
Valid average loss Recognize     : 2.074044
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 56.000000 %
Valid average accuracy guitar    : 44.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.186220

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.696447849273682 sec. =
Valid knn accuracy drums     : 63.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.638694524765015 sec. =
Valid knn accuracy bass      : 23.387096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.26474642753601 sec. =
Valid knn accuracy piano     : 24.4140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.401800155639648 sec. =
Valid knn accuracy guitar    : 38.839285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.969514608383179 sec. =
Valid knn accuracy residuals : 36.81818181818181%

Valid knn accuracy average   : 37.343899274375694%

                                                                      [AEpoch 36: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0384, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0335, Train/loss_recog_step=2.130, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.077, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0719, Train/loss_recog_epoch=2.050]  Epoch 36: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0384, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0335, Train/loss_recog_step=2.130, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.120031, 0.120713, 0.121431, 0.138879
Train average loss UNet                 (all)                : 0.501054

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.029952, 0.449266, 1.435741
Train average loss bass     (Triplet, dist_p, dist_n) : 0.130875, 0.229731, 0.377081
Train average loss piano    (Triplet, dist_p, dist_n) : 0.072724, 0.447083, 0.760598
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.064454, 0.426514, 0.832747
Train average loss residuals(Triplet, dist_p, dist_n) : 0.041133, 0.599852, 1.128117
Train average loss all      (Triplet)                 : 0.069109

== Recognize ==
Train average loss Recognize     : 2.078810
Train average accuracy drums     : 50.199997 %
Train average accuracy bass      : 50.344997 %
Train average accuracy piano     : 50.320000 %
Train average accuracy guitar    : 49.840000 %
Train average accuracy residuals : 50.335003 %

== Train average loss all : 0.074120

Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0384, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0335, Train/loss_recog_step=2.130, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]          Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0384, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0335, Train/loss_recog_step=2.130, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37:  16%|█▌        | 50/313 [00:53<04:38,  0.94it/s, v_num=0, Train/loss_all_step=0.0384, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0335, Train/loss_recog_step=2.130, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37:  16%|█▌        | 50/313 [00:53<04:38,  0.94it/s, v_num=0, Train/loss_all_step=0.0708, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.0657, Train/loss_recog_step=2.140, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37:  32%|███▏      | 100/313 [01:38<03:29,  1.02it/s, v_num=0, Train/loss_all_step=0.0708, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.0657, Train/loss_recog_step=2.140, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37:  32%|███▏      | 100/313 [01:38<03:29,  1.02it/s, v_num=0, Train/loss_all_step=0.0804, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0754, Train/loss_recog_step=2.060, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37:  48%|████▊     | 150/313 [02:23<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.0804, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0754, Train/loss_recog_step=2.060, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37:  48%|████▊     | 150/313 [02:23<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.0648, Train/loss_unet_all_step=0.540, Train/loss_triplet_all_step=0.0594, Train/loss_recog_step=2.020, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0648, Train/loss_unet_all_step=0.540, Train/loss_triplet_all_step=0.0594, Train/loss_recog_step=2.020, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.520, Train/loss_triplet_all_step=0.0632, Train/loss_recog_step=1.990, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.0684, Train/loss_unet_all_step=0.520, Train/loss_triplet_all_step=0.0632, Train/loss_recog_step=1.990, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.0473, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0425, Train/loss_recog_step=1.970, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37:  96%|█████████▌| 300/313 [04:41<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.0473, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0425, Train/loss_recog_step=1.970, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37:  96%|█████████▌| 300/313 [04:41<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.0782, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0734, Train/loss_recog_step=2.150, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.0782, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0734, Train/loss_recog_step=2.150, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0249, Train/loss_recog_step=2.270, Valid/loss_all_step=0.122, Valid/loss_unet_all_step=0.548, Valid/loss_triplet_all_step=0.117, Valid/loss_recog_step=1.870, Valid/loss_all_epoch=0.186, Valid/loss_unet_all_epoch=0.553, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.68it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.77it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.14it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.84it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126814, 0.132372, 0.122175, 0.148383
Valid average loss UNet                 (all)                : 0.529743

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073337, 0.511805, 1.199648
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.217449, 0.270386, 0.306193
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.274483, 0.597774, 0.560477
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.170380, 0.394112, 0.618363
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.255309, 0.637695, 0.743782
Valid average loss all      (Triplet)                 : 0.184563

== Recognize ==
Valid average loss Recognize     : 2.133713
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.189861

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.307847499847412 sec. =
Valid knn accuracy drums     : 64.13043478260869%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.970910549163818 sec. =
Valid knn accuracy bass      : 19.153225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.050028562545776 sec. =
Valid knn accuracy piano     : 21.2890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.639435291290283 sec. =
Valid knn accuracy guitar    : 40.17857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.494790315628052 sec. =
Valid knn accuracy residuals : 41.81818181818181%

Valid knn accuracy average   : 37.313895267162714%

                                                                      [AEpoch 37: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0249, Train/loss_recog_step=2.270, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0741, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0691, Train/loss_recog_epoch=2.080]Epoch 37: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0249, Train/loss_recog_step=2.270, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.119873, 0.120552, 0.121315, 0.138883
Train average loss UNet                 (all)                : 0.500623

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.028831, 0.456012, 1.431561
Train average loss bass     (Triplet, dist_p, dist_n) : 0.125745, 0.235846, 0.394786
Train average loss piano    (Triplet, dist_p, dist_n) : 0.064606, 0.464431, 0.811697
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.061137, 0.453201, 0.889864
Train average loss residuals(Triplet, dist_p, dist_n) : 0.039478, 0.625015, 1.179310
Train average loss all      (Triplet)                 : 0.065213

== Recognize ==
Train average loss Recognize     : 2.093504
Train average accuracy drums     : 50.005001 %
Train average accuracy bass      : 50.080002 %
Train average accuracy piano     : 49.880001 %
Train average accuracy guitar    : 50.110001 %
Train average accuracy residuals : 50.054996 %

== Train average loss all : 0.070219

Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0249, Train/loss_recog_step=2.270, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]          Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0249, Train/loss_recog_step=2.270, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]Epoch 38:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.0299, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0249, Train/loss_recog_step=2.270, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]Epoch 38:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.0339, Train/loss_unet_all_step=0.523, Train/loss_triplet_all_step=0.0287, Train/loss_recog_step=2.200, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]Epoch 38:  32%|███▏      | 100/313 [01:36<03:24,  1.04it/s, v_num=0, Train/loss_all_step=0.0339, Train/loss_unet_all_step=0.523, Train/loss_triplet_all_step=0.0287, Train/loss_recog_step=2.200, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]Epoch 38:  32%|███▏      | 100/313 [01:36<03:24,  1.04it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.0562, Train/loss_recog_step=2.200, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090] Epoch 38:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.061, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.0562, Train/loss_recog_step=2.200, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]Epoch 38:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.538, Train/loss_triplet_all_step=0.0606, Train/loss_recog_step=2.140, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]Epoch 38:  64%|██████▍   | 200/313 [03:04<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.066, Train/loss_unet_all_step=0.538, Train/loss_triplet_all_step=0.0606, Train/loss_recog_step=2.140, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]Epoch 38:  64%|██████▍   | 200/313 [03:04<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.0537, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.0486, Train/loss_recog_step=1.990, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]Epoch 38:  80%|███████▉  | 250/313 [03:50<00:58,  1.09it/s, v_num=0, Train/loss_all_step=0.0537, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.0486, Train/loss_recog_step=1.990, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]Epoch 38:  80%|███████▉  | 250/313 [03:50<00:58,  1.09it/s, v_num=0, Train/loss_all_step=0.0617, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.057, Train/loss_recog_step=2.140, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090] Epoch 38:  96%|█████████▌| 300/313 [04:35<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.0617, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.057, Train/loss_recog_step=2.140, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]Epoch 38:  96%|█████████▌| 300/313 [04:35<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.0648, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0599, Train/loss_recog_step=2.030, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]Epoch 38: 100%|██████████| 313/313 [04:43<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.0648, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0599, Train/loss_recog_step=2.030, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]Epoch 38: 100%|██████████| 313/313 [04:43<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.0343, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=2.370, Valid/loss_all_step=0.116, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.111, Valid/loss_recog_step=2.000, Valid/loss_all_epoch=0.190, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=2.130, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.99it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.67it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.131467, 0.133797, 0.127295, 0.154496
Valid average loss UNet                 (all)                : 0.547055

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079261, 0.471152, 1.306036
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.227320, 0.274623, 0.295742
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.292086, 0.596255, 0.562333
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.164543, 0.433033, 0.694419
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.248629, 0.641674, 0.739777
Valid average loss all      (Triplet)                 : 0.189611

== Recognize ==
Valid average loss Recognize     : 2.074511
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.195082

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3685667514801025 sec. =
Valid knn accuracy drums     : 68.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.285728931427002 sec. =
Valid knn accuracy bass      : 21.16935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.205659627914429 sec. =
Valid knn accuracy piano     : 21.2890625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.511226177215576 sec. =
Valid knn accuracy guitar    : 35.714285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.35833477973938 sec. =
Valid knn accuracy residuals : 42.72727272727273%

Valid knn accuracy average   : 37.788690808227535%

                                                                      [AEpoch 38: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0343, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=2.370, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0702, Train/loss_unet_all_epoch=0.501, Train/loss_triplet_all_epoch=0.0652, Train/loss_recog_epoch=2.090]Epoch 38: 100%|██████████| 313/313 [05:54<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0343, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=2.370, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.119982, 0.120638, 0.121341, 0.138058
Train average loss UNet                 (all)                : 0.500018

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.025708, 0.467613, 1.464826
Train average loss bass     (Triplet, dist_p, dist_n) : 0.119883, 0.246713, 0.423577
Train average loss piano    (Triplet, dist_p, dist_n) : 0.062037, 0.492768, 0.859353
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.059182, 0.466133, 0.916050
Train average loss residuals(Triplet, dist_p, dist_n) : 0.034730, 0.664882, 1.264981
Train average loss all      (Triplet)                 : 0.061600

== Recognize ==
Train average loss Recognize     : 2.105576
Train average accuracy drums     : 49.865002 %
Train average accuracy bass      : 49.480000 %
Train average accuracy piano     : 50.075001 %
Train average accuracy guitar    : 49.630001 %
Train average accuracy residuals : 50.634998 %

== Train average loss all : 0.066600

Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0343, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=2.370, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]          Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0343, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=2.370, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]Epoch 39:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.0343, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=2.370, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]Epoch 39:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.0505, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0454, Train/loss_recog_step=2.330, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]Epoch 39:  32%|███▏      | 100/313 [01:36<03:26,  1.03it/s, v_num=0, Train/loss_all_step=0.0505, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0454, Train/loss_recog_step=2.330, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]Epoch 39:  32%|███▏      | 100/313 [01:36<03:26,  1.03it/s, v_num=0, Train/loss_all_step=0.0449, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.040, Train/loss_recog_step=1.960, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110] Epoch 39:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.0449, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.040, Train/loss_recog_step=1.960, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]Epoch 39:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.0396, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.0344, Train/loss_recog_step=2.170, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]Epoch 39:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0396, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.0344, Train/loss_recog_step=2.170, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]Epoch 39:  64%|██████▍   | 200/313 [03:09<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0484, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0434, Train/loss_recog_step=2.230, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]Epoch 39:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.0484, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0434, Train/loss_recog_step=2.230, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]Epoch 39:  80%|███████▉  | 250/313 [03:56<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.0479, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.0433, Train/loss_recog_step=2.160, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]Epoch 39:  96%|█████████▌| 300/313 [04:43<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.0479, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.0433, Train/loss_recog_step=2.160, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]Epoch 39:  96%|█████████▌| 300/313 [04:43<00:12,  1.06it/s, v_num=0, Train/loss_all_step=0.049, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0443, Train/loss_recog_step=2.290, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110] Epoch 39: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.049, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0443, Train/loss_recog_step=2.290, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]Epoch 39: 100%|██████████| 313/313 [04:51<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.0273, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=2.460, Valid/loss_all_step=0.0879, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.0826, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.195, Valid/loss_unet_all_epoch=0.547, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=2.070, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.71it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.79it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.11it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.14it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.137749, 0.137886, 0.131540, 0.154458
Valid average loss UNet                 (all)                : 0.561633

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.131154, 0.575921, 1.216760
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.222317, 0.270985, 0.272556
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.341309, 0.669446, 0.580008
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.146059, 0.466710, 0.794694
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.249311, 0.723791, 0.850879
Valid average loss all      (Triplet)                 : 0.198442

== Recognize ==
Valid average loss Recognize     : 2.118266
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.204059

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8024656772613525 sec. =
Valid knn accuracy drums     : 74.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.017627239227295 sec. =
Valid knn accuracy bass      : 19.556451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.75390362739563 sec. =
Valid knn accuracy piano     : 20.703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.885558843612671 sec. =
Valid knn accuracy guitar    : 43.973214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.004613161087036 sec. =
Valid knn accuracy residuals : 44.31818181818182%

Valid knn accuracy average   : 40.6667162824903%

                                                                      [AEpoch 39: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.0273, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=2.460, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0666, Train/loss_unet_all_epoch=0.500, Train/loss_triplet_all_epoch=0.0616, Train/loss_recog_epoch=2.110]  Epoch 39: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.0273, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=2.460, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.119776, 0.120446, 0.121118, 0.138136
Train average loss UNet                 (all)                : 0.499475

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.027674, 0.507994, 1.597115
Train average loss bass     (Triplet, dist_p, dist_n) : 0.119667, 0.260265, 0.444050
Train average loss piano    (Triplet, dist_p, dist_n) : 0.054534, 0.514317, 0.914724
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.052035, 0.491515, 0.993571
Train average loss residuals(Triplet, dist_p, dist_n) : 0.031482, 0.702574, 1.341412
Train average loss all      (Triplet)                 : 0.058156

== Recognize ==
Train average loss Recognize     : 2.113420
Train average accuracy drums     : 49.750000 %
Train average accuracy bass      : 49.665001 %
Train average accuracy piano     : 49.880001 %
Train average accuracy guitar    : 49.470001 %
Train average accuracy residuals : 50.230003 %

== Train average loss all : 0.063151

Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0273, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=2.460, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]          Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0273, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=2.460, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40:  16%|█▌        | 50/313 [00:50<04:24,  0.99it/s, v_num=0, Train/loss_all_step=0.0273, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=2.460, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40:  16%|█▌        | 50/313 [00:50<04:24,  0.99it/s, v_num=0, Train/loss_all_step=0.0514, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0464, Train/loss_recog_step=2.230, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40:  32%|███▏      | 100/313 [01:34<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.0514, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0464, Train/loss_recog_step=2.230, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40:  32%|███▏      | 100/313 [01:34<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=1.980, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40:  48%|████▊     | 150/313 [02:20<02:32,  1.07it/s, v_num=0, Train/loss_all_step=0.0547, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=1.980, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40:  48%|████▊     | 150/313 [02:20<02:32,  1.07it/s, v_num=0, Train/loss_all_step=0.0589, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0537, Train/loss_recog_step=1.910, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40:  64%|██████▍   | 200/313 [03:04<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.0589, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0537, Train/loss_recog_step=1.910, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40:  64%|██████▍   | 200/313 [03:04<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.0475, Train/loss_unet_all_step=0.501, Train/loss_triplet_all_step=0.0425, Train/loss_recog_step=2.070, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40:  80%|███████▉  | 250/313 [03:51<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.0475, Train/loss_unet_all_step=0.501, Train/loss_triplet_all_step=0.0425, Train/loss_recog_step=2.070, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40:  80%|███████▉  | 250/313 [03:51<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.0509, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=2.070, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40:  96%|█████████▌| 300/313 [04:38<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.0509, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.0461, Train/loss_recog_step=2.070, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40:  96%|█████████▌| 300/313 [04:38<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.0485, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.0438, Train/loss_recog_step=2.300, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40: 100%|██████████| 313/313 [04:46<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.0485, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.0438, Train/loss_recog_step=2.300, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40: 100%|██████████| 313/313 [04:46<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.00713, Train/loss_recog_step=2.220, Valid/loss_all_step=0.143, Valid/loss_unet_all_step=0.561, Valid/loss_triplet_all_step=0.138, Valid/loss_recog_step=2.200, Valid/loss_all_epoch=0.204, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=2.120, Valid/knn_avr=0.407, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.83it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.77it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.87it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.30it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.136623, 0.136135, 0.129024, 0.155054
Valid average loss UNet                 (all)                : 0.556836

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.058930, 0.587674, 1.454774
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.233300, 0.299675, 0.288754
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.329080, 0.719521, 0.660798
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.185303, 0.536897, 0.811882
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.288602, 0.695768, 0.757883
Valid average loss all      (Triplet)                 : 0.220770

== Recognize ==
Valid average loss Recognize     : 2.080675
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.226339

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.351003885269165 sec. =
Valid knn accuracy drums     : 68.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.09146499633789 sec. =
Valid knn accuracy bass      : 22.177419354838708%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.425179481506348 sec. =
Valid knn accuracy piano     : 19.921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.440023422241211 sec. =
Valid knn accuracy guitar    : 41.964285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.945441246032715 sec. =
Valid knn accuracy residuals : 38.18181818181819%

Valid knn accuracy average   : 38.05777530236244%

                                                                      [AEpoch 40: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.00713, Train/loss_recog_step=2.220, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0632, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0582, Train/loss_recog_epoch=2.110]Epoch 40: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.00713, Train/loss_recog_step=2.220, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.119660, 0.120294, 0.120988, 0.137880
Train average loss UNet                 (all)                : 0.498822

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.024524, 0.514260, 1.579506
Train average loss bass     (Triplet, dist_p, dist_n) : 0.114271, 0.279794, 0.485114
Train average loss piano    (Triplet, dist_p, dist_n) : 0.055183, 0.538809, 0.952253
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.052418, 0.509779, 1.021838
Train average loss residuals(Triplet, dist_p, dist_n) : 0.030954, 0.695156, 1.336298
Train average loss all      (Triplet)                 : 0.056647

== Recognize ==
Train average loss Recognize     : 2.146630
Train average accuracy drums     : 50.230003 %
Train average accuracy bass      : 50.180000 %
Train average accuracy piano     : 49.584999 %
Train average accuracy guitar    : 50.510002 %
Train average accuracy residuals : 50.320000 %

== Train average loss all : 0.061636

Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.00713, Train/loss_recog_step=2.220, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]          Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.00713, Train/loss_recog_step=2.220, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.00713, Train/loss_recog_step=2.220, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.0373, Train/loss_recog_step=2.170, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150] Epoch 41:  32%|███▏      | 100/313 [01:37<03:28,  1.02it/s, v_num=0, Train/loss_all_step=0.0423, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.0373, Train/loss_recog_step=2.170, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41:  32%|███▏      | 100/313 [01:37<03:28,  1.02it/s, v_num=0, Train/loss_all_step=0.0462, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0414, Train/loss_recog_step=2.390, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41:  48%|████▊     | 150/313 [02:23<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.0462, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0414, Train/loss_recog_step=2.390, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41:  48%|████▊     | 150/313 [02:23<02:35,  1.05it/s, v_num=0, Train/loss_all_step=0.0304, Train/loss_unet_all_step=0.517, Train/loss_triplet_all_step=0.0253, Train/loss_recog_step=2.150, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0304, Train/loss_unet_all_step=0.517, Train/loss_triplet_all_step=0.0253, Train/loss_recog_step=2.150, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0622, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.0572, Train/loss_recog_step=2.260, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41:  80%|███████▉  | 250/313 [03:54<00:59,  1.07it/s, v_num=0, Train/loss_all_step=0.0622, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.0572, Train/loss_recog_step=2.260, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41:  80%|███████▉  | 250/313 [03:54<00:59,  1.07it/s, v_num=0, Train/loss_all_step=0.0544, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0496, Train/loss_recog_step=1.980, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41:  96%|█████████▌| 300/313 [04:37<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.0544, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0496, Train/loss_recog_step=1.980, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41:  96%|█████████▌| 300/313 [04:37<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.0531, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0483, Train/loss_recog_step=2.050, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41: 100%|██████████| 313/313 [04:45<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.0531, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0483, Train/loss_recog_step=2.050, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41: 100%|██████████| 313/313 [04:45<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00973, Train/loss_recog_step=2.270, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=1.910, Valid/loss_all_epoch=0.226, Valid/loss_unet_all_epoch=0.557, Valid/loss_triplet_all_epoch=0.221, Valid/loss_recog_epoch=2.080, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.77it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.06it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.14it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.91it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.133057, 0.133744, 0.125994, 0.147698
Valid average loss UNet                 (all)                : 0.540492

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.114231, 0.609645, 1.320808
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.239172, 0.313781, 0.295429
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.378479, 0.785885, 0.710290
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.154680, 0.498550, 0.809229
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.275110, 0.787340, 0.910684
Valid average loss all      (Triplet)                 : 0.219444

== Recognize ==
Valid average loss Recognize     : 2.240418
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.224849

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.776610612869263 sec. =
Valid knn accuracy drums     : 68.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.221354246139526 sec. =
Valid knn accuracy bass      : 17.338709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.274138689041138 sec. =
Valid knn accuracy piano     : 23.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.583191156387329 sec. =
Valid knn accuracy guitar    : 37.276785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.395397186279297 sec. =
Valid knn accuracy residuals : 38.40909090909091%

Valid knn accuracy average   : 37.0315476949418%

                                                                      [AEpoch 41: 100%|██████████| 313/313 [05:57<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00973, Train/loss_recog_step=2.270, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0616, Train/loss_unet_all_epoch=0.499, Train/loss_triplet_all_epoch=0.0566, Train/loss_recog_epoch=2.150]Epoch 41: 100%|██████████| 313/313 [05:57<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00973, Train/loss_recog_step=2.270, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.119488, 0.120126, 0.120778, 0.136725
Train average loss UNet                 (all)                : 0.497117

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.023420, 0.558429, 1.711420
Train average loss bass     (Triplet, dist_p, dist_n) : 0.109233, 0.291461, 0.511955
Train average loss piano    (Triplet, dist_p, dist_n) : 0.046307, 0.552577, 1.005740
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.047291, 0.537299, 1.084414
Train average loss residuals(Triplet, dist_p, dist_n) : 0.027364, 0.713758, 1.390134
Train average loss all      (Triplet)                 : 0.051921

== Recognize ==
Train average loss Recognize     : 2.162247
Train average accuracy drums     : 49.869999 %
Train average accuracy bass      : 49.904999 %
Train average accuracy piano     : 49.764999 %
Train average accuracy guitar    : 50.019997 %
Train average accuracy residuals : 49.720001 %

== Train average loss all : 0.056893

Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00973, Train/loss_recog_step=2.270, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]          Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00973, Train/loss_recog_step=2.270, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]Epoch 42:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00973, Train/loss_recog_step=2.270, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]Epoch 42:  16%|█▌        | 50/313 [00:51<04:30,  0.97it/s, v_num=0, Train/loss_all_step=0.0366, Train/loss_unet_all_step=0.525, Train/loss_triplet_all_step=0.0313, Train/loss_recog_step=2.200, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160] Epoch 42:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.0366, Train/loss_unet_all_step=0.525, Train/loss_triplet_all_step=0.0313, Train/loss_recog_step=2.200, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]Epoch 42:  32%|███▏      | 100/313 [01:35<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.0415, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0367, Train/loss_recog_step=2.390, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]Epoch 42:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.0415, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0367, Train/loss_recog_step=2.390, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]Epoch 42:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.0302, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.025, Train/loss_recog_step=2.430, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160] Epoch 42:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.0302, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.025, Train/loss_recog_step=2.430, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]Epoch 42:  64%|██████▍   | 200/313 [03:05<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.0351, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.0301, Train/loss_recog_step=2.270, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]Epoch 42:  80%|███████▉  | 250/313 [03:50<00:58,  1.09it/s, v_num=0, Train/loss_all_step=0.0351, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.0301, Train/loss_recog_step=2.270, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]Epoch 42:  80%|███████▉  | 250/313 [03:50<00:58,  1.09it/s, v_num=0, Train/loss_all_step=0.0537, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.0491, Train/loss_recog_step=2.260, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]Epoch 42:  96%|█████████▌| 300/313 [04:36<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.0537, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.0491, Train/loss_recog_step=2.260, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]Epoch 42:  96%|█████████▌| 300/313 [04:36<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.055, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.0503, Train/loss_recog_step=2.330, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160] Epoch 42: 100%|██████████| 313/313 [04:44<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.055, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.0503, Train/loss_recog_step=2.330, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]Epoch 42: 100%|██████████| 313/313 [04:44<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.00857, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=2.240, Valid/loss_all_step=0.156, Valid/loss_unet_all_step=0.522, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.225, Valid/loss_unet_all_epoch=0.540, Valid/loss_triplet_all_epoch=0.219, Valid/loss_recog_epoch=2.240, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.43it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.76it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.88it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.133222, 0.133604, 0.126021, 0.156304
Valid average loss UNet                 (all)                : 0.549152

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.136633, 0.648217, 1.349702
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.252635, 0.365875, 0.355587
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.353940, 0.799715, 0.722558
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.155059, 0.506798, 0.814245
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.208499, 0.828132, 1.072286
Valid average loss all      (Triplet)                 : 0.214375

== Recognize ==
Valid average loss Recognize     : 2.169611
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 56.000000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.219867

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.326415300369263 sec. =
Valid knn accuracy drums     : 72.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.015214681625366 sec. =
Valid knn accuracy bass      : 16.93548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.80234146118164 sec. =
Valid knn accuracy piano     : 26.171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.329115867614746 sec. =
Valid knn accuracy guitar    : 41.517857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.966871023178101 sec. =
Valid knn accuracy residuals : 45.45454545454545%

Valid knn accuracy average   : 40.49421316323929%

                                                                      [AEpoch 42: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00857, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=2.240, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0569, Train/loss_unet_all_epoch=0.497, Train/loss_triplet_all_epoch=0.0519, Train/loss_recog_epoch=2.160]Epoch 42: 100%|██████████| 313/313 [05:55<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00857, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=2.240, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.119359, 0.120056, 0.120720, 0.137595
Train average loss UNet                 (all)                : 0.497730

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.019875, 0.567120, 1.772451
Train average loss bass     (Triplet, dist_p, dist_n) : 0.100412, 0.304762, 0.551622
Train average loss piano    (Triplet, dist_p, dist_n) : 0.043139, 0.600414, 1.098609
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.044336, 0.564863, 1.165253
Train average loss residuals(Triplet, dist_p, dist_n) : 0.027280, 0.772371, 1.499558
Train average loss all      (Triplet)                 : 0.048101

== Recognize ==
Train average loss Recognize     : 2.206100
Train average accuracy drums     : 50.820000 %
Train average accuracy bass      : 50.445004 %
Train average accuracy piano     : 49.669998 %
Train average accuracy guitar    : 50.000000 %
Train average accuracy residuals : 50.234997 %

== Train average loss all : 0.053079

Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00857, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=2.240, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]          Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00857, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=2.240, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]Epoch 43:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.00857, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=2.240, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]Epoch 43:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.057, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.0519, Train/loss_recog_step=2.220, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]  Epoch 43:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.057, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.0519, Train/loss_recog_step=2.220, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]Epoch 43:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.0589, Train/loss_recog_step=2.400, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]Epoch 43:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.0637, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.0589, Train/loss_recog_step=2.400, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]Epoch 43:  48%|████▊     | 150/313 [02:24<02:36,  1.04it/s, v_num=0, Train/loss_all_step=0.0177, Train/loss_unet_all_step=0.513, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=2.220, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]Epoch 43:  64%|██████▍   | 200/313 [03:08<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.0177, Train/loss_unet_all_step=0.513, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=2.220, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]Epoch 43:  64%|██████▍   | 200/313 [03:08<01:46,  1.06it/s, v_num=0, Train/loss_all_step=0.037, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.032, Train/loss_recog_step=2.320, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]  Epoch 43:  80%|███████▉  | 250/313 [03:54<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.037, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.032, Train/loss_recog_step=2.320, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]Epoch 43:  80%|███████▉  | 250/313 [03:54<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.0442, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.0396, Train/loss_recog_step=2.050, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]Epoch 43:  96%|█████████▌| 300/313 [04:38<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.0442, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.0396, Train/loss_recog_step=2.050, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]Epoch 43:  96%|█████████▌| 300/313 [04:38<00:12,  1.08it/s, v_num=0, Train/loss_all_step=0.0559, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.0511, Train/loss_recog_step=2.250, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]Epoch 43: 100%|██████████| 313/313 [04:46<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.0559, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.0511, Train/loss_recog_step=2.250, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]Epoch 43: 100%|██████████| 313/313 [04:46<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0096, Train/loss_recog_step=2.320, Valid/loss_all_step=0.201, Valid/loss_unet_all_step=0.532, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=2.090, Valid/loss_all_epoch=0.220, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.214, Valid/loss_recog_epoch=2.170, Valid/knn_avr=0.405, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.69it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.36it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.06it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.135551, 0.135754, 0.128295, 0.156416
Valid average loss UNet                 (all)                : 0.556016

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.188941, 0.702144, 1.315867
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.288946, 0.405118, 0.344497
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.445779, 0.853542, 0.707737
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.186928, 0.619345, 0.975044
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.223094, 0.798532, 1.082600
Valid average loss all      (Triplet)                 : 0.267117

== Recognize ==
Valid average loss Recognize     : 2.256581
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 43.500000 %

== Valid average loss all : 0.272677

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8254477977752686 sec. =
Valid knn accuracy drums     : 70.65217391304348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.049708843231201 sec. =
Valid knn accuracy bass      : 15.92741935483871%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.447491645812988 sec. =
Valid knn accuracy piano     : 19.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.360076665878296 sec. =
Valid knn accuracy guitar    : 39.285714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.186387538909912 sec. =
Valid knn accuracy residuals : 46.36363636363636%

Valid knn accuracy average   : 38.27391378344657%

                                                                      [AEpoch 43: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0096, Train/loss_recog_step=2.320, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0531, Train/loss_unet_all_epoch=0.498, Train/loss_triplet_all_epoch=0.0481, Train/loss_recog_epoch=2.210]Epoch 43: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0096, Train/loss_recog_step=2.320, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.119208, 0.119859, 0.120579, 0.136372
Train average loss UNet                 (all)                : 0.496018

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.020430, 0.579051, 1.771118
Train average loss bass     (Triplet, dist_p, dist_n) : 0.096903, 0.333744, 0.606510
Train average loss piano    (Triplet, dist_p, dist_n) : 0.040707, 0.622550, 1.143429
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.040445, 0.582510, 1.192780
Train average loss residuals(Triplet, dist_p, dist_n) : 0.020441, 0.811712, 1.598401
Train average loss all      (Triplet)                 : 0.044556

== Recognize ==
Train average loss Recognize     : 2.241987
Train average accuracy drums     : 50.129997 %
Train average accuracy bass      : 50.489998 %
Train average accuracy piano     : 50.094997 %
Train average accuracy guitar    : 50.105000 %
Train average accuracy residuals : 49.849998 %

== Train average loss all : 0.049517

Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0096, Train/loss_recog_step=2.320, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]          Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0096, Train/loss_recog_step=2.320, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0096, Train/loss_recog_step=2.320, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44:  16%|█▌        | 50/313 [00:51<04:28,  0.98it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.0417, Train/loss_recog_step=2.270, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44:  32%|███▏      | 100/313 [01:35<03:23,  1.05it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.0417, Train/loss_recog_step=2.270, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44:  32%|███▏      | 100/313 [01:35<03:23,  1.05it/s, v_num=0, Train/loss_all_step=0.0347, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0298, Train/loss_recog_step=2.270, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44:  48%|████▊     | 150/313 [02:20<02:32,  1.07it/s, v_num=0, Train/loss_all_step=0.0347, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0298, Train/loss_recog_step=2.270, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44:  48%|████▊     | 150/313 [02:20<02:32,  1.07it/s, v_num=0, Train/loss_all_step=0.0338, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.0285, Train/loss_recog_step=2.270, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.0338, Train/loss_unet_all_step=0.522, Train/loss_triplet_all_step=0.0285, Train/loss_recog_step=2.270, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.0478, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0428, Train/loss_recog_step=2.560, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44:  80%|███████▉  | 250/313 [03:47<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.0478, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0428, Train/loss_recog_step=2.560, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44:  80%|███████▉  | 250/313 [03:47<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.0332, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.0287, Train/loss_recog_step=2.420, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44:  96%|█████████▌| 300/313 [04:31<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.0332, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.0287, Train/loss_recog_step=2.420, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44:  96%|█████████▌| 300/313 [04:31<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.0552, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.0505, Train/loss_recog_step=2.530, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.0552, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.0505, Train/loss_recog_step=2.530, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=1.960, Valid/loss_all_step=0.283, Valid/loss_unet_all_step=0.563, Valid/loss_triplet_all_step=0.277, Valid/loss_recog_step=2.340, Valid/loss_all_epoch=0.273, Valid/loss_unet_all_epoch=0.556, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=2.260, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.46it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.00it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.02it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.141691, 0.140245, 0.133832, 0.146033
Valid average loss UNet                 (all)                : 0.561801

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.124415, 0.749704, 1.469324
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.278669, 0.436066, 0.394186
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.275547, 0.739578, 0.753041
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.226967, 0.646837, 0.911072
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.188839, 0.785984, 1.087016
Valid average loss all      (Triplet)                 : 0.213108

== Recognize ==
Valid average loss Recognize     : 2.538446
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.218726

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.532229423522949 sec. =
Valid knn accuracy drums     : 72.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.14170789718628 sec. =
Valid knn accuracy bass      : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.368671894073486 sec. =
Valid knn accuracy piano     : 22.4609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.370879411697388 sec. =
Valid knn accuracy guitar    : 40.17857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.397459030151367 sec. =
Valid knn accuracy residuals : 40.45454545454545%

Valid knn accuracy average   : 40.097071746188604%

                                                                      [AEpoch 44: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=1.960, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0495, Train/loss_unet_all_epoch=0.496, Train/loss_triplet_all_epoch=0.0446, Train/loss_recog_epoch=2.240]Epoch 44: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=1.960, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.119116, 0.119776, 0.120418, 0.135118
Train average loss UNet                 (all)                : 0.494428

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.018906, 0.607053, 1.878585
Train average loss bass     (Triplet, dist_p, dist_n) : 0.089280, 0.373293, 0.675490
Train average loss piano    (Triplet, dist_p, dist_n) : 0.035628, 0.651788, 1.215927
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.037521, 0.620523, 1.269547
Train average loss residuals(Triplet, dist_p, dist_n) : 0.022604, 0.850814, 1.672851
Train average loss all      (Triplet)                 : 0.041745

== Recognize ==
Train average loss Recognize     : 2.294731
Train average accuracy drums     : 49.950001 %
Train average accuracy bass      : 49.939999 %
Train average accuracy piano     : 49.349998 %
Train average accuracy guitar    : 49.720001 %
Train average accuracy residuals : 50.125004 %

== Train average loss all : 0.046689

Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=1.960, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]          Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=1.960, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45:  16%|█▌        | 50/313 [00:49<04:21,  1.00it/s, v_num=0, Train/loss_all_step=0.0085, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=1.960, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45:  16%|█▌        | 50/313 [00:49<04:21,  1.00it/s, v_num=0, Train/loss_all_step=0.033, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=0.0279, Train/loss_recog_step=2.470, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290] Epoch 45:  32%|███▏      | 100/313 [01:36<03:24,  1.04it/s, v_num=0, Train/loss_all_step=0.033, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=0.0279, Train/loss_recog_step=2.470, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45:  32%|███▏      | 100/313 [01:36<03:24,  1.04it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=2.170, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=2.170, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45:  48%|████▊     | 150/313 [02:19<02:31,  1.08it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=2.410, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45:  64%|██████▍   | 200/313 [03:04<01:44,  1.09it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=2.410, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45:  64%|██████▍   | 200/313 [03:04<01:44,  1.09it/s, v_num=0, Train/loss_all_step=0.0385, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=2.230, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45:  80%|███████▉  | 250/313 [03:49<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.0385, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=2.230, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45:  80%|███████▉  | 250/313 [03:49<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.0375, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0327, Train/loss_recog_step=2.150, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45:  96%|█████████▌| 300/313 [04:33<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.0375, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0327, Train/loss_recog_step=2.150, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45:  96%|█████████▌| 300/313 [04:33<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.0421, Train/loss_recog_step=2.400, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.0468, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.0421, Train/loss_recog_step=2.400, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.0077, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00301, Train/loss_recog_step=2.150, Valid/loss_all_step=0.153, Valid/loss_unet_all_step=0.543, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=3.120, Valid/loss_all_epoch=0.219, Valid/loss_unet_all_epoch=0.562, Valid/loss_triplet_all_epoch=0.213, Valid/loss_recog_epoch=2.540, Valid/knn_avr=0.401, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.77it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.45it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.98it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.94it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.12it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.136997, 0.135902, 0.129167, 0.147244
Valid average loss UNet                 (all)                : 0.549309

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.201581, 0.768373, 1.421193
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.296558, 0.493731, 0.443731
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.314489, 0.814827, 0.780895
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.177122, 0.654550, 0.979030
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.249492, 0.874108, 1.089572
Valid average loss all      (Triplet)                 : 0.242744

== Recognize ==
Valid average loss Recognize     : 2.431308
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.248237

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.456894159317017 sec. =
Valid knn accuracy drums     : 70.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.274546384811401 sec. =
Valid knn accuracy bass      : 18.14516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.155977964401245 sec. =
Valid knn accuracy piano     : 22.8515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.510281085968018 sec. =
Valid knn accuracy guitar    : 42.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.9894773960113525 sec. =
Valid knn accuracy residuals : 38.40909090909091%

Valid knn accuracy average   : 38.49490517590754%

                                                                      [AEpoch 45: 100%|██████████| 313/313 [05:52<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0077, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00301, Train/loss_recog_step=2.150, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0467, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0417, Train/loss_recog_epoch=2.290]Epoch 45: 100%|██████████| 313/313 [05:52<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0077, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00301, Train/loss_recog_step=2.150, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.119070, 0.119726, 0.120399, 0.135140
Train average loss UNet                 (all)                : 0.494334

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.019480, 0.638308, 1.945252
Train average loss bass     (Triplet, dist_p, dist_n) : 0.082260, 0.384421, 0.715462
Train average loss piano    (Triplet, dist_p, dist_n) : 0.032482, 0.675469, 1.267635
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.033668, 0.654147, 1.367467
Train average loss residuals(Triplet, dist_p, dist_n) : 0.021580, 0.885604, 1.741198
Train average loss all      (Triplet)                 : 0.038826

== Recognize ==
Train average loss Recognize     : 2.316044
Train average accuracy drums     : 49.919998 %
Train average accuracy bass      : 49.965000 %
Train average accuracy piano     : 49.595001 %
Train average accuracy guitar    : 49.939999 %
Train average accuracy residuals : 50.045002 %

== Train average loss all : 0.043769

Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0077, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00301, Train/loss_recog_step=2.150, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]          Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0077, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00301, Train/loss_recog_step=2.150, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]Epoch 46:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.0077, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00301, Train/loss_recog_step=2.150, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]Epoch 46:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.0313, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.0263, Train/loss_recog_step=2.370, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320] Epoch 46:  32%|███▏      | 100/313 [01:34<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.0313, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.0263, Train/loss_recog_step=2.370, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]Epoch 46:  32%|███▏      | 100/313 [01:34<03:22,  1.05it/s, v_num=0, Train/loss_all_step=0.024, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=2.350, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320] Epoch 46:  48%|████▊     | 150/313 [02:20<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.024, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=2.350, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]Epoch 46:  48%|████▊     | 150/313 [02:20<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.0402, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.0349, Train/loss_recog_step=2.100, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]Epoch 46:  64%|██████▍   | 200/313 [03:04<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.0402, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.0349, Train/loss_recog_step=2.100, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]Epoch 46:  64%|██████▍   | 200/313 [03:04<01:44,  1.08it/s, v_num=0, Train/loss_all_step=0.0327, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=2.290, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]Epoch 46:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.0327, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=2.290, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]Epoch 46:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.451, Train/loss_triplet_all_step=0.0407, Train/loss_recog_step=2.520, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]Epoch 46:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.0452, Train/loss_unet_all_step=0.451, Train/loss_triplet_all_step=0.0407, Train/loss_recog_step=2.520, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]Epoch 46:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.0293, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0247, Train/loss_recog_step=2.460, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]Epoch 46: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.0293, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0247, Train/loss_recog_step=2.460, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]Epoch 46: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.00872, Train/loss_recog_step=2.300, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.549, Valid/loss_triplet_all_step=0.209, Valid/loss_recog_step=2.710, Valid/loss_all_epoch=0.248, Valid/loss_unet_all_epoch=0.549, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.385, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.33it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.87it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.81it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.131474, 0.133035, 0.124044, 0.144268
Valid average loss UNet                 (all)                : 0.532821

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.037604, 0.621848, 1.579014
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.302446, 0.540155, 0.497974
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.307815, 0.957481, 0.975176
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.210847, 0.783082, 1.139456
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.269790, 0.974956, 1.224068
Valid average loss all      (Triplet)                 : 0.227419

== Recognize ==
Valid average loss Recognize     : 2.334058
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.232748

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.332670211791992 sec. =
Valid knn accuracy drums     : 66.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.009411811828613 sec. =
Valid knn accuracy bass      : 16.33064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.348909378051758 sec. =
Valid knn accuracy piano     : 23.828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.30317234992981 sec. =
Valid knn accuracy guitar    : 44.419642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.471303462982178 sec. =
Valid knn accuracy residuals : 42.27272727272727%

Valid knn accuracy average   : 38.71805414518861%

                                                                      [AEpoch 46: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.00872, Train/loss_recog_step=2.300, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0438, Train/loss_unet_all_epoch=0.494, Train/loss_triplet_all_epoch=0.0388, Train/loss_recog_epoch=2.320]Epoch 46: 100%|██████████| 313/313 [05:51<00:00,  0.89it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.00872, Train/loss_recog_step=2.300, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.118855, 0.119493, 0.120217, 0.134387
Train average loss UNet                 (all)                : 0.492951

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.018941, 0.629172, 1.941121
Train average loss bass     (Triplet, dist_p, dist_n) : 0.077513, 0.390747, 0.730103
Train average loss piano    (Triplet, dist_p, dist_n) : 0.029555, 0.687311, 1.307659
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.033706, 0.656258, 1.367647
Train average loss residuals(Triplet, dist_p, dist_n) : 0.020025, 0.888099, 1.755485
Train average loss all      (Triplet)                 : 0.036492

== Recognize ==
Train average loss Recognize     : 2.310245
Train average accuracy drums     : 50.099998 %
Train average accuracy bass      : 50.185001 %
Train average accuracy piano     : 49.884998 %
Train average accuracy guitar    : 49.614998 %
Train average accuracy residuals : 49.614998 %

== Train average loss all : 0.041421

Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.00872, Train/loss_recog_step=2.300, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]          Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.00872, Train/loss_recog_step=2.300, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]Epoch 47:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.00872, Train/loss_recog_step=2.300, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]Epoch 47:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.0261, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=2.160, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310] Epoch 47:  32%|███▏      | 100/313 [01:36<03:26,  1.03it/s, v_num=0, Train/loss_all_step=0.0261, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=2.160, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]Epoch 47:  32%|███▏      | 100/313 [01:36<03:26,  1.03it/s, v_num=0, Train/loss_all_step=0.0313, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.0265, Train/loss_recog_step=2.170, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]Epoch 47:  48%|████▊     | 150/313 [02:21<02:34,  1.06it/s, v_num=0, Train/loss_all_step=0.0313, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.0265, Train/loss_recog_step=2.170, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]Epoch 47:  48%|████▊     | 150/313 [02:21<02:34,  1.06it/s, v_num=0, Train/loss_all_step=0.0463, Train/loss_unet_all_step=0.528, Train/loss_triplet_all_step=0.041, Train/loss_recog_step=2.240, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310] Epoch 47:  64%|██████▍   | 200/313 [03:06<01:45,  1.07it/s, v_num=0, Train/loss_all_step=0.0463, Train/loss_unet_all_step=0.528, Train/loss_triplet_all_step=0.041, Train/loss_recog_step=2.240, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]Epoch 47:  64%|██████▍   | 200/313 [03:06<01:45,  1.07it/s, v_num=0, Train/loss_all_step=0.0565, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0516, Train/loss_recog_step=2.340, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]Epoch 47:  80%|███████▉  | 250/313 [03:50<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.0565, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0516, Train/loss_recog_step=2.340, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]Epoch 47:  80%|███████▉  | 250/313 [03:50<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.0541, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.0495, Train/loss_recog_step=2.390, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]Epoch 47:  96%|█████████▌| 300/313 [04:36<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.0541, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.0495, Train/loss_recog_step=2.390, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]Epoch 47:  96%|█████████▌| 300/313 [04:36<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.0302, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.0254, Train/loss_recog_step=2.400, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]Epoch 47: 100%|██████████| 313/313 [04:44<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.0302, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.0254, Train/loss_recog_step=2.400, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]Epoch 47: 100%|██████████| 313/313 [04:44<00:00,  1.10it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=2.390, Valid/loss_all_step=0.106, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.101, Valid/loss_recog_step=2.460, Valid/loss_all_epoch=0.233, Valid/loss_unet_all_epoch=0.533, Valid/loss_triplet_all_epoch=0.227, Valid/loss_recog_epoch=2.330, Valid/knn_avr=0.387, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.49it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.57it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.36it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.12it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.19it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.132822, 0.132881, 0.126084, 0.147710
Valid average loss UNet                 (all)                : 0.539496

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.151649, 0.691418, 1.233796
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.331867, 0.586637, 0.510989
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.343641, 0.890685, 0.941177
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.157247, 0.700488, 1.091587
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.232213, 0.929785, 1.358044
Valid average loss all      (Triplet)                 : 0.232669

== Recognize ==
Valid average loss Recognize     : 2.286889
Valid average accuracy drums     : 56.500000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.238064

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.9620654582977295 sec. =
Valid knn accuracy drums     : 70.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.305022239685059 sec. =
Valid knn accuracy bass      : 19.153225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.134248733520508 sec. =
Valid knn accuracy piano     : 21.484375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.865588188171387 sec. =
Valid knn accuracy guitar    : 42.1875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3951640129089355 sec. =
Valid knn accuracy residuals : 39.31818181818182%

Valid knn accuracy average   : 38.42865652492669%

                                                                      [AEpoch 47: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=2.390, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0414, Train/loss_unet_all_epoch=0.493, Train/loss_triplet_all_epoch=0.0365, Train/loss_recog_epoch=2.310]Epoch 47: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=2.390, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.118750, 0.119432, 0.120076, 0.134076
Train average loss UNet                 (all)                : 0.492334

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.018785, 0.646859, 2.025483
Train average loss bass     (Triplet, dist_p, dist_n) : 0.069969, 0.429529, 0.830603
Train average loss piano    (Triplet, dist_p, dist_n) : 0.031205, 0.736667, 1.406342
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.031667, 0.688881, 1.417590
Train average loss residuals(Triplet, dist_p, dist_n) : 0.018954, 0.964952, 1.901004
Train average loss all      (Triplet)                 : 0.034383

== Recognize ==
Train average loss Recognize     : 2.340186
Train average accuracy drums     : 50.064999 %
Train average accuracy bass      : 49.889999 %
Train average accuracy piano     : 49.825001 %
Train average accuracy guitar    : 49.494999 %
Train average accuracy residuals : 49.985001 %

== Train average loss all : 0.039306

Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=2.390, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]          Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=2.390, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]Epoch 48:  16%|█▌        | 50/313 [00:51<04:32,  0.96it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=2.390, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]Epoch 48:  16%|█▌        | 50/313 [00:51<04:32,  0.96it/s, v_num=0, Train/loss_all_step=0.0306, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=2.410, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]  Epoch 48:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.0306, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=2.410, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]Epoch 48:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.055, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0502, Train/loss_recog_step=2.460, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340] Epoch 48:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.055, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0502, Train/loss_recog_step=2.460, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]Epoch 48:  48%|████▊     | 150/313 [02:24<02:37,  1.04it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.517, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=2.190, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]Epoch 48:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.517, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=2.190, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]Epoch 48:  64%|██████▍   | 200/313 [03:10<01:47,  1.05it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=2.350, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]Epoch 48:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=2.350, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]Epoch 48:  80%|███████▉  | 250/313 [03:55<00:59,  1.06it/s, v_num=0, Train/loss_all_step=0.0336, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.0291, Train/loss_recog_step=2.450, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]Epoch 48:  96%|█████████▌| 300/313 [04:41<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.0336, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.0291, Train/loss_recog_step=2.450, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]Epoch 48:  96%|█████████▌| 300/313 [04:41<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.0612, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0564, Train/loss_recog_step=2.270, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]Epoch 48: 100%|██████████| 313/313 [04:49<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.0612, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0564, Train/loss_recog_step=2.270, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]Epoch 48: 100%|██████████| 313/313 [04:49<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.00903, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=2.100, Valid/loss_all_step=0.140, Valid/loss_unet_all_step=0.546, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=2.230, Valid/loss_all_epoch=0.238, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.233, Valid/loss_recog_epoch=2.290, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.77it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.58it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.33it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.16it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.12it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.130965, 0.132460, 0.123587, 0.151759
Valid average loss UNet                 (all)                : 0.538771

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.117789, 0.693695, 1.371087
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.272880, 0.535953, 0.529325
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.358743, 0.951607, 0.901250
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.144116, 0.646585, 1.010783
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.212723, 0.973274, 1.287750
Valid average loss all      (Triplet)                 : 0.231952

== Recognize ==
Valid average loss Recognize     : 2.407419
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.237340

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.71528697013855 sec. =
Valid knn accuracy drums     : 66.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.969511270523071 sec. =
Valid knn accuracy bass      : 18.346774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.148991346359253 sec. =
Valid knn accuracy piano     : 24.8046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.652178764343262 sec. =
Valid knn accuracy guitar    : 44.642857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.404049396514893 sec. =
Valid knn accuracy residuals : 41.590909090909086%

Valid knn accuracy average   : 39.181393411549884%

                                                                      [AEpoch 48: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.00903, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=2.100, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0393, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0344, Train/loss_recog_epoch=2.340]Epoch 48: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.00903, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=2.100, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.118629, 0.119290, 0.120006, 0.134274
Train average loss UNet                 (all)                : 0.492199

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.017712, 0.654495, 2.004305
Train average loss bass     (Triplet, dist_p, dist_n) : 0.067355, 0.448059, 0.854743
Train average loss piano    (Triplet, dist_p, dist_n) : 0.027850, 0.755325, 1.436771
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.028140, 0.685162, 1.456934
Train average loss residuals(Triplet, dist_p, dist_n) : 0.017263, 0.966925, 1.925839
Train average loss all      (Triplet)                 : 0.032413

== Recognize ==
Train average loss Recognize     : 2.349855
Train average accuracy drums     : 50.320000 %
Train average accuracy bass      : 49.924999 %
Train average accuracy piano     : 50.180000 %
Train average accuracy guitar    : 49.924999 %
Train average accuracy residuals : 49.494999 %

== Train average loss all : 0.037335

Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00903, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=2.100, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]          Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00903, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=2.100, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]Epoch 49:  16%|█▌        | 50/313 [00:54<04:48,  0.91it/s, v_num=0, Train/loss_all_step=0.00903, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=2.100, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]Epoch 49:  16%|█▌        | 50/313 [00:54<04:48,  0.91it/s, v_num=0, Train/loss_all_step=0.023, Train/loss_unet_all_step=0.516, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=2.420, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]   Epoch 49:  32%|███▏      | 100/313 [01:41<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.023, Train/loss_unet_all_step=0.516, Train/loss_triplet_all_step=0.0178, Train/loss_recog_step=2.420, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]Epoch 49:  32%|███▏      | 100/313 [01:41<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.040, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0351, Train/loss_recog_step=1.990, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]Epoch 49:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.040, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0351, Train/loss_recog_step=1.990, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]Epoch 49:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0295, Train/loss_unet_all_step=0.516, Train/loss_triplet_all_step=0.0243, Train/loss_recog_step=2.120, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]Epoch 49:  64%|██████▍   | 200/313 [03:16<01:51,  1.02it/s, v_num=0, Train/loss_all_step=0.0295, Train/loss_unet_all_step=0.516, Train/loss_triplet_all_step=0.0243, Train/loss_recog_step=2.120, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]Epoch 49:  64%|██████▍   | 200/313 [03:16<01:51,  1.02it/s, v_num=0, Train/loss_all_step=0.0449, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.040, Train/loss_recog_step=2.580, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350] Epoch 49:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0449, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.040, Train/loss_recog_step=2.580, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]Epoch 49:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0401, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0355, Train/loss_recog_step=2.200, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]Epoch 49:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0401, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0355, Train/loss_recog_step=2.200, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]Epoch 49:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0447, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.0399, Train/loss_recog_step=2.270, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]Epoch 49: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0447, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.0399, Train/loss_recog_step=2.270, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]Epoch 49: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=2.490, Valid/loss_all_step=0.235, Valid/loss_unet_all_step=0.538, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=2.680, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.539, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.410, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.65it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:03<00:00,  2.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:03<00:00,  2.41it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.11it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:02<00:00,  2.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.133824, 0.133739, 0.126868, 0.147642
Valid average loss UNet                 (all)                : 0.542073

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.048714, 0.757648, 1.835027
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.251254, 0.590658, 0.681994
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.303475, 1.066353, 1.202256
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.180543, 0.876927, 1.343400
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.273514, 1.133719, 1.450928
Valid average loss all      (Triplet)                 : 0.223385

== Recognize ==
Valid average loss Recognize     : 2.299871
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.228806

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.30080270767212 sec. =
Valid knn accuracy drums     : 65.65217391304347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.047955751419067 sec. =
Valid knn accuracy bass      : 14.919354838709678%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.198572158813477 sec. =
Valid knn accuracy piano     : 23.046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.492235422134399 sec. =
Valid knn accuracy guitar    : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.436534404754639 sec. =
Valid knn accuracy residuals : 36.81818181818181%

Valid knn accuracy average   : 36.21231711398699%

                                                                      [AEpoch 49: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=2.490, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0373, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0324, Train/loss_recog_epoch=2.350]Epoch 49: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=2.490, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.118562, 0.119168, 0.119875, 0.134137
Train average loss UNet                 (all)                : 0.491742

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.014092, 0.681073, 2.102736
Train average loss bass     (Triplet, dist_p, dist_n) : 0.064963, 0.469445, 0.901149
Train average loss piano    (Triplet, dist_p, dist_n) : 0.027099, 0.775226, 1.494798
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.027182, 0.717404, 1.504861
Train average loss residuals(Triplet, dist_p, dist_n) : 0.016932, 0.963610, 1.922526
Train average loss all      (Triplet)                 : 0.030553

== Recognize ==
Train average loss Recognize     : 2.344434
Train average accuracy drums     : 50.019997 %
Train average accuracy bass      : 49.860001 %
Train average accuracy piano     : 50.535000 %
Train average accuracy guitar    : 49.555000 %
Train average accuracy residuals : 50.639999 %

== Train average loss all : 0.035470

Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=2.490, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]          Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=2.490, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50:  16%|█▌        | 50/313 [00:55<04:53,  0.90it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=2.490, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50:  16%|█▌        | 50/313 [00:55<04:53,  0.90it/s, v_num=0, Train/loss_all_step=0.0252, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.0202, Train/loss_recog_step=2.450, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.0252, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.0202, Train/loss_recog_step=2.450, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=2.520, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50:  48%|████▊     | 150/313 [02:27<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.0156, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=2.520, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50:  48%|████▊     | 150/313 [02:27<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.0318, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0266, Train/loss_recog_step=2.390, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50:  64%|██████▍   | 200/313 [03:14<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0318, Train/loss_unet_all_step=0.518, Train/loss_triplet_all_step=0.0266, Train/loss_recog_step=2.390, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50:  64%|██████▍   | 200/313 [03:14<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=2.490, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=2.490, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0454, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.0409, Train/loss_recog_step=2.550, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0454, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.0409, Train/loss_recog_step=2.550, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.024, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=2.580, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340] Epoch 50: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.024, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=2.580, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00491, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.380, Valid/loss_all_step=0.149, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.144, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.229, Valid/loss_unet_all_epoch=0.542, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=2.300, Valid/knn_avr=0.362, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.44it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.74it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.130855, 0.132287, 0.123871, 0.144736
Valid average loss UNet                 (all)                : 0.531748

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.053671, 0.807971, 1.803964
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.284802, 0.663935, 0.726628
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.307228, 1.162634, 1.271223
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.232919, 0.918773, 1.262456
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.279936, 1.303920, 1.717694
Valid average loss all      (Triplet)                 : 0.224222

== Recognize ==
Valid average loss Recognize     : 2.447304
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.229540

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.00407886505127 sec. =
Valid knn accuracy drums     : 66.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.418740034103394 sec. =
Valid knn accuracy bass      : 18.548387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.606915712356567 sec. =
Valid knn accuracy piano     : 22.65625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.068932056427002 sec. =
Valid knn accuracy guitar    : 41.964285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.235272645950317 sec. =
Valid knn accuracy residuals : 45.909090909090914%

Valid knn accuracy average   : 39.20690709185625%

                                                                      [AEpoch 50: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00491, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.380, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0355, Train/loss_unet_all_epoch=0.492, Train/loss_triplet_all_epoch=0.0306, Train/loss_recog_epoch=2.340]Epoch 50: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00491, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.380, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.118466, 0.119121, 0.119801, 0.134094
Train average loss UNet                 (all)                : 0.491481

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.013030, 0.683406, 2.122288
Train average loss bass     (Triplet, dist_p, dist_n) : 0.060622, 0.487014, 0.944487
Train average loss piano    (Triplet, dist_p, dist_n) : 0.025631, 0.783253, 1.507344
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.027125, 0.729032, 1.558701
Train average loss residuals(Triplet, dist_p, dist_n) : 0.014444, 0.975823, 1.968160
Train average loss all      (Triplet)                 : 0.028744

== Recognize ==
Train average loss Recognize     : 2.384499
Train average accuracy drums     : 50.010002 %
Train average accuracy bass      : 49.860001 %
Train average accuracy piano     : 49.389999 %
Train average accuracy guitar    : 50.255001 %
Train average accuracy residuals : 49.884998 %

== Train average loss all : 0.033659

Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00491, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.380, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]          Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00491, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.380, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]Epoch 51:  16%|█▌        | 50/313 [00:56<04:56,  0.89it/s, v_num=0, Train/loss_all_step=0.00491, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.380, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]Epoch 51:  16%|█▌        | 50/313 [00:56<04:56,  0.89it/s, v_num=0, Train/loss_all_step=0.0276, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.0226, Train/loss_recog_step=2.520, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]Epoch 51:  32%|███▏      | 100/313 [01:43<03:39,  0.97it/s, v_num=0, Train/loss_all_step=0.0276, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.0226, Train/loss_recog_step=2.520, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]Epoch 51:  32%|███▏      | 100/313 [01:43<03:39,  0.97it/s, v_num=0, Train/loss_all_step=0.0422, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0374, Train/loss_recog_step=2.450, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]Epoch 51:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.0422, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0374, Train/loss_recog_step=2.450, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]Epoch 51:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.034, Train/loss_unet_all_step=0.513, Train/loss_triplet_all_step=0.0288, Train/loss_recog_step=2.510, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380] Epoch 51:  64%|██████▍   | 200/313 [03:18<01:52,  1.01it/s, v_num=0, Train/loss_all_step=0.034, Train/loss_unet_all_step=0.513, Train/loss_triplet_all_step=0.0288, Train/loss_recog_step=2.510, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]Epoch 51:  64%|██████▍   | 200/313 [03:18<01:52,  1.01it/s, v_num=0, Train/loss_all_step=0.0244, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=2.700, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]Epoch 51:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0244, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=2.700, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]Epoch 51:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.032, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.0272, Train/loss_recog_step=2.510, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380] Epoch 51:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.032, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.0272, Train/loss_recog_step=2.510, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]Epoch 51:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.463, Train/loss_triplet_all_step=0.00633, Train/loss_recog_step=2.630, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]Epoch 51: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.463, Train/loss_triplet_all_step=0.00633, Train/loss_recog_step=2.630, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]Epoch 51: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00753, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=2.200, Valid/loss_all_step=0.00521, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.000, Valid/loss_recog_step=2.610, Valid/loss_all_epoch=0.230, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=2.450, Valid/knn_avr=0.392, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.56it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.18it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.16it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126278, 0.129739, 0.120072, 0.153970
Valid average loss UNet                 (all)                : 0.530060

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097322, 0.765845, 1.757958
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.250347, 0.571713, 0.641320
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.351351, 1.080569, 1.104245
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.233114, 0.786039, 1.243210
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.275940, 1.020728, 1.377850
Valid average loss all      (Triplet)                 : 0.234782

== Recognize ==
Valid average loss Recognize     : 2.560957
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.240082

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.24430775642395 sec. =
Valid knn accuracy drums     : 69.56521739130434%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.492971658706665 sec. =
Valid knn accuracy bass      : 15.725806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.945501565933228 sec. =
Valid knn accuracy piano     : 24.21875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.193089962005615 sec. =
Valid knn accuracy guitar    : 39.50892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.152943134307861 sec. =
Valid knn accuracy residuals : 40.22727272727273%

Valid knn accuracy average   : 37.849195028323706%

                                                                      [AEpoch 51: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00753, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=2.200, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0337, Train/loss_unet_all_epoch=0.491, Train/loss_triplet_all_epoch=0.0287, Train/loss_recog_epoch=2.380]Epoch 51: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00753, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=2.200, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.118354, 0.118975, 0.119707, 0.132861
Train average loss UNet                 (all)                : 0.489897

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.013717, 0.704613, 2.155880
Train average loss bass     (Triplet, dist_p, dist_n) : 0.054284, 0.518395, 1.025603
Train average loss piano    (Triplet, dist_p, dist_n) : 0.022216, 0.817744, 1.603292
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.025218, 0.767860, 1.636312
Train average loss residuals(Triplet, dist_p, dist_n) : 0.013779, 1.014706, 2.037974
Train average loss all      (Triplet)                 : 0.026278

== Recognize ==
Train average loss Recognize     : 2.444782
Train average accuracy drums     : 50.024998 %
Train average accuracy bass      : 50.155003 %
Train average accuracy piano     : 49.489998 %
Train average accuracy guitar    : 50.075001 %
Train average accuracy residuals : 49.924999 %

== Train average loss all : 0.031177

Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00753, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=2.200, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]          Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00753, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=2.200, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]Epoch 52:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.00753, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=2.200, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]Epoch 52:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.514, Train/loss_triplet_all_step=0.00806, Train/loss_recog_step=2.280, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440] Epoch 52:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.514, Train/loss_triplet_all_step=0.00806, Train/loss_recog_step=2.280, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]Epoch 52:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=2.470, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440] Epoch 52:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=2.470, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]Epoch 52:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.0483, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.0432, Train/loss_recog_step=2.340, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]Epoch 52:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0483, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.0432, Train/loss_recog_step=2.340, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]Epoch 52:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.00939, Train/loss_recog_step=2.710, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]Epoch 52:  80%|███████▉  | 250/313 [03:59<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.00939, Train/loss_recog_step=2.710, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]Epoch 52:  80%|███████▉  | 250/313 [03:59<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0346, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.030, Train/loss_recog_step=2.760, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]  Epoch 52:  96%|█████████▌| 300/313 [04:45<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.0346, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.030, Train/loss_recog_step=2.760, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]Epoch 52:  96%|█████████▌| 300/313 [04:45<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.0386, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.0338, Train/loss_recog_step=2.510, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]Epoch 52: 100%|██████████| 313/313 [04:54<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.0386, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.0338, Train/loss_recog_step=2.510, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]Epoch 52: 100%|██████████| 313/313 [04:54<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.00509, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=7.49e-5, Train/loss_recog_step=2.050, Valid/loss_all_step=0.0406, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.0355, Valid/loss_recog_step=2.840, Valid/loss_all_epoch=0.240, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.235, Valid/loss_recog_epoch=2.560, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.59it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.58it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.46it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127321, 0.129548, 0.121159, 0.145800
Valid average loss UNet                 (all)                : 0.523828

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099827, 0.807098, 1.731587
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.255531, 0.634935, 0.706574
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.357762, 1.136249, 1.163104
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.175050, 0.742326, 1.140729
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.255679, 1.163510, 1.586756
Valid average loss all      (Triplet)                 : 0.231817

== Recognize ==
Valid average loss Recognize     : 2.430537
Valid average accuracy drums     : 54.500000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 41.500000 %

== Valid average loss all : 0.237056

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.661288499832153 sec. =
Valid knn accuracy drums     : 69.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.246727228164673 sec. =
Valid knn accuracy bass      : 18.14516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.157589673995972 sec. =
Valid knn accuracy piano     : 26.3671875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.651429176330566 sec. =
Valid knn accuracy guitar    : 37.94642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.22683310508728 sec. =
Valid knn accuracy residuals : 47.5%

Valid knn accuracy average   : 39.948277211480665%

                                                                      [AEpoch 52: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00509, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=7.49e-5, Train/loss_recog_step=2.050, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.440]  Epoch 52: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00509, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=7.49e-5, Train/loss_recog_step=2.050, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.118293, 0.118894, 0.119568, 0.132820
Train average loss UNet                 (all)                : 0.489574

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.013850, 0.709670, 2.149831
Train average loss bass     (Triplet, dist_p, dist_n) : 0.049780, 0.524202, 1.040397
Train average loss piano    (Triplet, dist_p, dist_n) : 0.022366, 0.820310, 1.603181
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.026463, 0.763407, 1.628711
Train average loss residuals(Triplet, dist_p, dist_n) : 0.015914, 1.010456, 2.009149
Train average loss all      (Triplet)                 : 0.026263

== Recognize ==
Train average loss Recognize     : 2.523664
Train average accuracy drums     : 49.829998 %
Train average accuracy bass      : 50.204998 %
Train average accuracy piano     : 50.285000 %
Train average accuracy guitar    : 49.724998 %
Train average accuracy residuals : 49.200001 %

== Train average loss all : 0.031159

Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00509, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=7.49e-5, Train/loss_recog_step=2.050, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]          Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00509, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=7.49e-5, Train/loss_recog_step=2.050, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53:  16%|█▌        | 50/313 [00:55<04:53,  0.90it/s, v_num=0, Train/loss_all_step=0.00509, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=7.49e-5, Train/loss_recog_step=2.050, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53:  16%|█▌        | 50/313 [00:55<04:53,  0.90it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=2.530, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]  Epoch 53:  32%|███▏      | 100/313 [01:43<03:41,  0.96it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.521, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=2.530, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53:  32%|███▏      | 100/313 [01:43<03:41,  0.96it/s, v_num=0, Train/loss_all_step=0.0201, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=2.450, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.0201, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=2.450, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=2.610, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.0194, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=2.610, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.0403, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.0353, Train/loss_recog_step=2.660, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0403, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.0353, Train/loss_recog_step=2.660, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.0298, Train/loss_recog_step=2.220, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.0298, Train/loss_recog_step=2.220, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=2.680, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0191, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=2.680, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00477, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.720, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.102, Valid/loss_recog_step=2.040, Valid/loss_all_epoch=0.237, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.232, Valid/loss_recog_epoch=2.430, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.83it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.84it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.17it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.85it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.134546, 0.132847, 0.126761, 0.148548
Valid average loss UNet                 (all)                : 0.542702

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.081600, 0.875783, 1.875238
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.322757, 0.770591, 0.808378
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.368446, 1.235104, 1.328041
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.232064, 0.908680, 1.314207
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.245422, 1.185886, 1.641716
Valid average loss all      (Triplet)                 : 0.235810

== Recognize ==
Valid average loss Recognize     : 2.577650
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 44.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.241237

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.864003896713257 sec. =
Valid knn accuracy drums     : 60.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.157984018325806 sec. =
Valid knn accuracy bass      : 16.33064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.164746046066284 sec. =
Valid knn accuracy piano     : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.5548553466796875 sec. =
Valid knn accuracy guitar    : 40.848214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.206308841705322 sec. =
Valid knn accuracy residuals : 50.0%

Valid knn accuracy average   : 38.43577188940092%

                                                                      [AEpoch 53: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00477, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.720, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0312, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0263, Train/loss_recog_epoch=2.520]Epoch 53: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00477, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.720, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.118210, 0.118843, 0.119561, 0.133142
Train average loss UNet                 (all)                : 0.489755

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.011564, 0.715935, 2.252456
Train average loss bass     (Triplet, dist_p, dist_n) : 0.046339, 0.582484, 1.153353
Train average loss piano    (Triplet, dist_p, dist_n) : 0.019912, 0.838490, 1.647830
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.022172, 0.773822, 1.651792
Train average loss residuals(Triplet, dist_p, dist_n) : 0.014282, 1.028612, 2.070240
Train average loss all      (Triplet)                 : 0.023371

== Recognize ==
Train average loss Recognize     : 2.564599
Train average accuracy drums     : 50.089996 %
Train average accuracy bass      : 50.080002 %
Train average accuracy piano     : 50.305004 %
Train average accuracy guitar    : 50.160004 %
Train average accuracy residuals : 49.974998 %

== Train average loss all : 0.028268

Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00477, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.720, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]          Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00477, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.720, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54:  16%|█▌        | 50/313 [00:54<04:44,  0.92it/s, v_num=0, Train/loss_all_step=0.00477, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.720, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54:  16%|█▌        | 50/313 [00:54<04:44,  0.92it/s, v_num=0, Train/loss_all_step=0.0326, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0276, Train/loss_recog_step=2.600, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0326, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0276, Train/loss_recog_step=2.600, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=2.730, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54:  48%|████▊     | 150/313 [02:30<02:43,  0.99it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=2.730, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54:  48%|████▊     | 150/313 [02:30<02:43,  0.99it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=2.640, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54:  64%|██████▍   | 200/313 [03:17<01:51,  1.02it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=2.640, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54:  64%|██████▍   | 200/313 [03:17<01:51,  1.02it/s, v_num=0, Train/loss_all_step=0.0316, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.0267, Train/loss_recog_step=2.570, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0316, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.0267, Train/loss_recog_step=2.570, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=2.840, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0196, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=2.840, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=2.680, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0195, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=2.680, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]Epoch 54: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.00209, Train/loss_recog_step=2.690, Valid/loss_all_step=0.00829, Valid/loss_unet_all_step=0.553, Valid/loss_triplet_all_step=0.00275, Valid/loss_recog_step=2.350, Valid/loss_all_epoch=0.241, Valid/loss_unet_all_epoch=0.543, Valid/loss_triplet_all_epoch=0.236, Valid/loss_recog_epoch=2.580, Valid/knn_avr=0.384, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.05it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.53it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.38it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.89it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125624, 0.129282, 0.119573, 0.157178
Valid average loss UNet                 (all)                : 0.531657

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054726, 0.815840, 2.073333
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.271047, 0.739614, 0.770217
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.322343, 1.163202, 1.240210
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.296195, 0.927374, 1.156716
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.305915, 1.170416, 1.495155
Valid average loss all      (Triplet)                 : 0.252899

== Recognize ==
Valid average loss Recognize     : 2.348365
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.258216

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.294549703598022 sec. =
Valid knn accuracy drums     : 59.130434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.271204233169556 sec. =
Valid knn accuracy bass      : 11.693548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.850182056427002 sec. =
Valid knn accuracy piano     : 19.3359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2810845375061035 sec. =
Valid knn accuracy guitar    : 44.642857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.401941776275635 sec. =
Valid knn accuracy residuals : 43.63636363636363%

Valid knn accuracy average   : 35.68782828978525%

                                                                      [AEpoch 54: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.00209, Train/loss_recog_step=2.690, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0283, Train/loss_unet_all_epoch=0.490, Train/loss_triplet_all_epoch=0.0234, Train/loss_recog_epoch=2.560]  Epoch 54: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.00209, Train/loss_recog_step=2.690, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.118037, 0.118658, 0.119319, 0.131950
Train average loss UNet                 (all)                : 0.487965

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010404, 0.756385, 2.350072
Train average loss bass     (Triplet, dist_p, dist_n) : 0.043707, 0.613864, 1.239540
Train average loss piano    (Triplet, dist_p, dist_n) : 0.022619, 0.845999, 1.663941
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.018840, 0.764755, 1.655890
Train average loss residuals(Triplet, dist_p, dist_n) : 0.012882, 1.023159, 2.076110
Train average loss all      (Triplet)                 : 0.022191

== Recognize ==
Train average loss Recognize     : 2.643153
Train average accuracy drums     : 49.470001 %
Train average accuracy bass      : 50.010002 %
Train average accuracy piano     : 50.029999 %
Train average accuracy guitar    : 50.265003 %
Train average accuracy residuals : 49.535000 %

== Train average loss all : 0.027071

Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.00209, Train/loss_recog_step=2.690, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]          Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.00209, Train/loss_recog_step=2.690, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]Epoch 55:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.00701, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.00209, Train/loss_recog_step=2.690, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]Epoch 55:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.0238, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=2.710, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]  Epoch 55:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0238, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=2.710, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]Epoch 55:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0224, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0176, Train/loss_recog_step=2.780, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]Epoch 55:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.0224, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0176, Train/loss_recog_step=2.780, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]Epoch 55:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.0257, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=2.720, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]Epoch 55:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0257, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=2.720, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]Epoch 55:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=2.840, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]Epoch 55:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0212, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=2.840, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]Epoch 55:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0225, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.0179, Train/loss_recog_step=2.860, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]Epoch 55:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0225, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.0179, Train/loss_recog_step=2.860, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]Epoch 55:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0301, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.0255, Train/loss_recog_step=2.720, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]Epoch 55: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0301, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.0255, Train/loss_recog_step=2.720, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]Epoch 55: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0538, Train/loss_recog_step=2.780, Valid/loss_all_step=0.0996, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.0944, Valid/loss_recog_step=1.460, Valid/loss_all_epoch=0.258, Valid/loss_unet_all_epoch=0.532, Valid/loss_triplet_all_epoch=0.253, Valid/loss_recog_epoch=2.350, Valid/knn_avr=0.357, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.82it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.15it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.130253, 0.131092, 0.123658, 0.149131
Valid average loss UNet                 (all)                : 0.534134

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073662, 1.010408, 2.057417
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.214220, 0.768282, 0.921743
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.383029, 1.362154, 1.418790
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.218874, 0.917328, 1.283225
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.229900, 1.225508, 1.775081
Valid average loss all      (Triplet)                 : 0.217119

== Recognize ==
Valid average loss Recognize     : 2.656316
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 44.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.222461

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.925259828567505 sec. =
Valid knn accuracy drums     : 62.39130434782608%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.55691146850586 sec. =
Valid knn accuracy bass      : 13.306451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.728392362594604 sec. =
Valid knn accuracy piano     : 25.5859375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.352295637130737 sec. =
Valid knn accuracy guitar    : 42.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.148676156997681 sec. =
Valid knn accuracy residuals : 41.36363636363637%

Valid knn accuracy average   : 37.05625167915884%

                                                                      [AEpoch 55: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0538, Train/loss_recog_step=2.780, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0222, Train/loss_recog_epoch=2.640] Epoch 55: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0538, Train/loss_recog_step=2.780, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.117897, 0.118581, 0.119270, 0.132102
Train average loss UNet                 (all)                : 0.487851

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.013164, 0.752463, 2.309991
Train average loss bass     (Triplet, dist_p, dist_n) : 0.041311, 0.606551, 1.243987
Train average loss piano    (Triplet, dist_p, dist_n) : 0.019713, 0.849198, 1.668611
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.023174, 0.795482, 1.705461
Train average loss residuals(Triplet, dist_p, dist_n) : 0.013265, 1.020091, 2.088091
Train average loss all      (Triplet)                 : 0.022271

== Recognize ==
Train average loss Recognize     : 2.678407
Train average accuracy drums     : 50.150002 %
Train average accuracy bass      : 50.260002 %
Train average accuracy piano     : 49.524998 %
Train average accuracy guitar    : 49.500000 %
Train average accuracy residuals : 50.094997 %

== Train average loss all : 0.027150

Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0538, Train/loss_recog_step=2.780, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]          Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0538, Train/loss_recog_step=2.780, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.0586, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0538, Train/loss_recog_step=2.780, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=2.900, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.0218, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=2.900, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.0275, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0226, Train/loss_recog_step=2.480, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56:  48%|████▊     | 150/313 [02:27<02:40,  1.01it/s, v_num=0, Train/loss_all_step=0.0275, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0226, Train/loss_recog_step=2.480, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56:  48%|████▊     | 150/313 [02:27<02:40,  1.01it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.501, Train/loss_triplet_all_step=0.00991, Train/loss_recog_step=2.750, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.501, Train/loss_triplet_all_step=0.00991, Train/loss_recog_step=2.750, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0294, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0245, Train/loss_recog_step=2.570, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680] Epoch 56:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0294, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0245, Train/loss_recog_step=2.570, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=2.700, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=2.700, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0439, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.0391, Train/loss_recog_step=2.680, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0439, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.0391, Train/loss_recog_step=2.680, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00964, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.00492, Train/loss_recog_step=2.310, Valid/loss_all_step=0.0584, Valid/loss_unet_all_step=0.539, Valid/loss_triplet_all_step=0.053, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.222, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.01it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.65it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.45it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.92it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127298, 0.130894, 0.121574, 0.139878
Valid average loss UNet                 (all)                : 0.519644

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.141819, 1.080436, 1.989427
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.325666, 0.853767, 1.035308
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.328197, 1.311017, 1.559019
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.171733, 0.906006, 1.334124
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.263232, 1.162154, 1.767235
Valid average loss all      (Triplet)                 : 0.238787

== Recognize ==
Valid average loss Recognize     : 2.639817
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.243984

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.504236936569214 sec. =
Valid knn accuracy drums     : 57.826086956521735%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.15932583808899 sec. =
Valid knn accuracy bass      : 11.491935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.400378942489624 sec. =
Valid knn accuracy piano     : 25.9765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.57449197769165 sec. =
Valid knn accuracy guitar    : 39.50892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.048983812332153 sec. =
Valid knn accuracy residuals : 47.04545454545455%

Valid knn accuracy average   : 36.369793611455165%

                                                                      [AEpoch 56: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00964, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.00492, Train/loss_recog_step=2.310, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0271, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=2.680]Epoch 56: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00964, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.00492, Train/loss_recog_step=2.310, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.117881, 0.118546, 0.119202, 0.132388
Train average loss UNet                 (all)                : 0.488018

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008926, 0.795837, 2.470597
Train average loss bass     (Triplet, dist_p, dist_n) : 0.038888, 0.621943, 1.282009
Train average loss piano    (Triplet, dist_p, dist_n) : 0.019052, 0.880214, 1.743311
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.020433, 0.812020, 1.724281
Train average loss residuals(Triplet, dist_p, dist_n) : 0.013154, 1.050650, 2.143167
Train average loss all      (Triplet)                 : 0.020249

== Recognize ==
Train average loss Recognize     : 2.652428
Train average accuracy drums     : 49.790001 %
Train average accuracy bass      : 49.974998 %
Train average accuracy piano     : 50.365002 %
Train average accuracy guitar    : 50.035000 %
Train average accuracy residuals : 50.285000 %

== Train average loss all : 0.025130

Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00964, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.00492, Train/loss_recog_step=2.310, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]          Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00964, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.00492, Train/loss_recog_step=2.310, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]Epoch 57:  16%|█▌        | 50/313 [00:53<04:41,  0.93it/s, v_num=0, Train/loss_all_step=0.00964, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.00492, Train/loss_recog_step=2.310, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]Epoch 57:  16%|█▌        | 50/313 [00:53<04:41,  0.93it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=2.690, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]  Epoch 57:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=2.690, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]Epoch 57:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0275, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0227, Train/loss_recog_step=2.610, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]Epoch 57:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0275, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0227, Train/loss_recog_step=2.610, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]Epoch 57:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=2.760, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]Epoch 57:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=2.760, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]Epoch 57:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.0385, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0336, Train/loss_recog_step=2.750, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]Epoch 57:  80%|███████▉  | 250/313 [04:06<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0385, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0336, Train/loss_recog_step=2.750, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]Epoch 57:  80%|███████▉  | 250/313 [04:06<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=2.610, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]Epoch 57:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=2.610, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]Epoch 57:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=3.110, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]Epoch 57: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=3.110, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]Epoch 57: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00501, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.000165, Train/loss_recog_step=2.520, Valid/loss_all_step=0.0604, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.0555, Valid/loss_recog_step=2.530, Valid/loss_all_epoch=0.244, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.239, Valid/loss_recog_epoch=2.640, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.98it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.14it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.90it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.130490, 0.130829, 0.123851, 0.140381
Valid average loss UNet                 (all)                : 0.525551

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.151973, 1.060511, 2.014431
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.283148, 0.790904, 0.908544
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.336011, 1.220573, 1.367442
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.185155, 0.959320, 1.358042
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.254034, 1.318938, 1.819287
Valid average loss all      (Triplet)                 : 0.248250

== Recognize ==
Valid average loss Recognize     : 2.674060
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.253505

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.648715734481812 sec. =
Valid knn accuracy drums     : 59.56521739130435%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.839637517929077 sec. =
Valid knn accuracy bass      : 15.32258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.09452199935913 sec. =
Valid knn accuracy piano     : 25.390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.244467735290527 sec. =
Valid knn accuracy guitar    : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.559213399887085 sec. =
Valid knn accuracy residuals : 49.31818181818181%

Valid knn accuracy average   : 37.73182097092949%

                                                                      [AEpoch 57: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00501, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.000165, Train/loss_recog_step=2.520, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0251, Train/loss_unet_all_epoch=0.488, Train/loss_triplet_all_epoch=0.0202, Train/loss_recog_epoch=2.650]  Epoch 57: 100%|██████████| 313/313 [06:19<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00501, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.000165, Train/loss_recog_step=2.520, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.117715, 0.118373, 0.119078, 0.131347
Train average loss UNet                 (all)                : 0.486514

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.009132, 0.833294, 2.521709
Train average loss bass     (Triplet, dist_p, dist_n) : 0.036795, 0.649484, 1.345005
Train average loss piano    (Triplet, dist_p, dist_n) : 0.019067, 0.884603, 1.771051
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.019112, 0.835446, 1.777098
Train average loss residuals(Triplet, dist_p, dist_n) : 0.012107, 1.084109, 2.210738
Train average loss all      (Triplet)                 : 0.019672

== Recognize ==
Train average loss Recognize     : 2.690730
Train average accuracy drums     : 50.585003 %
Train average accuracy bass      : 49.720001 %
Train average accuracy piano     : 49.669998 %
Train average accuracy guitar    : 49.855000 %
Train average accuracy residuals : 49.375000 %

== Train average loss all : 0.024537

Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00501, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.000165, Train/loss_recog_step=2.520, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]          Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00501, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.000165, Train/loss_recog_step=2.520, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58:  16%|█▌        | 50/313 [00:55<04:52,  0.90it/s, v_num=0, Train/loss_all_step=0.00501, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.000165, Train/loss_recog_step=2.520, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58:  16%|█▌        | 50/313 [00:55<04:52,  0.90it/s, v_num=0, Train/loss_all_step=0.0317, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.0266, Train/loss_recog_step=2.300, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]   Epoch 58:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0317, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.0266, Train/loss_recog_step=2.300, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=2.280, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.0188, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=2.280, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=2.540, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58:  64%|██████▍   | 200/313 [03:18<01:52,  1.01it/s, v_num=0, Train/loss_all_step=0.0215, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=2.540, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58:  64%|██████▍   | 200/313 [03:18<01:52,  1.01it/s, v_num=0, Train/loss_all_step=0.0175, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=2.740, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58:  80%|███████▉  | 250/313 [04:06<01:02,  1.02it/s, v_num=0, Train/loss_all_step=0.0175, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=2.740, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58:  80%|███████▉  | 250/313 [04:06<01:02,  1.02it/s, v_num=0, Train/loss_all_step=0.0343, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.0298, Train/loss_recog_step=2.560, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0343, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.0298, Train/loss_recog_step=2.560, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0308, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.0261, Train/loss_recog_step=2.980, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0308, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.0261, Train/loss_recog_step=2.980, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.000985, Train/loss_recog_step=2.580, Valid/loss_all_step=0.150, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.145, Valid/loss_recog_step=3.040, Valid/loss_all_epoch=0.254, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.248, Valid/loss_recog_epoch=2.670, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.66it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.68it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.39it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.40it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.130701, 0.131023, 0.124399, 0.147618
Valid average loss UNet                 (all)                : 0.533741

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.233548, 1.289684, 2.192191
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.345723, 0.936413, 1.052993
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.392112, 1.348566, 1.540836
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.262512, 1.083616, 1.580894
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.280741, 1.273728, 1.752324
Valid average loss all      (Triplet)                 : 0.302409

== Recognize ==
Valid average loss Recognize     : 2.680273
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.307746

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.041630268096924 sec. =
Valid knn accuracy drums     : 63.04347826086957%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.00694727897644 sec. =
Valid knn accuracy bass      : 13.508064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.44118356704712 sec. =
Valid knn accuracy piano     : 27.5390625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.037391662597656 sec. =
Valid knn accuracy guitar    : 38.61607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.375934362411499 sec. =
Valid knn accuracy residuals : 45.45454545454545%

Valid knn accuracy average   : 37.6322444320231%

                                                                      [AEpoch 58: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.000985, Train/loss_recog_step=2.580, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0245, Train/loss_unet_all_epoch=0.487, Train/loss_triplet_all_epoch=0.0197, Train/loss_recog_epoch=2.690]Epoch 58: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.000985, Train/loss_recog_step=2.580, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.117663, 0.118318, 0.118980, 0.131491
Train average loss UNet                 (all)                : 0.486452

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010118, 0.857575, 2.662506
Train average loss bass     (Triplet, dist_p, dist_n) : 0.031975, 0.658675, 1.361808
Train average loss piano    (Triplet, dist_p, dist_n) : 0.018621, 0.902814, 1.809637
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.020464, 0.866628, 1.821473
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011365, 1.079980, 2.242695
Train average loss all      (Triplet)                 : 0.018750

== Recognize ==
Train average loss Recognize     : 2.643319
Train average accuracy drums     : 50.059998 %
Train average accuracy bass      : 50.174999 %
Train average accuracy piano     : 49.590000 %
Train average accuracy guitar    : 50.520004 %
Train average accuracy residuals : 50.660004 %

== Train average loss all : 0.023615

Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.000985, Train/loss_recog_step=2.580, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]          Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.000985, Train/loss_recog_step=2.580, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]Epoch 59:  16%|█▌        | 50/313 [00:52<04:35,  0.95it/s, v_num=0, Train/loss_all_step=0.00575, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.000985, Train/loss_recog_step=2.580, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]Epoch 59:  16%|█▌        | 50/313 [00:52<04:35,  0.95it/s, v_num=0, Train/loss_all_step=0.00856, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=2.580, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640] Epoch 59:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.00856, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=2.580, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]Epoch 59:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00653, Train/loss_recog_step=2.520, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640] Epoch 59:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00653, Train/loss_recog_step=2.520, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]Epoch 59:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0131, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00818, Train/loss_recog_step=2.770, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]Epoch 59:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0131, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00818, Train/loss_recog_step=2.770, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]Epoch 59:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0193, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=2.500, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640] Epoch 59:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0193, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=2.500, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]Epoch 59:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.022, Train/loss_unet_all_step=0.456, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=2.590, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640] Epoch 59:  96%|█████████▌| 300/313 [04:48<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.022, Train/loss_unet_all_step=0.456, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=2.590, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]Epoch 59:  96%|█████████▌| 300/313 [04:48<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0325, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.0276, Train/loss_recog_step=2.410, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]Epoch 59: 100%|██████████| 313/313 [04:56<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.0325, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.0276, Train/loss_recog_step=2.410, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]Epoch 59: 100%|██████████| 313/313 [04:56<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=2.480, Valid/loss_all_step=0.232, Valid/loss_unet_all_step=0.541, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=3.200, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.72it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.70it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.12it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.98it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.91it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125947, 0.129509, 0.119156, 0.155779
Valid average loss UNet                 (all)                : 0.530390

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.095849, 1.058913, 2.160392
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.309508, 0.894055, 1.051368
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.378732, 1.388935, 1.470600
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.284475, 1.160145, 1.504203
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.267802, 1.218374, 1.682083
Valid average loss all      (Triplet)                 : 0.264987

== Recognize ==
Valid average loss Recognize     : 2.553850
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.270290

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.338151693344116 sec. =
Valid knn accuracy drums     : 60.43478260869565%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.020228862762451 sec. =
Valid knn accuracy bass      : 16.33064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.887027025222778 sec. =
Valid knn accuracy piano     : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.573945045471191 sec. =
Valid knn accuracy guitar    : 33.482142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.101166248321533 sec. =
Valid knn accuracy residuals : 42.72727272727273%

Valid knn accuracy average   : 35.59496867088031%

                                                                      [AEpoch 59: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=2.480, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0236, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.0188, Train/loss_recog_epoch=2.640]Epoch 59: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=2.480, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.117584, 0.118186, 0.118907, 0.131339
Train average loss UNet                 (all)                : 0.486016

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.009167, 0.862823, 2.654624
Train average loss bass     (Triplet, dist_p, dist_n) : 0.029773, 0.693212, 1.470234
Train average loss piano    (Triplet, dist_p, dist_n) : 0.017794, 0.917559, 1.844854
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.015779, 0.860774, 1.878687
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010857, 1.071018, 2.219029
Train average loss all      (Triplet)                 : 0.017026

== Recognize ==
Train average loss Recognize     : 2.654989
Train average accuracy drums     : 49.665001 %
Train average accuracy bass      : 50.050003 %
Train average accuracy piano     : 50.070000 %
Train average accuracy guitar    : 50.795002 %
Train average accuracy residuals : 50.355000 %

== Train average loss all : 0.021886

Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=2.480, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]          Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=2.480, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]Epoch 60:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.00648, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=2.480, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]Epoch 60:  16%|█▌        | 50/313 [00:51<04:31,  0.97it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=2.760, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]  Epoch 60:  32%|███▏      | 100/313 [01:37<03:27,  1.03it/s, v_num=0, Train/loss_all_step=0.0179, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=2.760, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]Epoch 60:  32%|███▏      | 100/313 [01:37<03:27,  1.03it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.022, Train/loss_recog_step=2.680, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650] Epoch 60:  48%|████▊     | 150/313 [02:25<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.0268, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.022, Train/loss_recog_step=2.680, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]Epoch 60:  48%|████▊     | 150/313 [02:25<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.0374, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=2.730, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]Epoch 60:  64%|██████▍   | 200/313 [03:12<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.0374, Train/loss_unet_all_step=0.533, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=2.730, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]Epoch 60:  64%|██████▍   | 200/313 [03:12<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=2.730, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650] Epoch 60:  80%|███████▉  | 250/313 [03:59<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0309, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=2.730, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]Epoch 60:  80%|███████▉  | 250/313 [03:59<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0261, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=2.660, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]Epoch 60:  96%|█████████▌| 300/313 [04:44<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.0261, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=2.660, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]Epoch 60:  96%|█████████▌| 300/313 [04:44<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.0241, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=2.920, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]Epoch 60: 100%|██████████| 313/313 [04:53<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.0241, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=2.920, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]Epoch 60: 100%|██████████| 313/313 [04:53<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=2.320, Valid/loss_all_step=0.0718, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.0667, Valid/loss_recog_step=2.640, Valid/loss_all_epoch=0.270, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=2.550, Valid/knn_avr=0.356, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.68it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.08it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.94it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.12it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  3.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.128351, 0.129727, 0.121906, 0.141619
Valid average loss UNet                 (all)                : 0.521602

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.140770, 1.252758, 2.286657
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.293093, 0.960872, 1.113049
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.371638, 1.459821, 1.444617
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.245238, 1.076410, 1.547433
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.274139, 1.346432, 1.941961
Valid average loss all      (Triplet)                 : 0.271976

== Recognize ==
Valid average loss Recognize     : 2.617692
Valid average accuracy drums     : 47.000000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.277192

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.953243970870972 sec. =
Valid knn accuracy drums     : 52.17391304347826%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.995392560958862 sec. =
Valid knn accuracy bass      : 18.14516129032258%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.084796905517578 sec. =
Valid knn accuracy piano     : 24.8046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.94452977180481 sec. =
Valid knn accuracy guitar    : 41.294642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.6981329917907715 sec. =
Valid knn accuracy residuals : 50.0%

Valid knn accuracy average   : 37.28368093818874%

                                                                      [AEpoch 60: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=2.320, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0219, Train/loss_unet_all_epoch=0.486, Train/loss_triplet_all_epoch=0.017, Train/loss_recog_epoch=2.650]  Epoch 60: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=2.320, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.117494, 0.118099, 0.118777, 0.131017
Train average loss UNet                 (all)                : 0.485387

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.009692, 0.909123, 2.799893
Train average loss bass     (Triplet, dist_p, dist_n) : 0.027824, 0.723869, 1.518044
Train average loss piano    (Triplet, dist_p, dist_n) : 0.016119, 0.922610, 1.857014
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.018604, 0.888935, 1.906532
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011927, 1.094410, 2.265548
Train average loss all      (Triplet)                 : 0.016666

== Recognize ==
Train average loss Recognize     : 2.678175
Train average accuracy drums     : 50.010002 %
Train average accuracy bass      : 49.955002 %
Train average accuracy piano     : 50.050003 %
Train average accuracy guitar    : 50.360001 %
Train average accuracy residuals : 49.935001 %

== Train average loss all : 0.021520

Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=2.320, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]          Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=2.320, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61:  16%|█▌        | 50/313 [00:56<04:58,  0.88it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=2.320, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61:  16%|█▌        | 50/313 [00:56<04:58,  0.88it/s, v_num=0, Train/loss_all_step=0.0214, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=2.690, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61:  32%|███▏      | 100/313 [01:45<03:44,  0.95it/s, v_num=0, Train/loss_all_step=0.0214, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=2.690, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61:  32%|███▏      | 100/313 [01:45<03:44,  0.95it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.00563, Train/loss_recog_step=2.590, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.00563, Train/loss_recog_step=2.590, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.0317, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0266, Train/loss_recog_step=2.800, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680] Epoch 61:  64%|██████▍   | 200/313 [03:22<01:54,  0.99it/s, v_num=0, Train/loss_all_step=0.0317, Train/loss_unet_all_step=0.509, Train/loss_triplet_all_step=0.0266, Train/loss_recog_step=2.800, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61:  64%|██████▍   | 200/313 [03:22<01:54,  0.99it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0084, Train/loss_recog_step=2.590, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0084, Train/loss_recog_step=2.590, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.00629, Train/loss_recog_step=2.790, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61:  96%|█████████▌| 300/313 [04:56<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.00629, Train/loss_recog_step=2.790, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61:  96%|█████████▌| 300/313 [04:56<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=2.870, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=2.870, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00537, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.000515, Train/loss_recog_step=2.580, Valid/loss_all_step=0.108, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.103, Valid/loss_recog_step=2.330, Valid/loss_all_epoch=0.277, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.272, Valid/loss_recog_epoch=2.620, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.57it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.10it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.79it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.54it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.36it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.130896, 0.131268, 0.124776, 0.146657
Valid average loss UNet                 (all)                : 0.533596

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.120683, 1.376730, 2.811807
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.330704, 1.032546, 1.161891
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.622718, 1.656202, 1.484474
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.206976, 0.952352, 1.561199
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.274765, 1.486486, 2.087055
Valid average loss all      (Triplet)                 : 0.338065

== Recognize ==
Valid average loss Recognize     : 2.656834
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 57.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.343401

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.846208333969116 sec. =
Valid knn accuracy drums     : 56.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.867750406265259 sec. =
Valid knn accuracy bass      : 15.725806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.278159856796265 sec. =
Valid knn accuracy piano     : 26.171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.49852705001831 sec. =
Valid knn accuracy guitar    : 33.705357142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.878565311431885 sec. =
Valid knn accuracy residuals : 40.22727272727273%

Valid knn accuracy average   : 34.47041009043551%

                                                                      [AEpoch 61: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00537, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.000515, Train/loss_recog_step=2.580, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0215, Train/loss_unet_all_epoch=0.485, Train/loss_triplet_all_epoch=0.0167, Train/loss_recog_epoch=2.680]Epoch 61: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00537, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.000515, Train/loss_recog_step=2.580, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.117380, 0.118024, 0.118690, 0.130170
Train average loss UNet                 (all)                : 0.484264

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.009014, 0.935483, 2.917061
Train average loss bass     (Triplet, dist_p, dist_n) : 0.026414, 0.706213, 1.492384
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013633, 0.919340, 1.859254
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.014882, 0.873316, 1.915734
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008432, 1.104384, 2.315979
Train average loss all      (Triplet)                 : 0.014817

== Recognize ==
Train average loss Recognize     : 2.754092
Train average accuracy drums     : 49.834999 %
Train average accuracy bass      : 49.810001 %
Train average accuracy piano     : 50.040001 %
Train average accuracy guitar    : 50.940002 %
Train average accuracy residuals : 49.254997 %

== Train average loss all : 0.019660

Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00537, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.000515, Train/loss_recog_step=2.580, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]          Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00537, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.000515, Train/loss_recog_step=2.580, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]Epoch 62:  16%|█▌        | 50/313 [00:53<04:41,  0.93it/s, v_num=0, Train/loss_all_step=0.00537, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.000515, Train/loss_recog_step=2.580, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]Epoch 62:  16%|█▌        | 50/313 [00:53<04:41,  0.93it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=3.020, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]   Epoch 62:  32%|███▏      | 100/313 [01:40<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=3.020, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]Epoch 62:  32%|███▏      | 100/313 [01:40<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=2.700, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]Epoch 62:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=2.700, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]Epoch 62:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.0305, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=3.060, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]Epoch 62:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0305, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=3.060, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]Epoch 62:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.00852, Train/loss_recog_step=2.890, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]Epoch 62:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.00852, Train/loss_recog_step=2.890, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]Epoch 62:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.00691, Train/loss_recog_step=2.660, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]Epoch 62:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.00691, Train/loss_recog_step=2.660, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]Epoch 62:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0278, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.0231, Train/loss_recog_step=2.870, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750] Epoch 62: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0278, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.0231, Train/loss_recog_step=2.870, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]Epoch 62: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=2.610, Valid/loss_all_step=0.305, Valid/loss_unet_all_step=0.534, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=2.380, Valid/loss_all_epoch=0.343, Valid/loss_unet_all_epoch=0.534, Valid/loss_triplet_all_epoch=0.338, Valid/loss_recog_epoch=2.660, Valid/knn_avr=0.345, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.69it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.69it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.47it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.17it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.85it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127532, 0.129841, 0.121268, 0.143082
Valid average loss UNet                 (all)                : 0.521725

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.151542, 1.224668, 2.474373
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.343870, 1.063890, 1.225583
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.470514, 1.551288, 1.541666
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.207421, 0.939204, 1.460194
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.242309, 1.464706, 2.263825
Valid average loss all      (Triplet)                 : 0.300044

== Recognize ==
Valid average loss Recognize     : 2.894937
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.305261

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4382264614105225 sec. =
Valid knn accuracy drums     : 69.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.699574947357178 sec. =
Valid knn accuracy bass      : 17.741935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.717177629470825 sec. =
Valid knn accuracy piano     : 25.9765625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.422812223434448 sec. =
Valid knn accuracy guitar    : 37.05357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.310000896453857 sec. =
Valid knn accuracy residuals : 50.45454545454545%

Valid knn accuracy average   : 40.201844712528%

                                                                      [AEpoch 62: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=2.610, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0197, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0148, Train/loss_recog_epoch=2.750]Epoch 62: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=2.610, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.117201, 0.117865, 0.118567, 0.129975
Train average loss UNet                 (all)                : 0.483609

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.011028, 0.968632, 2.883481
Train average loss bass     (Triplet, dist_p, dist_n) : 0.024642, 0.748497, 1.591612
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013729, 0.947532, 1.939361
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.018722, 0.907052, 1.951464
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010232, 1.153477, 2.406424
Train average loss all      (Triplet)                 : 0.015689

== Recognize ==
Train average loss Recognize     : 2.800736
Train average accuracy drums     : 49.514999 %
Train average accuracy bass      : 50.564999 %
Train average accuracy piano     : 50.120003 %
Train average accuracy guitar    : 49.785000 %
Train average accuracy residuals : 49.794998 %

== Train average loss all : 0.020525

Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=2.610, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]          Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=2.610, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63:  16%|█▌        | 50/313 [00:54<04:45,  0.92it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=2.610, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63:  16%|█▌        | 50/313 [00:54<04:45,  0.92it/s, v_num=0, Train/loss_all_step=0.0237, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=2.980, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0237, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=2.980, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.00936, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.00465, Train/loss_recog_step=2.790, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.00936, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.00465, Train/loss_recog_step=2.790, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.00933, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.00436, Train/loss_recog_step=2.840, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.00933, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.00436, Train/loss_recog_step=2.840, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=2.750, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]  Epoch 63:  80%|███████▉  | 250/313 [04:03<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=2.750, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63:  80%|███████▉  | 250/313 [04:03<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.0147, Train/loss_recog_step=3.040, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0192, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.0147, Train/loss_recog_step=3.040, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00473, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.700, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00473, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.700, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00583, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=3.220, Valid/loss_all_step=0.220, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=2.800, Valid/loss_all_epoch=0.305, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.300, Valid/loss_recog_epoch=2.890, Valid/knn_avr=0.402, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.74it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.71it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.22it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.30it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.78it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.128651, 0.130947, 0.122182, 0.144468
Valid average loss UNet                 (all)                : 0.526247

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.106441, 1.259189, 2.626872
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.326559, 0.996645, 1.140291
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.440554, 1.582466, 1.660785
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.205616, 1.091730, 1.699707
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.273840, 1.351815, 1.980071
Valid average loss all      (Triplet)                 : 0.276062

== Recognize ==
Valid average loss Recognize     : 2.721367
Valid average accuracy drums     : 55.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.281324

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.642759799957275 sec. =
Valid knn accuracy drums     : 69.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.250429153442383 sec. =
Valid knn accuracy bass      : 22.58064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.105237245559692 sec. =
Valid knn accuracy piano     : 20.5078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.547452688217163 sec. =
Valid knn accuracy guitar    : 39.732142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.474905490875244 sec. =
Valid knn accuracy residuals : 46.36363636363636%

Valid knn accuracy average   : 39.70641259380521%

                                                                      [AEpoch 63: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00583, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=3.220, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0205, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0157, Train/loss_recog_epoch=2.800]Epoch 63: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00583, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=3.220, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.117165, 0.117803, 0.118501, 0.129707
Train average loss UNet                 (all)                : 0.483176

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007124, 0.919370, 2.826951
Train average loss bass     (Triplet, dist_p, dist_n) : 0.022041, 0.734922, 1.583932
Train average loss piano    (Triplet, dist_p, dist_n) : 0.014403, 0.946821, 1.937937
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.014628, 0.872282, 1.901127
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009379, 1.099416, 2.304085
Train average loss all      (Triplet)                 : 0.013690

== Recognize ==
Train average loss Recognize     : 2.808643
Train average accuracy drums     : 50.685001 %
Train average accuracy bass      : 50.000000 %
Train average accuracy piano     : 50.620003 %
Train average accuracy guitar    : 49.860001 %
Train average accuracy residuals : 49.184998 %

== Train average loss all : 0.018522

Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00583, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=3.220, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]          Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00583, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=3.220, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]Epoch 64:  16%|█▌        | 50/313 [00:54<04:48,  0.91it/s, v_num=0, Train/loss_all_step=0.00583, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=3.220, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]Epoch 64:  16%|█▌        | 50/313 [00:54<04:48,  0.91it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.0198, Train/loss_recog_step=2.860, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]  Epoch 64:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.0248, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.0198, Train/loss_recog_step=2.860, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]Epoch 64:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=2.630, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]Epoch 64:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=2.630, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]Epoch 64:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0177, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=2.790, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]Epoch 64:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0177, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=2.790, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]Epoch 64:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.00631, Train/loss_recog_step=3.000, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]Epoch 64:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.00631, Train/loss_recog_step=3.000, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]Epoch 64:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0226, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=2.750, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810] Epoch 64:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0226, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=2.750, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]Epoch 64:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0219, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=2.860, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]Epoch 64: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0219, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=2.860, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]Epoch 64: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.040, Valid/loss_all_step=0.129, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.124, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.281, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.276, Valid/loss_recog_epoch=2.720, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.57it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.58it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.85it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.97it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.42it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126449, 0.129684, 0.120643, 0.142731
Valid average loss UNet                 (all)                : 0.519507

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101468, 1.135281, 2.507811
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.412908, 1.030694, 1.082044
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.457087, 1.507582, 1.546213
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.226160, 0.950852, 1.460563
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.286299, 1.412661, 1.909477
Valid average loss all      (Triplet)                 : 0.283252

== Recognize ==
Valid average loss Recognize     : 2.879949
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.288447

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.305554389953613 sec. =
Valid knn accuracy drums     : 66.95652173913044%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.049625158309937 sec. =
Valid knn accuracy bass      : 15.725806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.809857368469238 sec. =
Valid knn accuracy piano     : 26.7578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.335171699523926 sec. =
Valid knn accuracy guitar    : 32.36607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.410999298095703 sec. =
Valid knn accuracy residuals : 45.909090909090914%

Valid knn accuracy average   : 37.54306060568114%

                                                                      [AEpoch 64: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.040, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0185, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0137, Train/loss_recog_epoch=2.810]Epoch 64: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.040, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.117107, 0.117769, 0.118439, 0.130083
Train average loss UNet                 (all)                : 0.483397

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006230, 0.985187, 3.100301
Train average loss bass     (Triplet, dist_p, dist_n) : 0.019569, 0.793524, 1.711934
Train average loss piano    (Triplet, dist_p, dist_n) : 0.015147, 0.979481, 1.999558
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.013937, 0.910751, 2.003652
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007630, 1.143955, 2.414476
Train average loss all      (Triplet)                 : 0.012575

== Recognize ==
Train average loss Recognize     : 2.820842
Train average accuracy drums     : 49.535000 %
Train average accuracy bass      : 50.484997 %
Train average accuracy piano     : 49.744999 %
Train average accuracy guitar    : 50.089996 %
Train average accuracy residuals : 50.389999 %

== Train average loss all : 0.017409

Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.040, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]          Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.040, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]Epoch 65:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.040, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]Epoch 65:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.00781, Train/loss_recog_step=2.870, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]Epoch 65:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.00781, Train/loss_recog_step=2.870, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]Epoch 65:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=2.580, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820] Epoch 65:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=2.580, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]Epoch 65:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0256, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=2.990, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]Epoch 65:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0256, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=2.990, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]Epoch 65:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.00839, Train/loss_recog_step=2.620, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]Epoch 65:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.00839, Train/loss_recog_step=2.620, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]Epoch 65:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.00918, Train/loss_recog_step=2.890, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]Epoch 65:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.00918, Train/loss_recog_step=2.890, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]Epoch 65:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00482, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.000118, Train/loss_recog_step=2.990, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]Epoch 65: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00482, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.000118, Train/loss_recog_step=2.990, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]Epoch 65: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=2.720, Valid/loss_all_step=0.0826, Valid/loss_unet_all_step=0.495, Valid/loss_triplet_all_step=0.0777, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.288, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=2.880, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.60it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.34it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.71it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.94it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125575, 0.128482, 0.118720, 0.148980
Valid average loss UNet                 (all)                : 0.521758

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080127, 1.189273, 2.352938
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.386464, 1.040653, 1.031712
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.487980, 1.604503, 1.614572
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.251845, 1.086573, 1.583069
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.284371, 1.498751, 1.856361
Valid average loss all      (Triplet)                 : 0.302569

== Recognize ==
Valid average loss Recognize     : 2.684074
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 54.000004 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.307786

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.655685901641846 sec. =
Valid knn accuracy drums     : 72.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.020901441574097 sec. =
Valid knn accuracy bass      : 11.693548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.596800088882446 sec. =
Valid knn accuracy piano     : 29.4921875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7676331996917725 sec. =
Valid knn accuracy guitar    : 32.8125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.06926441192627 sec. =
Valid knn accuracy residuals : 41.36363636363637%

Valid knn accuracy average   : 37.594113580581414%

                                                                      [AEpoch 65: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=2.720, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0174, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.0126, Train/loss_recog_epoch=2.820]  Epoch 65: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=2.720, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.117037, 0.117616, 0.118371, 0.129578
Train average loss UNet                 (all)                : 0.482602

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007331, 0.963663, 3.059953
Train average loss bass     (Triplet, dist_p, dist_n) : 0.022155, 0.789706, 1.687053
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013546, 0.976754, 1.982174
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.013880, 0.904520, 1.990201
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007607, 1.122379, 2.382812
Train average loss all      (Triplet)                 : 0.013036

== Recognize ==
Train average loss Recognize     : 2.849527
Train average accuracy drums     : 50.209999 %
Train average accuracy bass      : 50.050003 %
Train average accuracy piano     : 49.700001 %
Train average accuracy guitar    : 49.889999 %
Train average accuracy residuals : 49.595001 %

== Train average loss all : 0.017862

Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=2.720, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]          Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=2.720, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]Epoch 66:  16%|█▌        | 50/313 [00:53<04:41,  0.93it/s, v_num=0, Train/loss_all_step=0.0223, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=2.720, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]Epoch 66:  16%|█▌        | 50/313 [00:53<04:41,  0.93it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.00872, Train/loss_recog_step=2.710, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]Epoch 66:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.519, Train/loss_triplet_all_step=0.00872, Train/loss_recog_step=2.710, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]Epoch 66:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=2.490, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850] Epoch 66:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=2.490, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]Epoch 66:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=2.840, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]Epoch 66:  64%|██████▍   | 200/313 [03:18<01:52,  1.01it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=2.840, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]Epoch 66:  64%|██████▍   | 200/313 [03:18<01:52,  1.01it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00845, Train/loss_recog_step=2.680, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]Epoch 66:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00845, Train/loss_recog_step=2.680, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]Epoch 66:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=2.800, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850] Epoch 66:  96%|█████████▌| 300/313 [04:54<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=2.800, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]Epoch 66:  96%|█████████▌| 300/313 [04:54<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0201, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.0155, Train/loss_recog_step=3.170, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]Epoch 66: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0201, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.0155, Train/loss_recog_step=3.170, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]Epoch 66: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=2.850, Valid/loss_all_step=0.160, Valid/loss_unet_all_step=0.515, Valid/loss_triplet_all_step=0.155, Valid/loss_recog_step=2.420, Valid/loss_all_epoch=0.308, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.303, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.40it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.94it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.06it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.128872, 0.130504, 0.121775, 0.148945
Valid average loss UNet                 (all)                : 0.530096

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.089475, 1.087464, 2.297790
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.358095, 1.006654, 1.092492
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.617347, 1.621639, 1.525436
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.302988, 1.145208, 1.606998
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.342122, 1.623407, 2.113863
Valid average loss all      (Triplet)                 : 0.367977

== Recognize ==
Valid average loss Recognize     : 3.025459
Valid average accuracy drums     : 42.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.373278

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.264854431152344 sec. =
Valid knn accuracy drums     : 66.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.098076343536377 sec. =
Valid knn accuracy bass      : 17.338709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.671905755996704 sec. =
Valid knn accuracy piano     : 23.6328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.509721517562866 sec. =
Valid knn accuracy guitar    : 35.714285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.067548036575317 sec. =
Valid knn accuracy residuals : 45.45454545454545%

Valid knn accuracy average   : 37.77589675620663%

                                                                      [AEpoch 66: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=2.850, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0179, Train/loss_unet_all_epoch=0.483, Train/loss_triplet_all_epoch=0.013, Train/loss_recog_epoch=2.850]Epoch 66: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=2.850, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.117091, 0.117722, 0.118359, 0.130519
Train average loss UNet                 (all)                : 0.483691

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007830, 1.013535, 3.100026
Train average loss bass     (Triplet, dist_p, dist_n) : 0.020187, 0.790140, 1.697844
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010952, 0.991554, 2.042467
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.015329, 0.972333, 2.087599
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008550, 1.155995, 2.421504
Train average loss all      (Triplet)                 : 0.012464

== Recognize ==
Train average loss Recognize     : 2.826832
Train average accuracy drums     : 50.070000 %
Train average accuracy bass      : 49.614998 %
Train average accuracy piano     : 50.059998 %
Train average accuracy guitar    : 50.520004 %
Train average accuracy residuals : 50.419998 %

== Train average loss all : 0.017301

Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=2.850, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]          Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=2.850, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]Epoch 67:  16%|█▌        | 50/313 [00:54<04:47,  0.91it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=2.850, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]Epoch 67:  16%|█▌        | 50/313 [00:54<04:47,  0.91it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.00577, Train/loss_recog_step=2.920, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830] Epoch 67:  32%|███▏      | 100/313 [01:43<03:41,  0.96it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.00577, Train/loss_recog_step=2.920, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]Epoch 67:  32%|███▏      | 100/313 [01:43<03:41,  0.96it/s, v_num=0, Train/loss_all_step=0.0185, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=3.080, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830] Epoch 67:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.0185, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=3.080, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]Epoch 67:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.0291, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.024, Train/loss_recog_step=2.730, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830] Epoch 67:  64%|██████▍   | 200/313 [03:20<01:53,  1.00it/s, v_num=0, Train/loss_all_step=0.0291, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.024, Train/loss_recog_step=2.730, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]Epoch 67:  64%|██████▍   | 200/313 [03:20<01:53,  1.00it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=3.010, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]Epoch 67:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0061, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=3.010, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]Epoch 67:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.790, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]  Epoch 67:  96%|█████████▌| 300/313 [04:55<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.790, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]Epoch 67:  96%|█████████▌| 300/313 [04:55<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=2.850, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]Epoch 67: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0164, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=2.850, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]Epoch 67: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.00995, Train/loss_recog_step=3.120, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.528, Valid/loss_triplet_all_step=0.388, Valid/loss_recog_step=3.240, Valid/loss_all_epoch=0.373, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.64it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.17it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.19it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.84it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126311, 0.128640, 0.118603, 0.136672
Valid average loss UNet                 (all)                : 0.510227

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.289944, 1.334424, 2.369517
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.337673, 0.958690, 1.068947
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.506488, 1.478827, 1.588604
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.250427, 1.175419, 1.662614
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.305557, 1.556390, 1.965134
Valid average loss all      (Triplet)                 : 0.335789

== Recognize ==
Valid average loss Recognize     : 2.933970
Valid average accuracy drums     : 45.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.340892

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.099448680877686 sec. =
Valid knn accuracy drums     : 71.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.201032638549805 sec. =
Valid knn accuracy bass      : 9.475806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.419249534606934 sec. =
Valid knn accuracy piano     : 21.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.388550758361816 sec. =
Valid knn accuracy guitar    : 38.61607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.489176511764526 sec. =
Valid knn accuracy residuals : 42.04545454545455%

Valid knn accuracy average   : 36.70681431121473%

                                                                      [AEpoch 67: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.00995, Train/loss_recog_step=3.120, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0173, Train/loss_unet_all_epoch=0.484, Train/loss_triplet_all_epoch=0.0125, Train/loss_recog_epoch=2.830]Epoch 67: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.00995, Train/loss_recog_step=3.120, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.116875, 0.117505, 0.118179, 0.129564
Train average loss UNet                 (all)                : 0.482123

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008263, 1.033316, 3.258121
Train average loss bass     (Triplet, dist_p, dist_n) : 0.019545, 0.792039, 1.710916
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012917, 1.004059, 2.039275
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012451, 0.969879, 2.122036
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006785, 1.193655, 2.500402
Train average loss all      (Triplet)                 : 0.011997

== Recognize ==
Train average loss Recognize     : 2.855814
Train average accuracy drums     : 50.005001 %
Train average accuracy bass      : 49.779999 %
Train average accuracy piano     : 50.445004 %
Train average accuracy guitar    : 49.325001 %
Train average accuracy residuals : 49.910000 %

== Train average loss all : 0.016818

Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.00995, Train/loss_recog_step=3.120, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]          Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.00995, Train/loss_recog_step=3.120, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]Epoch 68:  16%|█▌        | 50/313 [00:55<04:51,  0.90it/s, v_num=0, Train/loss_all_step=0.0147, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.00995, Train/loss_recog_step=3.120, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]Epoch 68:  16%|█▌        | 50/313 [00:55<04:51,  0.90it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=2.760, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]  Epoch 68:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.025, Train/loss_unet_all_step=0.512, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=2.760, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]Epoch 68:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=2.830, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]Epoch 68:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=2.830, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]Epoch 68:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0185, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=2.800, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]Epoch 68:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0185, Train/loss_unet_all_step=0.506, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=2.800, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]Epoch 68:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.00603, Train/loss_recog_step=2.760, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]Epoch 68:  80%|███████▉  | 250/313 [04:06<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.00603, Train/loss_recog_step=2.760, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]Epoch 68:  80%|███████▉  | 250/313 [04:06<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=2.970, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860] Epoch 68:  96%|█████████▌| 300/313 [04:54<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=2.970, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]Epoch 68:  96%|█████████▌| 300/313 [04:54<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.00714, Train/loss_recog_step=2.950, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]Epoch 68: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0118, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.00714, Train/loss_recog_step=2.950, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]Epoch 68: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00606, Train/loss_recog_step=2.970, Valid/loss_all_step=0.311, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=2.850, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=2.930, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.66it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.46it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.22it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.74it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.129075, 0.131179, 0.121095, 0.141776
Valid average loss UNet                 (all)                : 0.523126

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113596, 1.007780, 2.606548
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.361134, 1.052043, 1.063096
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.507744, 1.602206, 1.669140
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.216597, 1.019441, 1.648134
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.311082, 1.516233, 1.967549
Valid average loss all      (Triplet)                 : 0.319867

== Recognize ==
Valid average loss Recognize     : 3.021522
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 42.000000 %
Valid average accuracy guitar    : 48.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.325098

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.355705976486206 sec. =
Valid knn accuracy drums     : 68.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.9462730884552 sec. =
Valid knn accuracy bass      : 12.903225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.471243143081665 sec. =
Valid knn accuracy piano     : 24.609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.451558589935303 sec. =
Valid knn accuracy guitar    : 37.94642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.079591274261475 sec. =
Valid knn accuracy residuals : 44.54545454545455%

Valid knn accuracy average   : 37.740027219449544%

                                                                      [AEpoch 68: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00606, Train/loss_recog_step=2.970, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0168, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.012, Train/loss_recog_epoch=2.860]Epoch 68: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00606, Train/loss_recog_step=2.970, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.116873, 0.117474, 0.118174, 0.129801
Train average loss UNet                 (all)                : 0.482322

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006501, 1.009485, 3.101497
Train average loss bass     (Triplet, dist_p, dist_n) : 0.017490, 0.790213, 1.728467
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011348, 1.011731, 2.067050
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012958, 0.974004, 2.147657
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007977, 1.238084, 2.607186
Train average loss all      (Triplet)                 : 0.011417

== Recognize ==
Train average loss Recognize     : 2.883953
Train average accuracy drums     : 50.349998 %
Train average accuracy bass      : 50.010002 %
Train average accuracy piano     : 49.070000 %
Train average accuracy guitar    : 50.255001 %
Train average accuracy residuals : 49.994999 %

== Train average loss all : 0.016240

Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00606, Train/loss_recog_step=2.970, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]          Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00606, Train/loss_recog_step=2.970, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00606, Train/loss_recog_step=2.970, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=2.800, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880] Epoch 69:  32%|███▏      | 100/313 [01:40<03:34,  1.00it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=2.800, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69:  32%|███▏      | 100/313 [01:40<03:34,  1.00it/s, v_num=0, Train/loss_all_step=0.0073, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.0024, Train/loss_recog_step=2.650, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0073, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.0024, Train/loss_recog_step=2.650, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0332, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.0282, Train/loss_recog_step=2.760, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0332, Train/loss_unet_all_step=0.504, Train/loss_triplet_all_step=0.0282, Train/loss_recog_step=2.760, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0175, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=3.080, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0175, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=3.080, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0296, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=3.040, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0296, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=3.040, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=2.920, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=2.920, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0048, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.760, Valid/loss_all_step=0.245, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.240, Valid/loss_recog_step=2.900, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.523, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.41it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.36it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.76it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.23it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.09it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.130023, 0.132331, 0.123384, 0.144348
Valid average loss UNet                 (all)                : 0.530086

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101294, 1.227300, 2.627722
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.296624, 0.969930, 1.136369
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.577312, 1.566972, 1.395756
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.263747, 1.059728, 1.573102
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.299553, 1.552876, 1.911390
Valid average loss all      (Triplet)                 : 0.323170

== Recognize ==
Valid average loss Recognize     : 2.852730
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.328471

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.345458745956421 sec. =
Valid knn accuracy drums     : 62.39130434782608%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.50508999824524 sec. =
Valid knn accuracy bass      : 12.701612903225806%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.001538038253784 sec. =
Valid knn accuracy piano     : 22.8515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.334894895553589 sec. =
Valid knn accuracy guitar    : 35.49107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.190425634384155 sec. =
Valid knn accuracy residuals : 40.909090909090914%

Valid knn accuracy average   : 34.86892841774285%

                                                                      [AEpoch 69: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0048, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.760, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.0162, Train/loss_unet_all_epoch=0.482, Train/loss_triplet_all_epoch=0.0114, Train/loss_recog_epoch=2.880]Epoch 69: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0048, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.760, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.116806, 0.117360, 0.118084, 0.129230
Train average loss UNet                 (all)                : 0.481480

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006481, 1.019692, 3.159081
Train average loss bass     (Triplet, dist_p, dist_n) : 0.016112, 0.812534, 1.757882
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009555, 1.006877, 2.047899
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.014195, 0.967976, 2.142796
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008532, 1.221461, 2.569655
Train average loss all      (Triplet)                 : 0.011230

== Recognize ==
Train average loss Recognize     : 2.891892
Train average accuracy drums     : 50.035000 %
Train average accuracy bass      : 49.700001 %
Train average accuracy piano     : 49.910000 %
Train average accuracy guitar    : 50.035000 %
Train average accuracy residuals : 50.199997 %

== Train average loss all : 0.016045

Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0048, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.760, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]          Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0048, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.760, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]Epoch 70:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.0048, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.760, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]Epoch 70:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.501, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=2.740, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]Epoch 70:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0176, Train/loss_unet_all_step=0.501, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=2.740, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]Epoch 70:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.00551, Train/loss_recog_step=2.820, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]Epoch 70:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.00551, Train/loss_recog_step=2.820, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]Epoch 70:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0159, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=2.890, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]  Epoch 70:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.0159, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=2.890, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]Epoch 70:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.00516, Train/loss_recog_step=2.730, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]Epoch 70:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.00516, Train/loss_recog_step=2.730, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]Epoch 70:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.027, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.0224, Train/loss_recog_step=2.540, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890] Epoch 70:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.027, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.0224, Train/loss_recog_step=2.540, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]Epoch 70:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00851, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.00392, Train/loss_recog_step=2.950, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]Epoch 70: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00851, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.00392, Train/loss_recog_step=2.950, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]Epoch 70: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.160, Valid/loss_all_step=0.263, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.258, Valid/loss_recog_step=2.980, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.530, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=2.850, Valid/knn_avr=0.349, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.89it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.98it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.95it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127278, 0.129142, 0.119637, 0.148658
Valid average loss UNet                 (all)                : 0.524714

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.049977, 1.294860, 2.966529
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.283666, 1.023904, 1.230301
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.524635, 1.607178, 1.638842
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.285376, 1.272167, 1.845316
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.302491, 1.470549, 2.030689
Valid average loss all      (Triplet)                 : 0.309323

== Recognize ==
Valid average loss Recognize     : 2.676082
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.314570

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.640588283538818 sec. =
Valid knn accuracy drums     : 61.95652173913043%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.949050664901733 sec. =
Valid knn accuracy bass      : 14.112903225806454%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.361213684082031 sec. =
Valid knn accuracy piano     : 26.7578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.865797519683838 sec. =
Valid knn accuracy guitar    : 40.17857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.14520263671875 sec. =
Valid knn accuracy residuals : 43.63636363636363%

Valid knn accuracy average   : 37.32843450597439%

                                                                      [AEpoch 70: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.160, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.016, Train/loss_unet_all_epoch=0.481, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=2.890]Epoch 70: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.160, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.116709, 0.117323, 0.118052, 0.128119
Train average loss UNet                 (all)                : 0.480203

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006701, 1.081248, 3.346118
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013448, 0.829302, 1.821285
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009914, 1.028566, 2.141423
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012146, 0.989838, 2.164294
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008383, 1.238696, 2.589460
Train average loss all      (Triplet)                 : 0.010230

== Recognize ==
Train average loss Recognize     : 2.886057
Train average accuracy drums     : 49.035000 %
Train average accuracy bass      : 49.590000 %
Train average accuracy piano     : 50.370003 %
Train average accuracy guitar    : 50.375004 %
Train average accuracy residuals : 49.520000 %

== Train average loss all : 0.015032

Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.160, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]          Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.160, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]Epoch 71:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.160, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]Epoch 71:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.00651, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=2.780, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]Epoch 71:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.00651, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=2.780, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]Epoch 71:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0197, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=3.360, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]   Epoch 71:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0197, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=3.360, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]Epoch 71:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0234, Train/loss_unet_all_step=0.505, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=2.850, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]Epoch 71:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0234, Train/loss_unet_all_step=0.505, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=2.850, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]Epoch 71:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0325, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.0278, Train/loss_recog_step=3.000, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]Epoch 71:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0325, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.0278, Train/loss_recog_step=3.000, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]Epoch 71:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.00217, Train/loss_recog_step=3.270, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]Epoch 71:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00661, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.00217, Train/loss_recog_step=3.270, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]Epoch 71:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.0071, Train/loss_recog_step=3.010, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]  Epoch 71: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0117, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.0071, Train/loss_recog_step=3.010, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]Epoch 71: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.680, Valid/loss_all_step=0.233, Valid/loss_unet_all_step=0.530, Valid/loss_triplet_all_step=0.228, Valid/loss_recog_step=2.190, Valid/loss_all_epoch=0.315, Valid/loss_unet_all_epoch=0.525, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.680, Valid/knn_avr=0.373, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.66it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.65it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.33it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.23it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.22it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126231, 0.127884, 0.118501, 0.147263
Valid average loss UNet                 (all)                : 0.519879

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070799, 1.123071, 3.094576
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.334405, 1.134664, 1.297759
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.601943, 1.696339, 1.671718
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.241805, 1.115558, 1.593828
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.309750, 1.465911, 2.234762
Valid average loss all      (Triplet)                 : 0.308732

== Recognize ==
Valid average loss Recognize     : 2.956597
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.313931

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.206955194473267 sec. =
Valid knn accuracy drums     : 68.26086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.775043487548828 sec. =
Valid knn accuracy bass      : 21.975806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.863956928253174 sec. =
Valid knn accuracy piano     : 24.8046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3711256980896 sec. =
Valid knn accuracy guitar    : 38.169642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2326271533966064 sec. =
Valid knn accuracy residuals : 43.40909090909091%

Valid knn accuracy average   : 39.32401945661281%

                                                                      [AEpoch 71: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.680, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.015, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=2.890]Epoch 71: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.680, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.116460, 0.117099, 0.117796, 0.129029
Train average loss UNet                 (all)                : 0.480384

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004281, 1.053285, 3.305855
Train average loss bass     (Triplet, dist_p, dist_n) : 0.017026, 0.886071, 1.934863
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010520, 1.062413, 2.200706
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010491, 1.005121, 2.203373
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007788, 1.242082, 2.642211
Train average loss all      (Triplet)                 : 0.010282

== Recognize ==
Train average loss Recognize     : 2.920862
Train average accuracy drums     : 50.080002 %
Train average accuracy bass      : 49.990002 %
Train average accuracy piano     : 50.059998 %
Train average accuracy guitar    : 49.974998 %
Train average accuracy residuals : 50.465000 %

== Train average loss all : 0.015086

Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.680, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]          Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.680, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]Epoch 72:  16%|█▌        | 50/313 [00:55<04:52,  0.90it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.680, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]Epoch 72:  16%|█▌        | 50/313 [00:55<04:52,  0.90it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.005, Train/loss_recog_step=2.720, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920] Epoch 72:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.005, Train/loss_recog_step=2.720, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]Epoch 72:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0409, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0361, Train/loss_recog_step=2.990, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]Epoch 72:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0409, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0361, Train/loss_recog_step=2.990, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]Epoch 72:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=2.870, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920] Epoch 72:  64%|██████▍   | 200/313 [03:14<01:50,  1.03it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.510, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=2.870, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]Epoch 72:  64%|██████▍   | 200/313 [03:14<01:50,  1.03it/s, v_num=0, Train/loss_all_step=0.0343, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=3.050, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]Epoch 72:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0343, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=3.050, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]Epoch 72:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0141, Train/loss_unet_all_step=0.431, Train/loss_triplet_all_step=0.00981, Train/loss_recog_step=3.430, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]Epoch 72:  96%|█████████▌| 300/313 [04:47<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0141, Train/loss_unet_all_step=0.431, Train/loss_triplet_all_step=0.00981, Train/loss_recog_step=3.430, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]Epoch 72:  96%|█████████▌| 300/313 [04:47<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00573, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.00112, Train/loss_recog_step=3.150, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]Epoch 72: 100%|██████████| 313/313 [04:56<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.00573, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.00112, Train/loss_recog_step=3.150, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]Epoch 72: 100%|██████████| 313/313 [04:56<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=3.060, Valid/loss_all_step=0.173, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.168, Valid/loss_recog_step=3.110, Valid/loss_all_epoch=0.314, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.309, Valid/loss_recog_epoch=2.960, Valid/knn_avr=0.393, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.77it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.13it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.26it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.19it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.13it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127239, 0.129490, 0.119014, 0.143589
Valid average loss UNet                 (all)                : 0.519331

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.118094, 1.121935, 2.824380
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.247144, 1.054351, 1.293955
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.486896, 1.526526, 1.609503
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.232251, 1.153442, 1.880978
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.295956, 1.514387, 2.226875
Valid average loss all      (Triplet)                 : 0.280287

== Recognize ==
Valid average loss Recognize     : 2.896667
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 56.000000 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.285480

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.339429140090942 sec. =
Valid knn accuracy drums     : 67.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.290093421936035 sec. =
Valid knn accuracy bass      : 16.33064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.125800609588623 sec. =
Valid knn accuracy piano     : 25.1953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.209466218948364 sec. =
Valid knn accuracy guitar    : 38.392857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.571558237075806 sec. =
Valid knn accuracy residuals : 38.18181818181819%

Valid knn accuracy average   : 37.14186572762791%

                                                                      [AEpoch 72: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=3.060, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0151, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0103, Train/loss_recog_epoch=2.920]Epoch 72: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=3.060, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.116474, 0.117083, 0.117762, 0.128433
Train average loss UNet                 (all)                : 0.479751

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006060, 1.067487, 3.323017
Train average loss bass     (Triplet, dist_p, dist_n) : 0.016899, 0.861593, 1.877494
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013424, 1.037574, 2.112976
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011454, 1.004182, 2.215945
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007354, 1.248832, 2.630226
Train average loss all      (Triplet)                 : 0.011104

== Recognize ==
Train average loss Recognize     : 3.028598
Train average accuracy drums     : 50.209999 %
Train average accuracy bass      : 50.505001 %
Train average accuracy piano     : 50.335003 %
Train average accuracy guitar    : 49.595001 %
Train average accuracy residuals : 50.080002 %

== Train average loss all : 0.015901

Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=3.060, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]          Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=3.060, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]Epoch 73:  16%|█▌        | 50/313 [00:55<04:50,  0.90it/s, v_num=0, Train/loss_all_step=0.0119, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=3.060, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]Epoch 73:  16%|█▌        | 50/313 [00:55<04:50,  0.90it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=3.000, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]Epoch 73:  32%|███▏      | 100/313 [01:42<03:38,  0.98it/s, v_num=0, Train/loss_all_step=0.0111, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00618, Train/loss_recog_step=3.000, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]Epoch 73:  32%|███▏      | 100/313 [01:42<03:38,  0.98it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=3.050, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030] Epoch 73:  48%|████▊     | 150/313 [02:31<02:45,  0.99it/s, v_num=0, Train/loss_all_step=0.0165, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=3.050, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]Epoch 73:  48%|████▊     | 150/313 [02:31<02:45,  0.99it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.517, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=2.840, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]Epoch 73:  64%|██████▍   | 200/313 [03:22<01:54,  0.99it/s, v_num=0, Train/loss_all_step=0.0149, Train/loss_unet_all_step=0.517, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=2.840, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]Epoch 73:  64%|██████▍   | 200/313 [03:22<01:54,  0.99it/s, v_num=0, Train/loss_all_step=0.030, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0252, Train/loss_recog_step=3.060, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]  Epoch 73:  80%|███████▉  | 250/313 [04:11<01:03,  0.99it/s, v_num=0, Train/loss_all_step=0.030, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0252, Train/loss_recog_step=3.060, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]Epoch 73:  80%|███████▉  | 250/313 [04:11<01:03,  0.99it/s, v_num=0, Train/loss_all_step=0.00786, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=3.110, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]Epoch 73:  96%|█████████▌| 300/313 [04:59<00:12,  1.00it/s, v_num=0, Train/loss_all_step=0.00786, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=3.110, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]Epoch 73:  96%|█████████▌| 300/313 [04:59<00:12,  1.00it/s, v_num=0, Train/loss_all_step=0.00713, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=2.990, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]Epoch 73: 100%|██████████| 313/313 [05:07<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00713, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=2.990, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]Epoch 73: 100%|██████████| 313/313 [05:07<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00481, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.910, Valid/loss_all_step=0.133, Valid/loss_unet_all_step=0.508, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=2.470, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.280, Valid/loss_recog_epoch=2.900, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.36it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.89it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.39it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125507, 0.128308, 0.118611, 0.149613
Valid average loss UNet                 (all)                : 0.522038

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090315, 1.412179, 2.776211
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.343452, 1.087355, 1.170889
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.529272, 1.666904, 1.670561
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.326972, 1.192042, 1.600770
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.315658, 1.439693, 1.930209
Valid average loss all      (Triplet)                 : 0.313445

== Recognize ==
Valid average loss Recognize     : 3.016699
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.318665

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.362501621246338 sec. =
Valid knn accuracy drums     : 65.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.370854139328003 sec. =
Valid knn accuracy bass      : 15.120967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.13511037826538 sec. =
Valid knn accuracy piano     : 23.046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.44313645362854 sec. =
Valid knn accuracy guitar    : 37.276785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.167125701904297 sec. =
Valid knn accuracy residuals : 41.36363636363637%

Valid knn accuracy average   : 36.361652963971515%

                                                                      [AEpoch 73: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00481, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.910, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0159, Train/loss_unet_all_epoch=0.480, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=3.030]Epoch 73: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00481, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.910, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.116343, 0.116953, 0.117673, 0.128031
Train average loss UNet                 (all)                : 0.479001

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004989, 1.091364, 3.305692
Train average loss bass     (Triplet, dist_p, dist_n) : 0.016098, 0.890618, 1.947792
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010315, 1.057207, 2.149615
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012319, 1.047131, 2.296922
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008065, 1.309711, 2.748269
Train average loss all      (Triplet)                 : 0.010152

== Recognize ==
Train average loss Recognize     : 3.144715
Train average accuracy drums     : 49.704998 %
Train average accuracy bass      : 50.355000 %
Train average accuracy piano     : 49.910000 %
Train average accuracy guitar    : 50.099998 %
Train average accuracy residuals : 50.129997 %

== Train average loss all : 0.014942

Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00481, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.910, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]          Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00481, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.910, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74:  16%|█▌        | 50/313 [00:55<04:51,  0.90it/s, v_num=0, Train/loss_all_step=0.00481, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.910, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74:  16%|█▌        | 50/313 [00:55<04:51,  0.90it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.0222, Train/loss_recog_step=3.190, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74:  32%|███▏      | 100/313 [01:41<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0272, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.0222, Train/loss_recog_step=3.190, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74:  32%|███▏      | 100/313 [01:41<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=3.180, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=3.180, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=3.280, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140] Epoch 74:  64%|██████▍   | 200/313 [03:16<01:51,  1.02it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=3.280, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74:  64%|██████▍   | 200/313 [03:16<01:51,  1.02it/s, v_num=0, Train/loss_all_step=0.00486, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.080, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00486, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.080, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=3.040, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0211, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=3.040, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000134, Train/loss_recog_step=3.580, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000134, Train/loss_recog_step=3.580, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0046, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.090, Valid/loss_all_step=0.152, Valid/loss_unet_all_step=0.505, Valid/loss_triplet_all_step=0.147, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.319, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.313, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]    
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.38it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.09it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.97it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.96it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.124569, 0.127839, 0.117426, 0.137963
Valid average loss UNet                 (all)                : 0.507797

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.298160, 1.394909, 2.709577
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.408218, 1.168078, 1.291359
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.489505, 1.572426, 1.678691
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.267537, 1.147435, 1.768042
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.241458, 1.494150, 2.148739
Valid average loss all      (Triplet)                 : 0.321700

== Recognize ==
Valid average loss Recognize     : 3.460091
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 45.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 45.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.326778

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.452235460281372 sec. =
Valid knn accuracy drums     : 68.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.187290668487549 sec. =
Valid knn accuracy bass      : 15.524193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.461869955062866 sec. =
Valid knn accuracy piano     : 28.3203125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.521104574203491 sec. =
Valid knn accuracy guitar    : 42.63392857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.07142162322998 sec. =
Valid knn accuracy residuals : 44.31818181818182%

Valid knn accuracy average   : 39.94193198325166%

                                                                      [AEpoch 74: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0046, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.090, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0149, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.0102, Train/loss_recog_epoch=3.140]Epoch 74: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0046, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.090, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.116182, 0.116826, 0.117577, 0.127925
Train average loss UNet                 (all)                : 0.478511

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004580, 1.100361, 3.353649
Train average loss bass     (Triplet, dist_p, dist_n) : 0.016322, 0.906877, 1.943590
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009052, 1.059026, 2.173452
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010807, 1.052627, 2.288047
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007138, 1.282843, 2.698634
Train average loss all      (Triplet)                 : 0.009735

== Recognize ==
Train average loss Recognize     : 3.211762
Train average accuracy drums     : 49.924999 %
Train average accuracy bass      : 49.794998 %
Train average accuracy piano     : 50.195004 %
Train average accuracy guitar    : 50.400002 %
Train average accuracy residuals : 50.230003 %

== Train average loss all : 0.014520

Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0046, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.090, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]          Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0046, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.090, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]Epoch 75:  16%|█▌        | 50/313 [00:55<04:54,  0.89it/s, v_num=0, Train/loss_all_step=0.0046, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.090, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]Epoch 75:  16%|█▌        | 50/313 [00:55<04:54,  0.89it/s, v_num=0, Train/loss_all_step=0.023, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=0.018, Train/loss_recog_step=3.090, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210] Epoch 75:  32%|███▏      | 100/313 [01:42<03:38,  0.97it/s, v_num=0, Train/loss_all_step=0.023, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=0.018, Train/loss_recog_step=3.090, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]Epoch 75:  32%|███▏      | 100/313 [01:42<03:38,  0.97it/s, v_num=0, Train/loss_all_step=0.00464, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.210, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]Epoch 75:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.00464, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.210, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]Epoch 75:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.0213, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=3.410, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]Epoch 75:  64%|██████▍   | 200/313 [03:20<01:53,  1.00it/s, v_num=0, Train/loss_all_step=0.0213, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=3.410, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]Epoch 75:  64%|██████▍   | 200/313 [03:20<01:53,  1.00it/s, v_num=0, Train/loss_all_step=0.022, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0172, Train/loss_recog_step=3.230, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210] Epoch 75:  80%|███████▉  | 250/313 [04:08<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.022, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0172, Train/loss_recog_step=3.230, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]Epoch 75:  80%|███████▉  | 250/313 [04:08<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.00873, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.00425, Train/loss_recog_step=3.070, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]Epoch 75:  96%|█████████▌| 300/313 [04:55<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.00873, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.00425, Train/loss_recog_step=3.070, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]Epoch 75:  96%|█████████▌| 300/313 [04:55<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.0358, Train/loss_unet_all_step=0.451, Train/loss_triplet_all_step=0.0313, Train/loss_recog_step=3.430, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]  Epoch 75: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0358, Train/loss_unet_all_step=0.451, Train/loss_triplet_all_step=0.0313, Train/loss_recog_step=3.430, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]Epoch 75: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.400, Valid/loss_all_step=0.278, Valid/loss_unet_all_step=0.478, Valid/loss_triplet_all_step=0.273, Valid/loss_recog_step=3.840, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.399, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.99it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.74it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.36it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.128912, 0.130077, 0.121071, 0.140397
Valid average loss UNet                 (all)                : 0.520455

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.159845, 1.623543, 3.099831
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.420360, 1.223189, 1.320340
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.499760, 1.542224, 1.507627
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.324746, 1.212599, 1.885682
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.255487, 1.263347, 1.829731
Valid average loss all      (Triplet)                 : 0.331418

== Recognize ==
Valid average loss Recognize     : 3.118408
Valid average accuracy drums     : 44.000000 %
Valid average accuracy bass      : 56.000000 %
Valid average accuracy piano     : 45.000000 %
Valid average accuracy guitar    : 43.500000 %
Valid average accuracy residuals : 45.000000 %

== Valid average loss all : 0.336622

= T-SNE...
T-SNE was finished!
= T-SNE time is 66.79810452461243 sec. =
Valid knn accuracy drums     : 64.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.964846849441528 sec. =
Valid knn accuracy bass      : 15.32258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.362144470214844 sec. =
Valid knn accuracy piano     : 24.0234375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3422746658325195 sec. =
Valid knn accuracy guitar    : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.030811548233032 sec. =
Valid knn accuracy residuals : 44.09090909090909%

Valid knn accuracy average   : 38.306950664605374%

                                                                      [AEpoch 75: 100%|██████████| 313/313 [07:19<00:00,  0.71it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.400, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.479, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.210]Epoch 75: 100%|██████████| 313/313 [07:19<00:00,  0.71it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.400, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.116214, 0.116828, 0.117528, 0.127067
Train average loss UNet                 (all)                : 0.477637

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005388, 1.173811, 3.545627
Train average loss bass     (Triplet, dist_p, dist_n) : 0.016299, 0.922276, 1.947774
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008888, 1.086169, 2.216919
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010309, 1.084359, 2.367077
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007226, 1.309603, 2.752704
Train average loss all      (Triplet)                 : 0.009737

== Recognize ==
Train average loss Recognize     : 3.225735
Train average accuracy drums     : 49.770000 %
Train average accuracy bass      : 50.545002 %
Train average accuracy piano     : 49.529999 %
Train average accuracy guitar    : 49.840000 %
Train average accuracy residuals : 50.005001 %

== Train average loss all : 0.014513

Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.400, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]          Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.400, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76:  16%|█▌        | 50/313 [00:54<04:47,  0.91it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.400, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76:  16%|█▌        | 50/313 [00:54<04:47,  0.91it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.00602, Train/loss_recog_step=3.000, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.011, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.00602, Train/loss_recog_step=3.000, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0244, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.0197, Train/loss_recog_step=3.380, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.0244, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.0197, Train/loss_recog_step=3.380, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.00982, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.00474, Train/loss_recog_step=3.020, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.00982, Train/loss_unet_all_step=0.508, Train/loss_triplet_all_step=0.00474, Train/loss_recog_step=3.020, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.00505, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.000263, Train/loss_recog_step=3.410, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.00505, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.000263, Train/loss_recog_step=3.410, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=3.350, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]   Epoch 76:  96%|█████████▌| 300/313 [04:56<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=3.350, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76:  96%|█████████▌| 300/313 [04:56<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.0177, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=3.250, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0177, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=3.250, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.940, Valid/loss_all_step=0.194, Valid/loss_unet_all_step=0.524, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=2.080, Valid/loss_all_epoch=0.337, Valid/loss_unet_all_epoch=0.520, Valid/loss_triplet_all_epoch=0.331, Valid/loss_recog_epoch=3.120, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.81it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.91it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.27it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.129658, 0.130878, 0.121492, 0.144828
Valid average loss UNet                 (all)                : 0.526855

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.119006, 1.539528, 3.146160
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.258341, 1.110310, 1.342216
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.463385, 1.558869, 1.562539
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.311215, 1.292431, 1.937052
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.277191, 1.348131, 1.834152
Valid average loss all      (Triplet)                 : 0.297341

== Recognize ==
Valid average loss Recognize     : 3.256946
Valid average accuracy drums     : 43.500000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.302609

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.715566635131836 sec. =
Valid knn accuracy drums     : 64.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.758510828018188 sec. =
Valid knn accuracy bass      : 17.338709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.213098287582397 sec. =
Valid knn accuracy piano     : 23.2421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.709868669509888 sec. =
Valid knn accuracy guitar    : 37.05357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.105234861373901 sec. =
Valid knn accuracy residuals : 42.95454545454545%

Valid knn accuracy average   : 36.987368029498555%

                                                                      [AEpoch 76: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.940, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0145, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00974, Train/loss_recog_epoch=3.230]Epoch 76: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.940, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.116183, 0.116828, 0.117500, 0.127573
Train average loss UNet                 (all)                : 0.478084

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005114, 1.173780, 3.554719
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013862, 0.938018, 2.024874
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009332, 1.069340, 2.201422
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011302, 1.079177, 2.351129
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007520, 1.278418, 2.672469
Train average loss all      (Triplet)                 : 0.009623

== Recognize ==
Train average loss Recognize     : 3.218173
Train average accuracy drums     : 49.605000 %
Train average accuracy bass      : 50.139999 %
Train average accuracy piano     : 50.344997 %
Train average accuracy guitar    : 50.005001 %
Train average accuracy residuals : 50.160004 %

== Train average loss all : 0.014403

Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.940, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]          Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.940, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]Epoch 77:  16%|█▌        | 50/313 [00:54<04:45,  0.92it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.940, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]Epoch 77:  16%|█▌        | 50/313 [00:54<04:45,  0.92it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=3.290, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]Epoch 77:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=3.290, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]Epoch 77:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.017, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=3.310, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]  Epoch 77:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.017, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=3.310, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]Epoch 77:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.00541, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.000422, Train/loss_recog_step=3.370, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]Epoch 77:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00541, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.000422, Train/loss_recog_step=3.370, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]Epoch 77:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0226, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0177, Train/loss_recog_step=2.870, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]   Epoch 77:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0226, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0177, Train/loss_recog_step=2.870, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]Epoch 77:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.00216, Train/loss_recog_step=3.320, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]Epoch 77:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00665, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.00216, Train/loss_recog_step=3.320, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]Epoch 77:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.456, Train/loss_triplet_all_step=0.00217, Train/loss_recog_step=3.570, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]Epoch 77: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00673, Train/loss_unet_all_step=0.456, Train/loss_triplet_all_step=0.00217, Train/loss_recog_step=3.570, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]Epoch 77: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=3.090, Valid/loss_all_step=0.176, Valid/loss_unet_all_step=0.523, Valid/loss_triplet_all_step=0.171, Valid/loss_recog_step=3.100, Valid/loss_all_epoch=0.303, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.297, Valid/loss_recog_epoch=3.260, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.79it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.56it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.124522, 0.128288, 0.116585, 0.148020
Valid average loss UNet                 (all)                : 0.517415

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.136042, 1.536306, 2.820626
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.356287, 1.148761, 1.196069
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.539082, 1.772445, 1.684690
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.378446, 1.432392, 1.717129
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.315715, 1.703128, 2.165332
Valid average loss all      (Triplet)                 : 0.334204

== Recognize ==
Valid average loss Recognize     : 3.113541
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 51.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.339379

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.7260847091674805 sec. =
Valid knn accuracy drums     : 63.69565217391304%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.932746171951294 sec. =
Valid knn accuracy bass      : 18.346774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.608309030532837 sec. =
Valid knn accuracy piano     : 26.171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.273750305175781 sec. =
Valid knn accuracy guitar    : 37.723214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.800660610198975 sec. =
Valid knn accuracy residuals : 40.45454545454545%

Valid knn accuracy average   : 37.27841222154423%

                                                                      [AEpoch 77: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=3.090, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0144, Train/loss_unet_all_epoch=0.478, Train/loss_triplet_all_epoch=0.00962, Train/loss_recog_epoch=3.220]Epoch 77: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=3.090, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115998, 0.116577, 0.117359, 0.127047
Train average loss UNet                 (all)                : 0.476980

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005144, 1.180650, 3.545637
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014029, 0.930525, 1.998646
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006977, 1.063951, 2.215492
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011393, 1.085598, 2.386777
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005247, 1.266088, 2.671854
Train average loss all      (Triplet)                 : 0.008550

== Recognize ==
Train average loss Recognize     : 3.255237
Train average accuracy drums     : 49.649998 %
Train average accuracy bass      : 49.785000 %
Train average accuracy piano     : 50.080002 %
Train average accuracy guitar    : 49.540001 %
Train average accuracy residuals : 50.709999 %

== Train average loss all : 0.013319

Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=3.090, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]          Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=3.090, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]Epoch 78:  16%|█▌        | 50/313 [00:54<04:47,  0.92it/s, v_num=0, Train/loss_all_step=0.0171, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=3.090, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]Epoch 78:  16%|█▌        | 50/313 [00:54<04:47,  0.92it/s, v_num=0, Train/loss_all_step=0.00741, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.00249, Train/loss_recog_step=3.310, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]Epoch 78:  32%|███▏      | 100/313 [01:46<03:46,  0.94it/s, v_num=0, Train/loss_all_step=0.00741, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.00249, Train/loss_recog_step=3.310, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]Epoch 78:  32%|███▏      | 100/313 [01:46<03:46,  0.94it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=3.370, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]  Epoch 78:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.0058, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=3.370, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]Epoch 78:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.00829, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=3.440, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]Epoch 78:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.00829, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=3.440, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]Epoch 78:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.0157, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=3.310, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]  Epoch 78:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.0157, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=3.310, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]Epoch 78:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.00705, Train/loss_recog_step=3.080, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]Epoch 78:  96%|█████████▌| 300/313 [04:55<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.00705, Train/loss_recog_step=3.080, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]Epoch 78:  96%|█████████▌| 300/313 [04:55<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0155, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=3.470, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260] Epoch 78: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0155, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=3.470, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]Epoch 78: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00467, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000112, Train/loss_recog_step=3.240, Valid/loss_all_step=0.170, Valid/loss_unet_all_step=0.492, Valid/loss_triplet_all_step=0.165, Valid/loss_recog_step=3.140, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.373, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.33it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.07it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.129065, 0.129998, 0.120596, 0.144770
Valid average loss UNet                 (all)                : 0.524430

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.106794, 1.466675, 3.035186
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.236237, 1.103022, 1.370862
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.589085, 1.724950, 1.662824
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.328887, 1.434194, 1.890607
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.300775, 1.551086, 2.192212
Valid average loss all      (Triplet)                 : 0.322185

== Recognize ==
Valid average loss Recognize     : 3.213212
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.327429

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.157601118087769 sec. =
Valid knn accuracy drums     : 72.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.159620523452759 sec. =
Valid knn accuracy bass      : 9.274193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.115135431289673 sec. =
Valid knn accuracy piano     : 24.21875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.753370523452759 sec. =
Valid knn accuracy guitar    : 45.3125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.1261842250823975 sec. =
Valid knn accuracy residuals : 39.77272727272727%

Valid knn accuracy average   : 38.28085155552722%

                                                                      [AEpoch 78: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00467, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000112, Train/loss_recog_step=3.240, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00855, Train/loss_recog_epoch=3.260]Epoch 78: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00467, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000112, Train/loss_recog_step=3.240, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115957, 0.116557, 0.117278, 0.126910
Train average loss UNet                 (all)                : 0.476702

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005016, 1.154512, 3.571341
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011295, 0.933725, 2.029437
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009510, 1.058393, 2.169755
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009614, 1.101429, 2.389890
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006565, 1.261310, 2.652932
Train average loss all      (Triplet)                 : 0.008457

== Recognize ==
Train average loss Recognize     : 3.323859
Train average accuracy drums     : 49.860001 %
Train average accuracy bass      : 49.500000 %
Train average accuracy piano     : 50.110001 %
Train average accuracy guitar    : 50.054996 %
Train average accuracy residuals : 50.085003 %

== Train average loss all : 0.013224

Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00467, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000112, Train/loss_recog_step=3.240, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]          Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00467, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000112, Train/loss_recog_step=3.240, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]Epoch 79:  16%|█▌        | 50/313 [00:54<04:44,  0.93it/s, v_num=0, Train/loss_all_step=0.00467, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000112, Train/loss_recog_step=3.240, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]Epoch 79:  16%|█▌        | 50/313 [00:54<04:44,  0.93it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=0.00173, Train/loss_recog_step=3.100, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320] Epoch 79:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.00675, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=0.00173, Train/loss_recog_step=3.100, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]Epoch 79:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0086, Train/loss_recog_step=3.260, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]  Epoch 79:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0134, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.0086, Train/loss_recog_step=3.260, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]Epoch 79:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=3.270, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]Epoch 79:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0133, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=3.270, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]Epoch 79:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.0067, Train/loss_recog_step=3.550, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320] Epoch 79:  80%|███████▉  | 250/313 [04:00<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.0067, Train/loss_recog_step=3.550, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]Epoch 79:  80%|███████▉  | 250/313 [04:00<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.00159, Train/loss_recog_step=3.240, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]Epoch 79:  96%|█████████▌| 300/313 [04:47<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00606, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.00159, Train/loss_recog_step=3.240, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]Epoch 79:  96%|█████████▌| 300/313 [04:47<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00563, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.00111, Train/loss_recog_step=3.830, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]Epoch 79: 100%|██████████| 313/313 [04:55<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.00563, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.00111, Train/loss_recog_step=3.830, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]Epoch 79: 100%|██████████| 313/313 [04:55<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.00454, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.600, Valid/loss_all_step=0.209, Valid/loss_unet_all_step=0.521, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=3.000, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.210, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.46it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.33it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.99it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126963, 0.128723, 0.119074, 0.130858
Valid average loss UNet                 (all)                : 0.505617

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.027825, 1.402925, 3.419075
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.377876, 1.279987, 1.381510
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.569143, 1.736244, 1.558441
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.273145, 1.249373, 1.900587
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.251816, 1.598192, 2.201659
Valid average loss all      (Triplet)                 : 0.300898

== Recognize ==
Valid average loss Recognize     : 3.442099
Valid average accuracy drums     : 46.000000 %
Valid average accuracy bass      : 43.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.305954

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.496352910995483 sec. =
Valid knn accuracy drums     : 63.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.154767751693726 sec. =
Valid knn accuracy bass      : 17.741935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.727057456970215 sec. =
Valid knn accuracy piano     : 24.609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.203136205673218 sec. =
Valid knn accuracy guitar    : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.980708837509155 sec. =
Valid knn accuracy residuals : 41.81818181818181%

Valid knn accuracy average   : 37.11650715606273%

                                                                      [AEpoch 79: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00454, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.600, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00846, Train/loss_recog_epoch=3.320]Epoch 79: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00454, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.600, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115871, 0.116508, 0.117249, 0.126946
Train average loss UNet                 (all)                : 0.476573

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004078, 1.217304, 3.681772
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012238, 0.994944, 2.182550
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008253, 1.156169, 2.373767
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011388, 1.189996, 2.584613
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006156, 1.368972, 2.857177
Train average loss all      (Triplet)                 : 0.008685

== Recognize ==
Train average loss Recognize     : 3.313458
Train average accuracy drums     : 49.595001 %
Train average accuracy bass      : 49.739998 %
Train average accuracy piano     : 50.064999 %
Train average accuracy guitar    : 49.865002 %
Train average accuracy residuals : 49.889999 %

== Train average loss all : 0.013451

Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00454, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.600, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]          Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00454, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.600, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]Epoch 80:  16%|█▌        | 50/313 [00:51<04:32,  0.97it/s, v_num=0, Train/loss_all_step=0.00454, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.600, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]Epoch 80:  16%|█▌        | 50/313 [00:51<04:32,  0.97it/s, v_num=0, Train/loss_all_step=0.00965, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00474, Train/loss_recog_step=3.500, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]Epoch 80:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.00965, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00474, Train/loss_recog_step=3.500, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]Epoch 80:  32%|███▏      | 100/313 [01:39<03:31,  1.01it/s, v_num=0, Train/loss_all_step=0.0357, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0311, Train/loss_recog_step=3.490, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]  Epoch 80:  48%|████▊     | 150/313 [02:27<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.0357, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0311, Train/loss_recog_step=3.490, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]Epoch 80:  48%|████▊     | 150/313 [02:27<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.0175, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=3.360, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]Epoch 80:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0175, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.0125, Train/loss_recog_step=3.360, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]Epoch 80:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.00197, Train/loss_recog_step=3.520, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]Epoch 80:  80%|███████▉  | 250/313 [04:00<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00669, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.00197, Train/loss_recog_step=3.520, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]Epoch 80:  80%|███████▉  | 250/313 [04:00<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.451, Train/loss_triplet_all_step=0.00931, Train/loss_recog_step=3.150, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310] Epoch 80:  96%|█████████▌| 300/313 [04:46<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.0138, Train/loss_unet_all_step=0.451, Train/loss_triplet_all_step=0.00931, Train/loss_recog_step=3.150, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]Epoch 80:  96%|█████████▌| 300/313 [04:46<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.020, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0154, Train/loss_recog_step=3.400, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]  Epoch 80: 100%|██████████| 313/313 [04:54<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.020, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0154, Train/loss_recog_step=3.400, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]Epoch 80: 100%|██████████| 313/313 [04:54<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=3.800, Valid/loss_all_step=0.183, Valid/loss_unet_all_step=0.454, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=3.660, Valid/loss_all_epoch=0.306, Valid/loss_unet_all_epoch=0.506, Valid/loss_triplet_all_epoch=0.301, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.81it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.45it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.30it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.68it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.25it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.129259, 0.130029, 0.120444, 0.140900
Valid average loss UNet                 (all)                : 0.520632

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.181572, 1.456378, 2.864291
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.229244, 1.154310, 1.487477
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.538732, 1.712780, 1.618765
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.294995, 1.376912, 1.903365
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.307538, 1.690597, 2.178698
Valid average loss all      (Triplet)                 : 0.292200

== Recognize ==
Valid average loss Recognize     : 3.496982
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.297407

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.857666254043579 sec. =
Valid knn accuracy drums     : 65.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.592132806777954 sec. =
Valid knn accuracy bass      : 13.709677419354838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.20300841331482 sec. =
Valid knn accuracy piano     : 22.65625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.857245922088623 sec. =
Valid knn accuracy guitar    : 44.86607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.289219379425049 sec. =
Valid knn accuracy residuals : 42.95454545454545%

Valid knn accuracy average   : 37.83730886049435%

                                                                      [AEpoch 80: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=3.800, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.0135, Train/loss_unet_all_epoch=0.477, Train/loss_triplet_all_epoch=0.00869, Train/loss_recog_epoch=3.310]Epoch 80: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=3.800, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115829, 0.116462, 0.117177, 0.126372
Train average loss UNet                 (all)                : 0.475841

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003254, 1.198747, 3.755563
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014660, 0.964133, 2.099819
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009207, 1.125268, 2.330094
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008766, 1.130635, 2.518109
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004722, 1.357405, 2.849772
Train average loss all      (Triplet)                 : 0.008288

== Recognize ==
Train average loss Recognize     : 3.298933
Train average accuracy drums     : 50.400002 %
Train average accuracy bass      : 49.505001 %
Train average accuracy piano     : 49.634998 %
Train average accuracy guitar    : 49.035000 %
Train average accuracy residuals : 50.470001 %

== Train average loss all : 0.013047

Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=3.800, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]          Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=3.800, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]Epoch 81:  16%|█▌        | 50/313 [00:52<04:36,  0.95it/s, v_num=0, Train/loss_all_step=0.00917, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.00461, Train/loss_recog_step=3.800, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]Epoch 81:  16%|█▌        | 50/313 [00:52<04:36,  0.95it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.00138, Train/loss_recog_step=3.200, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]Epoch 81:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.00641, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.00138, Train/loss_recog_step=3.200, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]Epoch 81:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.0214, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=3.200, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]  Epoch 81:  48%|████▊     | 150/313 [02:27<02:40,  1.01it/s, v_num=0, Train/loss_all_step=0.0214, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=3.200, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]Epoch 81:  48%|████▊     | 150/313 [02:27<02:40,  1.01it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=3.270, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]Epoch 81:  64%|██████▍   | 200/313 [03:14<01:50,  1.03it/s, v_num=0, Train/loss_all_step=0.0172, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=3.270, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]Epoch 81:  64%|██████▍   | 200/313 [03:14<01:50,  1.03it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.0079, Train/loss_recog_step=3.170, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]Epoch 81:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0127, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.0079, Train/loss_recog_step=3.170, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]Epoch 81:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00674, Train/loss_unet_all_step=0.442, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=3.380, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]Epoch 81:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00674, Train/loss_unet_all_step=0.442, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=3.380, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]Epoch 81:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=3.310, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]   Epoch 81: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.015, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=3.310, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]Epoch 81: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.00663, Train/loss_recog_step=3.310, Valid/loss_all_step=0.0923, Valid/loss_unet_all_step=0.500, Valid/loss_triplet_all_step=0.0873, Valid/loss_recog_step=4.100, Valid/loss_all_epoch=0.297, Valid/loss_unet_all_epoch=0.521, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=3.500, Valid/knn_avr=0.378, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.87it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.20it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.99it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.88it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125538, 0.128603, 0.118177, 0.144518
Valid average loss UNet                 (all)                : 0.516836

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.041722, 1.437773, 3.054809
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.372317, 1.184265, 1.279448
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.578722, 1.742812, 1.678453
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.349054, 1.318700, 1.599587
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.338234, 1.554703, 2.161796
Valid average loss all      (Triplet)                 : 0.334085

== Recognize ==
Valid average loss Recognize     : 3.107182
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 56.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.339253

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.699918985366821 sec. =
Valid knn accuracy drums     : 61.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.920265197753906 sec. =
Valid knn accuracy bass      : 17.741935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.686400175094604 sec. =
Valid knn accuracy piano     : 24.609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.468825340270996 sec. =
Valid knn accuracy guitar    : 41.964285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.211158514022827 sec. =
Valid knn accuracy residuals : 45.45454545454545%

Valid knn accuracy average   : 38.30185441749695%

                                                                      [AEpoch 81: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.00663, Train/loss_recog_step=3.310, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00829, Train/loss_recog_epoch=3.300]  Epoch 81: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.00663, Train/loss_recog_step=3.310, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115713, 0.116362, 0.117064, 0.126221
Train average loss UNet                 (all)                : 0.475360

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005502, 1.250868, 3.847802
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011663, 0.958756, 2.138619
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008845, 1.144314, 2.335495
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010119, 1.087126, 2.391515
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006694, 1.383114, 2.901990
Train average loss all      (Triplet)                 : 0.008531

== Recognize ==
Train average loss Recognize     : 3.267359
Train average accuracy drums     : 49.480000 %
Train average accuracy bass      : 50.244999 %
Train average accuracy piano     : 49.959999 %
Train average accuracy guitar    : 50.430000 %
Train average accuracy residuals : 49.794998 %

== Train average loss all : 0.013285

Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.00663, Train/loss_recog_step=3.310, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]          Epoch 82:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.00663, Train/loss_recog_step=3.310, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]Epoch 82:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.00663, Train/loss_recog_step=3.310, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]Epoch 82:  16%|█▌        | 50/313 [00:53<04:42,  0.93it/s, v_num=0, Train/loss_all_step=0.00493, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.060, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270] Epoch 82:  32%|███▏      | 100/313 [01:42<03:38,  0.97it/s, v_num=0, Train/loss_all_step=0.00493, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.060, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]Epoch 82:  32%|███▏      | 100/313 [01:42<03:38,  0.97it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.00963, Train/loss_recog_step=3.380, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]Epoch 82:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0145, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.00963, Train/loss_recog_step=3.380, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]Epoch 82:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.00489, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.600, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270] Epoch 82:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.00489, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.600, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]Epoch 82:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=3.380, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]Epoch 82:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=3.380, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]Epoch 82:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00441, Train/loss_unet_all_step=0.437, Train/loss_triplet_all_step=4.53e-5, Train/loss_recog_step=3.660, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]Epoch 82:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00441, Train/loss_unet_all_step=0.437, Train/loss_triplet_all_step=4.53e-5, Train/loss_recog_step=3.660, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]Epoch 82:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.100, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]  Epoch 82: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.100, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]Epoch 82: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00496, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.000317, Train/loss_recog_step=3.140, Valid/loss_all_step=0.179, Valid/loss_unet_all_step=0.502, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.339, Valid/loss_unet_all_epoch=0.517, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=3.110, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.62it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.92it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.95it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.26it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.128426, 0.130222, 0.120696, 0.144383
Valid average loss UNet                 (all)                : 0.523728

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.084467, 1.392103, 2.979886
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.291930, 1.136957, 1.372130
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.447046, 1.633906, 1.597488
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.253470, 1.234187, 1.692549
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.294387, 1.549553, 1.959031
Valid average loss all      (Triplet)                 : 0.277508

== Recognize ==
Valid average loss Recognize     : 3.339021
Valid average accuracy drums     : 48.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.282745

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.56565237045288 sec. =
Valid knn accuracy drums     : 67.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.17020869255066 sec. =
Valid knn accuracy bass      : 15.120967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.513221025466919 sec. =
Valid knn accuracy piano     : 22.0703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.291090250015259 sec. =
Valid knn accuracy guitar    : 38.61607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.673458576202393 sec. =
Valid knn accuracy residuals : 45.68181818181819%

Valid knn accuracy average   : 37.73261657916068%

                                                                      [AEpoch 82: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00496, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.000317, Train/loss_recog_step=3.140, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0133, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00853, Train/loss_recog_epoch=3.270]Epoch 82: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00496, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.000317, Train/loss_recog_step=3.140, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115694, 0.116374, 0.117028, 0.125800
Train average loss UNet                 (all)                : 0.474896

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005336, 1.215265, 3.676125
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011903, 0.927732, 2.029722
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007387, 1.107061, 2.276994
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009087, 1.048832, 2.320584
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007658, 1.345103, 2.821686
Train average loss all      (Triplet)                 : 0.008474

== Recognize ==
Train average loss Recognize     : 3.326090
Train average accuracy drums     : 49.959999 %
Train average accuracy bass      : 49.990002 %
Train average accuracy piano     : 49.564999 %
Train average accuracy guitar    : 49.570000 %
Train average accuracy residuals : 49.785000 %

== Train average loss all : 0.013223

Epoch 82:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00496, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.000317, Train/loss_recog_step=3.140, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]          Epoch 83:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00496, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.000317, Train/loss_recog_step=3.140, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]Epoch 83:  16%|█▌        | 50/313 [00:55<04:54,  0.89it/s, v_num=0, Train/loss_all_step=0.00496, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.000317, Train/loss_recog_step=3.140, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]Epoch 83:  16%|█▌        | 50/313 [00:55<04:54,  0.89it/s, v_num=0, Train/loss_all_step=0.00494, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.330, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]   Epoch 83:  32%|███▏      | 100/313 [01:43<03:41,  0.96it/s, v_num=0, Train/loss_all_step=0.00494, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.330, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]Epoch 83:  32%|███▏      | 100/313 [01:43<03:41,  0.96it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=3.370, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]Epoch 83:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0129, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=3.370, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]Epoch 83:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.00855, Train/loss_recog_step=3.330, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]Epoch 83:  64%|██████▍   | 200/313 [03:18<01:52,  1.01it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.497, Train/loss_triplet_all_step=0.00855, Train/loss_recog_step=3.330, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]Epoch 83:  64%|██████▍   | 200/313 [03:18<01:52,  1.01it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.00849, Train/loss_recog_step=3.240, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]Epoch 83:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0132, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.00849, Train/loss_recog_step=3.240, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]Epoch 83:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.451, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=3.230, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330] Epoch 83:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.451, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=3.230, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]Epoch 83:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.0015, Train/loss_recog_step=3.730, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]Epoch 83: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00599, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.0015, Train/loss_recog_step=3.730, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]Epoch 83: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00906, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=3.060, Valid/loss_all_step=0.139, Valid/loss_unet_all_step=0.517, Valid/loss_triplet_all_step=0.134, Valid/loss_recog_step=3.350, Valid/loss_all_epoch=0.283, Valid/loss_unet_all_epoch=0.524, Valid/loss_triplet_all_epoch=0.278, Valid/loss_recog_epoch=3.340, Valid/knn_avr=0.377, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.68it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.89it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.89it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125858, 0.128415, 0.118194, 0.139992
Valid average loss UNet                 (all)                : 0.512459

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.057674, 1.345096, 3.233025
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.273554, 1.245708, 1.465441
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.536643, 1.712971, 1.623806
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.324669, 1.323394, 1.774992
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.280030, 1.698560, 2.118020
Valid average loss all      (Triplet)                 : 0.282276

== Recognize ==
Valid average loss Recognize     : 3.182314
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 58.000000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.287401

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.28238320350647 sec. =
Valid knn accuracy drums     : 67.6086956521739%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.163013219833374 sec. =
Valid knn accuracy bass      : 11.895161290322582%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.02199912071228 sec. =
Valid knn accuracy piano     : 23.828125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.291739225387573 sec. =
Valid knn accuracy guitar    : 40.401785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.229140520095825 sec. =
Valid knn accuracy residuals : 43.18181818181818%

Valid knn accuracy average   : 37.38311716772008%

                                                                      [AEpoch 83: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00906, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=3.060, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.0132, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00847, Train/loss_recog_epoch=3.330]Epoch 83: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00906, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=3.060, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115521, 0.116195, 0.116880, 0.126288
Train average loss UNet                 (all)                : 0.474884

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002211, 1.191170, 3.605024
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012278, 0.953092, 2.054062
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008139, 1.104788, 2.267027
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008747, 1.072679, 2.324421
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004333, 1.296624, 2.739159
Train average loss all      (Triplet)                 : 0.007285

== Recognize ==
Train average loss Recognize     : 3.374017
Train average accuracy drums     : 50.379997 %
Train average accuracy bass      : 50.160004 %
Train average accuracy piano     : 50.430000 %
Train average accuracy guitar    : 50.349998 %
Train average accuracy residuals : 49.985001 %

== Train average loss all : 0.012034

Epoch 83:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00906, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=3.060, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370]          Epoch 84:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00906, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=3.060, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370]Epoch 84:  16%|█▌        | 50/313 [00:54<04:44,  0.93it/s, v_num=0, Train/loss_all_step=0.00906, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.00411, Train/loss_recog_step=3.060, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370]Epoch 84:  16%|█▌        | 50/313 [00:54<04:44,  0.93it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=2.990, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370] Epoch 84:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.0109, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=2.990, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370]Epoch 84:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00596, Train/loss_recog_step=3.390, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370]Epoch 84:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00596, Train/loss_recog_step=3.390, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370]Epoch 84:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=3.620, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370] Epoch 84:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=3.620, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370]Epoch 84:  64%|██████▍   | 200/313 [03:18<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0238, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=3.110, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370] Epoch 84:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0238, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=3.110, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370]Epoch 84:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.00196, Train/loss_recog_step=3.350, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370]Epoch 84:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.00196, Train/loss_recog_step=3.350, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370]Epoch 84:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.00704, Train/loss_recog_step=3.700, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370] Epoch 84: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.00704, Train/loss_recog_step=3.700, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370]Epoch 84: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00476, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.000, Valid/loss_all_step=0.0659, Valid/loss_unet_all_step=0.487, Valid/loss_triplet_all_step=0.061, Valid/loss_recog_step=2.720, Valid/loss_all_epoch=0.287, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.282, Valid/loss_recog_epoch=3.180, Valid/knn_avr=0.374, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.03it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.74it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.33it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.87it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127713, 0.128888, 0.118699, 0.151582
Valid average loss UNet                 (all)                : 0.526881

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.074706, 1.407526, 3.292611
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.284688, 1.241428, 1.499527
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.468269, 1.694248, 1.744264
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.295317, 1.269791, 1.656017
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.294493, 1.635998, 2.042441
Valid average loss all      (Triplet)                 : 0.278881

== Recognize ==
Valid average loss Recognize     : 3.099041
Valid average accuracy drums     : 55.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.284150

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.131433010101318 sec. =
Valid knn accuracy drums     : 65.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.440654277801514 sec. =
Valid knn accuracy bass      : 14.31451612903226%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.18637728691101 sec. =
Valid knn accuracy piano     : 26.7578125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.671351194381714 sec. =
Valid knn accuracy guitar    : 44.86607142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.67339277267456 sec. =
Valid knn accuracy residuals : 43.18181818181818%

Valid knn accuracy average   : 38.82404364788437%

                                                                      [AEpoch 84: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00476, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.000, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.012, Train/loss_unet_all_epoch=0.475, Train/loss_triplet_all_epoch=0.00728, Train/loss_recog_epoch=3.370]Epoch 84: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00476, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.000, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115772, 0.116326, 0.117055, 0.126488
Train average loss UNet                 (all)                : 0.475641

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004275, 1.240217, 3.684700
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011327, 1.015285, 2.188861
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010135, 1.186874, 2.427405
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007514, 1.147165, 2.521356
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007827, 1.383809, 2.893510
Train average loss all      (Triplet)                 : 0.008242

== Recognize ==
Train average loss Recognize     : 3.384085
Train average accuracy drums     : 50.260002 %
Train average accuracy bass      : 49.904999 %
Train average accuracy piano     : 49.700001 %
Train average accuracy guitar    : 49.770000 %
Train average accuracy residuals : 50.155003 %

== Train average loss all : 0.012998

Epoch 84:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00476, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.000, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]          Epoch 85:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00476, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.000, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]Epoch 85:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.00476, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.000, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]Epoch 85:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=3.220, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]Epoch 85:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=3.220, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]Epoch 85:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.00542, Train/loss_recog_step=3.290, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]Epoch 85:  48%|████▊     | 150/313 [02:26<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.00542, Train/loss_recog_step=3.290, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]Epoch 85:  48%|████▊     | 150/313 [02:26<02:38,  1.03it/s, v_num=0, Train/loss_all_step=0.0275, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.0225, Train/loss_recog_step=3.620, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]Epoch 85:  64%|██████▍   | 200/313 [03:11<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.0275, Train/loss_unet_all_step=0.499, Train/loss_triplet_all_step=0.0225, Train/loss_recog_step=3.620, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]Epoch 85:  64%|██████▍   | 200/313 [03:11<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.00927, Train/loss_unet_all_step=0.463, Train/loss_triplet_all_step=0.00464, Train/loss_recog_step=3.620, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]Epoch 85:  80%|███████▉  | 250/313 [03:58<01:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00927, Train/loss_unet_all_step=0.463, Train/loss_triplet_all_step=0.00464, Train/loss_recog_step=3.620, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]Epoch 85:  80%|███████▉  | 250/313 [03:58<01:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.441, Train/loss_triplet_all_step=0.00802, Train/loss_recog_step=3.310, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380] Epoch 85:  96%|█████████▌| 300/313 [04:45<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.441, Train/loss_triplet_all_step=0.00802, Train/loss_recog_step=3.310, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]Epoch 85:  96%|█████████▌| 300/313 [04:45<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.0287, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=3.300, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380] Epoch 85: 100%|██████████| 313/313 [04:53<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.0287, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=3.300, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]Epoch 85: 100%|██████████| 313/313 [04:53<00:00,  1.07it/s, v_num=0, Train/loss_all_step=0.0234, Train/loss_unet_all_step=0.446, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=3.640, Valid/loss_all_step=0.0823, Valid/loss_unet_all_step=0.529, Valid/loss_triplet_all_step=0.077, Valid/loss_recog_step=2.540, Valid/loss_all_epoch=0.284, Valid/loss_unet_all_epoch=0.527, Valid/loss_triplet_all_epoch=0.279, Valid/loss_recog_epoch=3.100, Valid/knn_avr=0.388, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.88it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.86it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.20it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.09it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.15it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125498, 0.129299, 0.118964, 0.147932
Valid average loss UNet                 (all)                : 0.521693

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.047307, 1.434201, 3.172112
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.335177, 1.299387, 1.563178
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.517656, 1.881728, 1.822394
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.348249, 1.492399, 1.896614
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.272558, 1.550395, 2.117257
Valid average loss all      (Triplet)                 : 0.311441

== Recognize ==
Valid average loss Recognize     : 3.158001
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 57.000000 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 58.000000 %
Valid average accuracy residuals : 55.000000 %

== Valid average loss all : 0.316658

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.464356899261475 sec. =
Valid knn accuracy drums     : 68.47826086956522%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.667794466018677 sec. =
Valid knn accuracy bass      : 15.32258064516129%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.168296098709106 sec. =
Valid knn accuracy piano     : 22.265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.142033100128174 sec. =
Valid knn accuracy guitar    : 38.169642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.021425247192383 sec. =
Valid knn accuracy residuals : 43.63636363636363%

Valid knn accuracy average   : 37.5744946016466%

                                                                      [AEpoch 85: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0234, Train/loss_unet_all_step=0.446, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=3.640, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.013, Train/loss_unet_all_epoch=0.476, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=3.380] Epoch 85: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0234, Train/loss_unet_all_step=0.446, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=3.640, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115557, 0.116143, 0.116859, 0.125531
Train average loss UNet                 (all)                : 0.474091

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006060, 1.279080, 3.686215
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011523, 1.051982, 2.254048
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008488, 1.233576, 2.562199
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009533, 1.192701, 2.624724
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008357, 1.410624, 2.957877
Train average loss all      (Triplet)                 : 0.008660

== Recognize ==
Train average loss Recognize     : 3.459749
Train average accuracy drums     : 49.924999 %
Train average accuracy bass      : 49.634998 %
Train average accuracy piano     : 50.204998 %
Train average accuracy guitar    : 49.840000 %
Train average accuracy residuals : 49.724998 %

== Train average loss all : 0.013401

Epoch 85:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0234, Train/loss_unet_all_step=0.446, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=3.640, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]          Epoch 86:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0234, Train/loss_unet_all_step=0.446, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=3.640, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]Epoch 86:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.0234, Train/loss_unet_all_step=0.446, Train/loss_triplet_all_step=0.0189, Train/loss_recog_step=3.640, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]Epoch 86:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.00637, Train/loss_recog_step=3.560, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]Epoch 86:  32%|███▏      | 100/313 [01:40<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0112, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.00637, Train/loss_recog_step=3.560, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]Epoch 86:  32%|███▏      | 100/313 [01:40<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.012, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.00733, Train/loss_recog_step=3.380, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460] Epoch 86:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.012, Train/loss_unet_all_step=0.470, Train/loss_triplet_all_step=0.00733, Train/loss_recog_step=3.380, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]Epoch 86:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.505, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=3.590, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]Epoch 86:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.505, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=3.590, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]Epoch 86:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00705, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=3.600, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]Epoch 86:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00705, Train/loss_unet_all_step=0.473, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=3.600, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]Epoch 86:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00499, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.000521, Train/loss_recog_step=3.470, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]Epoch 86:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00499, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.000521, Train/loss_recog_step=3.470, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]Epoch 86:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00858, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=3.360, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460] Epoch 86: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00858, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=3.360, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]Epoch 86: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=3.340, Valid/loss_all_step=0.221, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=3.260, Valid/loss_all_epoch=0.317, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.311, Valid/loss_recog_epoch=3.160, Valid/knn_avr=0.376, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.06it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.42it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.21it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.58it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127120, 0.128586, 0.118511, 0.141699
Valid average loss UNet                 (all)                : 0.515916

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091052, 1.349901, 3.016526
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.207046, 1.151042, 1.517457
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.329898, 1.797670, 1.895010
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.375336, 1.371320, 1.728832
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.286258, 1.789369, 2.303156
Valid average loss all      (Triplet)                 : 0.261610

== Recognize ==
Valid average loss Recognize     : 3.020799
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 48.000000 %

== Valid average loss all : 0.266769

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.000021934509277 sec. =
Valid knn accuracy drums     : 69.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.33604645729065 sec. =
Valid knn accuracy bass      : 13.508064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.130658388137817 sec. =
Valid knn accuracy piano     : 22.265625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.721949815750122 sec. =
Valid knn accuracy guitar    : 40.401785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.127918481826782 sec. =
Valid knn accuracy residuals : 42.04545454545455%

Valid knn accuracy average   : 37.513751172565165%

                                                                      [AEpoch 86: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=3.340, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0134, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00866, Train/loss_recog_epoch=3.460]Epoch 86: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=3.340, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115413, 0.116011, 0.116749, 0.125301
Train average loss UNet                 (all)                : 0.473474

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002769, 1.186434, 3.478726
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010723, 1.009923, 2.185902
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009773, 1.168987, 2.406796
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010435, 1.121383, 2.418050
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005856, 1.311217, 2.770830
Train average loss all      (Triplet)                 : 0.007882

== Recognize ==
Train average loss Recognize     : 3.435621
Train average accuracy drums     : 49.209999 %
Train average accuracy bass      : 49.779999 %
Train average accuracy piano     : 49.814999 %
Train average accuracy guitar    : 49.889999 %
Train average accuracy residuals : 50.379997 %

== Train average loss all : 0.012616

Epoch 86:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=3.340, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]          Epoch 87:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=3.340, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]Epoch 87:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.00672, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=3.340, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]Epoch 87:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.00938, Train/loss_recog_step=3.700, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]Epoch 87:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.0142, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.00938, Train/loss_recog_step=3.700, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]Epoch 87:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.180, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440] Epoch 87:  48%|████▊     | 150/313 [02:25<02:37,  1.03it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.180, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]Epoch 87:  48%|████▊     | 150/313 [02:25<02:37,  1.03it/s, v_num=0, Train/loss_all_step=0.00793, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.00306, Train/loss_recog_step=3.370, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]Epoch 87:  64%|██████▍   | 200/313 [03:12<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.00793, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.00306, Train/loss_recog_step=3.370, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]Epoch 87:  64%|██████▍   | 200/313 [03:12<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=3.330, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440] Epoch 87:  80%|███████▉  | 250/313 [04:00<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0102, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=3.330, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]Epoch 87:  80%|███████▉  | 250/313 [04:00<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.456, Train/loss_triplet_all_step=0.00174, Train/loss_recog_step=3.360, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]Epoch 87:  96%|█████████▌| 300/313 [04:46<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.0063, Train/loss_unet_all_step=0.456, Train/loss_triplet_all_step=0.00174, Train/loss_recog_step=3.360, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]Epoch 87:  96%|█████████▌| 300/313 [04:46<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.0046, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.430, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]  Epoch 87: 100%|██████████| 313/313 [04:54<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.0046, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.430, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]Epoch 87: 100%|██████████| 313/313 [04:54<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.560, Valid/loss_all_step=0.0981, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.0931, Valid/loss_recog_step=2.060, Valid/loss_all_epoch=0.267, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=3.020, Valid/knn_avr=0.375, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.72it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.33it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.12it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127611, 0.129052, 0.118214, 0.151416
Valid average loss UNet                 (all)                : 0.526293

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079443, 1.368513, 3.328444
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.303908, 1.272847, 1.552936
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.593758, 1.907070, 1.686356
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.362507, 1.370486, 1.801251
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.297000, 1.701907, 2.083722
Valid average loss all      (Triplet)                 : 0.323067

== Recognize ==
Valid average loss Recognize     : 3.458374
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 50.000000 %
Valid average accuracy piano     : 56.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.328330

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.488476514816284 sec. =
Valid knn accuracy drums     : 62.60869565217392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.404684066772461 sec. =
Valid knn accuracy bass      : 14.717741935483872%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.967881441116333 sec. =
Valid knn accuracy piano     : 25.78125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.33523416519165 sec. =
Valid knn accuracy guitar    : 38.169642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.198600769042969 sec. =
Valid knn accuracy residuals : 40.22727272727273%

Valid knn accuracy average   : 36.30092063441468%

                                                                      [AEpoch 87: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.560, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0126, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00788, Train/loss_recog_epoch=3.440]  Epoch 87: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.560, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115407, 0.116066, 0.116753, 0.126123
Train average loss UNet                 (all)                : 0.474349

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003960, 1.253022, 3.763757
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012044, 1.062863, 2.289715
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008688, 1.237136, 2.522680
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010783, 1.180848, 2.539071
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005599, 1.433673, 3.005710
Train average loss all      (Triplet)                 : 0.008137

== Recognize ==
Train average loss Recognize     : 3.430666
Train average accuracy drums     : 50.129997 %
Train average accuracy bass      : 49.770000 %
Train average accuracy piano     : 50.099998 %
Train average accuracy guitar    : 50.029999 %
Train average accuracy residuals : 50.300003 %

== Train average loss all : 0.012880

Epoch 87:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.560, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]          Epoch 88:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.560, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]Epoch 88:  16%|█▌        | 50/313 [00:54<04:44,  0.92it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.560, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]Epoch 88:  16%|█▌        | 50/313 [00:54<04:44,  0.92it/s, v_num=0, Train/loss_all_step=0.0416, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0366, Train/loss_recog_step=3.210, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]Epoch 88:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0416, Train/loss_unet_all_step=0.496, Train/loss_triplet_all_step=0.0366, Train/loss_recog_step=3.210, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]Epoch 88:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.00963, Train/loss_recog_step=3.270, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]Epoch 88:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.00963, Train/loss_recog_step=3.270, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]Epoch 88:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0254, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=3.500, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430] Epoch 88:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0254, Train/loss_unet_all_step=0.515, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=3.500, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]Epoch 88:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0204, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=3.800, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]Epoch 88:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0204, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=3.800, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]Epoch 88:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.017, Train/loss_recog_step=3.180, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430] Epoch 88:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.017, Train/loss_recog_step=3.180, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]Epoch 88:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00751, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.00303, Train/loss_recog_step=3.560, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]Epoch 88: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00751, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.00303, Train/loss_recog_step=3.560, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]Epoch 88: 100%|██████████| 313/313 [05:00<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.00897, Train/loss_recog_step=3.820, Valid/loss_all_step=0.244, Valid/loss_unet_all_step=0.537, Valid/loss_triplet_all_step=0.239, Valid/loss_recog_step=3.630, Valid/loss_all_epoch=0.328, Valid/loss_unet_all_epoch=0.526, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.363, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.96it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.50it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.11it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127386, 0.129573, 0.119067, 0.139508
Valid average loss UNet                 (all)                : 0.515534

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073259, 1.531389, 3.886001
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.305833, 1.245119, 1.413534
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.671331, 1.972031, 1.753750
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.371779, 1.466908, 1.848899
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.338245, 1.836329, 2.367843
Valid average loss all      (Triplet)                 : 0.374786

== Recognize ==
Valid average loss Recognize     : 3.701296
Valid average accuracy drums     : 45.000000 %
Valid average accuracy bass      : 56.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.379942

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.94662070274353 sec. =
Valid knn accuracy drums     : 71.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.266320705413818 sec. =
Valid knn accuracy bass      : 15.725806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.479365825653076 sec. =
Valid knn accuracy piano     : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8812150955200195 sec. =
Valid knn accuracy guitar    : 41.517857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.575658559799194 sec. =
Valid knn accuracy residuals : 42.27272727272727%

Valid knn accuracy average   : 37.95762599952642%

                                                                      [AEpoch 88: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.00897, Train/loss_recog_step=3.820, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0129, Train/loss_unet_all_epoch=0.474, Train/loss_triplet_all_epoch=0.00814, Train/loss_recog_epoch=3.430]Epoch 88: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.00897, Train/loss_recog_step=3.820, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115292, 0.115933, 0.116651, 0.124803
Train average loss UNet                 (all)                : 0.472678

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004178, 1.301293, 3.921015
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011659, 1.068958, 2.284329
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007431, 1.232617, 2.508400
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008997, 1.185822, 2.573775
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004689, 1.422629, 2.980104
Train average loss all      (Triplet)                 : 0.007440

== Recognize ==
Train average loss Recognize     : 3.483612
Train average accuracy drums     : 50.414997 %
Train average accuracy bass      : 49.614998 %
Train average accuracy piano     : 49.270000 %
Train average accuracy guitar    : 49.900002 %
Train average accuracy residuals : 49.715000 %

== Train average loss all : 0.012167

Epoch 88:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.00897, Train/loss_recog_step=3.820, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]          Epoch 89:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.00897, Train/loss_recog_step=3.820, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.00897, Train/loss_recog_step=3.820, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.00491, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.290, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480] Epoch 89:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.00491, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.290, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.430, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.430, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.00975, Train/loss_recog_step=3.460, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89:  64%|██████▍   | 200/313 [03:16<01:51,  1.02it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.00975, Train/loss_recog_step=3.460, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89:  64%|██████▍   | 200/313 [03:16<01:51,  1.02it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.00875, Train/loss_recog_step=3.460, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0135, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.00875, Train/loss_recog_step=3.460, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00442, Train/loss_unet_all_step=0.442, Train/loss_triplet_all_step=2.6e-6, Train/loss_recog_step=3.360, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00442, Train/loss_unet_all_step=0.442, Train/loss_triplet_all_step=2.6e-6, Train/loss_recog_step=3.360, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=3.370, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=3.370, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00596, Train/loss_recog_step=3.150, Valid/loss_all_step=0.350, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.345, Valid/loss_recog_step=4.290, Valid/loss_all_epoch=0.380, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.375, Valid/loss_recog_epoch=3.700, Valid/knn_avr=0.380, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.53it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.46it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.17it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.23it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.19it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127394, 0.129276, 0.119703, 0.134013
Valid average loss UNet                 (all)                : 0.510385

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077941, 1.373514, 3.691166
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.280338, 1.351178, 1.592912
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.698450, 1.947818, 1.620848
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.345147, 1.506294, 1.826142
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.280744, 1.887779, 2.648398
Valid average loss all      (Triplet)                 : 0.358044

== Recognize ==
Valid average loss Recognize     : 3.403865
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.363147

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.4113030433654785 sec. =
Valid knn accuracy drums     : 61.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.756856918334961 sec. =
Valid knn accuracy bass      : 19.35483870967742%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.070658445358276 sec. =
Valid knn accuracy piano     : 21.6796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.641695976257324 sec. =
Valid knn accuracy guitar    : 40.401785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.033881664276123 sec. =
Valid knn accuracy residuals : 40.45454545454545%

Valid knn accuracy average   : 36.72599756265824%

                                                                      [AEpoch 89: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00596, Train/loss_recog_step=3.150, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0122, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=3.480]Epoch 89: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00596, Train/loss_recog_step=3.150, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115260, 0.115908, 0.116541, 0.125028
Train average loss UNet                 (all)                : 0.472736

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004929, 1.337656, 4.051169
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009509, 1.054697, 2.316509
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007990, 1.228056, 2.497166
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009205, 1.189364, 2.590007
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004308, 1.455691, 3.064922
Train average loss all      (Triplet)                 : 0.007087

== Recognize ==
Train average loss Recognize     : 3.426215
Train average accuracy drums     : 49.814999 %
Train average accuracy bass      : 50.040001 %
Train average accuracy piano     : 50.335003 %
Train average accuracy guitar    : 49.314999 %
Train average accuracy residuals : 50.285000 %

== Train average loss all : 0.011815

Epoch 89:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00596, Train/loss_recog_step=3.150, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]          Epoch 90:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00596, Train/loss_recog_step=3.150, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]Epoch 90:  16%|█▌        | 50/313 [00:52<04:38,  0.95it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00596, Train/loss_recog_step=3.150, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]Epoch 90:  16%|█▌        | 50/313 [00:52<04:38,  0.95it/s, v_num=0, Train/loss_all_step=0.0254, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=3.840, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430] Epoch 90:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.0254, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=3.840, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]Epoch 90:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.220, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]Epoch 90:  48%|████▊     | 150/313 [02:25<02:37,  1.03it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.220, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]Epoch 90:  48%|████▊     | 150/313 [02:25<02:37,  1.03it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=3.180, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]Epoch 90:  64%|██████▍   | 200/313 [03:11<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.502, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=3.180, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]Epoch 90:  64%|██████▍   | 200/313 [03:11<01:48,  1.04it/s, v_num=0, Train/loss_all_step=0.00555, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0008, Train/loss_recog_step=3.200, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]Epoch 90:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00555, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.0008, Train/loss_recog_step=3.200, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]Epoch 90:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00911, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.00464, Train/loss_recog_step=2.910, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]Epoch 90:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00911, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.00464, Train/loss_recog_step=2.910, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]Epoch 90:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0083, Train/loss_recog_step=2.990, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]   Epoch 90: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0083, Train/loss_recog_step=2.990, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]Epoch 90: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.120, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.466, Valid/loss_triplet_all_step=0.349, Valid/loss_recog_step=3.420, Valid/loss_all_epoch=0.363, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.367, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.34it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.79it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.18it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127981, 0.129552, 0.119254, 0.144935
Valid average loss UNet                 (all)                : 0.521723

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080164, 1.205548, 3.345048
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.349173, 1.275200, 1.402508
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.726247, 1.800087, 1.553283
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.357422, 1.410697, 1.946815
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.270825, 1.584821, 2.194012
Valid average loss all      (Triplet)                 : 0.372766

== Recognize ==
Valid average loss Recognize     : 3.031940
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.377984

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.491496801376343 sec. =
Valid knn accuracy drums     : 65.8695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.134246349334717 sec. =
Valid knn accuracy bass      : 13.709677419354838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.471155643463135 sec. =
Valid knn accuracy piano     : 24.8046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.654392242431641 sec. =
Valid knn accuracy guitar    : 38.169642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.467047929763794 sec. =
Valid knn accuracy residuals : 39.77272727272727%

Valid knn accuracy average   : 36.465260053323256%

                                                                      [AEpoch 90: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.120, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0118, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00709, Train/loss_recog_epoch=3.430]Epoch 90: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.120, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115224, 0.115844, 0.116506, 0.125245
Train average loss UNet                 (all)                : 0.472819

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002843, 1.337074, 4.092951
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010187, 1.101017, 2.385130
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008630, 1.232283, 2.552829
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011451, 1.215401, 2.628681
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004802, 1.462438, 3.102775
Train average loss all      (Triplet)                 : 0.007563

== Recognize ==
Train average loss Recognize     : 3.327317
Train average accuracy drums     : 49.869999 %
Train average accuracy bass      : 50.529999 %
Train average accuracy piano     : 49.950001 %
Train average accuracy guitar    : 50.320000 %
Train average accuracy residuals : 50.089996 %

== Train average loss all : 0.012291

Epoch 90:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.120, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]          Epoch 91:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.120, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]Epoch 91:  16%|█▌        | 50/313 [00:57<05:03,  0.87it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.120, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]Epoch 91:  16%|█▌        | 50/313 [00:57<05:03,  0.87it/s, v_num=0, Train/loss_all_step=0.018, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=2.860, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330] Epoch 91:  32%|███▏      | 100/313 [01:45<03:45,  0.95it/s, v_num=0, Train/loss_all_step=0.018, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.0129, Train/loss_recog_step=2.860, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]Epoch 91:  32%|███▏      | 100/313 [01:45<03:45,  0.95it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=3.650, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]Epoch 91:  48%|████▊     | 150/313 [02:33<02:47,  0.98it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=3.650, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]Epoch 91:  48%|████▊     | 150/313 [02:33<02:47,  0.98it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=3.000, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]Epoch 91:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.0163, Train/loss_unet_all_step=0.531, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=3.000, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]Epoch 91:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.00597, Train/loss_recog_step=3.450, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]Epoch 91:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0106, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.00597, Train/loss_recog_step=3.450, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]Epoch 91:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.028, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.0235, Train/loss_recog_step=2.840, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]  Epoch 91:  96%|█████████▌| 300/313 [04:56<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.028, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.0235, Train/loss_recog_step=2.840, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]Epoch 91:  96%|█████████▌| 300/313 [04:56<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.00729, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=3.140, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]Epoch 91: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00729, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=3.140, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]Epoch 91: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.400, Valid/loss_all_step=0.384, Valid/loss_unet_all_step=0.506, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=2.300, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.365, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.15it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.11it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.41it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.128707, 0.130937, 0.120193, 0.138977
Valid average loss UNet                 (all)                : 0.518814

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073466, 1.304408, 3.450532
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.344167, 1.309630, 1.551459
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.558665, 1.616103, 1.564144
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.397704, 1.474001, 1.804828
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.305574, 1.487363, 2.226963
Valid average loss all      (Triplet)                 : 0.335816

== Recognize ==
Valid average loss Recognize     : 3.403497
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 52.000000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.341004

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.08514404296875 sec. =
Valid knn accuracy drums     : 67.3913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.253029108047485 sec. =
Valid knn accuracy bass      : 17.338709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.167927503585815 sec. =
Valid knn accuracy piano     : 22.0703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.028793811798096 sec. =
Valid knn accuracy guitar    : 37.05357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.086916446685791 sec. =
Valid knn accuracy residuals : 41.81818181818181%

Valid knn accuracy average   : 37.134415954399735%

                                                                      [AEpoch 91: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.400, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0123, Train/loss_unet_all_epoch=0.473, Train/loss_triplet_all_epoch=0.00756, Train/loss_recog_epoch=3.330]Epoch 91: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.400, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115130, 0.115760, 0.116457, 0.124841
Train average loss UNet                 (all)                : 0.472187

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003965, 1.273845, 3.950310
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007991, 1.058121, 2.350146
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006295, 1.212527, 2.571589
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007923, 1.199405, 2.672222
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004290, 1.431542, 3.056803
Train average loss all      (Triplet)                 : 0.006183

== Recognize ==
Train average loss Recognize     : 3.252917
Train average accuracy drums     : 50.330002 %
Train average accuracy bass      : 49.910000 %
Train average accuracy piano     : 50.024998 %
Train average accuracy guitar    : 49.480000 %
Train average accuracy residuals : 50.295002 %

== Train average loss all : 0.010905

Epoch 91:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.400, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]          Epoch 92:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.400, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]Epoch 92:  16%|█▌        | 50/313 [00:52<04:35,  0.96it/s, v_num=0, Train/loss_all_step=0.00469, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.400, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]Epoch 92:  16%|█▌        | 50/313 [00:52<04:35,  0.96it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=3.210, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]Epoch 92:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=3.210, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]Epoch 92:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=3.300, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]Epoch 92:  48%|████▊     | 150/313 [02:27<02:40,  1.01it/s, v_num=0, Train/loss_all_step=0.00611, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=3.300, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]Epoch 92:  48%|████▊     | 150/313 [02:27<02:40,  1.01it/s, v_num=0, Train/loss_all_step=0.0232, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=3.290, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]  Epoch 92:  64%|██████▍   | 200/313 [03:13<01:49,  1.04it/s, v_num=0, Train/loss_all_step=0.0232, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=3.290, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]Epoch 92:  64%|██████▍   | 200/313 [03:13<01:49,  1.04it/s, v_num=0, Train/loss_all_step=0.00991, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00501, Train/loss_recog_step=3.420, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]Epoch 92:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00991, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00501, Train/loss_recog_step=3.420, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]Epoch 92:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.00218, Train/loss_recog_step=3.040, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250] Epoch 92:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0066, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.00218, Train/loss_recog_step=3.040, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]Epoch 92:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.370, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250] Epoch 92: 100%|██████████| 313/313 [04:57<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.370, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]Epoch 92: 100%|██████████| 313/313 [04:57<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.990, Valid/loss_all_step=0.225, Valid/loss_unet_all_step=0.512, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=3.990, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.400, Valid/knn_avr=0.371, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.30it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.66it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.39it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.75it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.84it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125585, 0.128012, 0.116554, 0.136976
Valid average loss UNet                 (all)                : 0.507126

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073416, 1.311943, 3.433577
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.437879, 1.344519, 1.285894
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.716121, 1.852285, 1.630687
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.290926, 1.401394, 2.078034
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.290884, 1.441108, 2.123316
Valid average loss all      (Triplet)                 : 0.353203

== Recognize ==
Valid average loss Recognize     : 3.463840
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 43.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 49.500000 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.358274

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.355257034301758 sec. =
Valid knn accuracy drums     : 67.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.00569748878479 sec. =
Valid knn accuracy bass      : 17.137096774193548%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.73164176940918 sec. =
Valid knn accuracy piano     : 26.171875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.262821912765503 sec. =
Valid knn accuracy guitar    : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.009966135025024 sec. =
Valid knn accuracy residuals : 40.45454545454545%

Valid knn accuracy average   : 38.13042083705215%

                                                                      [AEpoch 92: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.990, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00618, Train/loss_recog_epoch=3.250]Epoch 92: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.990, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115033, 0.115700, 0.116398, 0.124262
Train average loss UNet                 (all)                : 0.471394

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004604, 1.230424, 3.799680
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009648, 1.031436, 2.306141
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007542, 1.181905, 2.485898
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008229, 1.183732, 2.633282
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003414, 1.349042, 2.887703
Train average loss all      (Triplet)                 : 0.006852

== Recognize ==
Train average loss Recognize     : 3.234618
Train average accuracy drums     : 49.825001 %
Train average accuracy bass      : 50.150002 %
Train average accuracy piano     : 49.875000 %
Train average accuracy guitar    : 49.924999 %
Train average accuracy residuals : 50.209999 %

== Train average loss all : 0.011565

Epoch 92:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.990, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]          Epoch 93:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.990, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.990, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=3.270, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.0216, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=3.270, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93:  32%|███▏      | 100/313 [01:40<03:33,  1.00it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.260, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.260, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.00487, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=5.59e-5, Train/loss_recog_step=3.250, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00487, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=5.59e-5, Train/loss_recog_step=3.250, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.390, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]  Epoch 93:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.390, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0141, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.00961, Train/loss_recog_step=3.130, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0141, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.00961, Train/loss_recog_step=3.130, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.00992, Train/loss_recog_step=3.060, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0146, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.00992, Train/loss_recog_step=3.060, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.470, Valid/loss_all_step=0.226, Valid/loss_unet_all_step=0.484, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=3.770, Valid/loss_all_epoch=0.358, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.353, Valid/loss_recog_epoch=3.460, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  2.00it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.31it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.83it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.59it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127139, 0.128852, 0.118931, 0.139684
Valid average loss UNet                 (all)                : 0.514606

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.066425, 1.337574, 3.624778
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.452939, 1.329180, 1.361212
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.700868, 1.875791, 1.762589
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.383088, 1.519112, 2.074693
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.279526, 1.623014, 2.332672
Valid average loss all      (Triplet)                 : 0.360726

== Recognize ==
Valid average loss Recognize     : 3.219132
Valid average accuracy drums     : 59.500004 %
Valid average accuracy bass      : 54.000004 %
Valid average accuracy piano     : 47.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.365872

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.121331691741943 sec. =
Valid knn accuracy drums     : 70.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.450372457504272 sec. =
Valid knn accuracy bass      : 16.733870967741936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.317783117294312 sec. =
Valid knn accuracy piano     : 25.78125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.579480409622192 sec. =
Valid knn accuracy guitar    : 35.044642857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.429731130599976 sec. =
Valid knn accuracy residuals : 43.18181818181818%

Valid knn accuracy average   : 38.148316401340594%

                                                                      [AEpoch 93: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.470, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0116, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00685, Train/loss_recog_epoch=3.230]Epoch 93: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.470, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.115036, 0.115658, 0.116350, 0.124486
Train average loss UNet                 (all)                : 0.471530

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003772, 1.355003, 4.133994
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006905, 1.086870, 2.421117
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007301, 1.235669, 2.595401
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007610, 1.240045, 2.783569
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004925, 1.452786, 3.092779
Train average loss all      (Triplet)                 : 0.006218

== Recognize ==
Train average loss Recognize     : 3.277384
Train average accuracy drums     : 50.250000 %
Train average accuracy bass      : 50.664997 %
Train average accuracy piano     : 49.820000 %
Train average accuracy guitar    : 49.869999 %
Train average accuracy residuals : 49.895000 %

== Train average loss all : 0.010934

Epoch 93:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.470, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]          Epoch 94:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.470, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94:  16%|█▌        | 50/313 [00:56<04:59,  0.88it/s, v_num=0, Train/loss_all_step=0.00445, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.470, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94:  16%|█▌        | 50/313 [00:56<04:59,  0.88it/s, v_num=0, Train/loss_all_step=0.00797, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=3.070, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94:  32%|███▏      | 100/313 [01:45<03:45,  0.95it/s, v_num=0, Train/loss_all_step=0.00797, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=3.070, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94:  32%|███▏      | 100/313 [01:45<03:45,  0.95it/s, v_num=0, Train/loss_all_step=0.022, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=3.300, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]   Epoch 94:  48%|████▊     | 150/313 [02:34<02:47,  0.97it/s, v_num=0, Train/loss_all_step=0.022, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=3.300, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94:  48%|████▊     | 150/313 [02:34<02:47,  0.97it/s, v_num=0, Train/loss_all_step=0.029, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=3.550, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94:  64%|██████▍   | 200/313 [03:24<01:55,  0.98it/s, v_num=0, Train/loss_all_step=0.029, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=3.550, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94:  64%|██████▍   | 200/313 [03:24<01:55,  0.98it/s, v_num=0, Train/loss_all_step=0.0341, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=3.270, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94:  80%|███████▉  | 250/313 [04:13<01:03,  0.99it/s, v_num=0, Train/loss_all_step=0.0341, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.0292, Train/loss_recog_step=3.270, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94:  80%|███████▉  | 250/313 [04:13<01:03,  0.99it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.435, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=3.430, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94:  96%|█████████▌| 300/313 [05:01<00:13,  1.00it/s, v_num=0, Train/loss_all_step=0.00639, Train/loss_unet_all_step=0.435, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=3.430, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94:  96%|█████████▌| 300/313 [05:01<00:13,  1.00it/s, v_num=0, Train/loss_all_step=0.00857, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=3.170, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94: 100%|██████████| 313/313 [05:10<00:00,  1.01it/s, v_num=0, Train/loss_all_step=0.00857, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=3.170, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94: 100%|██████████| 313/313 [05:10<00:00,  1.01it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=3.300, Valid/loss_all_step=0.192, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.187, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.366, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.361, Valid/loss_recog_epoch=3.220, Valid/knn_avr=0.381, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.63it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.78it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.81it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.90it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.128099, 0.129922, 0.119394, 0.137433
Valid average loss UNet                 (all)                : 0.514847

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073651, 1.446371, 3.374266
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.397061, 1.297680, 1.311906
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.516124, 1.961492, 1.961043
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.347327, 1.388851, 2.026165
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.259467, 1.733996, 2.292243
Valid average loss all      (Triplet)                 : 0.321736

== Recognize ==
Valid average loss Recognize     : 3.027425
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 54.500000 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 51.500000 %
Valid average accuracy residuals : 49.500000 %

== Valid average loss all : 0.326884

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.721349954605103 sec. =
Valid knn accuracy drums     : 71.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.730327129364014 sec. =
Valid knn accuracy bass      : 20.362903225806452%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.111574411392212 sec. =
Valid knn accuracy piano     : 28.7109375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.514055967330933 sec. =
Valid knn accuracy guitar    : 40.401785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.321440696716309 sec. =
Valid knn accuracy residuals : 47.5%

Valid knn accuracy average   : 41.74295137497496%

                                                                      [AEpoch 94: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=3.300, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0109, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=3.280]Epoch 94: 100%|██████████| 313/313 [06:27<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=3.300, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114977, 0.115625, 0.116281, 0.124583
Train average loss UNet                 (all)                : 0.471465

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003787, 1.301536, 3.955026
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008919, 1.054632, 2.352350
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007165, 1.232949, 2.577681
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006573, 1.192627, 2.720069
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005535, 1.478019, 3.140031
Train average loss all      (Triplet)                 : 0.006522

== Recognize ==
Train average loss Recognize     : 3.275015
Train average accuracy drums     : 50.865002 %
Train average accuracy bass      : 50.115002 %
Train average accuracy piano     : 50.209999 %
Train average accuracy guitar    : 49.810001 %
Train average accuracy residuals : 50.180000 %

== Train average loss all : 0.011237

Epoch 94:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=3.300, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]          Epoch 95:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=3.300, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95:  16%|█▌        | 50/313 [00:55<04:52,  0.90it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0066, Train/loss_recog_step=3.300, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95:  16%|█▌        | 50/313 [00:55<04:52,  0.90it/s, v_num=0, Train/loss_all_step=0.00494, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.900, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95:  32%|███▏      | 100/313 [01:43<03:41,  0.96it/s, v_num=0, Train/loss_all_step=0.00494, Train/loss_unet_all_step=0.494, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.900, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95:  32%|███▏      | 100/313 [01:43<03:41,  0.96it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.330, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95:  48%|████▊     | 150/313 [02:32<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.330, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95:  48%|████▊     | 150/313 [02:32<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.00596, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=3.140, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.00596, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=3.140, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.00486, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=7.04e-5, Train/loss_recog_step=3.180, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.00486, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=7.04e-5, Train/loss_recog_step=3.180, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.441, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=3.160, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280] Epoch 95:  96%|█████████▌| 300/313 [04:56<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.0101, Train/loss_unet_all_step=0.441, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=3.160, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95:  96%|█████████▌| 300/313 [04:56<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.00625, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.00165, Train/loss_recog_step=3.110, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00625, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.00165, Train/loss_recog_step=3.110, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95: 100%|██████████| 313/313 [05:04<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00435, Train/loss_unet_all_step=0.435, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.590, Valid/loss_all_step=0.190, Valid/loss_unet_all_step=0.497, Valid/loss_triplet_all_step=0.186, Valid/loss_recog_step=2.650, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.515, Valid/loss_triplet_all_epoch=0.322, Valid/loss_recog_epoch=3.030, Valid/knn_avr=0.417, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.65it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.89it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.04it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.08it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.13it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127906, 0.129410, 0.118242, 0.143940
Valid average loss UNet                 (all)                : 0.519497

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.092949, 1.328882, 3.625524
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.360635, 1.350356, 1.534767
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.612239, 1.856734, 1.602520
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.263415, 1.300038, 2.021366
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.398872, 1.611340, 1.907572
Valid average loss all      (Triplet)                 : 0.320302

== Recognize ==
Valid average loss Recognize     : 3.169226
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 55.500000 %

== Valid average loss all : 0.325497

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.474689245223999 sec. =
Valid knn accuracy drums     : 68.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.77048110961914 sec. =
Valid knn accuracy bass      : 18.346774193548388%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.110306739807129 sec. =
Valid knn accuracy piano     : 19.140625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.293561935424805 sec. =
Valid knn accuracy guitar    : 41.964285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.173012018203735 sec. =
Valid knn accuracy residuals : 37.04545454545455%

Valid knn accuracy average   : 37.03855832544035%

                                                                      [AEpoch 95: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00435, Train/loss_unet_all_step=0.435, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.590, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0112, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00652, Train/loss_recog_epoch=3.280]Epoch 95: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00435, Train/loss_unet_all_step=0.435, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.590, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114900, 0.115539, 0.116301, 0.124770
Train average loss UNet                 (all)                : 0.471510

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003093, 1.297397, 3.995503
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008064, 1.093005, 2.421808
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008244, 1.258461, 2.664860
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005744, 1.188601, 2.701474
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003914, 1.425311, 3.034525
Train average loss all      (Triplet)                 : 0.005819

== Recognize ==
Train average loss Recognize     : 3.263123
Train average accuracy drums     : 50.650002 %
Train average accuracy bass      : 50.110001 %
Train average accuracy piano     : 49.895000 %
Train average accuracy guitar    : 50.475002 %
Train average accuracy residuals : 50.405003 %

== Train average loss all : 0.010534

Epoch 95:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00435, Train/loss_unet_all_step=0.435, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.590, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]          Epoch 96:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00435, Train/loss_unet_all_step=0.435, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.590, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]Epoch 96:  16%|█▌        | 50/313 [00:54<04:44,  0.92it/s, v_num=0, Train/loss_all_step=0.00435, Train/loss_unet_all_step=0.435, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.590, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]Epoch 96:  16%|█▌        | 50/313 [00:54<04:44,  0.92it/s, v_num=0, Train/loss_all_step=0.00491, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.340, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]Epoch 96:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.00491, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.340, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]Epoch 96:  32%|███▏      | 100/313 [01:40<03:34,  0.99it/s, v_num=0, Train/loss_all_step=0.00819, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=3.760, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]Epoch 96:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.00819, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=3.760, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]Epoch 96:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=3.360, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260] Epoch 96:  64%|██████▍   | 200/313 [03:14<01:50,  1.03it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.500, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=3.360, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]Epoch 96:  64%|██████▍   | 200/313 [03:14<01:50,  1.03it/s, v_num=0, Train/loss_all_step=0.00702, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.00226, Train/loss_recog_step=3.310, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]Epoch 96:  80%|███████▉  | 250/313 [04:01<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00702, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.00226, Train/loss_recog_step=3.310, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]Epoch 96:  80%|███████▉  | 250/313 [04:01<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00516, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.00064, Train/loss_recog_step=3.110, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]Epoch 96:  96%|█████████▌| 300/313 [04:48<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00516, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.00064, Train/loss_recog_step=3.110, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]Epoch 96:  96%|█████████▌| 300/313 [04:48<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.456, Train/loss_triplet_all_step=0.00807, Train/loss_recog_step=3.160, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260] Epoch 96: 100%|██████████| 313/313 [04:56<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.456, Train/loss_triplet_all_step=0.00807, Train/loss_recog_step=3.160, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]Epoch 96: 100%|██████████| 313/313 [04:56<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.030, Valid/loss_all_step=0.169, Valid/loss_unet_all_step=0.513, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.325, Valid/loss_unet_all_epoch=0.519, Valid/loss_triplet_all_epoch=0.320, Valid/loss_recog_epoch=3.170, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.42it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.22it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.30it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.28it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.34it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.30it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125594, 0.127530, 0.116301, 0.144733
Valid average loss UNet                 (all)                : 0.514158

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097043, 1.400712, 3.187696
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.382540, 1.385830, 1.598018
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.819869, 2.044868, 1.624368
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.387510, 1.488987, 2.127058
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.431752, 1.792459, 2.116648
Valid average loss all      (Triplet)                 : 0.436786

== Recognize ==
Valid average loss Recognize     : 3.388850
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 52.999996 %

== Valid average loss all : 0.441927

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.418065309524536 sec. =
Valid knn accuracy drums     : 64.78260869565217%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.801084995269775 sec. =
Valid knn accuracy bass      : 15.725806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.93619680404663 sec. =
Valid knn accuracy piano     : 22.4609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.594105005264282 sec. =
Valid knn accuracy guitar    : 45.535714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.204890012741089 sec. =
Valid knn accuracy residuals : 44.31818181818182%

Valid knn accuracy average   : 38.564649750232235%

                                                                      [AEpoch 96: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.030, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.472, Train/loss_triplet_all_epoch=0.00582, Train/loss_recog_epoch=3.260]Epoch 96: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.030, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114817, 0.115430, 0.116155, 0.124875
Train average loss UNet                 (all)                : 0.471277

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003213, 1.335618, 4.189366
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008567, 1.099634, 2.419837
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007753, 1.255281, 2.654471
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005363, 1.206841, 2.772772
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004709, 1.431595, 3.087395
Train average loss all      (Triplet)                 : 0.006066

== Recognize ==
Train average loss Recognize     : 3.282172
Train average accuracy drums     : 50.115002 %
Train average accuracy bass      : 49.770000 %
Train average accuracy piano     : 50.700005 %
Train average accuracy guitar    : 50.489998 %
Train average accuracy residuals : 50.185001 %

== Train average loss all : 0.010779

Epoch 96:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.030, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]          Epoch 97:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.030, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97:  16%|█▌        | 50/313 [00:54<04:45,  0.92it/s, v_num=0, Train/loss_all_step=0.00483, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.030, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97:  16%|█▌        | 50/313 [00:54<04:45,  0.92it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=3.300, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0167, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=3.300, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.463, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=3.180, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.0206, Train/loss_unet_all_step=0.463, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=3.180, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.00949, Train/loss_recog_step=3.180, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0144, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.00949, Train/loss_recog_step=3.180, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00658, Train/loss_recog_step=3.340, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97:  80%|███████▉  | 250/313 [03:59<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0113, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00658, Train/loss_recog_step=3.340, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97:  80%|███████▉  | 250/313 [03:59<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.018, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=3.350, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]  Epoch 97:  96%|█████████▌| 300/313 [04:48<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.018, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=3.350, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97:  96%|█████████▌| 300/313 [04:48<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=3.050, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97: 100%|██████████| 313/313 [04:56<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.0229, Train/loss_unet_all_step=0.460, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=3.050, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97: 100%|██████████| 313/313 [04:56<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.00439, Train/loss_unet_all_step=0.439, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.230, Valid/loss_all_step=0.475, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=3.830, Valid/loss_all_epoch=0.442, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=3.390, Valid/knn_avr=0.386, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.62it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.05it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.77it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.28it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.12it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126940, 0.129051, 0.117500, 0.140350
Valid average loss UNet                 (all)                : 0.513841

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087445, 1.523191, 3.418515
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.378107, 1.379157, 1.503433
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.728405, 1.978653, 1.578583
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.432933, 1.543701, 1.911250
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.322677, 1.735457, 2.236504
Valid average loss all      (Triplet)                 : 0.407540

== Recognize ==
Valid average loss Recognize     : 3.468876
Valid average accuracy drums     : 42.000000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 46.500000 %
Valid average accuracy guitar    : 45.000000 %
Valid average accuracy residuals : 54.500000 %

== Valid average loss all : 0.412678

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.640214681625366 sec. =
Valid knn accuracy drums     : 61.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.939355373382568 sec. =
Valid knn accuracy bass      : 18.951612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.899949550628662 sec. =
Valid knn accuracy piano     : 26.5625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.952667474746704 sec. =
Valid knn accuracy guitar    : 32.8125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.306674242019653 sec. =
Valid knn accuracy residuals : 45.0%

Valid knn accuracy average   : 37.01314866760168%

                                                                      [AEpoch 97: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00439, Train/loss_unet_all_step=0.439, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.230, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0108, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=3.280]Epoch 97: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00439, Train/loss_unet_all_step=0.439, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.230, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114841, 0.115466, 0.116133, 0.124194
Train average loss UNet                 (all)                : 0.470633

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004086, 1.320241, 3.943218
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010771, 1.090437, 2.405000
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007141, 1.249823, 2.596634
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007313, 1.215531, 2.786925
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004919, 1.446673, 3.114967
Train average loss all      (Triplet)                 : 0.006953

== Recognize ==
Train average loss Recognize     : 3.286376
Train average accuracy drums     : 50.050003 %
Train average accuracy bass      : 50.410004 %
Train average accuracy piano     : 50.115002 %
Train average accuracy guitar    : 49.584999 %
Train average accuracy residuals : 50.559998 %

== Train average loss all : 0.011659

Epoch 97:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00439, Train/loss_unet_all_step=0.439, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.230, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]          Epoch 98:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00439, Train/loss_unet_all_step=0.439, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.230, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98:  16%|█▌        | 50/313 [00:54<04:44,  0.93it/s, v_num=0, Train/loss_all_step=0.00439, Train/loss_unet_all_step=0.439, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.230, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98:  16%|█▌        | 50/313 [00:54<04:44,  0.93it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.00578, Train/loss_recog_step=3.050, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98:  32%|███▏      | 100/313 [01:43<03:41,  0.96it/s, v_num=0, Train/loss_all_step=0.0107, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.00578, Train/loss_recog_step=3.050, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98:  32%|███▏      | 100/313 [01:43<03:41,  0.96it/s, v_num=0, Train/loss_all_step=0.00797, Train/loss_unet_all_step=0.456, Train/loss_triplet_all_step=0.00342, Train/loss_recog_step=3.160, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98:  48%|████▊     | 150/313 [02:32<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.00797, Train/loss_unet_all_step=0.456, Train/loss_triplet_all_step=0.00342, Train/loss_recog_step=3.160, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98:  48%|████▊     | 150/313 [02:32<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.00694, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=3.150, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98:  64%|██████▍   | 200/313 [03:22<01:54,  0.99it/s, v_num=0, Train/loss_all_step=0.00694, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=3.150, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98:  64%|██████▍   | 200/313 [03:22<01:54,  0.99it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00668, Train/loss_recog_step=3.310, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290] Epoch 98:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00668, Train/loss_recog_step=3.310, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.00824, Train/loss_unet_all_step=0.434, Train/loss_triplet_all_step=0.0039, Train/loss_recog_step=3.350, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98:  96%|█████████▌| 300/313 [04:57<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.00824, Train/loss_unet_all_step=0.434, Train/loss_triplet_all_step=0.0039, Train/loss_recog_step=3.350, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98:  96%|█████████▌| 300/313 [04:57<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.00529, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.000743, Train/loss_recog_step=3.220, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00529, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.000743, Train/loss_recog_step=3.220, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98: 100%|██████████| 313/313 [05:05<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.330, Valid/loss_all_step=0.366, Valid/loss_unet_all_step=0.493, Valid/loss_triplet_all_step=0.362, Valid/loss_recog_step=3.590, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.408, Valid/loss_recog_epoch=3.470, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.50it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.82it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.25it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.70it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.124186, 0.127731, 0.115582, 0.148191
Valid average loss UNet                 (all)                : 0.515690

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.111162, 1.530369, 3.119558
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.397132, 1.378667, 1.445415
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.670452, 1.978720, 1.672357
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.367867, 1.476805, 2.031742
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.266574, 1.671671, 2.271116
Valid average loss all      (Triplet)                 : 0.370508

== Recognize ==
Valid average loss Recognize     : 3.298326
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 52.999996 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 57.500000 %

== Valid average loss all : 0.375665

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.262026309967041 sec. =
Valid knn accuracy drums     : 62.82608695652174%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.11692190170288 sec. =
Valid knn accuracy bass      : 17.943548387096776%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.886961221694946 sec. =
Valid knn accuracy piano     : 23.046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3901941776275635 sec. =
Valid knn accuracy guitar    : 48.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.966066122055054 sec. =
Valid knn accuracy residuals : 42.27272727272727%

Valid knn accuracy average   : 38.905347523269164%

                                                                      [AEpoch 98: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.330, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.0117, Train/loss_unet_all_epoch=0.471, Train/loss_triplet_all_epoch=0.00695, Train/loss_recog_epoch=3.290]Epoch 98: 100%|██████████| 313/313 [06:22<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.330, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114701, 0.115298, 0.115992, 0.122812
Train average loss UNet                 (all)                : 0.468803

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004736, 1.281577, 3.970749
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009112, 1.029568, 2.292311
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006742, 1.186209, 2.489933
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007152, 1.133955, 2.601093
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003789, 1.409185, 3.043349
Train average loss all      (Triplet)                 : 0.006314

== Recognize ==
Train average loss Recognize     : 3.277411
Train average accuracy drums     : 49.570000 %
Train average accuracy bass      : 50.105000 %
Train average accuracy piano     : 49.865002 %
Train average accuracy guitar    : 49.505001 %
Train average accuracy residuals : 49.919998 %

== Train average loss all : 0.011002

Epoch 98:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.330, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]          Epoch 99:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.330, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]Epoch 99:  16%|█▌        | 50/313 [00:55<04:50,  0.91it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.330, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]Epoch 99:  16%|█▌        | 50/313 [00:55<04:50,  0.91it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.00595, Train/loss_recog_step=3.250, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]Epoch 99:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.0108, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.00595, Train/loss_recog_step=3.250, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]Epoch 99:  32%|███▏      | 100/313 [01:41<03:36,  0.98it/s, v_num=0, Train/loss_all_step=0.00458, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.550, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280] Epoch 99:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.00458, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.550, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]Epoch 99:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.00797, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.00315, Train/loss_recog_step=3.470, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]Epoch 99:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00797, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.00315, Train/loss_recog_step=3.470, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]Epoch 99:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0336, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.0289, Train/loss_recog_step=3.210, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]  Epoch 99:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0336, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.0289, Train/loss_recog_step=3.210, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]Epoch 99:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00508, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.000649, Train/loss_recog_step=3.220, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]Epoch 99:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00508, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.000649, Train/loss_recog_step=3.220, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]Epoch 99:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.451, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=3.180, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]   Epoch 99: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0161, Train/loss_unet_all_step=0.451, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=3.180, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]Epoch 99: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00527, Train/loss_unet_all_step=0.441, Train/loss_triplet_all_step=0.00086, Train/loss_recog_step=3.120, Valid/loss_all_step=0.295, Valid/loss_unet_all_step=0.504, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=3.900, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.300, Valid/knn_avr=0.389, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.02it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.18it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.72it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.80it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126557, 0.128663, 0.118117, 0.139582
Valid average loss UNet                 (all)                : 0.512919

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.110213, 1.541502, 3.147716
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.332968, 1.191018, 1.422111
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.657284, 1.762124, 1.524942
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.346415, 1.347828, 1.772554
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.335882, 1.858101, 2.198954
Valid average loss all      (Triplet)                 : 0.348068

== Recognize ==
Valid average loss Recognize     : 2.972753
Valid average accuracy drums     : 42.000000 %
Valid average accuracy bass      : 55.500000 %
Valid average accuracy piano     : 58.999996 %
Valid average accuracy guitar    : 55.500000 %
Valid average accuracy residuals : 43.500000 %

== Valid average loss all : 0.353197

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.652402400970459 sec. =
Valid knn accuracy drums     : 62.82608695652174%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.136380672454834 sec. =
Valid knn accuracy bass      : 13.104838709677418%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.56745982170105 sec. =
Valid knn accuracy piano     : 23.046875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.541154623031616 sec. =
Valid knn accuracy guitar    : 39.0625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.991252660751343 sec. =
Valid knn accuracy residuals : 45.0%

Valid knn accuracy average   : 36.60806013323983%

                                                                      [AEpoch 99: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00527, Train/loss_unet_all_step=0.441, Train/loss_triplet_all_step=0.00086, Train/loss_recog_step=3.120, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.011, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00631, Train/loss_recog_epoch=3.280]Epoch 99: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00527, Train/loss_unet_all_step=0.441, Train/loss_triplet_all_step=0.00086, Train/loss_recog_step=3.120, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114781, 0.115322, 0.116045, 0.123550
Train average loss UNet                 (all)                : 0.469698

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004344, 1.319097, 4.155540
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007724, 1.067392, 2.402853
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007290, 1.229054, 2.564134
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008309, 1.178178, 2.690700
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006143, 1.501664, 3.175023
Train average loss all      (Triplet)                 : 0.006806

== Recognize ==
Train average loss Recognize     : 3.203760
Train average accuracy drums     : 50.125004 %
Train average accuracy bass      : 50.414997 %
Train average accuracy piano     : 50.880005 %
Train average accuracy guitar    : 49.814999 %
Train average accuracy residuals : 49.360001 %

== Train average loss all : 0.011503

Epoch 99:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00527, Train/loss_unet_all_step=0.441, Train/loss_triplet_all_step=0.00086, Train/loss_recog_step=3.120, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]          Epoch 100:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00527, Train/loss_unet_all_step=0.441, Train/loss_triplet_all_step=0.00086, Train/loss_recog_step=3.120, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]Epoch 100:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.00527, Train/loss_unet_all_step=0.441, Train/loss_triplet_all_step=0.00086, Train/loss_recog_step=3.120, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]Epoch 100:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.0159, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=3.160, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]   Epoch 100:  32%|███▏      | 100/313 [01:39<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.0159, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=3.160, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]Epoch 100:  32%|███▏      | 100/313 [01:39<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.0208, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=3.170, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]Epoch 100:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.0208, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=3.170, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]Epoch 100:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.00756, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.00263, Train/loss_recog_step=3.260, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]Epoch 100:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00756, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.00263, Train/loss_recog_step=3.260, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]Epoch 100:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.260, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]  Epoch 100:  80%|███████▉  | 250/313 [04:03<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00468, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.260, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]Epoch 100:  80%|███████▉  | 250/313 [04:03<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0177, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=3.050, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]Epoch 100:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0177, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=3.050, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]Epoch 100:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.440, Train/loss_triplet_all_step=0.00864, Train/loss_recog_step=3.400, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]Epoch 100: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.440, Train/loss_triplet_all_step=0.00864, Train/loss_recog_step=3.400, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]Epoch 100: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00457, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.410, Valid/loss_all_step=0.247, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.242, Valid/loss_recog_step=2.400, Valid/loss_all_epoch=0.353, Valid/loss_unet_all_epoch=0.513, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=2.970, Valid/knn_avr=0.366, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.98it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.83it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.16it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.87it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.56it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.92it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125885, 0.128676, 0.117880, 0.138056
Valid average loss UNet                 (all)                : 0.510496

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.093241, 1.433933, 3.403810
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.328821, 1.408423, 1.731151
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.703527, 1.842861, 1.626565
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.440052, 1.539496, 1.985073
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.315795, 1.642614, 2.546985
Valid average loss all      (Triplet)                 : 0.388882

== Recognize ==
Valid average loss Recognize     : 3.249529
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 50.500000 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 52.000000 %
Valid average accuracy residuals : 42.500000 %

== Valid average loss all : 0.393987

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.513645887374878 sec. =
Valid knn accuracy drums     : 71.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.334240198135376 sec. =
Valid knn accuracy bass      : 14.31451612903226%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.75630259513855 sec. =
Valid knn accuracy piano     : 18.359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.245177745819092 sec. =
Valid knn accuracy guitar    : 35.714285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.203768730163574 sec. =
Valid knn accuracy residuals : 45.22727272727273%

Valid knn accuracy average   : 36.98395947933554%

                                                                      [AEpoch 100: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00457, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.410, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0115, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00681, Train/loss_recog_epoch=3.200]Epoch 100: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00457, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.410, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114723, 0.115346, 0.116004, 0.123175
Train average loss UNet                 (all)                : 0.469248

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003684, 1.311978, 4.158568
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008048, 1.093822, 2.476002
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005475, 1.206882, 2.558092
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005109, 1.159796, 2.663054
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004318, 1.460362, 3.188129
Train average loss all      (Triplet)                 : 0.005454

== Recognize ==
Train average loss Recognize     : 3.215655
Train average accuracy drums     : 50.089996 %
Train average accuracy bass      : 50.440002 %
Train average accuracy piano     : 49.739998 %
Train average accuracy guitar    : 50.930000 %
Train average accuracy residuals : 49.544998 %

== Train average loss all : 0.010146

Epoch 100:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00457, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.410, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]          Epoch 101:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00457, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.410, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]Epoch 101:  16%|█▌        | 50/313 [00:54<04:47,  0.91it/s, v_num=0, Train/loss_all_step=0.00457, Train/loss_unet_all_step=0.457, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.410, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]Epoch 101:  16%|█▌        | 50/313 [00:54<04:47,  0.91it/s, v_num=0, Train/loss_all_step=0.00816, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=3.190, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]Epoch 101:  32%|███▏      | 100/313 [01:43<03:40,  0.97it/s, v_num=0, Train/loss_all_step=0.00816, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=3.190, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]Epoch 101:  32%|███▏      | 100/313 [01:43<03:40,  0.97it/s, v_num=0, Train/loss_all_step=0.00802, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.00339, Train/loss_recog_step=3.480, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]Epoch 101:  48%|████▊     | 150/313 [02:31<02:45,  0.99it/s, v_num=0, Train/loss_all_step=0.00802, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.00339, Train/loss_recog_step=3.480, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]Epoch 101:  48%|████▊     | 150/313 [02:31<02:45,  0.99it/s, v_num=0, Train/loss_all_step=0.0294, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0245, Train/loss_recog_step=3.240, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]  Epoch 101:  64%|██████▍   | 200/313 [03:24<01:55,  0.98it/s, v_num=0, Train/loss_all_step=0.0294, Train/loss_unet_all_step=0.487, Train/loss_triplet_all_step=0.0245, Train/loss_recog_step=3.240, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]Epoch 101:  64%|██████▍   | 200/313 [03:24<01:55,  0.98it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=3.270, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]Epoch 101:  80%|███████▉  | 250/313 [04:15<01:04,  0.98it/s, v_num=0, Train/loss_all_step=0.00646, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=3.270, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]Epoch 101:  80%|███████▉  | 250/313 [04:15<01:04,  0.98it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.350, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]  Epoch 101:  96%|█████████▌| 300/313 [05:04<00:13,  0.99it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.350, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]Epoch 101:  96%|█████████▌| 300/313 [05:04<00:13,  0.99it/s, v_num=0, Train/loss_all_step=0.00574, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.00129, Train/loss_recog_step=3.360, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]Epoch 101: 100%|██████████| 313/313 [05:12<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.00574, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.00129, Train/loss_recog_step=3.360, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]Epoch 101: 100%|██████████| 313/313 [05:12<00:00,  1.00it/s, v_num=0, Train/loss_all_step=0.00488, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.020, Valid/loss_all_step=0.321, Valid/loss_unet_all_step=0.494, Valid/loss_triplet_all_step=0.316, Valid/loss_recog_step=3.250, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.370, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.89it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.65it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.87it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.51it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.124929, 0.127246, 0.116282, 0.139664
Valid average loss UNet                 (all)                : 0.508121

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.081796, 1.674802, 3.678363
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.349179, 1.395401, 1.623560
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.866619, 2.022929, 1.555743
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.319230, 1.395323, 1.867133
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.307685, 1.796279, 2.389779
Valid average loss all      (Triplet)                 : 0.402484

== Recognize ==
Valid average loss Recognize     : 3.250431
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 43.500000 %
Valid average accuracy piano     : 49.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 46.000000 %

== Valid average loss all : 0.407565

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.117262840270996 sec. =
Valid knn accuracy drums     : 71.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.095852375030518 sec. =
Valid knn accuracy bass      : 18.548387096774192%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.397793292999268 sec. =
Valid knn accuracy piano     : 23.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3421125411987305 sec. =
Valid knn accuracy guitar    : 45.089285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.386825799942017 sec. =
Valid knn accuracy residuals : 40.22727272727273%

Valid knn accuracy average   : 39.72135867288392%

                                                                      [AEpoch 101: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00488, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.020, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00545, Train/loss_recog_epoch=3.220]Epoch 101: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.00488, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.020, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114729, 0.115397, 0.116086, 0.124045
Train average loss UNet                 (all)                : 0.470258

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003107, 1.327993, 4.228499
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008799, 1.115502, 2.443199
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006224, 1.238453, 2.610819
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007476, 1.184347, 2.665760
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003924, 1.514901, 3.262178
Train average loss all      (Triplet)                 : 0.005861

== Recognize ==
Train average loss Recognize     : 3.268216
Train average accuracy drums     : 49.910000 %
Train average accuracy bass      : 49.990002 %
Train average accuracy piano     : 50.489998 %
Train average accuracy guitar    : 49.990002 %
Train average accuracy residuals : 50.059998 %

== Train average loss all : 0.010564

Epoch 101:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00488, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.020, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]          Epoch 102:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00488, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.020, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]Epoch 102:  16%|█▌        | 50/313 [00:52<04:34,  0.96it/s, v_num=0, Train/loss_all_step=0.00488, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.020, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]Epoch 102:  16%|█▌        | 50/313 [00:52<04:34,  0.96it/s, v_num=0, Train/loss_all_step=0.00503, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.880, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]Epoch 102:  32%|███▏      | 100/313 [01:40<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.00503, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=2.880, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]Epoch 102:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.00858, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.00392, Train/loss_recog_step=3.160, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]Epoch 102:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.00858, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.00392, Train/loss_recog_step=3.160, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]Epoch 102:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0023, Train/loss_recog_step=3.350, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270] Epoch 102:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00709, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.0023, Train/loss_recog_step=3.350, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]Epoch 102:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.340, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270] Epoch 102:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.340, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]Epoch 102:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00869, Train/loss_unet_all_step=0.441, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=3.290, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]Epoch 102:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00869, Train/loss_unet_all_step=0.441, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=3.290, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]Epoch 102:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.00781, Train/loss_recog_step=3.120, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270] Epoch 102: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0123, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.00781, Train/loss_recog_step=3.120, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]Epoch 102: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=3.600, Valid/loss_all_step=0.422, Valid/loss_unet_all_step=0.510, Valid/loss_triplet_all_step=0.417, Valid/loss_recog_step=2.770, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.402, Valid/loss_recog_epoch=3.250, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  2.00it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.79it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.83it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.00it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.128694, 0.130151, 0.118709, 0.144033
Valid average loss UNet                 (all)                : 0.521587

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083631, 1.371772, 3.212390
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.393436, 1.318368, 1.488506
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.785203, 1.894527, 1.466188
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.300519, 1.367828, 1.849044
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.272301, 1.702423, 2.256734
Valid average loss all      (Triplet)                 : 0.381588

== Recognize ==
Valid average loss Recognize     : 3.307185
Valid average accuracy drums     : 42.500000 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 48.000000 %
Valid average accuracy residuals : 48.500000 %

== Valid average loss all : 0.386803

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.910637378692627 sec. =
Valid knn accuracy drums     : 68.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.908252239227295 sec. =
Valid knn accuracy bass      : 17.741935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.57758355140686 sec. =
Valid knn accuracy piano     : 25.1953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.547147274017334 sec. =
Valid knn accuracy guitar    : 45.982142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.96575403213501 sec. =
Valid knn accuracy residuals : 47.27272727272727%

Valid knn accuracy average   : 40.847119274922136%

                                                                      [AEpoch 102: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=3.600, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.470, Train/loss_triplet_all_epoch=0.00586, Train/loss_recog_epoch=3.270]Epoch 102: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=3.600, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114638, 0.115270, 0.115956, 0.123522
Train average loss UNet                 (all)                : 0.469387

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002627, 1.317633, 4.120567
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008816, 1.133578, 2.489890
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006403, 1.259980, 2.666073
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005014, 1.195428, 2.758116
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004310, 1.465110, 3.184614
Train average loss all      (Triplet)                 : 0.005568

== Recognize ==
Train average loss Recognize     : 3.262490
Train average accuracy drums     : 50.300003 %
Train average accuracy bass      : 49.834999 %
Train average accuracy piano     : 50.050003 %
Train average accuracy guitar    : 49.970001 %
Train average accuracy residuals : 49.910000 %

== Train average loss all : 0.010262

Epoch 102:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=3.600, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]          Epoch 103:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=3.600, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]Epoch 103:  16%|█▌        | 50/313 [00:54<04:47,  0.91it/s, v_num=0, Train/loss_all_step=0.00562, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=3.600, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]Epoch 103:  16%|█▌        | 50/313 [00:54<04:47,  0.91it/s, v_num=0, Train/loss_all_step=0.0159, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=3.100, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]   Epoch 103:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0159, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=3.100, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]Epoch 103:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00958, Train/loss_recog_step=3.280, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]Epoch 103:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0143, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00958, Train/loss_recog_step=3.280, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]Epoch 103:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.00746, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0026, Train/loss_recog_step=3.380, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]Epoch 103:  64%|██████▍   | 200/313 [03:20<01:53,  1.00it/s, v_num=0, Train/loss_all_step=0.00746, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0026, Train/loss_recog_step=3.380, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]Epoch 103:  64%|██████▍   | 200/313 [03:20<01:53,  1.00it/s, v_num=0, Train/loss_all_step=0.0237, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=3.070, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260] Epoch 103:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0237, Train/loss_unet_all_step=0.488, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=3.070, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]Epoch 103:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.00616, Train/loss_unet_all_step=0.433, Train/loss_triplet_all_step=0.00183, Train/loss_recog_step=3.530, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]Epoch 103:  96%|█████████▌| 300/313 [04:55<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.00616, Train/loss_unet_all_step=0.433, Train/loss_triplet_all_step=0.00183, Train/loss_recog_step=3.530, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]Epoch 103:  96%|█████████▌| 300/313 [04:55<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.00449, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.430, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]  Epoch 103: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00449, Train/loss_unet_all_step=0.449, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.430, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]Epoch 103: 100%|██████████| 313/313 [05:03<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.300, Valid/loss_all_step=0.359, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=2.780, Valid/loss_all_epoch=0.387, Valid/loss_unet_all_epoch=0.522, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=3.310, Valid/knn_avr=0.408, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.21it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.05it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.51it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125750, 0.129132, 0.118440, 0.139040
Valid average loss UNet                 (all)                : 0.512362

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.125202, 1.772861, 3.738770
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.369608, 1.446607, 1.604532
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.862686, 2.041343, 1.657735
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.288119, 1.464296, 2.135260
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.336315, 1.715258, 2.480697
Valid average loss all      (Triplet)                 : 0.414983

== Recognize ==
Valid average loss Recognize     : 3.436408
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 50.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.420107

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.321881532669067 sec. =
Valid knn accuracy drums     : 68.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.629913330078125 sec. =
Valid knn accuracy bass      : 19.959677419354836%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.127046585083008 sec. =
Valid knn accuracy piano     : 22.0703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.012133598327637 sec. =
Valid knn accuracy guitar    : 43.526785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.439975738525391 sec. =
Valid knn accuracy residuals : 43.86363636363637%

Valid knn accuracy average   : 39.4927780516293%

                                                                      [AEpoch 103: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.300, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00557, Train/loss_recog_epoch=3.260]Epoch 103: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.300, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114665, 0.115327, 0.115998, 0.123117
Train average loss UNet                 (all)                : 0.469108

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002922, 1.315270, 4.046521
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007980, 1.112008, 2.423835
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007146, 1.251982, 2.615325
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006370, 1.195292, 2.735783
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004589, 1.449888, 3.152164
Train average loss all      (Triplet)                 : 0.005877

== Recognize ==
Train average loss Recognize     : 3.313738
Train average accuracy drums     : 50.405003 %
Train average accuracy bass      : 49.274998 %
Train average accuracy piano     : 50.255001 %
Train average accuracy guitar    : 49.775002 %
Train average accuracy residuals : 49.735001 %

== Train average loss all : 0.010568

Epoch 103:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.300, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]          Epoch 104:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.300, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]Epoch 104:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.0045, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.300, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]Epoch 104:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.00806, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00316, Train/loss_recog_step=3.410, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]Epoch 104:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.00806, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00316, Train/loss_recog_step=3.410, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]Epoch 104:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=3.500, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]Epoch 104:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.00656, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=3.500, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]Epoch 104:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=3.130, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310] Epoch 104:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0103, Train/loss_unet_all_step=0.489, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=3.130, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]Epoch 104:  64%|██████▍   | 200/313 [03:16<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00531, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.000661, Train/loss_recog_step=3.200, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]Epoch 104:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00531, Train/loss_unet_all_step=0.464, Train/loss_triplet_all_step=0.000661, Train/loss_recog_step=3.200, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]Epoch 104:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00446, Train/loss_unet_all_step=0.446, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.480, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]   Epoch 104:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00446, Train/loss_unet_all_step=0.446, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.480, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]Epoch 104:  96%|█████████▌| 300/313 [04:51<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0203, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=3.410, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]Epoch 104: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0203, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=3.410, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]Epoch 104: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.680, Valid/loss_all_step=0.389, Valid/loss_unet_all_step=0.498, Valid/loss_triplet_all_step=0.384, Valid/loss_recog_step=3.540, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.415, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.82it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.70it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.27it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.76it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.132546, 0.132824, 0.121591, 0.128708
Valid average loss UNet                 (all)                : 0.515670

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.050896, 1.561446, 3.744076
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.373881, 1.378457, 1.591977
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.737263, 1.990818, 1.584041
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.310821, 1.431069, 2.155581
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.381422, 1.834042, 2.416136
Valid average loss all      (Triplet)                 : 0.390746

== Recognize ==
Valid average loss Recognize     : 3.717732
Valid average accuracy drums     : 57.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 44.500000 %

== Valid average loss all : 0.395903

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.27301812171936 sec. =
Valid knn accuracy drums     : 68.04347826086956%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.349295616149902 sec. =
Valid knn accuracy bass      : 17.338709677419356%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.23123550415039 sec. =
Valid knn accuracy piano     : 20.8984375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.343991041183472 sec. =
Valid knn accuracy guitar    : 49.55357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.086451530456543 sec. =
Valid knn accuracy residuals : 45.68181818181819%

Valid knn accuracy average   : 40.30320300973571%

                                                                      [AEpoch 104: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.680, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=3.310]Epoch 104: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.680, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114628, 0.115269, 0.115888, 0.123251
Train average loss UNet                 (all)                : 0.469035

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003318, 1.363357, 4.296122
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008110, 1.136271, 2.487806
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006027, 1.270231, 2.655769
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006114, 1.209957, 2.773687
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004298, 1.464552, 3.082384
Train average loss all      (Triplet)                 : 0.005805

== Recognize ==
Train average loss Recognize     : 3.415083
Train average accuracy drums     : 49.810001 %
Train average accuracy bass      : 50.849998 %
Train average accuracy piano     : 50.650002 %
Train average accuracy guitar    : 49.605000 %
Train average accuracy residuals : 49.450001 %

== Train average loss all : 0.010495

Epoch 104:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.680, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]          Epoch 105:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.680, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105:  16%|█▌        | 50/313 [00:52<04:33,  0.96it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.680, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105:  16%|█▌        | 50/313 [00:52<04:33,  0.96it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=3.720, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=3.720, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.00453, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.910, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420] Epoch 105:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.00453, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.910, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.0295, Train/loss_recog_step=3.420, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0345, Train/loss_unet_all_step=0.503, Train/loss_triplet_all_step=0.0295, Train/loss_recog_step=3.420, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0208, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=3.330, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0208, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=3.330, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00434, Train/loss_unet_all_step=0.434, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.390, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00434, Train/loss_unet_all_step=0.434, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.390, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00534, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000826, Train/loss_recog_step=3.300, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00534, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000826, Train/loss_recog_step=3.300, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105: 100%|██████████| 313/313 [04:59<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00432, Train/loss_unet_all_step=0.432, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.680, Valid/loss_all_step=0.353, Valid/loss_unet_all_step=0.485, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=4.480, Valid/loss_all_epoch=0.396, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.391, Valid/loss_recog_epoch=3.720, Valid/knn_avr=0.403, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.46it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.03it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.98it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.32it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.11it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126586, 0.129553, 0.118764, 0.136848
Valid average loss UNet                 (all)                : 0.511751

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099857, 1.582941, 3.866156
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.427919, 1.506833, 1.661151
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.823781, 2.179579, 1.750527
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.319148, 1.540556, 2.238588
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.350708, 1.952845, 2.617249
Valid average loss all      (Triplet)                 : 0.405716

== Recognize ==
Valid average loss Recognize     : 3.440034
Valid average accuracy drums     : 57.000000 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 43.500000 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 52.499996 %

== Valid average loss all : 0.410833

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.805853843688965 sec. =
Valid knn accuracy drums     : 70.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.374993085861206 sec. =
Valid knn accuracy bass      : 16.33064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.104200839996338 sec. =
Valid knn accuracy piano     : 22.8515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.16090440750122 sec. =
Valid knn accuracy guitar    : 41.74107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 6.959773778915405 sec. =
Valid knn accuracy residuals : 43.40909090909091%

Valid knn accuracy average   : 38.95343052152967%

                                                                      [AEpoch 105: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00432, Train/loss_unet_all_step=0.432, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.680, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.0058, Train/loss_recog_epoch=3.420]Epoch 105: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00432, Train/loss_unet_all_step=0.432, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.680, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114438, 0.115079, 0.115773, 0.122765
Train average loss UNet                 (all)                : 0.468054

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003006, 1.443988, 4.367814
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007691, 1.150113, 2.539788
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004355, 1.303793, 2.750918
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007758, 1.271272, 2.852966
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005113, 1.522216, 3.221529
Train average loss all      (Triplet)                 : 0.005779

== Recognize ==
Train average loss Recognize     : 3.448076
Train average accuracy drums     : 50.400002 %
Train average accuracy bass      : 50.024998 %
Train average accuracy piano     : 50.064999 %
Train average accuracy guitar    : 50.300003 %
Train average accuracy residuals : 49.575001 %

== Train average loss all : 0.010459

Epoch 105:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00432, Train/loss_unet_all_step=0.432, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.680, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]          Epoch 106:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00432, Train/loss_unet_all_step=0.432, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.680, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]Epoch 106:  16%|█▌        | 50/313 [00:55<04:50,  0.90it/s, v_num=0, Train/loss_all_step=0.00432, Train/loss_unet_all_step=0.432, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.680, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]Epoch 106:  16%|█▌        | 50/313 [00:55<04:50,  0.90it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00899, Train/loss_recog_step=3.480, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]Epoch 106:  32%|███▏      | 100/313 [01:45<03:44,  0.95it/s, v_num=0, Train/loss_all_step=0.0139, Train/loss_unet_all_step=0.490, Train/loss_triplet_all_step=0.00899, Train/loss_recog_step=3.480, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]Epoch 106:  32%|███▏      | 100/313 [01:45<03:44,  0.95it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=3.530, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450] Epoch 106:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.0199, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=3.530, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]Epoch 106:  48%|████▊     | 150/313 [02:33<02:46,  0.98it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.0064, Train/loss_recog_step=3.220, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]Epoch 106:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.0114, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.0064, Train/loss_recog_step=3.220, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]Epoch 106:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=3.260, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]Epoch 106:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.0069, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=3.260, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]Epoch 106:  80%|███████▉  | 250/313 [04:09<01:02,  1.00it/s, v_num=0, Train/loss_all_step=0.00556, Train/loss_unet_all_step=0.429, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=3.620, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]Epoch 106:  96%|█████████▌| 300/313 [04:56<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.00556, Train/loss_unet_all_step=0.429, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=3.620, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]Epoch 106:  96%|█████████▌| 300/313 [04:56<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.230, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]  Epoch 106: 100%|██████████| 313/313 [05:05<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00459, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.230, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]Epoch 106: 100%|██████████| 313/313 [05:05<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00444, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.160, Valid/loss_all_step=0.289, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.284, Valid/loss_recog_step=3.820, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.406, Valid/loss_recog_epoch=3.440, Valid/knn_avr=0.390, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.66it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.49it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.31it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.01it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.73it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.122453, 0.126630, 0.115794, 0.143943
Valid average loss UNet                 (all)                : 0.508820

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.074584, 1.508622, 3.648278
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.410205, 1.573993, 1.712356
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.651419, 2.003064, 1.793417
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.318760, 1.561406, 2.213408
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.342067, 1.880231, 2.498662
Valid average loss all      (Triplet)                 : 0.380309

== Recognize ==
Valid average loss Recognize     : 3.413983
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 51.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.385397

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.295783519744873 sec. =
Valid knn accuracy drums     : 72.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.24000334739685 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.237296342849731 sec. =
Valid knn accuracy piano     : 21.875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.349049806594849 sec. =
Valid knn accuracy guitar    : 39.50892857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.397848844528198 sec. =
Valid knn accuracy residuals : 44.77272727272727%

Valid knn accuracy average   : 39.54654856013551%

                                                                      [AEpoch 106: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00444, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.160, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00578, Train/loss_recog_epoch=3.450]Epoch 106: 100%|██████████| 313/313 [06:20<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00444, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.160, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114389, 0.115038, 0.115753, 0.122432
Train average loss UNet                 (all)                : 0.467612

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002850, 1.433812, 4.289711
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008329, 1.212890, 2.676314
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006396, 1.370702, 2.883741
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007263, 1.304623, 2.846955
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004307, 1.590988, 3.401593
Train average loss all      (Triplet)                 : 0.005852

== Recognize ==
Train average loss Recognize     : 3.504681
Train average accuracy drums     : 50.139999 %
Train average accuracy bass      : 50.300003 %
Train average accuracy piano     : 49.735001 %
Train average accuracy guitar    : 50.005001 %
Train average accuracy residuals : 49.814999 %

== Train average loss all : 0.010528

Epoch 106:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00444, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.160, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]          Epoch 107:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00444, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.160, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]Epoch 107:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.00444, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.160, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]Epoch 107:  16%|█▌        | 50/313 [00:53<04:39,  0.94it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.640, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]Epoch 107:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.640, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]Epoch 107:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.00734, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.00269, Train/loss_recog_step=3.530, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]Epoch 107:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.00734, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.00269, Train/loss_recog_step=3.530, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]Epoch 107:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.00665, Train/loss_recog_step=3.820, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500] Epoch 107:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0115, Train/loss_unet_all_step=0.484, Train/loss_triplet_all_step=0.00665, Train/loss_recog_step=3.820, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]Epoch 107:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.00754, Train/loss_recog_step=3.740, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]Epoch 107:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.459, Train/loss_triplet_all_step=0.00754, Train/loss_recog_step=3.740, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]Epoch 107:  80%|███████▉  | 250/313 [04:01<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00438, Train/loss_unet_all_step=0.438, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.490, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500] Epoch 107:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00438, Train/loss_unet_all_step=0.438, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.490, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]Epoch 107:  96%|█████████▌| 300/313 [04:49<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.00847, Train/loss_recog_step=3.370, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]Epoch 107: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.013, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.00847, Train/loss_recog_step=3.370, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]Epoch 107: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00472, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.190, Valid/loss_all_step=0.293, Valid/loss_unet_all_step=0.496, Valid/loss_triplet_all_step=0.288, Valid/loss_recog_step=3.340, Valid/loss_all_epoch=0.385, Valid/loss_unet_all_epoch=0.509, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.410, Valid/knn_avr=0.395, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.70it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.80it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.24it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.47it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.123599, 0.126409, 0.114735, 0.140330
Valid average loss UNet                 (all)                : 0.505072

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101557, 1.724255, 3.890168
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.455280, 1.449173, 1.431407
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.616094, 1.878065, 1.651653
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.283248, 1.507617, 2.002230
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.356854, 1.892973, 2.222353
Valid average loss all      (Triplet)                 : 0.371438

== Recognize ==
Valid average loss Recognize     : 3.329105
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 48.000000 %
Valid average accuracy guitar    : 50.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.376489

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.359375238418579 sec. =
Valid knn accuracy drums     : 75.43478260869566%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.64670705795288 sec. =
Valid knn accuracy bass      : 16.93548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.662307024002075 sec. =
Valid knn accuracy piano     : 20.703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.838989496231079 sec. =
Valid knn accuracy guitar    : 41.74107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.512479782104492 sec. =
Valid knn accuracy residuals : 39.54545454545455%

Valid knn accuracy average   : 38.87198349073787%

                                                                      [AEpoch 107: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00472, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.190, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.0105, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=3.500]Epoch 107: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00472, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.190, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114352, 0.114990, 0.115645, 0.122655
Train average loss UNet                 (all)                : 0.467642

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003116, 1.417857, 4.293422
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007135, 1.177514, 2.556000
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006017, 1.250861, 2.633440
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006161, 1.257610, 2.791736
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003903, 1.500741, 3.182659
Train average loss all      (Triplet)                 : 0.005343

== Recognize ==
Train average loss Recognize     : 3.505434
Train average accuracy drums     : 49.779999 %
Train average accuracy bass      : 49.955002 %
Train average accuracy piano     : 49.709999 %
Train average accuracy guitar    : 50.070000 %
Train average accuracy residuals : 50.089996 %

== Train average loss all : 0.010019

Epoch 107:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00472, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.190, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]          Epoch 108:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00472, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.190, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]Epoch 108:  16%|█▌        | 50/313 [00:55<04:53,  0.90it/s, v_num=0, Train/loss_all_step=0.00472, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.190, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]Epoch 108:  16%|█▌        | 50/313 [00:55<04:53,  0.90it/s, v_num=0, Train/loss_all_step=0.00481, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.500, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]Epoch 108:  32%|███▏      | 100/313 [01:43<03:39,  0.97it/s, v_num=0, Train/loss_all_step=0.00481, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.500, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]Epoch 108:  32%|███▏      | 100/313 [01:43<03:39,  0.97it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.240, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]Epoch 108:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.240, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]Epoch 108:  48%|████▊     | 150/313 [02:29<02:42,  1.00it/s, v_num=0, Train/loss_all_step=0.0067, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=3.560, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]Epoch 108:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.0067, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=3.560, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]Epoch 108:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.0055, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.000725, Train/loss_recog_step=3.550, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]Epoch 108:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0055, Train/loss_unet_all_step=0.478, Train/loss_triplet_all_step=0.000725, Train/loss_recog_step=3.550, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]Epoch 108:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.00715, Train/loss_recog_step=3.620, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510] Epoch 108:  96%|█████████▌| 300/313 [04:59<00:12,  1.00it/s, v_num=0, Train/loss_all_step=0.0116, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.00715, Train/loss_recog_step=3.620, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]Epoch 108:  96%|█████████▌| 300/313 [04:59<00:12,  1.00it/s, v_num=0, Train/loss_all_step=0.0247, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=3.740, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510] Epoch 108: 100%|██████████| 313/313 [05:07<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0247, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=3.740, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]Epoch 108: 100%|██████████| 313/313 [05:07<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.428, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.690, Valid/loss_all_step=0.296, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.291, Valid/loss_recog_step=2.620, Valid/loss_all_epoch=0.376, Valid/loss_unet_all_epoch=0.505, Valid/loss_triplet_all_epoch=0.371, Valid/loss_recog_epoch=3.330, Valid/knn_avr=0.389, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.04it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.93it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.89it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.68it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.51it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.98it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125908, 0.127987, 0.117182, 0.137289
Valid average loss UNet                 (all)                : 0.508367

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133036, 1.550380, 4.168028
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.299856, 1.497412, 1.788029
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.750339, 2.235646, 1.861755
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.334336, 1.724324, 2.371043
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.365786, 2.289892, 2.832938
Valid average loss all      (Triplet)                 : 0.393186

== Recognize ==
Valid average loss Recognize     : 3.846990
Valid average accuracy drums     : 51.500000 %
Valid average accuracy bass      : 49.000000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 43.500000 %
Valid average accuracy residuals : 52.000000 %

== Valid average loss all : 0.398270

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.585694789886475 sec. =
Valid knn accuracy drums     : 68.69565217391305%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.514770746231079 sec. =
Valid knn accuracy bass      : 13.709677419354838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.050670146942139 sec. =
Valid knn accuracy piano     : 23.2421875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.987999677658081 sec. =
Valid knn accuracy guitar    : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.296030521392822 sec. =
Valid knn accuracy residuals : 42.04545454545455%

Valid knn accuracy average   : 38.288594327744484%

                                                                      [AEpoch 108: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.428, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.690, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.010, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00534, Train/loss_recog_epoch=3.510]Epoch 108: 100%|██████████| 313/313 [06:25<00:00,  0.81it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.428, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.690, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114396, 0.115029, 0.115719, 0.123553
Train average loss UNet                 (all)                : 0.468697

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004507, 1.479829, 4.396339
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006401, 1.224713, 2.642584
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006843, 1.334044, 2.772617
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004759, 1.280737, 2.877825
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005180, 1.596903, 3.371229
Train average loss all      (Triplet)                 : 0.005384

== Recognize ==
Train average loss Recognize     : 3.507748
Train average accuracy drums     : 49.790001 %
Train average accuracy bass      : 50.349998 %
Train average accuracy piano     : 49.924999 %
Train average accuracy guitar    : 50.269997 %
Train average accuracy residuals : 50.164997 %

== Train average loss all : 0.010071

Epoch 108:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.428, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.690, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]          Epoch 109:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.428, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.690, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]Epoch 109:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.00428, Train/loss_unet_all_step=0.428, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.690, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]Epoch 109:  16%|█▌        | 50/313 [00:53<04:40,  0.94it/s, v_num=0, Train/loss_all_step=0.00873, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=3.600, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]Epoch 109:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.00873, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=3.600, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]Epoch 109:  32%|███▏      | 100/313 [01:39<03:32,  1.00it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.610, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]  Epoch 109:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.00474, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.610, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]Epoch 109:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.00714, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=3.490, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]Epoch 109:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00714, Train/loss_unet_all_step=0.493, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=3.490, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]Epoch 109:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0411, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.0364, Train/loss_recog_step=3.440, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510] Epoch 109:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0411, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.0364, Train/loss_recog_step=3.440, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]Epoch 109:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00756, Train/loss_unet_all_step=0.432, Train/loss_triplet_all_step=0.00324, Train/loss_recog_step=3.700, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]Epoch 109:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00756, Train/loss_unet_all_step=0.432, Train/loss_triplet_all_step=0.00324, Train/loss_recog_step=3.700, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]Epoch 109:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=3.650, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510] Epoch 109: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.00591, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=3.650, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]Epoch 109: 100%|██████████| 313/313 [04:58<00:00,  1.05it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00808, Train/loss_recog_step=3.960, Valid/loss_all_step=0.214, Valid/loss_unet_all_step=0.481, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=4.440, Valid/loss_all_epoch=0.398, Valid/loss_unet_all_epoch=0.508, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=3.850, Valid/knn_avr=0.383, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.95it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.73it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.06it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.77it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.20it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125577, 0.127839, 0.117307, 0.140021
Valid average loss UNet                 (all)                : 0.510745

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.084555, 1.751918, 3.930554
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.325933, 1.500917, 1.781029
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.768431, 2.128304, 1.783744
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.405665, 1.655190, 2.044161
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.279379, 1.909524, 2.410579
Valid average loss all      (Triplet)                 : 0.376218

== Recognize ==
Valid average loss Recognize     : 3.604993
Valid average accuracy drums     : 49.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.381326

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.381560325622559 sec. =
Valid knn accuracy drums     : 70.86956521739131%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.649554967880249 sec. =
Valid knn accuracy bass      : 19.153225806451612%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.158994197845459 sec. =
Valid knn accuracy piano     : 19.3359375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.779568195343018 sec. =
Valid knn accuracy guitar    : 43.526785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.2399680614471436 sec. =
Valid knn accuracy residuals : 41.36363636363637%

Valid knn accuracy average   : 38.849830120353005%

                                                                      [AEpoch 109: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00808, Train/loss_recog_step=3.960, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.469, Train/loss_triplet_all_epoch=0.00538, Train/loss_recog_epoch=3.510]Epoch 109: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00808, Train/loss_recog_step=3.960, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114413, 0.115042, 0.115686, 0.122978
Train average loss UNet                 (all)                : 0.468119

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005418, 1.558520, 4.604823
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009661, 1.279431, 2.726498
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005986, 1.360214, 2.816549
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007538, 1.354170, 2.989193
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005296, 1.625956, 3.362359
Train average loss all      (Triplet)                 : 0.006751

== Recognize ==
Train average loss Recognize     : 3.585809
Train average accuracy drums     : 49.820000 %
Train average accuracy bass      : 50.389999 %
Train average accuracy piano     : 50.059998 %
Train average accuracy guitar    : 50.195004 %
Train average accuracy residuals : 50.295002 %

== Train average loss all : 0.011432

Epoch 109:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00808, Train/loss_recog_step=3.960, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]          Epoch 110:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00808, Train/loss_recog_step=3.960, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]Epoch 110:  16%|█▌        | 50/313 [00:54<04:45,  0.92it/s, v_num=0, Train/loss_all_step=0.0128, Train/loss_unet_all_step=0.468, Train/loss_triplet_all_step=0.00808, Train/loss_recog_step=3.960, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]Epoch 110:  16%|█▌        | 50/313 [00:54<04:45,  0.92it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=3.630, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590] Epoch 110:  32%|███▏      | 100/313 [01:43<03:39,  0.97it/s, v_num=0, Train/loss_all_step=0.0153, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=3.630, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]Epoch 110:  32%|███▏      | 100/313 [01:43<03:39,  0.97it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.00223, Train/loss_recog_step=4.040, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]Epoch 110:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.00677, Train/loss_unet_all_step=0.454, Train/loss_triplet_all_step=0.00223, Train/loss_recog_step=4.040, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]Epoch 110:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=3.590, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]  Epoch 110:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0182, Train/loss_unet_all_step=0.507, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=3.590, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]Epoch 110:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.00458, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.720, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]Epoch 110:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.00458, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.720, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]Epoch 110:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.00828, Train/loss_unet_all_step=0.433, Train/loss_triplet_all_step=0.00395, Train/loss_recog_step=4.000, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]Epoch 110:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.00828, Train/loss_unet_all_step=0.433, Train/loss_triplet_all_step=0.00395, Train/loss_recog_step=4.000, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]Epoch 110:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.456, Train/loss_triplet_all_step=0.0018, Train/loss_recog_step=3.590, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590] Epoch 110: 100%|██████████| 313/313 [05:02<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00636, Train/loss_unet_all_step=0.456, Train/loss_triplet_all_step=0.0018, Train/loss_recog_step=3.590, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]Epoch 110: 100%|██████████| 313/313 [05:02<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00434, Train/loss_unet_all_step=0.434, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=4.000, Valid/loss_all_step=0.340, Valid/loss_unet_all_step=0.499, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=3.270, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.511, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=3.600, Valid/knn_avr=0.388, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.65it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.35it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.69it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.48it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.17it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125837, 0.128299, 0.117550, 0.129087
Valid average loss UNet                 (all)                : 0.500774

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090197, 1.761451, 4.058845
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.473151, 1.756343, 1.764414
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.834353, 2.165900, 1.800958
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.321148, 1.664837, 2.236527
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.279311, 1.871985, 2.498333
Valid average loss all      (Triplet)                 : 0.407050

== Recognize ==
Valid average loss Recognize     : 3.809328
Valid average accuracy drums     : 52.000000 %
Valid average accuracy bass      : 49.500000 %
Valid average accuracy piano     : 51.500000 %
Valid average accuracy guitar    : 46.500000 %
Valid average accuracy residuals : 50.000000 %

== Valid average loss all : 0.412057

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.380266904830933 sec. =
Valid knn accuracy drums     : 66.30434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.11034893989563 sec. =
Valid knn accuracy bass      : 11.895161290322582%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.617064952850342 sec. =
Valid knn accuracy piano     : 22.65625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.664815664291382 sec. =
Valid knn accuracy guitar    : 43.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.092883586883545 sec. =
Valid knn accuracy residuals : 45.0%

Valid knn accuracy average   : 37.9211518232819%

                                                                      [AEpoch 110: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00434, Train/loss_unet_all_step=0.434, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=4.000, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0114, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00675, Train/loss_recog_epoch=3.590]Epoch 110: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00434, Train/loss_unet_all_step=0.434, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=4.000, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114277, 0.114936, 0.115621, 0.122915
Train average loss UNet                 (all)                : 0.467748

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002673, 1.550103, 4.518207
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007990, 1.278499, 2.723259
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006549, 1.410637, 2.921962
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007719, 1.388387, 3.006794
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003321, 1.675635, 3.439454
Train average loss all      (Triplet)                 : 0.005626

== Recognize ==
Train average loss Recognize     : 3.686181
Train average accuracy drums     : 50.080002 %
Train average accuracy bass      : 49.599998 %
Train average accuracy piano     : 49.910000 %
Train average accuracy guitar    : 49.759998 %
Train average accuracy residuals : 50.400002 %

== Train average loss all : 0.010303

Epoch 110:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00434, Train/loss_unet_all_step=0.434, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=4.000, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]          Epoch 111:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00434, Train/loss_unet_all_step=0.434, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=4.000, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]Epoch 111:  16%|█▌        | 50/313 [00:52<04:34,  0.96it/s, v_num=0, Train/loss_all_step=0.00434, Train/loss_unet_all_step=0.434, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=4.000, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]Epoch 111:  16%|█▌        | 50/313 [00:52<04:35,  0.96it/s, v_num=0, Train/loss_all_step=0.00796, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.00316, Train/loss_recog_step=3.960, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]Epoch 111:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.00796, Train/loss_unet_all_step=0.480, Train/loss_triplet_all_step=0.00316, Train/loss_recog_step=3.960, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]Epoch 111:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.00465, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.320, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]  Epoch 111:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.00465, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.320, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]Epoch 111:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.00964, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=4.070, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]Epoch 111:  64%|██████▍   | 200/313 [03:14<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.00964, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=4.070, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]Epoch 111:  64%|██████▍   | 200/313 [03:14<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.00714, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.0026, Train/loss_recog_step=3.870, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690] Epoch 111:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00714, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.0026, Train/loss_recog_step=3.870, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]Epoch 111:  80%|███████▉  | 250/313 [04:02<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00432, Train/loss_unet_all_step=0.432, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.880, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690] Epoch 111:  96%|█████████▌| 300/313 [04:48<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00432, Train/loss_unet_all_step=0.432, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.880, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]Epoch 111:  96%|█████████▌| 300/313 [04:48<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.00605, Train/loss_recog_step=3.750, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]Epoch 111: 100%|██████████| 313/313 [04:56<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.00605, Train/loss_recog_step=3.750, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]Epoch 111: 100%|██████████| 313/313 [04:56<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.820, Valid/loss_all_step=0.393, Valid/loss_unet_all_step=0.458, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=4.240, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.501, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.64it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.49it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.56it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.04it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.82it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.127073, 0.128753, 0.117424, 0.142655
Valid average loss UNet                 (all)                : 0.515905

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080973, 1.860168, 4.034628
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.375456, 1.620631, 1.757643
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.603374, 1.852426, 1.659243
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.343418, 1.703538, 2.467970
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.326861, 2.175752, 2.572989
Valid average loss all      (Triplet)                 : 0.336003

== Recognize ==
Valid average loss Recognize     : 3.521241
Valid average accuracy drums     : 56.000000 %
Valid average accuracy bass      : 58.999996 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 56.500000 %
Valid average accuracy residuals : 44.000000 %

== Valid average loss all : 0.341162

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3799662590026855 sec. =
Valid knn accuracy drums     : 72.82608695652173%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.04616093635559 sec. =
Valid knn accuracy bass      : 14.717741935483872%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.498390436172485 sec. =
Valid knn accuracy piano     : 21.6796875%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.648852348327637 sec. =
Valid knn accuracy guitar    : 49.55357142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.673543691635132 sec. =
Valid knn accuracy residuals : 38.40909090909091%

Valid knn accuracy average   : 39.4372357459336%

                                                                      [AEpoch 111: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.820, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.468, Train/loss_triplet_all_epoch=0.00563, Train/loss_recog_epoch=3.690]Epoch 111: 100%|██████████| 313/313 [06:14<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.820, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114309, 0.114934, 0.115584, 0.122223
Train average loss UNet                 (all)                : 0.467050

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002358, 1.547204, 4.597559
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006732, 1.283558, 2.745787
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008562, 1.405097, 2.896881
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007577, 1.403729, 3.002061
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004781, 1.671052, 3.445082
Train average loss all      (Triplet)                 : 0.005968

== Recognize ==
Train average loss Recognize     : 3.668195
Train average accuracy drums     : 50.279999 %
Train average accuracy bass      : 50.019997 %
Train average accuracy piano     : 50.174999 %
Train average accuracy guitar    : 50.305004 %
Train average accuracy residuals : 49.630001 %

== Train average loss all : 0.010639

Epoch 111:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.820, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]          Epoch 112:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.820, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]Epoch 112:  16%|█▌        | 50/313 [00:52<04:36,  0.95it/s, v_num=0, Train/loss_all_step=0.00452, Train/loss_unet_all_step=0.452, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.820, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]Epoch 112:  16%|█▌        | 50/313 [00:52<04:36,  0.95it/s, v_num=0, Train/loss_all_step=0.0314, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0265, Train/loss_recog_step=3.950, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]Epoch 112:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.0314, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.0265, Train/loss_recog_step=3.950, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]Epoch 112:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=3.660, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]Epoch 112:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.00617, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=3.660, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]Epoch 112:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.00492, Train/loss_recog_step=3.660, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]  Epoch 112:  64%|██████▍   | 200/313 [03:13<01:49,  1.04it/s, v_num=0, Train/loss_all_step=0.010, Train/loss_unet_all_step=0.511, Train/loss_triplet_all_step=0.00492, Train/loss_recog_step=3.660, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]Epoch 112:  64%|██████▍   | 200/313 [03:13<01:49,  1.04it/s, v_num=0, Train/loss_all_step=0.00898, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.00417, Train/loss_recog_step=3.440, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]Epoch 112:  80%|███████▉  | 250/313 [04:00<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00898, Train/loss_unet_all_step=0.481, Train/loss_triplet_all_step=0.00417, Train/loss_recog_step=3.440, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]Epoch 112:  80%|███████▉  | 250/313 [04:00<01:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00739, Train/loss_unet_all_step=0.437, Train/loss_triplet_all_step=0.00301, Train/loss_recog_step=3.680, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]Epoch 112:  96%|█████████▌| 300/313 [04:47<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00739, Train/loss_unet_all_step=0.437, Train/loss_triplet_all_step=0.00301, Train/loss_recog_step=3.680, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]Epoch 112:  96%|█████████▌| 300/313 [04:47<00:12,  1.04it/s, v_num=0, Train/loss_all_step=0.00444, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=4.070, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]  Epoch 112: 100%|██████████| 313/313 [04:55<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.00444, Train/loss_unet_all_step=0.444, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=4.070, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]Epoch 112: 100%|██████████| 313/313 [04:55<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.840, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.491, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=3.500, Valid/loss_all_epoch=0.341, Valid/loss_unet_all_epoch=0.516, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=3.520, Valid/knn_avr=0.394, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.78it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.22it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.98it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.37it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.96it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125725, 0.127959, 0.116477, 0.147684
Valid average loss UNet                 (all)                : 0.517846

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.074632, 1.839051, 4.491973
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.378990, 1.678708, 1.834013
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.805455, 2.292472, 1.873563
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.342906, 1.742640, 2.414476
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.275141, 2.096196, 2.563575
Valid average loss all      (Triplet)                 : 0.373202

== Recognize ==
Valid average loss Recognize     : 3.810263
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 45.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 51.500000 %

== Valid average loss all : 0.378381

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.962092638015747 sec. =
Valid knn accuracy drums     : 66.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.199401378631592 sec. =
Valid knn accuracy bass      : 17.741935483870968%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.152490139007568 sec. =
Valid knn accuracy piano     : 22.65625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.449670314788818 sec. =
Valid knn accuracy guitar    : 43.526785714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.236898183822632 sec. =
Valid knn accuracy residuals : 38.63636363636363%

Valid knn accuracy average   : 37.86009305386059%

                                                                      [AEpoch 112: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.840, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00597, Train/loss_recog_epoch=3.670]Epoch 112: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.840, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114128, 0.114734, 0.115466, 0.122552
Train average loss UNet                 (all)                : 0.466879

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004021, 1.631609, 4.683424
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005941, 1.312756, 2.839541
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006429, 1.426494, 2.953615
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006852, 1.451096, 3.096934
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004293, 1.697810, 3.514523
Train average loss all      (Triplet)                 : 0.005435

== Recognize ==
Train average loss Recognize     : 3.706973
Train average accuracy drums     : 49.759998 %
Train average accuracy bass      : 50.094997 %
Train average accuracy piano     : 49.880001 %
Train average accuracy guitar    : 49.590000 %
Train average accuracy residuals : 50.370003 %

== Train average loss all : 0.010103

Epoch 112:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.840, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]          Epoch 113:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.840, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]Epoch 113:  16%|█▌        | 50/313 [00:53<04:43,  0.93it/s, v_num=0, Train/loss_all_step=0.00475, Train/loss_unet_all_step=0.475, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.840, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]Epoch 113:  16%|█▌        | 50/313 [00:53<04:43,  0.93it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=3.710, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]Epoch 113:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.483, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=3.710, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]Epoch 113:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0258, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=3.680, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]Epoch 113:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.0258, Train/loss_unet_all_step=0.461, Train/loss_triplet_all_step=0.0212, Train/loss_recog_step=3.680, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]Epoch 113:  48%|████▊     | 150/313 [02:27<02:40,  1.02it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.00779, Train/loss_recog_step=3.450, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]Epoch 113:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.0126, Train/loss_unet_all_step=0.485, Train/loss_triplet_all_step=0.00779, Train/loss_recog_step=3.450, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]Epoch 113:  64%|██████▍   | 200/313 [03:15<01:50,  1.02it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.790, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710] Epoch 113:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.790, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]Epoch 113:  80%|███████▉  | 250/313 [04:03<01:01,  1.03it/s, v_num=0, Train/loss_all_step=0.0044, Train/loss_unet_all_step=0.440, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.650, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710] Epoch 113:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0044, Train/loss_unet_all_step=0.440, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.650, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]Epoch 113:  96%|█████████▌| 300/313 [04:50<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.700, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]Epoch 113: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00455, Train/loss_unet_all_step=0.455, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.700, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]Epoch 113: 100%|██████████| 313/313 [04:59<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00482, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.000153, Train/loss_recog_step=3.360, Valid/loss_all_step=0.228, Valid/loss_unet_all_step=0.511, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=3.950, Valid/loss_all_epoch=0.378, Valid/loss_unet_all_epoch=0.518, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=3.810, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.58it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.85it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.29it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.99it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.00it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.10it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126243, 0.127758, 0.116785, 0.138811
Valid average loss UNet                 (all)                : 0.509596

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054025, 1.697876, 3.919502
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.420581, 1.640604, 1.828505
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.716966, 2.169047, 1.895410
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.336608, 1.764390, 2.389724
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.249163, 2.117433, 2.671742
Valid average loss all      (Triplet)                 : 0.363301

== Recognize ==
Valid average loss Recognize     : 3.892952
Valid average accuracy drums     : 53.500004 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 49.500000 %
Valid average accuracy guitar    : 50.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.368397

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.496932506561279 sec. =
Valid knn accuracy drums     : 70.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.003124713897705 sec. =
Valid knn accuracy bass      : 11.693548387096774%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.39656400680542 sec. =
Valid knn accuracy piano     : 22.8515625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.843707084655762 sec. =
Valid knn accuracy guitar    : 51.5625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.335204124450684 sec. =
Valid knn accuracy residuals : 43.86363636363637%

Valid knn accuracy average   : 39.99424945014663%

                                                                      [AEpoch 113: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00482, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.000153, Train/loss_recog_step=3.360, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0101, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00543, Train/loss_recog_epoch=3.710]Epoch 113: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00482, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.000153, Train/loss_recog_step=3.360, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114150, 0.114874, 0.115465, 0.121751
Train average loss UNet                 (all)                : 0.466240

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004103, 1.687057, 4.841644
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007631, 1.331378, 2.867686
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006011, 1.450851, 2.956160
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005701, 1.469962, 3.108431
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005061, 1.743864, 3.571340
Train average loss all      (Triplet)                 : 0.005669

== Recognize ==
Train average loss Recognize     : 3.756685
Train average accuracy drums     : 49.555000 %
Train average accuracy bass      : 50.169998 %
Train average accuracy piano     : 49.904999 %
Train average accuracy guitar    : 49.614998 %
Train average accuracy residuals : 50.255001 %

== Train average loss all : 0.010331

Epoch 113:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00482, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.000153, Train/loss_recog_step=3.360, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]          Epoch 114:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00482, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.000153, Train/loss_recog_step=3.360, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]Epoch 114:  16%|█▌        | 50/313 [00:54<04:47,  0.92it/s, v_num=0, Train/loss_all_step=0.00482, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.000153, Train/loss_recog_step=3.360, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]Epoch 114:  16%|█▌        | 50/313 [00:54<04:47,  0.92it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.00723, Train/loss_recog_step=4.000, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]  Epoch 114:  32%|███▏      | 100/313 [01:43<03:39,  0.97it/s, v_num=0, Train/loss_all_step=0.0121, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.00723, Train/loss_recog_step=4.000, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]Epoch 114:  32%|███▏      | 100/313 [01:43<03:39,  0.97it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.470, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760] Epoch 114:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.470, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]Epoch 114:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0099, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.00508, Train/loss_recog_step=4.060, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]Epoch 114:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.0099, Train/loss_unet_all_step=0.482, Train/loss_triplet_all_step=0.00508, Train/loss_recog_step=4.060, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]Epoch 114:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.670, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760] Epoch 114:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.00466, Train/loss_unet_all_step=0.466, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.670, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]Epoch 114:  80%|███████▉  | 250/313 [04:05<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.436, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=3.490, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]Epoch 114:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.0207, Train/loss_unet_all_step=0.436, Train/loss_triplet_all_step=0.0163, Train/loss_recog_step=3.490, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]Epoch 114:  96%|█████████▌| 300/313 [04:52<00:12,  1.03it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.00174, Train/loss_recog_step=3.480, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]Epoch 114: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00621, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.00174, Train/loss_recog_step=3.480, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]Epoch 114: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00436, Train/loss_unet_all_step=0.436, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.920, Valid/loss_all_step=0.292, Valid/loss_unet_all_step=0.509, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=4.150, Valid/loss_all_epoch=0.368, Valid/loss_unet_all_epoch=0.510, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=3.890, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.61it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.86it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.05it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.10it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.32it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126006, 0.128388, 0.117147, 0.140103
Valid average loss UNet                 (all)                : 0.511644

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.072552, 1.821761, 3.719746
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.256538, 1.584652, 1.882572
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.832803, 2.239505, 1.814087
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.401726, 1.923406, 2.297526
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.330770, 1.981037, 2.412763
Valid average loss all      (Triplet)                 : 0.389340

== Recognize ==
Valid average loss Recognize     : 3.786858
Valid average accuracy drums     : 48.000000 %
Valid average accuracy bass      : 46.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 46.500000 %

== Valid average loss all : 0.394456

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.213427782058716 sec. =
Valid knn accuracy drums     : 71.73913043478261%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.954482078552246 sec. =
Valid knn accuracy bass      : 14.717741935483872%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.101228713989258 sec. =
Valid knn accuracy piano     : 23.6328125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.346226692199707 sec. =
Valid knn accuracy guitar    : 41.07142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.020263433456421 sec. =
Valid knn accuracy residuals : 47.27272727272727%

Valid knn accuracy average   : 39.68676814288446%

                                                                      [AEpoch 114: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00436, Train/loss_unet_all_step=0.436, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.920, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0103, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00567, Train/loss_recog_epoch=3.760]Epoch 114: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.00436, Train/loss_unet_all_step=0.436, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.920, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114126, 0.114793, 0.115437, 0.122046
Train average loss UNet                 (all)                : 0.466402

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002763, 1.642946, 4.710332
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007420, 1.398407, 2.969875
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006164, 1.476507, 2.997763
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006005, 1.504971, 3.181201
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005183, 1.710168, 3.529968
Train average loss all      (Triplet)                 : 0.005503

== Recognize ==
Train average loss Recognize     : 3.767089
Train average accuracy drums     : 50.139999 %
Train average accuracy bass      : 50.195004 %
Train average accuracy piano     : 49.639999 %
Train average accuracy guitar    : 49.584999 %
Train average accuracy residuals : 50.059998 %

== Train average loss all : 0.010167

Epoch 114:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00436, Train/loss_unet_all_step=0.436, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.920, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]          Epoch 115:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00436, Train/loss_unet_all_step=0.436, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.920, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115:  16%|█▌        | 50/313 [00:51<04:32,  0.97it/s, v_num=0, Train/loss_all_step=0.00436, Train/loss_unet_all_step=0.436, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.920, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115:  16%|█▌        | 50/313 [00:51<04:32,  0.97it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00545, Train/loss_recog_step=3.490, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00545, Train/loss_recog_step=3.490, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=3.650, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.0124, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=3.650, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115:  48%|████▊     | 150/313 [02:26<02:39,  1.02it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.00874, Train/loss_recog_step=3.530, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0137, Train/loss_unet_all_step=0.492, Train/loss_triplet_all_step=0.00874, Train/loss_recog_step=3.530, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115:  64%|██████▍   | 200/313 [03:13<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.00593, Train/loss_recog_step=4.010, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115:  80%|███████▉  | 250/313 [04:02<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.0105, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.00593, Train/loss_recog_step=4.010, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115:  80%|███████▉  | 250/313 [04:02<01:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00513, Train/loss_unet_all_step=0.431, Train/loss_triplet_all_step=0.000823, Train/loss_recog_step=3.920, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115:  96%|█████████▌| 300/313 [04:46<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.00513, Train/loss_unet_all_step=0.431, Train/loss_triplet_all_step=0.000823, Train/loss_recog_step=3.920, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115:  96%|█████████▌| 300/313 [04:46<00:12,  1.05it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.451, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=3.690, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]   Epoch 115: 100%|██████████| 313/313 [04:54<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.0184, Train/loss_unet_all_step=0.451, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=3.690, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115: 100%|██████████| 313/313 [04:54<00:00,  1.06it/s, v_num=0, Train/loss_all_step=0.0217, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=3.540, Valid/loss_all_step=0.319, Valid/loss_unet_all_step=0.516, Valid/loss_triplet_all_step=0.314, Valid/loss_recog_step=3.730, Valid/loss_all_epoch=0.394, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=3.790, Valid/knn_avr=0.397, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.99it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  4.79it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.93it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.20it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.36it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.126017, 0.127833, 0.116487, 0.143500
Valid average loss UNet                 (all)                : 0.513837

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.146241, 2.033402, 4.325201
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.332240, 1.707007, 2.040880
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.763054, 2.285051, 2.061087
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.391483, 1.802830, 2.600551
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.379675, 2.272599, 2.781881
Valid average loss all      (Triplet)                 : 0.396644

== Recognize ==
Valid average loss Recognize     : 3.506305
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 52.000000 %
Valid average accuracy piano     : 50.000000 %
Valid average accuracy guitar    : 54.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.401783

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.662851095199585 sec. =
Valid knn accuracy drums     : 75.65217391304347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.5354483127594 sec. =
Valid knn accuracy bass      : 14.919354838709678%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.57713508605957 sec. =
Valid knn accuracy piano     : 22.4609375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.877996206283569 sec. =
Valid knn accuracy guitar    : 39.732142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.554517984390259 sec. =
Valid knn accuracy residuals : 47.04545454545455%

Valid knn accuracy average   : 39.962012730870114%

                                                                      [AEpoch 115: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0217, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=3.540, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.0102, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.0055, Train/loss_recog_epoch=3.770]Epoch 115: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.0217, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=3.540, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114175, 0.114801, 0.115478, 0.122351
Train average loss UNet                 (all)                : 0.466806

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003081, 1.679883, 4.911625
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006733, 1.392105, 2.965262
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003303, 1.477583, 3.060496
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007494, 1.505463, 3.196086
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003896, 1.732913, 3.619053
Train average loss all      (Triplet)                 : 0.004939

== Recognize ==
Train average loss Recognize     : 3.721197
Train average accuracy drums     : 49.895000 %
Train average accuracy bass      : 50.180000 %
Train average accuracy piano     : 49.779999 %
Train average accuracy guitar    : 50.290001 %
Train average accuracy residuals : 50.035000 %

== Train average loss all : 0.009607

Epoch 115:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0217, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=3.540, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]          Epoch 116:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0217, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=3.540, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]Epoch 116:  16%|█▌        | 50/313 [00:55<04:49,  0.91it/s, v_num=0, Train/loss_all_step=0.0217, Train/loss_unet_all_step=0.465, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=3.540, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]Epoch 116:  16%|█▌        | 50/313 [00:55<04:49,  0.91it/s, v_num=0, Train/loss_all_step=0.00559, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000847, Train/loss_recog_step=3.860, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]Epoch 116:  32%|███▏      | 100/313 [01:44<03:43,  0.96it/s, v_num=0, Train/loss_all_step=0.00559, Train/loss_unet_all_step=0.474, Train/loss_triplet_all_step=0.000847, Train/loss_recog_step=3.860, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]Epoch 116:  32%|███▏      | 100/313 [01:44<03:43,  0.96it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.00218, Train/loss_recog_step=3.220, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720] Epoch 116:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.00691, Train/loss_unet_all_step=0.472, Train/loss_triplet_all_step=0.00218, Train/loss_recog_step=3.220, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]Epoch 116:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.00749, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=3.740, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]Epoch 116:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.00749, Train/loss_unet_all_step=0.477, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=3.740, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]Epoch 116:  64%|██████▍   | 200/313 [03:19<01:52,  1.00it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.570, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]  Epoch 116:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.00471, Train/loss_unet_all_step=0.471, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.570, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]Epoch 116:  80%|███████▉  | 250/313 [04:07<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.446, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=3.540, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]Epoch 116:  96%|█████████▌| 300/313 [04:54<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.00614, Train/loss_unet_all_step=0.446, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=3.540, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]Epoch 116:  96%|█████████▌| 300/313 [04:54<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.00453, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.380, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]  Epoch 116: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00453, Train/loss_unet_all_step=0.453, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.380, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]Epoch 116: 100%|██████████| 313/313 [05:02<00:00,  1.03it/s, v_num=0, Train/loss_all_step=0.00462, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.500, Valid/loss_all_step=0.218, Valid/loss_unet_all_step=0.507, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=2.940, Valid/loss_all_epoch=0.402, Valid/loss_unet_all_epoch=0.514, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=3.510, Valid/knn_avr=0.400, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.84it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.98it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.53it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  4.44it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.72it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.125945, 0.128629, 0.117678, 0.139429
Valid average loss UNet                 (all)                : 0.511681

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.117477, 1.855247, 4.505770
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.423746, 1.756230, 1.861258
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.799561, 2.178775, 1.986071
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.314969, 1.743505, 2.417432
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.331338, 2.057117, 2.792971
Valid average loss all      (Triplet)                 : 0.380490

== Recognize ==
Valid average loss Recognize     : 3.627333
Valid average accuracy drums     : 47.500000 %
Valid average accuracy bass      : 44.000000 %
Valid average accuracy piano     : 53.500004 %
Valid average accuracy guitar    : 49.000000 %
Valid average accuracy residuals : 56.000000 %

== Valid average loss all : 0.385607

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.686995029449463 sec. =
Valid knn accuracy drums     : 69.34782608695652%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.673435926437378 sec. =
Valid knn accuracy bass      : 17.540322580645164%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.466191053390503 sec. =
Valid knn accuracy piano     : 20.703125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.3127100467681885 sec. =
Valid knn accuracy guitar    : 41.74107142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.216430425643921 sec. =
Valid knn accuracy residuals : 44.09090909090909%

Valid knn accuracy average   : 38.68465083741645%

                                                                      [AEpoch 116: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00462, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.500, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00961, Train/loss_unet_all_epoch=0.467, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=3.720]Epoch 116: 100%|██████████| 313/313 [06:21<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00462, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.500, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114127, 0.114745, 0.115439, 0.121951
Train average loss UNet                 (all)                : 0.466261

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003874, 1.663110, 4.952355
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007081, 1.381018, 2.986476
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004027, 1.471619, 3.090764
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007480, 1.485025, 3.197208
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003601, 1.739515, 3.653422
Train average loss all      (Triplet)                 : 0.005243

== Recognize ==
Train average loss Recognize     : 3.656980
Train average accuracy drums     : 50.470001 %
Train average accuracy bass      : 50.000000 %
Train average accuracy piano     : 50.125004 %
Train average accuracy guitar    : 50.800003 %
Train average accuracy residuals : 49.639999 %

== Train average loss all : 0.009906

Epoch 116:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00462, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.500, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]          Epoch 117:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00462, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.500, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]Epoch 117:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.00462, Train/loss_unet_all_step=0.462, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.500, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]Epoch 117:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.00712, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.00214, Train/loss_recog_step=3.080, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]Epoch 117:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.00712, Train/loss_unet_all_step=0.498, Train/loss_triplet_all_step=0.00214, Train/loss_recog_step=3.080, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]Epoch 117:  32%|███▏      | 100/313 [01:42<03:37,  0.98it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.0052, Train/loss_recog_step=3.410, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660] Epoch 117:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.00987, Train/loss_unet_all_step=0.467, Train/loss_triplet_all_step=0.0052, Train/loss_recog_step=3.410, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]Epoch 117:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.00946, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=3.740, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]Epoch 117:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.00946, Train/loss_unet_all_step=0.491, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=3.740, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]Epoch 117:  64%|██████▍   | 200/313 [03:21<01:53,  0.99it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00124, Train/loss_recog_step=3.640, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]Epoch 117:  80%|███████▉  | 250/313 [04:11<01:03,  0.99it/s, v_num=0, Train/loss_all_step=0.00593, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.00124, Train/loss_recog_step=3.640, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]Epoch 117:  80%|███████▉  | 250/313 [04:11<01:03,  0.99it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.431, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=3.790, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]   Epoch 117:  96%|█████████▌| 300/313 [04:58<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.016, Train/loss_unet_all_step=0.431, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=3.790, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]Epoch 117:  96%|█████████▌| 300/313 [04:58<00:12,  1.01it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.00599, Train/loss_recog_step=3.700, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]Epoch 117: 100%|██████████| 313/313 [05:07<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.0104, Train/loss_unet_all_step=0.445, Train/loss_triplet_all_step=0.00599, Train/loss_recog_step=3.700, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]Epoch 117: 100%|██████████| 313/313 [05:07<00:00,  1.02it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.730, Valid/loss_all_step=0.168, Valid/loss_unet_all_step=0.490, Valid/loss_triplet_all_step=0.163, Valid/loss_recog_step=3.620, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.512, Valid/loss_triplet_all_epoch=0.380, Valid/loss_recog_epoch=3.630, Valid/knn_avr=0.387, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.83it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.41it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  4.88it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.05it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  5.00it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  5.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.124873, 0.128159, 0.117394, 0.127619
Valid average loss UNet                 (all)                : 0.498045

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.112932, 1.829621, 3.849803
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.343200, 1.800703, 2.070532
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.847716, 2.477111, 2.023333
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.318909, 1.710764, 2.528730
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.339056, 2.297495, 2.938116
Valid average loss all      (Triplet)                 : 0.420173

== Recognize ==
Valid average loss Recognize     : 4.005534
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 40.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 46.000000 %
Valid average accuracy residuals : 45.500000 %

== Valid average loss all : 0.425154

= T-SNE...
T-SNE was finished!
= T-SNE time is 7.703958034515381 sec. =
Valid knn accuracy drums     : 72.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.564395427703857 sec. =
Valid knn accuracy bass      : 9.879032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.635933637619019 sec. =
Valid knn accuracy piano     : 22.65625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.90044379234314 sec. =
Valid knn accuracy guitar    : 37.723214285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.340261936187744 sec. =
Valid knn accuracy residuals : 39.77272727272727%

Valid knn accuracy average   : 36.44102737199687%

                                                                      [AEpoch 117: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.730, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.00991, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00524, Train/loss_recog_epoch=3.660]Epoch 117: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.730, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.114040, 0.114720, 0.115346, 0.122046
Train average loss UNet                 (all)                : 0.466153

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003152, 1.569496, 4.647422
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009261, 1.365674, 2.974262
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005933, 1.443044, 3.008943
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006619, 1.443597, 3.115784
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004550, 1.738618, 3.627556
Train average loss all      (Triplet)                 : 0.005954

== Recognize ==
Train average loss Recognize     : 3.631277
Train average accuracy drums     : 50.685001 %
Train average accuracy bass      : 50.180000 %
Train average accuracy piano     : 50.024998 %
Train average accuracy guitar    : 50.260002 %
Train average accuracy residuals : 49.855000 %

== Train average loss all : 0.010616

Epoch 117:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.730, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]          Epoch 118:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.730, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.00443, Train/loss_unet_all_step=0.443, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.730, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118:  16%|█▌        | 50/313 [00:52<04:37,  0.95it/s, v_num=0, Train/loss_all_step=0.00789, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.00309, Train/loss_recog_step=3.760, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.00789, Train/loss_unet_all_step=0.479, Train/loss_triplet_all_step=0.00309, Train/loss_recog_step=3.760, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118:  32%|███▏      | 100/313 [01:41<03:35,  0.99it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=3.540, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]   Epoch 118:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.0154, Train/loss_unet_all_step=0.447, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=3.540, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118:  48%|████▊     | 150/313 [02:30<02:43,  1.00it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.00922, Train/loss_recog_step=3.620, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.014, Train/loss_unet_all_step=0.476, Train/loss_triplet_all_step=0.00922, Train/loss_recog_step=3.620, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.0255, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=3.610, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0255, Train/loss_unet_all_step=0.469, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=3.610, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118:  80%|███████▉  | 250/313 [04:04<01:01,  1.02it/s, v_num=0, Train/loss_all_step=0.0141, Train/loss_unet_all_step=0.439, Train/loss_triplet_all_step=0.00967, Train/loss_recog_step=3.680, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.0141, Train/loss_unet_all_step=0.439, Train/loss_triplet_all_step=0.00967, Train/loss_recog_step=3.680, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118:  96%|█████████▌| 300/313 [04:53<00:12,  1.02it/s, v_num=0, Train/loss_all_step=0.00767, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.00318, Train/loss_recog_step=3.850, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.00767, Train/loss_unet_all_step=0.450, Train/loss_triplet_all_step=0.00318, Train/loss_recog_step=3.850, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118: 100%|██████████| 313/313 [05:01<00:00,  1.04it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=4.120, Valid/loss_all_step=0.481, Valid/loss_unet_all_step=0.465, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=4.250, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.498, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=4.010, Valid/knn_avr=0.364, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.97it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:01<00:00,  5.47it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:01<00:00,  5.43it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:01<00:00,  5.24it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:01<00:00,  4.23it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:01<00:00,  4.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.124735, 0.127641, 0.116755, 0.137880
Valid average loss UNet                 (all)                : 0.507011

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.112648, 1.784977, 4.590134
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.358170, 1.839156, 2.087970
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.831378, 2.442022, 2.281995
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.376859, 1.748005, 2.425717
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.357800, 2.407351, 3.144581
Valid average loss all      (Triplet)                 : 0.435117

== Recognize ==
Valid average loss Recognize     : 3.869287
Valid average accuracy drums     : 51.000000 %
Valid average accuracy bass      : 48.000000 %
Valid average accuracy piano     : 52.999996 %
Valid average accuracy guitar    : 47.000000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.440187

= T-SNE...
T-SNE was finished!
= T-SNE time is 8.147675514221191 sec. =
Valid knn accuracy drums     : 63.91304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.075773239135742 sec. =
Valid knn accuracy bass      : 21.975806451612904%
= T-SNE...
T-SNE was finished!
= T-SNE time is 8.75112533569336 sec. =
Valid knn accuracy piano     : 23.4375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.701680660247803 sec. =
Valid knn accuracy guitar    : 40.625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 7.8108274936676025 sec. =
Valid knn accuracy residuals : 39.31818181818182%

Valid knn accuracy average   : 37.853906349611115%

                                                                      [AEpoch 118: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=4.120, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.482, Valid/loss_triplet_all_step=0.406, Valid/loss_recog_step=4.620, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=3.870, Valid/knn_avr=0.379, Train/loss_all_epoch=0.0106, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=3.630]Epoch 118: 100%|██████████| 313/313 [06:19<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=4.120, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.482, Valid/loss_triplet_all_step=0.406, Valid/loss_recog_step=4.620, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=3.870, Valid/knn_avr=0.379, Train/loss_all_epoch=0.00972, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=3.680]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.113969, 0.114611, 0.115278, 0.121804
Train average loss UNet                 (all)                : 0.465661

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002570, 1.685363, 5.046415
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008039, 1.413679, 3.013970
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006533, 1.519959, 3.110918
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004330, 1.508615, 3.292050
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003653, 1.855997, 3.828163
Train average loss all      (Triplet)                 : 0.005066

== Recognize ==
Train average loss Recognize     : 3.678573
Train average accuracy drums     : 50.029999 %
Train average accuracy bass      : 49.790001 %
Train average accuracy piano     : 49.704998 %
Train average accuracy guitar    : 50.169998 %
Train average accuracy residuals : 49.980000 %

== Train average loss all : 0.009723

Epoch 118:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=4.120, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.482, Valid/loss_triplet_all_step=0.406, Valid/loss_recog_step=4.620, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=3.870, Valid/knn_avr=0.379, Train/loss_all_epoch=0.00972, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=3.680]          Epoch 119:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=4.120, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.482, Valid/loss_triplet_all_step=0.406, Valid/loss_recog_step=4.620, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=3.870, Valid/knn_avr=0.379, Train/loss_all_epoch=0.00972, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=3.680]Epoch 119:  16%|█▌        | 50/313 [00:55<04:51,  0.90it/s, v_num=0, Train/loss_all_step=0.0166, Train/loss_unet_all_step=0.448, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=4.120, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.482, Valid/loss_triplet_all_step=0.406, Valid/loss_recog_step=4.620, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=3.870, Valid/knn_avr=0.379, Train/loss_all_epoch=0.00972, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=3.680]Epoch 119:  16%|█▌        | 50/313 [00:55<04:51,  0.90it/s, v_num=0, Train/loss_all_step=0.00486, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.580, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.482, Valid/loss_triplet_all_step=0.406, Valid/loss_recog_step=4.620, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=3.870, Valid/knn_avr=0.379, Train/loss_all_epoch=0.00972, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=3.680]Epoch 119:  32%|███▏      | 100/313 [01:42<03:38,  0.97it/s, v_num=0, Train/loss_all_step=0.00486, Train/loss_unet_all_step=0.486, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=3.580, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.482, Valid/loss_triplet_all_step=0.406, Valid/loss_recog_step=4.620, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=3.870, Valid/knn_avr=0.379, Train/loss_all_epoch=0.00972, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=3.680]Epoch 119:  32%|███▏      | 100/313 [01:42<03:38,  0.97it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.00246, Train/loss_recog_step=3.800, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.482, Valid/loss_triplet_all_step=0.406, Valid/loss_recog_step=4.620, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=3.870, Valid/knn_avr=0.379, Train/loss_all_epoch=0.00972, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=3.680]Epoch 119:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.00704, Train/loss_unet_all_step=0.458, Train/loss_triplet_all_step=0.00246, Train/loss_recog_step=3.800, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.482, Valid/loss_triplet_all_step=0.406, Valid/loss_recog_step=4.620, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=3.870, Valid/knn_avr=0.379, Train/loss_all_epoch=0.00972, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=3.680]Epoch 119:  48%|████▊     | 150/313 [02:28<02:41,  1.01it/s, v_num=0, Train/loss_all_step=0.0404, Train/loss_unet_all_step=0.495, Train/loss_triplet_all_step=0.0355, Train/loss_recog_step=4.200, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.482, Valid/loss_triplet_all_step=0.406, Valid/loss_recog_step=4.620, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.507, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=3.870, Valid/knn_avr=0.379, Train/loss_all_epoch=0.00972, Train/loss_unet_all_epoch=0.466, Train/loss_triplet_all_epoch=0.00507, Train/loss_recog_epoch=3.680]  