
=== Using cuda(utils.func). ===


=== Using cuda(utils.logger). ===

[2023-11-01 23:53:16,372][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-01 23:53:16,380][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 100                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 20                                                       
│         batch_test: 64                                                        
│         num_workers: 2                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         load_using_librosa: true                                              
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: false                                                            
│         db: true                                                              
│         target: model.UNetForTriplet_to1d640_1dde5                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 0.001                                                             
│         monitor_es: Valid/loss_all                                            
│         monitor_mode_es: min                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0.5                                                        
│         recog_rate: 0                                                         
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.UNetForTriplet_to1d640_1dde5                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│       cfg:                                                                    
│         n_epoch: 100                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 20                                                       
│         batch_test: 64                                                        
│         num_workers: 2                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         train_dirname: 3s_on1.5                                               
│         test_dirname: 3s_on1.5                                                
│         load_using_librosa: true                                              
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_train: 3                                                      
│         seconds_test: 3                                                       
│         sr: 44100                                                             
│         mel: false                                                            
│         db: true                                                              
│         target: model.UNetForTriplet_to1d640_1dde5                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         lr: 0.001                                                             
│         monitor_es: Valid/loss_all                                            
│         monitor_mode_es: min                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 0.5                                                        
│         recog_rate: 0                                                         
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/loss_all                                               
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: 1                                                         
│         mode: min                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/loss_all                                               
│         min_delta: 0.0                                                        
│         patience: 10                                                          
│         verbose: true                                                         
│         mode: min                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 100                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 100                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 20                                                         
│       batch_test: 64                                                          
│       num_workers: 2                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       train_dirname: 3s_on1.5                                                 
│       test_dirname: 3s_on1.5                                                  
│       load_using_librosa: true                                                
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_train: 3                                                        
│       seconds_test: 3                                                         
│       sr: 44100                                                               
│       mel: false                                                              
│       db: true                                                                
│       target: model.UNetForTriplet_to1d640_1dde5                              
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       lr: 0.001                                                               
│       monitor_es: Valid/loss_all                                              
│       monitor_mode_es: min                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 0.5                                                          
│       recog_rate: 0                                                           
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'unet=0.5', 'model_to1d640_to2dde5']                        
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-01 23:53:16,467][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-01 23:53:16,482][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-01 23:53:18,160][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp04rihevz
[2023-11-01 23:53:18,160][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp04rihevz/_remote_module_non_scriptable.py
UNetForTriplet_to1d640_1dde5(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
      )
    )
  )
  (decoder_drums): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_bass): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_piano): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_guitar): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (decoder_residuals): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 1, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=10880, out_features=640, bias=True)
    )
  )
  (to2d): To2DFrom1D640(
    (to2d): To2DFrom1DFreqTime(
      (linear): Linear(in_features=640, out_features=10880, bias=True)
    )
  )
)
[2023-11-01 23:53:18,236][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-01 23:53:18,236][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-01 23:53:18,243][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-01 23:53:18,246][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-01 23:53:18,246][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-01 23:53:18,247][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-01 23:53:18,283][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-01 23:53:18,665][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-01 23:53:18,872][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.6207613945007324 sec. *
Sanity Checking: |          | 0/? [00:00<?, ?it/s]Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:04<00:00,  0.49it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 1: 100%|██████████| 2/2 [00:00<00:00, 10.87it/s]Sanity Checking DataLoader 1:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 2: 100%|██████████| 2/2 [00:00<00:00, 11.00it/s]Sanity Checking DataLoader 2:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 3: 100%|██████████| 2/2 [00:00<00:00,  4.53it/s]Sanity Checking DataLoader 3:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 4: 100%|██████████| 2/2 [00:00<00:00,  5.11it/s]Sanity Checking DataLoader 4:   0%|          | 0/2 [00:00<?, ?it/s]        Sanity Checking DataLoader 5:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 5: 100%|██████████| 2/2 [00:00<00:00, 10.84it/s]

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.078944, 0.080638, 0.078985, 0.055843
Valid average loss UNet                 (all)                : 0.294409

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.199827, 0.003498, 0.003671
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.200508, 0.003809, 0.003301
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.199831, 0.003117, 0.003286
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.199547, 0.003661, 0.004113
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.200156, 0.003649, 0.003494
Valid average loss all      (Triplet)                 : 0.200009

== Recognize ==
Valid average loss Recognize     : 1.390934
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 49.218750 %
Valid average accuracy piano     : 45.312500 %
Valid average accuracy guitar    : 46.093750 %
Valid average accuracy residuals : 46.093750 %

== Valid average loss all : 0.347213

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 5.504169464111328 sec. =
Valid knn accuracy drums     : 35.9375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 5.43332839012146 sec. =
Valid knn accuracy bass      : 21.09375%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 4.601458787918091 sec. =
Valid knn accuracy piano     : 35.15625%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 3.230483055114746 sec. =
Valid knn accuracy guitar    : 49.21875%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 2.566952705383301 sec. =
Valid knn accuracy residuals : 88.28125%

Valid knn accuracy average   : 45.9375%
                                                                           Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/1000 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/1000 [00:00<?, ?it/s] Epoch 0:   5%|▌         | 50/1000 [03:19<1:03:01,  0.25it/s]Epoch 0:   5%|▌         | 50/1000 [03:19<1:03:01,  0.25it/s, v_num=0, Train/loss_all_step=3.220, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=3.110, Train/loss_recog_step=2.160]Epoch 0:  10%|█         | 100/1000 [06:27<58:06,  0.26it/s, v_num=0, Train/loss_all_step=3.220, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=3.110, Train/loss_recog_step=2.160] Epoch 0:  10%|█         | 100/1000 [06:27<58:06,  0.26it/s, v_num=0, Train/loss_all_step=3.090, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=2.980, Train/loss_recog_step=1.870]Epoch 0:  15%|█▌        | 150/1000 [09:21<53:04,  0.27it/s, v_num=0, Train/loss_all_step=3.090, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=2.980, Train/loss_recog_step=1.870]Epoch 0:  15%|█▌        | 150/1000 [09:21<53:04,  0.27it/s, v_num=0, Train/loss_all_step=1.090, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.996, Train/loss_recog_step=1.570]Epoch 0:  20%|██        | 200/1000 [12:16<49:07,  0.27it/s, v_num=0, Train/loss_all_step=1.090, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.996, Train/loss_recog_step=1.570]Epoch 0:  20%|██        | 200/1000 [12:16<49:07,  0.27it/s, v_num=0, Train/loss_all_step=0.583, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.494, Train/loss_recog_step=1.740]Epoch 0:  25%|██▌       | 250/1000 [15:09<45:29,  0.27it/s, v_num=0, Train/loss_all_step=0.583, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.494, Train/loss_recog_step=1.740]Epoch 0:  25%|██▌       | 250/1000 [15:09<45:29,  0.27it/s, v_num=0, Train/loss_all_step=0.450, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.358, Train/loss_recog_step=1.240]Epoch 0:  30%|███       | 300/1000 [18:22<42:52,  0.27it/s, v_num=0, Train/loss_all_step=0.450, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.358, Train/loss_recog_step=1.240]Epoch 0:  30%|███       | 300/1000 [18:22<42:52,  0.27it/s, v_num=0, Train/loss_all_step=0.312, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.230, Train/loss_recog_step=1.530]Epoch 0:  35%|███▌      | 350/1000 [21:37<40:09,  0.27it/s, v_num=0, Train/loss_all_step=0.312, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.230, Train/loss_recog_step=1.530]Epoch 0:  35%|███▌      | 350/1000 [21:37<40:09,  0.27it/s, v_num=0, Train/loss_all_step=0.412, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.327, Train/loss_recog_step=1.250]Epoch 0:  40%|████      | 400/1000 [24:55<37:23,  0.27it/s, v_num=0, Train/loss_all_step=0.412, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.327, Train/loss_recog_step=1.250]Epoch 0:  40%|████      | 400/1000 [24:55<37:23,  0.27it/s, v_num=0, Train/loss_all_step=0.323, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.236, Train/loss_recog_step=1.170]Epoch 0:  45%|████▌     | 450/1000 [28:10<34:25,  0.27it/s, v_num=0, Train/loss_all_step=0.323, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.236, Train/loss_recog_step=1.170]Epoch 0:  45%|████▌     | 450/1000 [28:10<34:25,  0.27it/s, v_num=0, Train/loss_all_step=0.554, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.464, Train/loss_recog_step=1.230]Epoch 0:  50%|█████     | 500/1000 [31:24<31:24,  0.27it/s, v_num=0, Train/loss_all_step=0.554, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.464, Train/loss_recog_step=1.230]Epoch 0:  50%|█████     | 500/1000 [31:24<31:24,  0.27it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.350, Train/loss_recog_step=1.350]Epoch 0:  55%|█████▌    | 550/1000 [34:40<28:22,  0.26it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.350, Train/loss_recog_step=1.350]Epoch 0:  55%|█████▌    | 550/1000 [34:40<28:22,  0.26it/s, v_num=0, Train/loss_all_step=0.266, Train/loss_unet_all_step=0.146, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=0.924]Epoch 0:  60%|██████    | 600/1000 [37:56<25:17,  0.26it/s, v_num=0, Train/loss_all_step=0.266, Train/loss_unet_all_step=0.146, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=0.924]Epoch 0:  60%|██████    | 600/1000 [37:56<25:17,  0.26it/s, v_num=0, Train/loss_all_step=0.307, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.224, Train/loss_recog_step=1.090]Epoch 0:  65%|██████▌   | 650/1000 [41:15<22:12,  0.26it/s, v_num=0, Train/loss_all_step=0.307, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.224, Train/loss_recog_step=1.090]Epoch 0:  65%|██████▌   | 650/1000 [41:15<22:12,  0.26it/s, v_num=0, Train/loss_all_step=0.394, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.308, Train/loss_recog_step=1.130]Epoch 0:  70%|███████   | 700/1000 [44:23<19:01,  0.26it/s, v_num=0, Train/loss_all_step=0.394, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.308, Train/loss_recog_step=1.130]Epoch 0:  70%|███████   | 700/1000 [44:23<19:01,  0.26it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.137, Train/loss_triplet_all_step=0.241, Train/loss_recog_step=1.120]Epoch 0:  75%|███████▌  | 750/1000 [47:10<15:43,  0.26it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.137, Train/loss_triplet_all_step=0.241, Train/loss_recog_step=1.120]Epoch 0:  75%|███████▌  | 750/1000 [47:10<15:43,  0.26it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.240, Train/loss_recog_step=1.180]Epoch 0:  80%|████████  | 800/1000 [50:07<12:31,  0.27it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.240, Train/loss_recog_step=1.180]Epoch 0:  80%|████████  | 800/1000 [50:07<12:31,  0.27it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.125, Train/loss_triplet_all_step=0.311, Train/loss_recog_step=1.140]Epoch 0:  85%|████████▌ | 850/1000 [52:57<09:20,  0.27it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.125, Train/loss_triplet_all_step=0.311, Train/loss_recog_step=1.140]Epoch 0:  85%|████████▌ | 850/1000 [52:57<09:20,  0.27it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.139, Train/loss_triplet_all_step=0.221, Train/loss_recog_step=1.240]Epoch 0:  90%|█████████ | 900/1000 [56:12<06:14,  0.27it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.139, Train/loss_triplet_all_step=0.221, Train/loss_recog_step=1.240]Epoch 0:  90%|█████████ | 900/1000 [56:12<06:14,  0.27it/s, v_num=0, Train/loss_all_step=0.268, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=1.360]Epoch 0:  95%|█████████▌| 950/1000 [59:25<03:07,  0.27it/s, v_num=0, Train/loss_all_step=0.268, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=1.360]Epoch 0:  95%|█████████▌| 950/1000 [59:25<03:07,  0.27it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.310]Epoch 0: 100%|██████████| 1000/1000 [1:02:42<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.310]Epoch 0: 100%|██████████| 1000/1000 [1:02:42<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.250]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:21<00:00,  0.18it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:15<00:00,  0.53it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:15<00:00,  0.50it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:16<00:00,  0.47it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.47it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:15<00:00,  0.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.042327, 0.045693, 0.046001, 0.022021
Valid average loss UNet                 (all)                : 0.156042

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.197207, 0.644228, 0.749533
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.164814, 0.296537, 0.289885
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.216894, 0.498646, 0.518076
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.208099, 0.461717, 0.472470
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.270730, 0.625844, 0.575828
Valid average loss all      (Triplet)                 : 0.215492

== Recognize ==
Valid average loss Recognize     : 1.251176
Valid average accuracy drums     : 52.499996 %
Valid average accuracy bass      : 48.500000 %
Valid average accuracy piano     : 47.000000 %
Valid average accuracy guitar    : 53.500004 %
Valid average accuracy residuals : 50.500000 %

== Valid average loss all : 0.293513

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.873408317565918 sec. =
Valid knn accuracy drums     : 45.21739130434783%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.372883796691895 sec. =
Valid knn accuracy bass      : 21.774193548387096%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.66884469985962 sec. =
Valid knn accuracy piano     : 26.5625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.810546159744263 sec. =
Valid knn accuracy guitar    : 42.410714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.095236778259277 sec. =
Valid knn accuracy residuals : 62.272727272727266%

Valid knn accuracy average   : 39.647505282235294%

                                                                      [AEpoch 0: 100%|██████████| 1000/1000 [1:06:31<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.250, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396]Epoch 0: 100%|██████████| 1000/1000 [1:06:31<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.250, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.044566, 0.044331, 0.044456, 0.035910
Train average loss UNet                 (all)                : 0.169263

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.692619, 2.531887, 2.830519
Train average loss bass     (Triplet, dist_p, dist_n) : 0.875051, 2.404613, 2.164948
Train average loss piano    (Triplet, dist_p, dist_n) : 0.817059, 2.421118, 2.330836
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.753594, 2.419816, 2.416074
Train average loss residuals(Triplet, dist_p, dist_n) : 0.674140, 2.502605, 2.733926
Train average loss all      (Triplet)                 : 0.767489

== Recognize ==
Train average loss Recognize     : 1.396708
Train average accuracy drums     : 49.625000 %
Train average accuracy bass      : 50.215000 %
Train average accuracy piano     : 50.244999 %
Train average accuracy guitar    : 50.244999 %
Train average accuracy residuals : 50.244999 %

== Train average loss all : 0.852121

Epoch 0:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.250, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]             Epoch 1:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.250, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:   5%|▌         | 50/1000 [03:22<1:04:12,  0.25it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.250, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:   5%|▌         | 50/1000 [03:22<1:04:12,  0.25it/s, v_num=0, Train/loss_all_step=0.326, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=1.290, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  10%|█         | 100/1000 [06:26<58:02,  0.26it/s, v_num=0, Train/loss_all_step=0.326, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=1.290, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400] Epoch 1:  10%|█         | 100/1000 [06:26<58:02,  0.26it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=1.330, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  15%|█▌        | 150/1000 [09:38<54:36,  0.26it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=1.330, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  15%|█▌        | 150/1000 [09:38<54:36,  0.26it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.229, Train/loss_recog_step=1.230, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  20%|██        | 200/1000 [12:52<51:30,  0.26it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.229, Train/loss_recog_step=1.230, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  20%|██        | 200/1000 [12:52<51:30,  0.26it/s, v_num=0, Train/loss_all_step=0.293, Train/loss_unet_all_step=0.157, Train/loss_triplet_all_step=0.214, Train/loss_recog_step=1.350, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  25%|██▌       | 250/1000 [16:01<48:05,  0.26it/s, v_num=0, Train/loss_all_step=0.293, Train/loss_unet_all_step=0.157, Train/loss_triplet_all_step=0.214, Train/loss_recog_step=1.350, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  25%|██▌       | 250/1000 [16:01<48:05,  0.26it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.210, Train/loss_recog_step=1.370, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  30%|███       | 300/1000 [19:00<44:20,  0.26it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.210, Train/loss_recog_step=1.370, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  30%|███       | 300/1000 [19:00<44:20,  0.26it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.149, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=1.280, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  35%|███▌      | 350/1000 [21:53<40:39,  0.27it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.149, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=1.280, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  35%|███▌      | 350/1000 [21:53<40:39,  0.27it/s, v_num=0, Train/loss_all_step=0.276, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.360, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  40%|████      | 400/1000 [24:49<37:13,  0.27it/s, v_num=0, Train/loss_all_step=0.276, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.360, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  40%|████      | 400/1000 [24:49<37:13,  0.27it/s, v_num=0, Train/loss_all_step=0.252, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.250, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  45%|████▌     | 450/1000 [28:04<34:19,  0.27it/s, v_num=0, Train/loss_all_step=0.252, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=1.250, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  45%|████▌     | 450/1000 [28:04<34:19,  0.27it/s, v_num=0, Train/loss_all_step=0.316, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.232, Train/loss_recog_step=1.210, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  50%|█████     | 500/1000 [31:19<31:19,  0.27it/s, v_num=0, Train/loss_all_step=0.316, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.232, Train/loss_recog_step=1.210, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  50%|█████     | 500/1000 [31:19<31:19,  0.27it/s, v_num=0, Train/loss_all_step=0.269, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=1.440, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  55%|█████▌    | 550/1000 [34:34<28:17,  0.27it/s, v_num=0, Train/loss_all_step=0.269, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=1.440, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  55%|█████▌    | 550/1000 [34:34<28:17,  0.27it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.136, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=1.260, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  60%|██████    | 600/1000 [37:49<25:13,  0.26it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.136, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=1.260, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  60%|██████    | 600/1000 [37:49<25:13,  0.26it/s, v_num=0, Train/loss_all_step=0.284, Train/loss_unet_all_step=0.157, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=1.350, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  65%|██████▌   | 650/1000 [41:06<22:08,  0.26it/s, v_num=0, Train/loss_all_step=0.284, Train/loss_unet_all_step=0.157, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=1.350, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  65%|██████▌   | 650/1000 [41:06<22:08,  0.26it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.310, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  70%|███████   | 700/1000 [44:21<19:00,  0.26it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.310, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  70%|███████   | 700/1000 [44:21<19:00,  0.26it/s, v_num=0, Train/loss_all_step=0.281, Train/loss_unet_all_step=0.139, Train/loss_triplet_all_step=0.211, Train/loss_recog_step=1.260, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  75%|███████▌  | 750/1000 [47:32<15:50,  0.26it/s, v_num=0, Train/loss_all_step=0.281, Train/loss_unet_all_step=0.139, Train/loss_triplet_all_step=0.211, Train/loss_recog_step=1.260, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  75%|███████▌  | 750/1000 [47:32<15:50,  0.26it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.150, Train/loss_triplet_all_step=0.215, Train/loss_recog_step=1.370, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  80%|████████  | 800/1000 [50:36<12:39,  0.26it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.150, Train/loss_triplet_all_step=0.215, Train/loss_recog_step=1.370, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  80%|████████  | 800/1000 [50:36<12:39,  0.26it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.121, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.220, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  85%|████████▌ | 850/1000 [53:44<09:29,  0.26it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.121, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.220, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  85%|████████▌ | 850/1000 [53:44<09:29,  0.26it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.135, Train/loss_triplet_all_step=0.218, Train/loss_recog_step=1.330, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  90%|█████████ | 900/1000 [56:39<06:17,  0.26it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.135, Train/loss_triplet_all_step=0.218, Train/loss_recog_step=1.330, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  90%|█████████ | 900/1000 [56:39<06:17,  0.26it/s, v_num=0, Train/loss_all_step=0.311, Train/loss_unet_all_step=0.151, Train/loss_triplet_all_step=0.235, Train/loss_recog_step=1.560, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  95%|█████████▌| 950/1000 [59:33<03:08,  0.27it/s, v_num=0, Train/loss_all_step=0.311, Train/loss_unet_all_step=0.151, Train/loss_triplet_all_step=0.235, Train/loss_recog_step=1.560, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1:  95%|█████████▌| 950/1000 [59:33<03:08,  0.27it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.170, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1: 100%|██████████| 1000/1000 [1:02:26<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.170, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1: 100%|██████████| 1000/1000 [1:02:26<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.152, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.140, Valid/loss_all_step=0.309, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.294, Valid/loss_unet_all_epoch=0.156, Valid/loss_triplet_all_epoch=0.215, Valid/loss_recog_epoch=1.250, Valid/knn_avr=0.396, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:23<00:00,  0.17it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:16<00:00,  0.48it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:16<00:00,  0.48it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:16<00:00,  0.47it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:15<00:00,  0.44it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:16<00:00,  0.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.041772, 0.044909, 0.045148, 0.020842
Valid average loss UNet                 (all)                : 0.152671

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.220566, 0.419181, 0.478314
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.233585, 0.407724, 0.334856
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.226912, 0.552913, 0.691986
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.247875, 0.407835, 0.393544
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.292200, 0.519642, 0.488103
Valid average loss all      (Triplet)                 : 0.250676

== Recognize ==
Valid average loss Recognize     : 1.286420
Valid average accuracy drums     : 52.999996 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 48.500000 %
Valid average accuracy guitar    : 55.000000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : 0.327012

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.120254516601562 sec. =
Valid knn accuracy drums     : 26.08695652173913%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.909157037734985 sec. =
Valid knn accuracy bass      : 15.120967741935484%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.506113052368164 sec. =
Valid knn accuracy piano     : 25.1953125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.89812159538269 sec. =
Valid knn accuracy guitar    : 38.839285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.619130373001099 sec. =
Valid knn accuracy residuals : 60.68181818181818%

Valid knn accuracy average   : 33.1848681319557%

                                                                      [AEpoch 1: 100%|██████████| 1000/1000 [1:07:18<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.152, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.140, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.852, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.767, Train/loss_recog_epoch=1.400]Epoch 1: 100%|██████████| 1000/1000 [1:07:18<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.152, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.140, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.041684, 0.041460, 0.041628, 0.032489
Train average loss UNet                 (all)                : 0.157262

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.144001, 0.450143, 0.647806
Train average loss bass     (Triplet, dist_p, dist_n) : 0.233190, 0.362873, 0.341825
Train average loss piano    (Triplet, dist_p, dist_n) : 0.220074, 0.396395, 0.397648
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.221470, 0.409195, 0.411113
Train average loss residuals(Triplet, dist_p, dist_n) : 0.203564, 0.464778, 0.496290
Train average loss all      (Triplet)                 : 0.206553

== Recognize ==
Train average loss Recognize     : 1.318522
Train average accuracy drums     : 49.775002 %
Train average accuracy bass      : 49.799999 %
Train average accuracy piano     : 50.099998 %
Train average accuracy guitar    : 49.799999 %
Train average accuracy residuals : 50.089996 %

== Train average loss all : 0.285184

Epoch 1:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.152, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.140, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]             Epoch 2:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.152, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.140, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:   5%|▌         | 50/1000 [03:20<1:03:20,  0.25it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.152, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.140, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:   5%|▌         | 50/1000 [03:20<1:03:20,  0.25it/s, v_num=0, Train/loss_all_step=0.265, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=1.410, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  10%|█         | 100/1000 [06:28<58:19,  0.26it/s, v_num=0, Train/loss_all_step=0.265, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=1.410, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320] Epoch 2:  10%|█         | 100/1000 [06:28<58:19,  0.26it/s, v_num=0, Train/loss_all_step=0.331, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.236, Train/loss_recog_step=1.260, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  15%|█▌        | 150/1000 [09:43<55:05,  0.26it/s, v_num=0, Train/loss_all_step=0.331, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.236, Train/loss_recog_step=1.260, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  15%|█▌        | 150/1000 [09:43<55:05,  0.26it/s, v_num=0, Train/loss_all_step=0.289, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=1.310, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  20%|██        | 200/1000 [13:00<52:00,  0.26it/s, v_num=0, Train/loss_all_step=0.289, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=1.310, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  20%|██        | 200/1000 [13:00<52:00,  0.26it/s, v_num=0, Train/loss_all_step=0.269, Train/loss_unet_all_step=0.147, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.300, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  25%|██▌       | 250/1000 [16:15<48:46,  0.26it/s, v_num=0, Train/loss_all_step=0.269, Train/loss_unet_all_step=0.147, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.300, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  25%|██▌       | 250/1000 [16:15<48:47,  0.26it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=1.410, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  30%|███       | 300/1000 [19:28<45:27,  0.26it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=1.410, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  30%|███       | 300/1000 [19:28<45:27,  0.26it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.147, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.340, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  35%|███▌      | 350/1000 [22:40<42:06,  0.26it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.147, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.340, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  35%|███▌      | 350/1000 [22:40<42:06,  0.26it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.550, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  40%|████      | 400/1000 [25:40<38:31,  0.26it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.550, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  40%|████      | 400/1000 [25:40<38:31,  0.26it/s, v_num=0, Train/loss_all_step=0.247, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.370, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  45%|████▌     | 450/1000 [28:36<34:58,  0.26it/s, v_num=0, Train/loss_all_step=0.247, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.370, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  45%|████▌     | 450/1000 [28:36<34:58,  0.26it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.600, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  50%|█████     | 500/1000 [31:27<31:27,  0.26it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=1.600, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  50%|█████     | 500/1000 [31:27<31:27,  0.26it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.370, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  55%|█████▌    | 550/1000 [34:36<28:18,  0.26it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.370, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  55%|█████▌    | 550/1000 [34:36<28:18,  0.26it/s, v_num=0, Train/loss_all_step=0.259, Train/loss_unet_all_step=0.137, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.310, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  60%|██████    | 600/1000 [37:49<25:13,  0.26it/s, v_num=0, Train/loss_all_step=0.259, Train/loss_unet_all_step=0.137, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.310, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  60%|██████    | 600/1000 [37:49<25:13,  0.26it/s, v_num=0, Train/loss_all_step=0.256, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.260, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  65%|██████▌   | 650/1000 [41:07<22:08,  0.26it/s, v_num=0, Train/loss_all_step=0.256, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.260, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  65%|██████▌   | 650/1000 [41:07<22:08,  0.26it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.250, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  70%|███████   | 700/1000 [44:22<19:00,  0.26it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.250, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  70%|███████   | 700/1000 [44:22<19:00,  0.26it/s, v_num=0, Train/loss_all_step=0.288, Train/loss_unet_all_step=0.136, Train/loss_triplet_all_step=0.220, Train/loss_recog_step=1.330, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  75%|███████▌  | 750/1000 [47:36<15:52,  0.26it/s, v_num=0, Train/loss_all_step=0.288, Train/loss_unet_all_step=0.136, Train/loss_triplet_all_step=0.220, Train/loss_recog_step=1.330, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  75%|███████▌  | 750/1000 [47:36<15:52,  0.26it/s, v_num=0, Train/loss_all_step=0.264, Train/loss_unet_all_step=0.149, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=1.500, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  80%|████████  | 800/1000 [50:45<12:41,  0.26it/s, v_num=0, Train/loss_all_step=0.264, Train/loss_unet_all_step=0.149, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=1.500, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  80%|████████  | 800/1000 [50:45<12:41,  0.26it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.118, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.250, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  85%|████████▌ | 850/1000 [53:50<09:30,  0.26it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.118, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.250, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  85%|████████▌ | 850/1000 [53:50<09:30,  0.26it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.135, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=1.400, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  90%|█████████ | 900/1000 [57:02<06:20,  0.26it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.135, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=1.400, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  90%|█████████ | 900/1000 [57:02<06:20,  0.26it/s, v_num=0, Train/loss_all_step=0.272, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.410, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  95%|█████████▌| 950/1000 [1:00:11<03:10,  0.26it/s, v_num=0, Train/loss_all_step=0.272, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.410, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2:  95%|█████████▌| 950/1000 [1:00:11<03:10,  0.26it/s, v_num=0, Train/loss_all_step=0.271, Train/loss_unet_all_step=0.157, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.400, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2: 100%|██████████| 1000/1000 [1:03:13<00:00,  0.26it/s, v_num=0, Train/loss_all_step=0.271, Train/loss_unet_all_step=0.157, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.400, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2: 100%|██████████| 1000/1000 [1:03:13<00:00,  0.26it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.150, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.580, Valid/loss_all_step=0.288, Valid/loss_unet_all_step=0.145, Valid/loss_triplet_all_step=0.215, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.327, Valid/loss_unet_all_epoch=0.153, Valid/loss_triplet_all_epoch=0.251, Valid/loss_recog_epoch=1.290, Valid/knn_avr=0.332, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.21it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:14<00:00,  0.56it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:15<00:00,  0.53it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:13<00:00,  0.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:14<00:00,  0.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:12<00:00,  0.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.041291, 0.043540, 0.044277, 0.021914
Valid average loss UNet                 (all)                : 0.151023

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.158824, 0.310009, 0.444560
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.156237, 0.162211, 0.156498
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.171925, 0.257519, 0.287060
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.177620, 0.284805, 0.321763
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.305086, 0.395620, 0.299042
Valid average loss all      (Triplet)                 : 0.189228

== Recognize ==
Valid average loss Recognize     : 1.458847
Valid average accuracy drums     : 49.500000 %
Valid average accuracy bass      : 52.499996 %
Valid average accuracy piano     : 55.000000 %
Valid average accuracy guitar    : 54.000004 %
Valid average accuracy residuals : 47.500000 %

== Valid average loss all : 0.264740

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.635354042053223 sec. =
Valid knn accuracy drums     : 54.130434782608695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.351814270019531 sec. =
Valid knn accuracy bass      : 19.556451612903224%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.5438551902771 sec. =
Valid knn accuracy piano     : 30.078125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.809163570404053 sec. =
Valid knn accuracy guitar    : 44.19642857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.606590032577515 sec. =
Valid knn accuracy residuals : 62.5%

Valid knn accuracy average   : 42.0922879933881%

                                                                      [AEpoch 2: 100%|██████████| 1000/1000 [1:06:42<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.150, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.580, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.285, Train/loss_unet_all_epoch=0.157, Train/loss_triplet_all_epoch=0.207, Train/loss_recog_epoch=1.320]Epoch 2: 100%|██████████| 1000/1000 [1:06:42<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.150, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.580, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.041092, 0.040855, 0.041048, 0.031704
Train average loss UNet                 (all)                : 0.154699

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.114330, 0.337063, 0.559865
Train average loss bass     (Triplet, dist_p, dist_n) : 0.216469, 0.270956, 0.260085
Train average loss piano    (Triplet, dist_p, dist_n) : 0.210592, 0.311074, 0.309328
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.200047, 0.321677, 0.339020
Train average loss residuals(Triplet, dist_p, dist_n) : 0.190104, 0.364983, 0.399814
Train average loss all      (Triplet)                 : 0.188293

== Recognize ==
Train average loss Recognize     : 1.370556
Train average accuracy drums     : 50.285000 %
Train average accuracy bass      : 50.094997 %
Train average accuracy piano     : 49.790001 %
Train average accuracy guitar    : 49.860001 %
Train average accuracy residuals : 49.965000 %

== Train average loss all : 0.265642

Epoch 2:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.150, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.580, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]             Epoch 3:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.150, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.580, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:   5%|▌         | 50/1000 [02:49<53:42,  0.29it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.150, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.580, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:   5%|▌         | 50/1000 [02:49<53:43,  0.29it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.620, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  10%|█         | 100/1000 [06:03<54:35,  0.27it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=1.620, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  10%|█         | 100/1000 [06:03<54:35,  0.27it/s, v_num=0, Train/loss_all_step=0.303, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.213, Train/loss_recog_step=1.670, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  15%|█▌        | 150/1000 [09:22<53:08,  0.27it/s, v_num=0, Train/loss_all_step=0.303, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.213, Train/loss_recog_step=1.670, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  15%|█▌        | 150/1000 [09:22<53:08,  0.27it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.211, Train/loss_recog_step=1.620, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  20%|██        | 200/1000 [12:38<50:34,  0.26it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.211, Train/loss_recog_step=1.620, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  20%|██        | 200/1000 [12:38<50:34,  0.26it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.147, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.410, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  25%|██▌       | 250/1000 [15:53<47:40,  0.26it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.147, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=1.410, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  25%|██▌       | 250/1000 [15:53<47:40,  0.26it/s, v_num=0, Train/loss_all_step=0.298, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.216, Train/loss_recog_step=1.440, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  30%|███       | 300/1000 [19:07<44:36,  0.26it/s, v_num=0, Train/loss_all_step=0.298, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.216, Train/loss_recog_step=1.440, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  30%|███       | 300/1000 [19:07<44:36,  0.26it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.139, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.700, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  35%|███▌      | 350/1000 [22:21<41:31,  0.26it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.139, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=1.700, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  35%|███▌      | 350/1000 [22:21<41:31,  0.26it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.390, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  40%|████      | 400/1000 [25:35<38:23,  0.26it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.168, Train/loss_recog_step=1.390, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  40%|████      | 400/1000 [25:35<38:23,  0.26it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=1.460, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  45%|████▌     | 450/1000 [28:48<35:12,  0.26it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=1.460, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  45%|████▌     | 450/1000 [28:48<35:12,  0.26it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.570, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  50%|█████     | 500/1000 [32:01<32:01,  0.26it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=1.570, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  50%|█████     | 500/1000 [32:01<32:01,  0.26it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.570, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  55%|█████▌    | 550/1000 [35:00<28:38,  0.26it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.570, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  55%|█████▌    | 550/1000 [35:00<28:38,  0.26it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.133, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.380, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  60%|██████    | 600/1000 [37:56<25:17,  0.26it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.133, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.380, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  60%|██████    | 600/1000 [37:56<25:17,  0.26it/s, v_num=0, Train/loss_all_step=0.268, Train/loss_unet_all_step=0.155, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.530, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  65%|██████▌   | 650/1000 [40:48<21:58,  0.27it/s, v_num=0, Train/loss_all_step=0.268, Train/loss_unet_all_step=0.155, Train/loss_triplet_all_step=0.191, Train/loss_recog_step=1.530, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  65%|██████▌   | 650/1000 [40:48<21:58,  0.27it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.340, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  70%|███████   | 700/1000 [44:02<18:52,  0.26it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=1.340, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  70%|███████   | 700/1000 [44:02<18:52,  0.26it/s, v_num=0, Train/loss_all_step=0.314, Train/loss_unet_all_step=0.127, Train/loss_triplet_all_step=0.250, Train/loss_recog_step=1.590, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  75%|███████▌  | 750/1000 [47:16<15:45,  0.26it/s, v_num=0, Train/loss_all_step=0.314, Train/loss_unet_all_step=0.127, Train/loss_triplet_all_step=0.250, Train/loss_recog_step=1.590, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  75%|███████▌  | 750/1000 [47:16<15:45,  0.26it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.530, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  80%|████████  | 800/1000 [50:29<12:37,  0.26it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.530, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  80%|████████  | 800/1000 [50:29<12:37,  0.26it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.117, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=1.690, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  85%|████████▌ | 850/1000 [53:37<09:27,  0.26it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.117, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=1.690, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  85%|████████▌ | 850/1000 [53:37<09:27,  0.26it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.131, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.690, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  90%|█████████ | 900/1000 [56:41<06:17,  0.26it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.131, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=1.690, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  90%|█████████ | 900/1000 [56:41<06:17,  0.26it/s, v_num=0, Train/loss_all_step=0.293, Train/loss_unet_all_step=0.154, Train/loss_triplet_all_step=0.216, Train/loss_recog_step=1.630, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  95%|█████████▌| 950/1000 [59:57<03:09,  0.26it/s, v_num=0, Train/loss_all_step=0.293, Train/loss_unet_all_step=0.154, Train/loss_triplet_all_step=0.216, Train/loss_recog_step=1.630, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3:  95%|█████████▌| 950/1000 [59:57<03:09,  0.26it/s, v_num=0, Train/loss_all_step=0.257, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=1.510, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3: 100%|██████████| 1000/1000 [1:03:06<00:00,  0.26it/s, v_num=0, Train/loss_all_step=0.257, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=1.510, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3: 100%|██████████| 1000/1000 [1:03:06<00:00,  0.26it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.143, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.470, Valid/loss_all_step=0.276, Valid/loss_unet_all_step=0.144, Valid/loss_triplet_all_step=0.204, Valid/loss_recog_step=1.660, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=1.460, Valid/knn_avr=0.421, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:22<00:00,  0.18it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:15<00:00,  0.51it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:14<00:00,  0.55it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.50it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:15<00:00,  0.44it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:14<00:00,  0.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.040505, 0.043182, 0.043901, 0.022920
Valid average loss UNet                 (all)                : 0.150508

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.187381, 0.344427, 0.426307
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.146248, 0.205101, 0.219474
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.231201, 0.339140, 0.316331
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.195134, 0.316363, 0.352831
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.273509, 0.440487, 0.380167
Valid average loss all      (Triplet)                 : 0.210245

== Recognize ==
Valid average loss Recognize     : 1.602515
Valid average accuracy drums     : 46.500000 %
Valid average accuracy bass      : 47.000000 %
Valid average accuracy piano     : 52.499996 %
Valid average accuracy guitar    : 52.999996 %
Valid average accuracy residuals : 49.000000 %

== Valid average loss all : 0.285499

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.608007192611694 sec. =
Valid knn accuracy drums     : 57.173913043478265%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.441393852233887 sec. =
Valid knn accuracy bass      : 25.201612903225808%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.531249523162842 sec. =
Valid knn accuracy piano     : 25.5859375%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.589826822280884 sec. =
Valid knn accuracy guitar    : 38.839285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.407680034637451 sec. =
Valid knn accuracy residuals : 57.72727272727273%

Valid knn accuracy average   : 40.9056043776525%

                                                                      [AEpoch 3: 100%|██████████| 1000/1000 [1:06:46<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.143, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.470, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.266, Train/loss_unet_all_epoch=0.155, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=1.370]Epoch 3: 100%|██████████| 1000/1000 [1:06:46<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.143, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.470, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.040640, 0.040416, 0.040561, 0.031122
Train average loss UNet                 (all)                : 0.152739

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.103438, 0.312419, 0.571597
Train average loss bass     (Triplet, dist_p, dist_n) : 0.217973, 0.246053, 0.234843
Train average loss piano    (Triplet, dist_p, dist_n) : 0.205166, 0.293246, 0.297693
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.197298, 0.300751, 0.322383
Train average loss residuals(Triplet, dist_p, dist_n) : 0.172467, 0.363650, 0.422021
Train average loss all      (Triplet)                 : 0.180837

== Recognize ==
Train average loss Recognize     : 1.499304
Train average accuracy drums     : 50.260002 %
Train average accuracy bass      : 50.285000 %
Train average accuracy piano     : 49.805000 %
Train average accuracy guitar    : 50.164997 %
Train average accuracy residuals : 50.335003 %

== Train average loss all : 0.257207

Epoch 3:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.143, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.470, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]             Epoch 4:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.143, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.470, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:   5%|▌         | 50/1000 [03:13<1:01:17,  0.26it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.143, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=1.470, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:   5%|▌         | 50/1000 [03:13<1:01:17,  0.26it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.155, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.740, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  10%|█         | 100/1000 [06:12<55:49,  0.27it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.155, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.740, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500] Epoch 4:  10%|█         | 100/1000 [06:12<55:49,  0.27it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=1.520, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  15%|█▌        | 150/1000 [09:07<51:40,  0.27it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=1.520, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  15%|█▌        | 150/1000 [09:07<51:40,  0.27it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=1.600, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  20%|██        | 200/1000 [11:58<47:54,  0.28it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=1.600, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  20%|██        | 200/1000 [11:58<47:54,  0.28it/s, v_num=0, Train/loss_all_step=0.308, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.225, Train/loss_recog_step=1.670, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  25%|██▌       | 250/1000 [15:12<45:38,  0.27it/s, v_num=0, Train/loss_all_step=0.308, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.225, Train/loss_recog_step=1.670, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  25%|██▌       | 250/1000 [15:12<45:38,  0.27it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.217, Train/loss_recog_step=1.920, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  30%|███       | 300/1000 [18:27<43:04,  0.27it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.217, Train/loss_recog_step=1.920, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  30%|███       | 300/1000 [18:27<43:04,  0.27it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.145, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.720, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  35%|███▌      | 350/1000 [21:44<40:23,  0.27it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.145, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=1.720, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  35%|███▌      | 350/1000 [21:44<40:23,  0.27it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.620, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  40%|████      | 400/1000 [25:00<37:31,  0.27it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=1.620, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  40%|████      | 400/1000 [25:00<37:31,  0.27it/s, v_num=0, Train/loss_all_step=0.243, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.700, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  45%|████▌     | 450/1000 [28:11<34:27,  0.27it/s, v_num=0, Train/loss_all_step=0.243, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=1.700, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  45%|████▌     | 450/1000 [28:11<34:27,  0.27it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.630, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  50%|█████     | 500/1000 [31:26<31:26,  0.27it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=1.630, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  50%|█████     | 500/1000 [31:26<31:26,  0.27it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.410, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  55%|█████▌    | 550/1000 [34:40<28:22,  0.26it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=1.410, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  55%|█████▌    | 550/1000 [34:40<28:22,  0.26it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.136, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.500, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  60%|██████    | 600/1000 [37:54<25:16,  0.26it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.136, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.500, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  60%|██████    | 600/1000 [37:54<25:16,  0.26it/s, v_num=0, Train/loss_all_step=0.269, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=1.500, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  65%|██████▌   | 650/1000 [41:04<22:06,  0.26it/s, v_num=0, Train/loss_all_step=0.269, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=1.500, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  65%|██████▌   | 650/1000 [41:04<22:06,  0.26it/s, v_num=0, Train/loss_all_step=0.245, Train/loss_unet_all_step=0.156, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.670, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  70%|███████   | 700/1000 [44:01<18:52,  0.26it/s, v_num=0, Train/loss_all_step=0.245, Train/loss_unet_all_step=0.156, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.670, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  70%|███████   | 700/1000 [44:01<18:52,  0.26it/s, v_num=0, Train/loss_all_step=0.256, Train/loss_unet_all_step=0.122, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.910, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  75%|███████▌  | 750/1000 [46:58<15:39,  0.27it/s, v_num=0, Train/loss_all_step=0.256, Train/loss_unet_all_step=0.122, Train/loss_triplet_all_step=0.195, Train/loss_recog_step=1.910, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  75%|███████▌  | 750/1000 [46:58<15:39,  0.27it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.144, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.650, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  80%|████████  | 800/1000 [49:49<12:27,  0.27it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.144, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=1.650, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  80%|████████  | 800/1000 [49:49<12:27,  0.27it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.114, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.680, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  85%|████████▌ | 850/1000 [53:01<09:21,  0.27it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.114, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.680, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  85%|████████▌ | 850/1000 [53:01<09:21,  0.27it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.135, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.360, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  90%|█████████ | 900/1000 [56:13<06:14,  0.27it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.135, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.360, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  90%|█████████ | 900/1000 [56:13<06:14,  0.27it/s, v_num=0, Train/loss_all_step=0.285, Train/loss_unet_all_step=0.154, Train/loss_triplet_all_step=0.208, Train/loss_recog_step=1.590, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  95%|█████████▌| 950/1000 [59:17<03:07,  0.27it/s, v_num=0, Train/loss_all_step=0.285, Train/loss_unet_all_step=0.154, Train/loss_triplet_all_step=0.208, Train/loss_recog_step=1.590, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4:  95%|█████████▌| 950/1000 [59:17<03:07,  0.27it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.155, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.590, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4: 100%|██████████| 1000/1000 [1:02:29<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.155, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.590, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4: 100%|██████████| 1000/1000 [1:02:29<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.140, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.360, Valid/loss_all_step=0.304, Valid/loss_unet_all_step=0.149, Valid/loss_triplet_all_step=0.230, Valid/loss_recog_step=1.600, Valid/loss_all_epoch=0.285, Valid/loss_unet_all_epoch=0.151, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=1.600, Valid/knn_avr=0.409, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:23<00:00,  0.17it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:16<00:00,  0.50it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:15<00:00,  0.53it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:13<00:00,  0.50it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.040127, 0.043142, 0.043292, 0.023246
Valid average loss UNet                 (all)                : 0.149808

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087867, 0.388731, 0.656567
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.140592, 0.162992, 0.184408
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.232705, 0.342151, 0.318073
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.159530, 0.265731, 0.325109
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.160350, 0.368228, 0.430681
Valid average loss all      (Triplet)                 : 0.171114

== Recognize ==
Valid average loss Recognize     : 1.555295
Valid average accuracy drums     : 50.500000 %
Valid average accuracy bass      : 46.500000 %
Valid average accuracy piano     : 45.500000 %
Valid average accuracy guitar    : 51.000000 %
Valid average accuracy residuals : 53.500004 %

== Valid average loss all : 0.246018

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.83541488647461 sec. =
Valid knn accuracy drums     : 74.1304347826087%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.118694067001343 sec. =
Valid knn accuracy bass      : 16.532258064516128%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.57588815689087 sec. =
Valid knn accuracy piano     : 32.03125%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.682757377624512 sec. =
Valid knn accuracy guitar    : 40.17857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.536666870117188 sec. =
Valid knn accuracy residuals : 62.727272727272734%

Valid knn accuracy average   : 45.1199574005938%

                                                                      [AEpoch 4: 100%|██████████| 1000/1000 [1:05:59<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.140, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.360, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.257, Train/loss_unet_all_epoch=0.153, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=1.500]Epoch 4: 100%|██████████| 1000/1000 [1:05:59<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.140, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.360, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.040416, 0.040162, 0.040276, 0.030628
Train average loss UNet                 (all)                : 0.151481

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.085990, 0.312549, 0.610901
Train average loss bass     (Triplet, dist_p, dist_n) : 0.217597, 0.253908, 0.242281
Train average loss piano    (Triplet, dist_p, dist_n) : 0.204757, 0.300505, 0.305909
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.188792, 0.312273, 0.348188
Train average loss residuals(Triplet, dist_p, dist_n) : 0.162757, 0.381107, 0.462982
Train average loss all      (Triplet)                 : 0.173930

== Recognize ==
Train average loss Recognize     : 1.615722
Train average accuracy drums     : 50.365002 %
Train average accuracy bass      : 49.955002 %
Train average accuracy piano     : 50.204998 %
Train average accuracy guitar    : 49.764999 %
Train average accuracy residuals : 49.494999 %

== Train average loss all : 0.249671

Epoch 4:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.140, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.360, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]             Epoch 5:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.140, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.360, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:   5%|▌         | 50/1000 [03:19<1:03:07,  0.25it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.140, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=1.360, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:   5%|▌         | 50/1000 [03:19<1:03:07,  0.25it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.154, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.830, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  10%|█         | 100/1000 [06:34<59:10,  0.25it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.154, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=1.830, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620] Epoch 5:  10%|█         | 100/1000 [06:34<59:10,  0.25it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.250, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  15%|█▌        | 150/1000 [09:49<55:41,  0.25it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.250, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  15%|█▌        | 150/1000 [09:49<55:41,  0.25it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=1.620, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  20%|██        | 200/1000 [12:58<51:54,  0.26it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=1.620, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  20%|██        | 200/1000 [12:58<51:54,  0.26it/s, v_num=0, Train/loss_all_step=0.278, Train/loss_unet_all_step=0.151, Train/loss_triplet_all_step=0.202, Train/loss_recog_step=1.400, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  25%|██▌       | 250/1000 [15:56<47:49,  0.26it/s, v_num=0, Train/loss_all_step=0.278, Train/loss_unet_all_step=0.151, Train/loss_triplet_all_step=0.202, Train/loss_recog_step=1.400, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  25%|██▌       | 250/1000 [15:56<47:49,  0.26it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=1.590, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  30%|███       | 300/1000 [18:53<44:04,  0.26it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=1.590, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  30%|███       | 300/1000 [18:53<44:04,  0.26it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.147, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.660, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  35%|███▌      | 350/1000 [21:44<40:23,  0.27it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.147, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.660, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  35%|███▌      | 350/1000 [21:44<40:23,  0.27it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.540, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  40%|████      | 400/1000 [25:02<37:33,  0.27it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=1.540, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  40%|████      | 400/1000 [25:02<37:33,  0.27it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=2.000, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  45%|████▌     | 450/1000 [28:18<34:36,  0.26it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=2.000, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  45%|████▌     | 450/1000 [28:18<34:36,  0.26it/s, v_num=0, Train/loss_all_step=0.272, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=1.860, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  50%|█████     | 500/1000 [31:33<31:33,  0.26it/s, v_num=0, Train/loss_all_step=0.272, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=1.860, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  50%|█████     | 500/1000 [31:33<31:33,  0.26it/s, v_num=0, Train/loss_all_step=0.280, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=1.690, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  55%|█████▌    | 550/1000 [34:54<28:33,  0.26it/s, v_num=0, Train/loss_all_step=0.280, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=1.690, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  55%|█████▌    | 550/1000 [34:54<28:33,  0.26it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.132, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=1.680, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  60%|██████    | 600/1000 [38:14<25:29,  0.26it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.132, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=1.680, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  60%|██████    | 600/1000 [38:14<25:29,  0.26it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.152, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.680, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  65%|██████▌   | 650/1000 [41:31<22:21,  0.26it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.152, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=1.680, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  65%|██████▌   | 650/1000 [41:31<22:21,  0.26it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.153, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=1.940, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  70%|███████   | 700/1000 [44:45<19:11,  0.26it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.153, Train/loss_triplet_all_step=0.143, Train/loss_recog_step=1.940, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  70%|███████   | 700/1000 [44:45<19:11,  0.26it/s, v_num=0, Train/loss_all_step=0.257, Train/loss_unet_all_step=0.129, Train/loss_triplet_all_step=0.193, Train/loss_recog_step=1.680, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  75%|███████▌  | 750/1000 [48:01<16:00,  0.26it/s, v_num=0, Train/loss_all_step=0.257, Train/loss_unet_all_step=0.129, Train/loss_triplet_all_step=0.193, Train/loss_recog_step=1.680, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  75%|███████▌  | 750/1000 [48:01<16:00,  0.26it/s, v_num=0, Train/loss_all_step=0.241, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.770, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  80%|████████  | 800/1000 [51:13<12:48,  0.26it/s, v_num=0, Train/loss_all_step=0.241, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.770, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  80%|████████  | 800/1000 [51:13<12:48,  0.26it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.116, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.870, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  85%|████████▌ | 850/1000 [54:09<09:33,  0.26it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.116, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.870, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  85%|████████▌ | 850/1000 [54:09<09:33,  0.26it/s, v_num=0, Train/loss_all_step=0.248, Train/loss_unet_all_step=0.132, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=1.720, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  90%|█████████ | 900/1000 [57:04<06:20,  0.26it/s, v_num=0, Train/loss_all_step=0.248, Train/loss_unet_all_step=0.132, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=1.720, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  90%|█████████ | 900/1000 [57:04<06:20,  0.26it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.155, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.890, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  95%|█████████▌| 950/1000 [59:53<03:09,  0.26it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.155, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=1.890, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5:  95%|█████████▌| 950/1000 [59:53<03:09,  0.26it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.153, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.780, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5: 100%|██████████| 1000/1000 [1:02:48<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.153, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=1.780, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5: 100%|██████████| 1000/1000 [1:02:48<00:00,  0.27it/s, v_num=0, Train/loss_all_step=0.263, Train/loss_unet_all_step=0.141, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.870, Valid/loss_all_step=0.269, Valid/loss_unet_all_step=0.150, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.246, Valid/loss_unet_all_epoch=0.150, Valid/loss_triplet_all_epoch=0.171, Valid/loss_recog_epoch=1.560, Valid/knn_avr=0.451, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:19<00:00,  0.20it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:15<00:00,  0.52it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:17<00:00,  0.45it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:16<00:00,  0.42it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:15<00:00,  0.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : 0.039948, 0.043210, 0.043673, 0.020838
Valid average loss UNet                 (all)                : 0.147668

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079704, 0.439743, 0.742412
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.166932, 0.231926, 0.217706
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.271223, 0.515125, 0.451622
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.165487, 0.452093, 0.535031
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.202581, 0.558478, 0.589278
Valid average loss all      (Triplet)                 : 0.191385

== Recognize ==
Valid average loss Recognize     : 1.828783
Valid average accuracy drums     : 50.000000 %
Valid average accuracy bass      : 47.500000 %
Valid average accuracy piano     : 51.000000 %
Valid average accuracy guitar    : 52.499996 %
Valid average accuracy residuals : 51.000000 %

== Valid average loss all : 0.265219

= T-SNE...
T-SNE was finished!
= T-SNE time is 9.686116695404053 sec. =
Valid knn accuracy drums     : 76.52173913043478%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.362415552139282 sec. =
Valid knn accuracy bass      : 16.33064516129032%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.402831077575684 sec. =
Valid knn accuracy piano     : 22.65625%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.075145959854126 sec. =
Valid knn accuracy guitar    : 44.642857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.625868797302246 sec. =
Valid knn accuracy residuals : 61.81818181818181%

Valid knn accuracy average   : 44.393934650552815%

                                                                      [AEpoch 5: 100%|██████████| 1000/1000 [1:06:29<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.263, Train/loss_unet_all_step=0.141, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.870, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.250, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.174, Train/loss_recog_epoch=1.620]Epoch 5: 100%|██████████| 1000/1000 [1:06:29<00:00,  0.25it/s, v_num=0, Train/loss_all_step=0.263, Train/loss_unet_all_step=0.141, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.870, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.040144, 0.039905, 0.040066, 0.030498
Train average loss UNet                 (all)                : 0.150614

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.082140, 0.338052, 0.666364
Train average loss bass     (Triplet, dist_p, dist_n) : 0.216487, 0.264187, 0.255055
Train average loss piano    (Triplet, dist_p, dist_n) : 0.198535, 0.318205, 0.331666
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.187168, 0.312788, 0.354897
Train average loss residuals(Triplet, dist_p, dist_n) : 0.153102, 0.394570, 0.498598
Train average loss all      (Triplet)                 : 0.169812

== Recognize ==
Train average loss Recognize     : 1.755006
Train average accuracy drums     : 49.945000 %
Train average accuracy bass      : 50.204998 %
Train average accuracy piano     : 49.605000 %
Train average accuracy guitar    : 49.985001 %
Train average accuracy residuals : 50.750000 %

== Train average loss all : 0.245119

Epoch 5:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.263, Train/loss_unet_all_step=0.141, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.870, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]             Epoch 6:   0%|          | 0/1000 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.263, Train/loss_unet_all_step=0.141, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.870, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:   5%|▌         | 50/1000 [03:22<1:04:07,  0.25it/s, v_num=0, Train/loss_all_step=0.263, Train/loss_unet_all_step=0.141, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=1.870, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:   5%|▌         | 50/1000 [03:22<1:04:07,  0.25it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.630, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  10%|█         | 100/1000 [06:39<59:54,  0.25it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.630, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760] Epoch 6:  10%|█         | 100/1000 [06:39<59:54,  0.25it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.690, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  15%|█▌        | 150/1000 [09:58<56:30,  0.25it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=1.690, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  15%|█▌        | 150/1000 [09:58<56:30,  0.25it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=2.160, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  20%|██        | 200/1000 [13:13<52:55,  0.25it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=2.160, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  20%|██        | 200/1000 [13:13<52:55,  0.25it/s, v_num=0, Train/loss_all_step=0.308, Train/loss_unet_all_step=0.142, Train/loss_triplet_all_step=0.237, Train/loss_recog_step=1.900, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  25%|██▌       | 250/1000 [16:30<49:30,  0.25it/s, v_num=0, Train/loss_all_step=0.308, Train/loss_unet_all_step=0.142, Train/loss_triplet_all_step=0.237, Train/loss_recog_step=1.900, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  25%|██▌       | 250/1000 [16:30<49:30,  0.25it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.206, Train/loss_recog_step=1.860, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  30%|███       | 300/1000 [19:44<46:03,  0.25it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.206, Train/loss_recog_step=1.860, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  30%|███       | 300/1000 [19:44<46:03,  0.25it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=2.060, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  35%|███▌      | 350/1000 [22:55<42:33,  0.25it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.148, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=2.060, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  35%|███▌      | 350/1000 [22:55<42:33,  0.25it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=2.230, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  40%|████      | 400/1000 [25:50<38:45,  0.26it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=2.230, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  40%|████      | 400/1000 [25:50<38:45,  0.26it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.154, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=2.000, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  45%|████▌     | 450/1000 [28:44<35:07,  0.26it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.154, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=2.000, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  45%|████▌     | 450/1000 [28:44<35:07,  0.26it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=2.000, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  50%|█████     | 500/1000 [31:43<31:43,  0.26it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=2.000, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  50%|█████     | 500/1000 [31:43<31:43,  0.26it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=2.220, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  55%|█████▌    | 550/1000 [34:59<28:37,  0.26it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=2.220, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  55%|█████▌    | 550/1000 [34:59<28:37,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.910, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  60%|██████    | 600/1000 [38:18<25:32,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=1.910, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  60%|██████    | 600/1000 [38:18<25:32,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=2.120, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  65%|██████▌   | 650/1000 [41:36<22:24,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=2.120, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  65%|██████▌   | 650/1000 [41:36<22:24,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=2.030, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  70%|███████   | 700/1000 [44:57<19:16,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=2.030, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  70%|███████   | 700/1000 [44:57<19:16,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=1.800, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  75%|███████▌  | 750/1000 [48:12<16:04,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=1.800, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  75%|███████▌  | 750/1000 [48:12<16:04,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=2.000, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  80%|████████  | 800/1000 [51:27<12:51,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=2.000, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  80%|████████  | 800/1000 [51:27<12:51,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.890, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  85%|████████▌ | 850/1000 [54:43<09:39,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=1.890, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  85%|████████▌ | 850/1000 [54:43<09:39,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.800, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  90%|█████████ | 900/1000 [57:56<06:26,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.800, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  90%|█████████ | 900/1000 [57:56<06:26,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.201, Train/loss_recog_step=1.940, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  95%|█████████▌| 950/1000 [1:01:00<03:12,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.201, Train/loss_recog_step=1.940, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6:  95%|█████████▌| 950/1000 [1:01:00<03:12,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=2.030, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6: 100%|██████████| 1000/1000 [1:03:43<00:00,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=2.030, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6: 100%|██████████| 1000/1000 [1:03:43<00:00,  0.26it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.930, Valid/loss_all_step=0.290, Valid/loss_unet_all_step=0.143, Valid/loss_triplet_all_step=0.218, Valid/loss_recog_step=1.760, Valid/loss_all_epoch=0.265, Valid/loss_unet_all_epoch=0.148, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=1.830, Valid/knn_avr=0.444, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:17<00:00,  0.23it/s][A
Validation DataLoader 0:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 8/8 [00:12<00:00,  0.63it/s][A
Validation DataLoader 1:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 8/8 [00:13<00:00,  0.61it/s][A
Validation DataLoader 2:   0%|          | 0/8 [00:00<?, ?it/s]        [A
Validation DataLoader 3:   0%|          | 0/8 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 8/8 [00:14<00:00,  0.57it/s][A
Validation DataLoader 3:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 7/7 [00:13<00:00,  0.52it/s][A
Validation DataLoader 4:   0%|          | 0/7 [00:00<?, ?it/s]        [A
Validation DataLoader 5:   0%|          | 0/7 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 7/7 [00:13<00:00,  0.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative, cases)  : nan, nan, nan, nan
Valid average loss UNet                 (all)                : nan

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091159, 0.325115, 0.563213
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.145679, 0.172073, 0.180819
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.267358, 0.349189, 0.283234
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.115506, 0.267717, 0.384577
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.108002, 0.375795, 0.493406
Valid average loss all      (Triplet)                 : 0.156297

== Recognize ==
Valid average loss Recognize     : 1.887177
Valid average accuracy drums     : 54.000004 %
Valid average accuracy bass      : 53.500004 %
Valid average accuracy piano     : 54.500000 %
Valid average accuracy guitar    : 47.500000 %
Valid average accuracy residuals : 47.000000 %

== Valid average loss all : nan

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.150173664093018 sec. =
Valid knn accuracy drums     : 72.17391304347827%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.98108196258545 sec. =
Valid knn accuracy bass      : 16.129032258064516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.645014524459839 sec. =
Valid knn accuracy piano     : 31.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.908098697662354 sec. =
Valid knn accuracy guitar    : 55.58035714285714%
= T-SNE...
T-SNE was finished!
= T-SNE time is 9.656735181808472 sec. =
Valid knn accuracy residuals : 64.0909090909091%

Valid knn accuracy average   : 47.8448423070618%

                                                                      [AEpoch 6: 100%|██████████| 1000/1000 [1:07:05<00:00,  0.25it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.930, Valid/loss_all_step=nan.0, Valid/loss_unet_all_step=nan.0, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=1.930, Valid/loss_all_epoch=nan.0, Valid/loss_unet_all_epoch=nan.0, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.890, Valid/knn_avr=0.478, Train/loss_all_epoch=0.245, Train/loss_unet_all_epoch=0.151, Train/loss_triplet_all_epoch=0.170, Train/loss_recog_epoch=1.760]Epoch 6: 100%|██████████| 1000/1000 [1:07:05<00:00,  0.25it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.930, Valid/loss_all_step=nan.0, Valid/loss_unet_all_step=nan.0, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=1.930, Valid/loss_all_epoch=nan.0, Valid/loss_unet_all_epoch=nan.0, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.890, Valid/knn_avr=0.478, Train/loss_all_epoch=0.241, Train/loss_unet_all_epoch=0.149, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.920]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative, cases)  : 0.039868, 0.039496, 0.039715, 0.030244
Train average loss UNet                 (all)                : 0.149206

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.073331, 0.331997, 0.680134
Train average loss bass     (Triplet, dist_p, dist_n) : 0.214487, 0.260659, 0.251766
Train average loss piano    (Triplet, dist_p, dist_n) : 0.192698, 0.318340, 0.340477
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.177414, 0.318725, 0.374018
Train average loss residuals(Triplet, dist_p, dist_n) : 0.141740, 0.393037, 0.511111
Train average loss all      (Triplet)                 : 0.161893

== Recognize ==
Train average loss Recognize     : 1.923638
Train average accuracy drums     : 49.919998 %
Train average accuracy bass      : 49.470001 %
Train average accuracy piano     : 50.019997 %
Train average accuracy guitar    : 50.335003 %
Train average accuracy residuals : 49.884998 %

== Train average loss all : 0.240682

Epoch 6: 100%|██████████| 1000/1000 [1:07:05<00:00,  0.25it/s, v_num=0, Train/loss_all_step=nan.0, Train/loss_unet_all_step=nan.0, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.930, Valid/loss_all_step=nan.0, Valid/loss_unet_all_step=nan.0, Valid/loss_triplet_all_step=0.174, Valid/loss_recog_step=1.930, Valid/loss_all_epoch=nan.0, Valid/loss_unet_all_epoch=nan.0, Valid/loss_triplet_all_epoch=0.156, Valid/loss_recog_epoch=1.890, Valid/knn_avr=0.478, Train/loss_all_epoch=0.241, Train/loss_unet_all_epoch=0.149, Train/loss_triplet_all_epoch=0.162, Train/loss_recog_epoch=1.920]
[2023-11-02 07:42:14,346][source.train][INFO] - [rank: 0] Starting testing!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
The length of seg for train is 3s.
The length of seg for valid and test is 3s.
----------------------------------------
Testing: |          | 0/? [00:00<?, ?it/s]Testing:   0%|          | 0/16 [00:00<?, ?it/s]Testing DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]ディレクトリを作成します
ディレクトリを作成します
ディレクトリを作成します
ディレクトリを作成します
ディレクトリを作成します
ディレクトリを作成します
Testing DataLoader 0: 100%|██████████| 16/16 [00:39<00:00,  0.40it/s]Testing DataLoader 0:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 1: 100%|██████████| 15/15 [00:32<00:00,  0.46it/s]Testing DataLoader 1:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 2:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 2: 100%|██████████| 15/15 [00:35<00:00,  0.43it/s]Testing DataLoader 2:   0%|          | 0/13 [00:00<?, ?it/s]         Testing DataLoader 3:   0%|          | 0/13 [00:00<?, ?it/s]Testing DataLoader 3: 100%|██████████| 13/13 [00:31<00:00,  0.41it/s]Testing DataLoader 3:   0%|          | 0/14 [00:00<?, ?it/s]         Testing DataLoader 4:   0%|          | 0/14 [00:00<?, ?it/s]Testing DataLoader 4: 100%|██████████| 14/14 [00:33<00:00,  0.42it/s]Testing DataLoader 4:   0%|          | 0/15 [00:00<?, ?it/s]         Testing DataLoader 5:   0%|          | 0/15 [00:00<?, ?it/s]Testing DataLoader 5: 100%|██████████| 15/15 [00:34<00:00,  0.43it/s]
Test average accuracy drums     :  47.900002 %
Test average accuracy bass      :  48.000000 %
Test average accuracy piano     :  53.399998 %
Test average accuracy guitar    :  49.599998 %
Test average accuracy residuals :  49.700001 %
= T-SNE...
T-SNE was finished!
= T-SNE time is 21.397570848464966 sec. =
Test knn accuracy drums     : 48.799126637554586%
= T-SNE...
T-SNE was finished!
= T-SNE time is 22.791910409927368 sec. =
Test knn accuracy bass      : 7.087486157253599%
= T-SNE...
T-SNE was finished!
= T-SNE time is 19.548624515533447 sec. =
Test knn accuracy piano     : 22.74939172749392%
= T-SNE...
T-SNE was finished!
= T-SNE time is 21.394192457199097 sec. =
Test knn accuracy guitar    : 17.873303167420815%
= T-SNE...
T-SNE was finished!
= T-SNE time is 22.300132036209106 sec. =
Test knn accuracy residuals : 40.796555435952634%

Test knn accuracy average   : 27.46117262513511%
Testing DataLoader 5: 100%|██████████| 15/15 [02:32<00:00,  0.10it/s]
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 0    ┃   DataLoader 1    ┃   DataLoader 2   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.27461171150207… │ 0.27461171150207… │ 0.2746117115020… │
│   Test/knn_bass   │ 0.07087486237287… │ 0.07087486237287… │ 0.0708748623728… │
│  Test/knn_drums   │ 0.48799127340316… │ 0.48799127340316… │ 0.4879912734031… │
│  Test/knn_guitar  │ 0.17873303592205… │ 0.17873303592205… │ 0.1787330359220… │
│  Test/knn_piano   │ 0.22749391198158… │ 0.22749391198158… │ 0.2274939119815… │
│ Test/knn_residua… │ 0.40796554088592… │ 0.40796554088592… │ 0.4079655408859… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃    Test metric    ┃   DataLoader 3    ┃   DataLoader 4    ┃   DataLoader 5   ┃
┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│   Test/knn_avr    │ 0.27461171150207… │ 0.27461171150207… │ 0.2746117115020… │
│   Test/knn_bass   │ 0.07087486237287… │ 0.07087486237287… │ 0.0708748623728… │
│  Test/knn_drums   │ 0.48799127340316… │ 0.48799127340316… │ 0.4879912734031… │
│  Test/knn_guitar  │ 0.17873303592205… │ 0.17873303592205… │ 0.1787330359220… │
│  Test/knn_piano   │ 0.22749391198158… │ 0.22749391198158… │ 0.2274939119815… │
│ Test/knn_residua… │ 0.40796554088592… │ 0.40796554088592… │ 0.4079655408859… │
└───────────────────┴───────────────────┴───────────────────┴──────────────────┘
[2023-11-02 07:48:19,856][source.train][INFO] - [rank: 0] Best ckpt path: /nas02/homes/imamura23-1000067/outputs/triplet_with_unet/runs/2023-11-01/23-53-16/checkpoints/epoch_004.ckpt
[2023-11-02 07:48:19,859][utils.utils][INFO] - [rank: 0] Output dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023-11-01/23-53-16
[2023-11-02 07:48:19,863][utils.utils][INFO] - [rank: 0] Metric name is None! Skipping metric value retrieval...

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Time taken to study : 07:55:03

All prosess was Done!
