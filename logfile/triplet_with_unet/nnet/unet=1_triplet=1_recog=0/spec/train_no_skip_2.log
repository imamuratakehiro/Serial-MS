
=== Using cuda(utils.func). ===

[2023-11-15 20:15:57,763][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-15 20:15:57,768][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: false                                                            
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.NNetForTriplet                                          
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 1                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         ckpt_model_path: null                                                 
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.NNetForTriplet                                        
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: false                                                            
│         n_mels: 259                                                           
│       ckpt_model_path: null                                                   
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: false                                                            
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.NNetForTriplet                                          
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 1                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         ckpt_model_path: null                                                 
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: -1                                                        
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 200                                                         
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       num_sanity_val_steps: 0                                                 
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       load_using_librosa: false                                               
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_psd_train: 3                                                    
│       seconds_psd_valid: 10                                                   
│       seconds_psd_test: 10                                                    
│       offset_psd_train: 1.5                                                   
│       offset_psd_valid: 5.0                                                   
│       offset_psd_test: 10.0                                                   
│       seconds_triplet_train: 3                                                
│       seconds_triplet_valid: 3                                                
│       offset_triplet_train: 1.5                                               
│       offset_triplet_valid: 1.5                                               
│       seconds_c32_train: 3                                                    
│       seconds_c32_valid: 10                                                   
│       seconds_c32_test: 10                                                    
│       offset_c32_train: 1.5                                                   
│       offset_c32_valid: 5.0                                                   
│       offset_c32_test: 10.0                                                   
│       sr: 44100                                                               
│       mel: false                                                              
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.NNetForTriplet                                            
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 1                                                            
│       recog_rate: 0                                                           
│       test_psd_mine: false                                                    
│       ckpt_model_path: null                                                   
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-15 20:15:57,852][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-15 20:15:57,869][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet_old). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640_addencoder). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de1_to1d640). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-15 20:15:59,220][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpa7gpjsde
[2023-11-15 20:15:59,221][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpa7gpjsde/_remote_module_non_scriptable.py
NNetForTriplet(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (encoder2): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(5, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 5, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=10880, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-15 20:15:59,301][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-15 20:15:59,301][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-15 20:15:59,305][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-15 20:15:59,307][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-15 20:15:59,307][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-15 20:15:59,307][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-15 20:15:59,347][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-15 20:15:59,810][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-15 20:16:00,044][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.651569128036499 sec. *
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s]Epoch 0:  16%|█▌        | 50/313 [00:54<04:46,  0.92it/s, v_num=0, Train/loss_all_step=0.613, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.244, Train/loss_recog_step=0.743]Epoch 0:  32%|███▏      | 100/313 [01:37<03:27,  1.03it/s, v_num=0, Train/loss_all_step=0.613, Train/loss_unet_all_step=0.369, Train/loss_triplet_all_step=0.244, Train/loss_recog_step=0.743]Epoch 0:  32%|███▏      | 100/313 [01:37<03:27,  1.03it/s, v_num=0, Train/loss_all_step=0.540, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.209, Train/loss_recog_step=0.842]Epoch 0:  48%|████▊     | 150/313 [02:19<02:31,  1.07it/s, v_num=0, Train/loss_all_step=0.540, Train/loss_unet_all_step=0.331, Train/loss_triplet_all_step=0.209, Train/loss_recog_step=0.842]Epoch 0:  48%|████▊     | 150/313 [02:19<02:31,  1.07it/s, v_num=0, Train/loss_all_step=0.490, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.659]Epoch 0:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.490, Train/loss_unet_all_step=0.311, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.659]Epoch 0:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.473, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.825]Epoch 0:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.473, Train/loss_unet_all_step=0.283, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.825]Epoch 0:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.484, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.199, Train/loss_recog_step=0.709]Epoch 0:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.484, Train/loss_unet_all_step=0.285, Train/loss_triplet_all_step=0.199, Train/loss_recog_step=0.709]Epoch 0:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.462, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.209, Train/loss_recog_step=0.914]Epoch 0: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.462, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.209, Train/loss_recog_step=0.914]Epoch 0: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.477, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.671]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.73it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.05it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.51it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.35it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.78it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.090780, 0.089274, 0.088954
Valid average loss UNet            (all)              : 0.269008

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.116870, 0.129994, 0.247307
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.253397, 0.163582, 0.112358
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.230763, 0.111033, 0.083446
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.193781, 0.065527, 0.071747
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.180619, 0.144561, 0.164756
Valid average loss all      (Triplet)                 : 0.203256

== Recognize ==
Valid average loss Recognize     : 0.769779
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.472264

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 11.36617398262024 sec. =
Valid knn accuracy drums     : 47.205882352941174%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 11.639020442962646 sec. =
Valid knn accuracy bass      : 9.593023255813954%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 12.799415111541748 sec. =
Valid knn accuracy piano     : 6.351351351351352%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 10.792980670928955 sec. =
Valid knn accuracy guitar    : 8.766233766233766%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 10.814324617385864 sec. =
Valid knn accuracy residuals : 29.40251572327044%

Valid knn accuracy average   : 20.26380128992214%

                                                                        [AEpoch 0: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.477, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.671, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203]Epoch 0: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.477, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.671, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.104008, 0.104182, 0.104407
Train average loss UNet            (all)              : 0.312596

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.265438, 0.609047, 0.688606
Train average loss bass     (Triplet, dist_p, dist_n) : 0.351451, 0.645484, 0.604136
Train average loss piano    (Triplet, dist_p, dist_n) : 0.317567, 0.606810, 0.595819
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.299066, 0.568812, 0.563220
Train average loss residuals(Triplet, dist_p, dist_n) : 0.256653, 0.579091, 0.627777
Train average loss all      (Triplet)                 : 0.298548

== Recognize ==
Train average loss Recognize     : 0.818605
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.611144

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.477, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.671, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.477, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.671, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.477, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.671, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.428, Train/loss_unet_all_step=0.241, Train/loss_triplet_all_step=0.188, Train/loss_recog_step=0.744, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.428, Train/loss_unet_all_step=0.241, Train/loss_triplet_all_step=0.188, Train/loss_recog_step=0.744, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.468, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.842, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.468, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.842, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.261, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.682, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.447, Train/loss_unet_all_step=0.261, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.682, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.244, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.821, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.244, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.821, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.429, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=0.732, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.429, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=0.732, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.426, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.904, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.426, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.904, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.711, Valid/loss_all_step=0.508, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.872, Valid/loss_all_epoch=0.472, Valid/loss_unet_all_epoch=0.269, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.203, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.93it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.98it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.86it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.35it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.69it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.085448, 0.084104, 0.083441
Valid average loss UNet            (all)              : 0.252993

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.093967, 0.162777, 0.354194
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.212469, 0.064697, 0.052228
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.235158, 0.134799, 0.105097
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.187150, 0.102532, 0.115382
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.162888, 0.175364, 0.216035
Valid average loss all      (Triplet)                 : 0.184040

== Recognize ==
Valid average loss Recognize     : 0.786150
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.437034

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.34558653831482 sec. =
Valid knn accuracy drums     : 51.911764705882355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.379026412963867 sec. =
Valid knn accuracy bass      : 10.174418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.482265949249268 sec. =
Valid knn accuracy piano     : 11.891891891891893%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.5856192111969 sec. =
Valid knn accuracy guitar    : 11.2012987012987%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.642829418182373 sec. =
Valid knn accuracy residuals : 26.10062893081761%

Valid knn accuracy average   : 22.256000566908344%

                                                                        [AEpoch 1: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.711, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.611, Train/loss_unet_all_epoch=0.313, Train/loss_triplet_all_epoch=0.299, Train/loss_recog_epoch=0.819]Epoch 1: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.711, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.083830, 0.083683, 0.084690
Train average loss UNet            (all)              : 0.252203

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.121619, 0.177645, 0.330360
Train average loss bass     (Triplet, dist_p, dist_n) : 0.209266, 0.130457, 0.124585
Train average loss piano    (Triplet, dist_p, dist_n) : 0.207676, 0.140455, 0.136763
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.203632, 0.124202, 0.122873
Train average loss residuals(Triplet, dist_p, dist_n) : 0.193858, 0.169708, 0.182741
Train average loss all      (Triplet)                 : 0.187604

== Recognize ==
Train average loss Recognize     : 0.819879
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.439807

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.711, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.711, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.253, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.711, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.418, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=0.764, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.418, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.192, Train/loss_recog_step=0.764, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.838, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.251, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.838, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.424, Train/loss_unet_all_step=0.250, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.643, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.424, Train/loss_unet_all_step=0.250, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.643, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.233, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.791, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.233, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.791, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.410, Train/loss_unet_all_step=0.244, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.695, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.410, Train/loss_unet_all_step=0.244, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.695, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.424, Train/loss_unet_all_step=0.228, Train/loss_triplet_all_step=0.196, Train/loss_recog_step=0.962, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.424, Train/loss_unet_all_step=0.228, Train/loss_triplet_all_step=0.196, Train/loss_recog_step=0.962, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.208, Train/loss_recog_step=0.695, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.210, Valid/loss_recog_step=0.871, Valid/loss_all_epoch=0.437, Valid/loss_unet_all_epoch=0.253, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.786, Valid/knn_avr=0.223, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.20it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.97it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.05it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.47it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.085526, 0.084349, 0.085198
Valid average loss UNet            (all)              : 0.255072

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083457, 0.193798, 0.503548
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.221629, 0.185985, 0.170683
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.243257, 0.197386, 0.154566
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.193534, 0.121266, 0.127732
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.231135, 0.350478, 0.338095
Valid average loss all      (Triplet)                 : 0.198264

== Recognize ==
Valid average loss Recognize     : 0.804453
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.453336

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.03108263015747 sec. =
Valid knn accuracy drums     : 59.411764705882355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.15181303024292 sec. =
Valid knn accuracy bass      : 11.046511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.54866623878479 sec. =
Valid knn accuracy piano     : 10.27027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.304692506790161 sec. =
Valid knn accuracy guitar    : 4.870129870129871%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.995619535446167 sec. =
Valid knn accuracy residuals : 31.91823899371069%

Valid knn accuracy average   : 23.50338309358003%

                                                                        [AEpoch 2: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.208, Train/loss_recog_step=0.695, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.440, Train/loss_unet_all_epoch=0.252, Train/loss_triplet_all_epoch=0.188, Train/loss_recog_epoch=0.820]Epoch 2: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.208, Train/loss_recog_step=0.695, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.080256, 0.080082, 0.081183
Train average loss UNet            (all)              : 0.241521

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.100265, 0.176552, 0.374494
Train average loss bass     (Triplet, dist_p, dist_n) : 0.204938, 0.126733, 0.125937
Train average loss piano    (Triplet, dist_p, dist_n) : 0.204434, 0.131050, 0.130115
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.205079, 0.139201, 0.136683
Train average loss residuals(Triplet, dist_p, dist_n) : 0.188623, 0.188889, 0.207567
Train average loss all      (Triplet)                 : 0.181092

== Recognize ==
Train average loss Recognize     : 0.820139
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.422613

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.208, Train/loss_recog_step=0.695, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.208, Train/loss_recog_step=0.695, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.208, Train/loss_recog_step=0.695, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.393, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.793, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3:  32%|███▏      | 100/313 [01:29<03:11,  1.12it/s, v_num=0, Train/loss_all_step=0.393, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.793, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3:  32%|███▏      | 100/313 [01:29<03:11,  1.12it/s, v_num=0, Train/loss_all_step=0.401, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.838, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.401, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.838, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.415, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.692, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.415, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.692, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=0.789, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=0.789, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.240, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.695, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.240, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.695, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.426, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.201, Train/loss_recog_step=0.912, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.426, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.201, Train/loss_recog_step=0.912, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.238, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.681, Valid/loss_all_step=0.536, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.248, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.255, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.804, Valid/knn_avr=0.235, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.13it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.90it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.45it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.50it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.14it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.083962, 0.083141, 0.083862
Valid average loss UNet            (all)              : 0.250965

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073597, 0.176085, 0.471049
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.218403, 0.137448, 0.119045
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.238543, 0.167561, 0.129085
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.190615, 0.160326, 0.170680
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.158488, 0.194664, 0.247204
Valid average loss all      (Triplet)                 : 0.184192

== Recognize ==
Valid average loss Recognize     : 0.772495
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.435157

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.282370328903198 sec. =
Valid knn accuracy drums     : 65.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.965401411056519 sec. =
Valid knn accuracy bass      : 9.30232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.523656606674194 sec. =
Valid knn accuracy piano     : 13.513513513513514%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.923912763595581 sec. =
Valid knn accuracy guitar    : 17.045454545454543%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.381833791732788 sec. =
Valid knn accuracy residuals : 40.25157232704403%

Valid knn accuracy average   : 29.110808487599133%

                                                                        [AEpoch 3: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.238, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.681, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.423, Train/loss_unet_all_epoch=0.242, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.820]Epoch 3: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.238, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.681, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.078354, 0.078163, 0.079283
Train average loss UNet            (all)              : 0.235800

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.074722, 0.205695, 0.488328
Train average loss bass     (Triplet, dist_p, dist_n) : 0.204883, 0.148041, 0.146757
Train average loss piano    (Triplet, dist_p, dist_n) : 0.203998, 0.154979, 0.154475
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.196871, 0.171692, 0.179849
Train average loss residuals(Triplet, dist_p, dist_n) : 0.186361, 0.210983, 0.234331
Train average loss all      (Triplet)                 : 0.174574

== Recognize ==
Train average loss Recognize     : 0.824614
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.410373

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.238, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.681, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.238, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.681, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.238, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.681, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.369, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.771, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.369, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.771, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.239, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.832, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.239, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.832, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.393, Train/loss_unet_all_step=0.240, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=0.652, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.393, Train/loss_unet_all_step=0.240, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=0.652, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.387, Train/loss_unet_all_step=0.227, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=0.791, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.387, Train/loss_unet_all_step=0.227, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=0.791, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.382, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.685, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.382, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.685, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.396, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.918, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.396, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.918, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.406, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.668, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.219, Valid/loss_recog_step=0.892, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.291, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.06it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.41it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.082689, 0.081606, 0.082261
Valid average loss UNet            (all)              : 0.246556

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.094444, 0.231748, 0.512054
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.221149, 0.182636, 0.164580
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.194166, 0.173560, 0.179586
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.191209, 0.206962, 0.220853
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.185401, 0.267316, 0.302968
Valid average loss all      (Triplet)                 : 0.180837

== Recognize ==
Valid average loss Recognize     : 0.752592
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.427393

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.222436904907227 sec. =
Valid knn accuracy drums     : 69.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.804113626480103 sec. =
Valid knn accuracy bass      : 6.25%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.709643840789795 sec. =
Valid knn accuracy piano     : 13.243243243243244%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.256762027740479 sec. =
Valid knn accuracy guitar    : 17.532467532467532%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.852733373641968 sec. =
Valid knn accuracy residuals : 21.069182389937108%

Valid knn accuracy average   : 25.501331574306047%

                                                                        [AEpoch 4: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.406, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.668, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.410, Train/loss_unet_all_epoch=0.236, Train/loss_triplet_all_epoch=0.175, Train/loss_recog_epoch=0.825]Epoch 4: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.406, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.668, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.077432, 0.077209, 0.078381
Train average loss UNet            (all)              : 0.233022

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.067491, 0.211446, 0.521625
Train average loss bass     (Triplet, dist_p, dist_n) : 0.204969, 0.150788, 0.150940
Train average loss piano    (Triplet, dist_p, dist_n) : 0.201744, 0.162682, 0.163885
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.185248, 0.192545, 0.216413
Train average loss residuals(Triplet, dist_p, dist_n) : 0.178957, 0.227414, 0.260430
Train average loss all      (Triplet)                 : 0.169073

== Recognize ==
Train average loss Recognize     : 0.814888
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.402095

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.406, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.668, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.406, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.668, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.406, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.668, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.359, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.750, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.359, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.750, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.412, Train/loss_unet_all_step=0.238, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.848, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.412, Train/loss_unet_all_step=0.238, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.848, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.398, Train/loss_unet_all_step=0.237, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.662, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.398, Train/loss_unet_all_step=0.237, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.662, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.786, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.786, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.377, Train/loss_unet_all_step=0.233, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.692, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.377, Train/loss_unet_all_step=0.233, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.692, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.940, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.940, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.651, Valid/loss_all_step=0.487, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.881, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.181, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.255, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.75it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.34it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.18it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.90it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.06it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.080090, 0.079088, 0.079225
Valid average loss UNet            (all)              : 0.238403

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079308, 0.216386, 0.537623
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.202473, 0.150426, 0.149661
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.234575, 0.229571, 0.198645
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.151498, 0.196476, 0.277817
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.266302, 0.396512, 0.352088
Valid average loss all      (Triplet)                 : 0.184862

== Recognize ==
Valid average loss Recognize     : 0.776070
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.423266

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.195069074630737 sec. =
Valid knn accuracy drums     : 65.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.567787170410156 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.658746480941772 sec. =
Valid knn accuracy piano     : 16.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.380949974060059 sec. =
Valid knn accuracy guitar    : 25.487012987012985%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.314288854598999 sec. =
Valid knn accuracy residuals : 35.062893081761004%

Valid knn accuracy average   : 31.111108880409144%

                                                                        [AEpoch 5: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.651, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 5: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.651, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.076612, 0.076412, 0.077604
Train average loss UNet            (all)              : 0.230627

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.063588, 0.222283, 0.542738
Train average loss bass     (Triplet, dist_p, dist_n) : 0.203234, 0.151469, 0.153702
Train average loss piano    (Triplet, dist_p, dist_n) : 0.197663, 0.181457, 0.188927
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.176040, 0.206473, 0.247804
Train average loss residuals(Triplet, dist_p, dist_n) : 0.168788, 0.257819, 0.308892
Train average loss all      (Triplet)                 : 0.163212

== Recognize ==
Train average loss Recognize     : 0.814934
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.393839

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.651, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.651, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6:  16%|█▌        | 50/313 [01:11<06:17,  0.70it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.171, Train/loss_recog_step=0.651, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6:  16%|█▌        | 50/313 [01:11<06:17,  0.70it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.716, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6:  32%|███▏      | 100/313 [01:53<04:02,  0.88it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.716, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6:  32%|███▏      | 100/313 [01:53<04:02,  0.88it/s, v_num=0, Train/loss_all_step=0.372, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.823, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6:  48%|████▊     | 150/313 [02:35<02:48,  0.97it/s, v_num=0, Train/loss_all_step=0.372, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.823, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6:  48%|████▊     | 150/313 [02:35<02:48,  0.97it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.644, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.644, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6:  64%|██████▍   | 200/313 [03:17<01:51,  1.01it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.782, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.782, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6:  80%|███████▉  | 250/313 [04:08<01:02,  1.01it/s, v_num=0, Train/loss_all_step=0.366, Train/loss_unet_all_step=0.230, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.666, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6:  96%|█████████▌| 300/313 [05:13<00:13,  0.96it/s, v_num=0, Train/loss_all_step=0.366, Train/loss_unet_all_step=0.230, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.666, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6:  96%|█████████▌| 300/313 [05:13<00:13,  0.96it/s, v_num=0, Train/loss_all_step=0.367, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.919, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6: 100%|██████████| 313/313 [05:29<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.367, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.919, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6: 100%|██████████| 313/313 [05:29<00:00,  0.95it/s, v_num=0, Train/loss_all_step=0.397, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.666, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.423, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.311, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.85it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.08it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.56it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.079627, 0.078179, 0.078030
Valid average loss UNet            (all)              : 0.235836

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.065075, 0.247350, 0.639369
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.285381, 0.284193, 0.212940
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.214192, 0.222203, 0.245134
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.139668, 0.207155, 0.313750
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.137115, 0.301075, 0.395133
Valid average loss all      (Triplet)                 : 0.186370

== Recognize ==
Valid average loss Recognize     : 0.752597
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.422206

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.179534673690796 sec. =
Valid knn accuracy drums     : 73.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.27942705154419 sec. =
Valid knn accuracy bass      : 17.87790697674419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.444576978683472 sec. =
Valid knn accuracy piano     : 14.324324324324325%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.126234531402588 sec. =
Valid knn accuracy guitar    : 23.7012987012987%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.759447574615479 sec. =
Valid knn accuracy residuals : 30.50314465408805%

Valid knn accuracy average   : 31.928393754820462%

                                                                        [AEpoch 6: 100%|██████████| 313/313 [07:07<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.397, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.666, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.394, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.815]Epoch 6: 100%|██████████| 313/313 [07:07<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.397, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.666, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.075948, 0.075717, 0.076942
Train average loss UNet            (all)              : 0.228607

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.061870, 0.226497, 0.555562
Train average loss bass     (Triplet, dist_p, dist_n) : 0.200425, 0.158532, 0.162542
Train average loss piano    (Triplet, dist_p, dist_n) : 0.194544, 0.191338, 0.203163
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.165149, 0.214135, 0.274801
Train average loss residuals(Triplet, dist_p, dist_n) : 0.160383, 0.286646, 0.353138
Train average loss all      (Triplet)                 : 0.157735

== Recognize ==
Train average loss Recognize     : 0.805867
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.386342

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.397, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.666, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.397, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.666, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.397, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.666, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7:  16%|█▌        | 50/313 [01:08<05:59,  0.73it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=0.742, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7:  32%|███▏      | 100/313 [02:12<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=0.742, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7:  32%|███▏      | 100/313 [02:12<04:43,  0.75it/s, v_num=0, Train/loss_all_step=0.370, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.844, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7:  48%|████▊     | 150/313 [03:19<03:37,  0.75it/s, v_num=0, Train/loss_all_step=0.370, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.844, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7:  48%|████▊     | 150/313 [03:19<03:37,  0.75it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=0.629, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7:  64%|██████▍   | 200/313 [04:24<02:29,  0.76it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=0.629, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7:  64%|██████▍   | 200/313 [04:24<02:29,  0.76it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=0.805, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=0.805, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7:  80%|███████▉  | 250/313 [05:08<01:17,  0.81it/s, v_num=0, Train/loss_all_step=0.349, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=0.700, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.349, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=0.700, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7:  96%|█████████▌| 300/313 [06:19<00:16,  0.79it/s, v_num=0, Train/loss_all_step=0.372, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.937, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7: 100%|██████████| 313/313 [06:36<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.372, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.151, Train/loss_recog_step=0.937, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7: 100%|██████████| 313/313 [06:36<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=0.654, Valid/loss_all_step=0.521, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.254, Valid/loss_recog_step=0.864, Valid/loss_all_epoch=0.422, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.753, Valid/knn_avr=0.319, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:02<00:00,  1.60it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  3.98it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  3.95it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.99it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:02<00:00,  4.00it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  3.89it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.078948, 0.077554, 0.077950
Valid average loss UNet            (all)              : 0.234452

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064818, 0.197136, 0.528046
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.207037, 0.228810, 0.224320
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.186739, 0.163299, 0.176698
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.143247, 0.195397, 0.294221
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.150388, 0.279341, 0.340269
Valid average loss all      (Triplet)                 : 0.156691

== Recognize ==
Valid average loss Recognize     : 0.767171
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.391143

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.613144397735596 sec. =
Valid knn accuracy drums     : 51.911764705882355%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.957451820373535 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.851601123809814 sec. =
Valid knn accuracy piano     : 20.405405405405403%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.302106380462646 sec. =
Valid knn accuracy guitar    : 30.357142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.296702861785889 sec. =
Valid knn accuracy residuals : 37.89308176100629%

Valid knn accuracy average   : 30.933246387747847%

                                                                        [AEpoch 7: 100%|██████████| 313/313 [08:18<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=0.654, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.386, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.158, Train/loss_recog_epoch=0.806]Epoch 7: 100%|██████████| 313/313 [08:18<00:00,  0.63it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=0.654, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.075486, 0.075261, 0.076487
Train average loss UNet            (all)              : 0.227234

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.058236, 0.240921, 0.586394
Train average loss bass     (Triplet, dist_p, dist_n) : 0.198385, 0.183783, 0.194316
Train average loss piano    (Triplet, dist_p, dist_n) : 0.191900, 0.216408, 0.232816
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.161052, 0.225278, 0.298866
Train average loss residuals(Triplet, dist_p, dist_n) : 0.153720, 0.303111, 0.382043
Train average loss all      (Triplet)                 : 0.153982

== Recognize ==
Train average loss Recognize     : 0.816774
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.381217

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=0.654, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=0.654, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8:  16%|█▌        | 50/313 [01:17<06:49,  0.64it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=0.654, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8:  16%|█▌        | 50/313 [01:17<06:49,  0.64it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.736, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8:  32%|███▏      | 100/313 [02:30<05:21,  0.66it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.736, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8:  32%|███▏      | 100/313 [02:30<05:21,  0.66it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.233, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=0.842, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8:  48%|████▊     | 150/313 [03:20<03:37,  0.75it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.233, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=0.842, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8:  48%|████▊     | 150/313 [03:20<03:37,  0.75it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.637, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.637, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8:  64%|██████▍   | 200/313 [04:02<02:17,  0.82it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.809, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8:  80%|███████▉  | 250/313 [04:44<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.809, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8:  80%|███████▉  | 250/313 [04:44<01:11,  0.88it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.228, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.689, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8:  96%|█████████▌| 300/313 [05:25<00:14,  0.92it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.228, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.689, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8:  96%|█████████▌| 300/313 [05:25<00:14,  0.92it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.928, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8: 100%|██████████| 313/313 [05:34<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.928, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8: 100%|██████████| 313/313 [05:34<00:00,  0.93it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=0.667, Valid/loss_all_step=0.433, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.906, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.234, Valid/loss_triplet_all_epoch=0.157, Valid/loss_recog_epoch=0.767, Valid/knn_avr=0.309, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.13it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.95it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.97it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.72it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.61it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.078555, 0.077192, 0.077562
Valid average loss UNet            (all)              : 0.233309

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.061297, 0.206878, 0.507127
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.220041, 0.207492, 0.204341
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.217384, 0.234717, 0.217333
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.127242, 0.224395, 0.346703
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.124383, 0.347479, 0.454658
Valid average loss all      (Triplet)                 : 0.157620

== Recognize ==
Valid average loss Recognize     : 0.751855
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.390930

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.151474237442017 sec. =
Valid knn accuracy drums     : 63.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.879218816757202 sec. =
Valid knn accuracy bass      : 18.168604651162788%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.584956407546997 sec. =
Valid knn accuracy piano     : 14.864864864864865%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.421342134475708 sec. =
Valid knn accuracy guitar    : 36.038961038961034%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.75534176826477 sec. =
Valid knn accuracy residuals : 46.069182389937104%

Valid knn accuracy average   : 35.76361670663222%

                                                                        [AEpoch 8: 100%|██████████| 313/313 [07:08<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=0.667, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.227, Train/loss_triplet_all_epoch=0.154, Train/loss_recog_epoch=0.817]Epoch 8: 100%|██████████| 313/313 [07:08<00:00,  0.73it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=0.667, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.075168, 0.074889, 0.076071
Train average loss UNet            (all)              : 0.226128

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.053655, 0.253931, 0.629920
Train average loss bass     (Triplet, dist_p, dist_n) : 0.196371, 0.199240, 0.212429
Train average loss piano    (Triplet, dist_p, dist_n) : 0.185660, 0.242640, 0.269081
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.156178, 0.238448, 0.324162
Train average loss residuals(Triplet, dist_p, dist_n) : 0.151933, 0.327519, 0.416249
Train average loss all      (Triplet)                 : 0.150378

== Recognize ==
Train average loss Recognize     : 0.823949
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.376506

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=0.667, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=0.667, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=0.667, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.746, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.746, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.370, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.839, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.370, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.839, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.352, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.662, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.352, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.662, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.338, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=0.797, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.338, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=0.797, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.656, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.656, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.949, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.949, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.661, Valid/loss_all_step=0.424, Valid/loss_unet_all_step=0.260, Valid/loss_triplet_all_step=0.164, Valid/loss_recog_step=0.888, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.752, Valid/knn_avr=0.358, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.50it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.13it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.35it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.078804, 0.077432, 0.079121
Valid average loss UNet            (all)              : 0.235357

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060098, 0.221867, 0.497493
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.192320, 0.194635, 0.211946
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.208806, 0.238484, 0.234404
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.119286, 0.229381, 0.375032
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.108499, 0.321200, 0.451284
Valid average loss all      (Triplet)                 : 0.143896

== Recognize ==
Valid average loss Recognize     : 0.775110
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.379253

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.434916257858276 sec. =
Valid knn accuracy drums     : 66.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.189047574996948 sec. =
Valid knn accuracy bass      : 16.13372093023256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.68891167640686 sec. =
Valid knn accuracy piano     : 19.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.184340476989746 sec. =
Valid knn accuracy guitar    : 31.818181818181817%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.603607416152954 sec. =
Valid knn accuracy residuals : 54.55974842767296%

Valid knn accuracy average   : 37.51902339896945%

                                                                        [AEpoch 9: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.661, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.150, Train/loss_recog_epoch=0.824]Epoch 9: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.661, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.074454, 0.074173, 0.075374
Train average loss UNet            (all)              : 0.224001

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.049299, 0.260774, 0.651204
Train average loss bass     (Triplet, dist_p, dist_n) : 0.192178, 0.207210, 0.226362
Train average loss piano    (Triplet, dist_p, dist_n) : 0.180840, 0.258919, 0.291560
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.150799, 0.253635, 0.351582
Train average loss residuals(Triplet, dist_p, dist_n) : 0.143045, 0.337283, 0.438143
Train average loss all      (Triplet)                 : 0.144608

== Recognize ==
Train average loss Recognize     : 0.820361
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.368608

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.661, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.661, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.661, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.335, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.780, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.335, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.780, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.867, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.867, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.358, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.647, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.358, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.647, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=0.823, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=0.823, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.318, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.0955, Train/loss_recog_step=0.685, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.318, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.0955, Train/loss_recog_step=0.685, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.973, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820] Epoch 10: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.973, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.661, Valid/loss_all_step=0.392, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.128, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.379, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.144, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.375, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.99it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.47it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.97it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.71it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.79it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.076481, 0.074712, 0.074640
Valid average loss UNet            (all)              : 0.225833

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068344, 0.248874, 0.578924
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.212415, 0.254561, 0.256194
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.209324, 0.255114, 0.260058
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.164302, 0.280899, 0.429141
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.108135, 0.342467, 0.464169
Valid average loss all      (Triplet)                 : 0.161677

== Recognize ==
Valid average loss Recognize     : 0.786668
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.387510

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.555755853652954 sec. =
Valid knn accuracy drums     : 65.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.383777141571045 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.50338363647461 sec. =
Valid knn accuracy piano     : 27.972972972972972%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.594260454177856 sec. =
Valid knn accuracy guitar    : 35.87662337662338%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.774450540542603 sec. =
Valid knn accuracy residuals : 48.270440251572325%

Valid knn accuracy average   : 38.593979960452614%

                                                                        [AEpoch 10: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.661, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.224, Train/loss_triplet_all_epoch=0.145, Train/loss_recog_epoch=0.820]Epoch 10: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.661, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.073705, 0.073483, 0.074604
Train average loss UNet            (all)              : 0.221792

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.046945, 0.278100, 0.674605
Train average loss bass     (Triplet, dist_p, dist_n) : 0.188986, 0.223541, 0.245159
Train average loss piano    (Triplet, dist_p, dist_n) : 0.179021, 0.273017, 0.308259
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.149404, 0.266866, 0.366181
Train average loss residuals(Triplet, dist_p, dist_n) : 0.134500, 0.357955, 0.473614
Train average loss all      (Triplet)                 : 0.141372

== Recognize ==
Train average loss Recognize     : 0.840711
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.363165

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.661, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.661, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.661, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.338, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.772, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.338, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.772, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.895, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.374, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.895, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.349, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=0.648, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.349, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=0.648, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.309, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0963, Train/loss_recog_step=0.816, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.309, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0963, Train/loss_recog_step=0.816, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.0904, Train/loss_recog_step=0.693, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.0904, Train/loss_recog_step=0.693, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.994, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841] Epoch 11: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.994, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.662, Valid/loss_all_step=0.436, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.189, Valid/loss_recog_step=0.951, Valid/loss_all_epoch=0.388, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.162, Valid/loss_recog_epoch=0.787, Valid/knn_avr=0.386, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.09it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.21it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.46it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.076449, 0.075096, 0.076062
Valid average loss UNet            (all)              : 0.227607

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060077, 0.293579, 0.672342
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.228797, 0.296875, 0.274848
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.197274, 0.279097, 0.286855
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.178033, 0.314639, 0.439469
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.111843, 0.353833, 0.465531
Valid average loss all      (Triplet)                 : 0.165725

== Recognize ==
Valid average loss Recognize     : 0.800598
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.393332

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.437355756759644 sec. =
Valid knn accuracy drums     : 74.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.59267258644104 sec. =
Valid knn accuracy bass      : 16.71511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.955116271972656 sec. =
Valid knn accuracy piano     : 29.324324324324323%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.435402631759644 sec. =
Valid knn accuracy guitar    : 40.0974025974026%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.769390344619751 sec. =
Valid knn accuracy residuals : 51.41509433962265%

Valid knn accuracy average   : 42.39274044926034%

                                                                        [AEpoch 11: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.662, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.141, Train/loss_recog_epoch=0.841]Epoch 11: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.662, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.072946, 0.072613, 0.073842
Train average loss UNet            (all)              : 0.219401

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.045003, 0.298599, 0.710940
Train average loss bass     (Triplet, dist_p, dist_n) : 0.183820, 0.244934, 0.275573
Train average loss piano    (Triplet, dist_p, dist_n) : 0.175262, 0.286994, 0.327746
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.144293, 0.281860, 0.395083
Train average loss residuals(Triplet, dist_p, dist_n) : 0.131287, 0.374088, 0.499998
Train average loss all      (Triplet)                 : 0.137372

== Recognize ==
Train average loss Recognize     : 0.843887
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.356773

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.662, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.662, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.662, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=0.775, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=0.775, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.888, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.888, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.645, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.645, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.305, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0942, Train/loss_recog_step=0.833, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.305, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0942, Train/loss_recog_step=0.833, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.0824, Train/loss_recog_step=0.699, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.0824, Train/loss_recog_step=0.699, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.000, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844] Epoch 12: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=1.000, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.669, Valid/loss_all_step=0.451, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.198, Valid/loss_recog_step=0.969, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.801, Valid/knn_avr=0.424, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.21it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.95it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.16it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.89it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.077150, 0.076338, 0.079094
Valid average loss UNet            (all)              : 0.232581

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.068696, 0.283567, 0.602447
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.299454, 0.346594, 0.369060
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.219841, 0.309879, 0.294500
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.183564, 0.305990, 0.447926
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.280888, 0.585290, 0.548122
Valid average loss all      (Triplet)                 : 0.224106

== Recognize ==
Valid average loss Recognize     : 0.807793
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.456687

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.792723894119263 sec. =
Valid knn accuracy drums     : 65.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.616217613220215 sec. =
Valid knn accuracy bass      : 13.226744186046513%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.601863622665405 sec. =
Valid knn accuracy piano     : 28.64864864864865%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.037551403045654 sec. =
Valid knn accuracy guitar    : 32.7922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.909853219985962 sec. =
Valid knn accuracy residuals : 49.528301886792455%

Valid knn accuracy average   : 37.92741579685673%

                                                                        [AEpoch 12: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.669, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.357, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.844]Epoch 12: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.669, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.072438, 0.072086, 0.073229
Train average loss UNet            (all)              : 0.217753

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.041880, 0.311946, 0.733072
Train average loss bass     (Triplet, dist_p, dist_n) : 0.182813, 0.258176, 0.290891
Train average loss piano    (Triplet, dist_p, dist_n) : 0.169396, 0.313050, 0.365868
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.139771, 0.307767, 0.432014
Train average loss residuals(Triplet, dist_p, dist_n) : 0.128298, 0.394882, 0.528591
Train average loss all      (Triplet)                 : 0.133949

== Recognize ==
Train average loss Recognize     : 0.853074
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.351701

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.669, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.669, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.669, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.761, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13:  32%|███▏      | 100/313 [01:29<03:11,  1.12it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.761, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=0.915, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=0.915, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.352, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.667, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.352, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.667, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.302, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0908, Train/loss_recog_step=0.829, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.302, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0908, Train/loss_recog_step=0.829, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.083, Train/loss_recog_step=0.687, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853] Epoch 13:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.083, Train/loss_recog_step=0.687, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.030, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=1.030, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.662, Valid/loss_all_step=0.648, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.394, Valid/loss_recog_step=0.984, Valid/loss_all_epoch=0.457, Valid/loss_unet_all_epoch=0.233, Valid/loss_triplet_all_epoch=0.224, Valid/loss_recog_epoch=0.808, Valid/knn_avr=0.379, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.15it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.34it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.98it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.29it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.95it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.075338, 0.073540, 0.073718
Valid average loss UNet            (all)              : 0.222595

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.050572, 0.281687, 0.628104
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.210222, 0.276413, 0.267769
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.218210, 0.288133, 0.274880
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.184415, 0.333281, 0.483096
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.117491, 0.336528, 0.457638
Valid average loss all      (Triplet)                 : 0.166251

== Recognize ==
Valid average loss Recognize     : 0.825020
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.388847

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.126864910125732 sec. =
Valid knn accuracy drums     : 70.44117647058825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.078562259674072 sec. =
Valid knn accuracy bass      : 15.55232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.188860654830933 sec. =
Valid knn accuracy piano     : 29.18918918918919%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.289652824401855 sec. =
Valid knn accuracy guitar    : 40.0974025974026%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.713565826416016 sec. =
Valid knn accuracy residuals : 45.911949685534594%

Valid knn accuracy average   : 40.23840870482199%

                                                                        [AEpoch 13: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.662, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.352, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.853]Epoch 13: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.662, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.072020, 0.071819, 0.072914
Train average loss UNet            (all)              : 0.216754

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.039316, 0.328123, 0.767776
Train average loss bass     (Triplet, dist_p, dist_n) : 0.180252, 0.268088, 0.305664
Train average loss piano    (Triplet, dist_p, dist_n) : 0.167114, 0.321016, 0.377733
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.136691, 0.321017, 0.451823
Train average loss residuals(Triplet, dist_p, dist_n) : 0.125097, 0.403228, 0.539970
Train average loss all      (Triplet)                 : 0.131229

== Recognize ==
Train average loss Recognize     : 0.863746
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.347983

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.662, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.662, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.662, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.332, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.803, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.332, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.803, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.929, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.929, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.340, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=0.662, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.340, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=0.662, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.300, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0924, Train/loss_recog_step=0.843, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.300, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0924, Train/loss_recog_step=0.843, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0974, Train/loss_recog_step=0.698, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0974, Train/loss_recog_step=0.698, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.336, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.010, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864] Epoch 14: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.336, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.010, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.655, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.389, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.166, Valid/loss_recog_epoch=0.825, Valid/knn_avr=0.402, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.80it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.76it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.95it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.26it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.075487, 0.074125, 0.076795
Valid average loss UNet            (all)              : 0.226407

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.048903, 0.323284, 0.715416
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.242287, 0.316970, 0.356172
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.212953, 0.355810, 0.350986
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.166202, 0.403564, 0.599028
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.182955, 0.468952, 0.527355
Valid average loss all      (Triplet)                 : 0.184382

== Recognize ==
Valid average loss Recognize     : 0.804623
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.410789

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.068925619125366 sec. =
Valid knn accuracy drums     : 75.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.550368309020996 sec. =
Valid knn accuracy bass      : 13.08139534883721%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.798075914382935 sec. =
Valid knn accuracy piano     : 35.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.31109619140625 sec. =
Valid knn accuracy guitar    : 43.506493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.88119101524353 sec. =
Valid knn accuracy residuals : 57.861635220125784%

Valid knn accuracy average   : 44.978140109208944%

                                                                        [AEpoch 14: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.655, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.348, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.131, Train/loss_recog_epoch=0.864]Epoch 14: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.655, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.071597, 0.071292, 0.072446
Train average loss UNet            (all)              : 0.215336

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.035868, 0.347572, 0.801066
Train average loss bass     (Triplet, dist_p, dist_n) : 0.175814, 0.286427, 0.331051
Train average loss piano    (Triplet, dist_p, dist_n) : 0.163794, 0.345518, 0.408183
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.133517, 0.348008, 0.491974
Train average loss residuals(Triplet, dist_p, dist_n) : 0.121653, 0.435462, 0.584579
Train average loss all      (Triplet)                 : 0.127669

== Recognize ==
Train average loss Recognize     : 0.868128
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.343005

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.655, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.655, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.655, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.323, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=0.809, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.323, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=0.809, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.895, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.895, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.0946, Train/loss_recog_step=0.653, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.0946, Train/loss_recog_step=0.653, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15:  64%|██████▍   | 200/313 [02:51<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.296, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0867, Train/loss_recog_step=0.841, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.296, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0867, Train/loss_recog_step=0.841, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.308, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0943, Train/loss_recog_step=0.714, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.308, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0943, Train/loss_recog_step=0.714, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.030, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868] Epoch 15: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.120, Train/loss_recog_step=1.030, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.660, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.276, Valid/loss_recog_step=0.994, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.184, Valid/loss_recog_epoch=0.805, Valid/knn_avr=0.450, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.71it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.69it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.00it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.47it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.85it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.077215, 0.075222, 0.075250
Valid average loss UNet            (all)              : 0.227687

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.058956, 0.327989, 0.732456
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.262825, 0.384138, 0.408401
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.219079, 0.371035, 0.359519
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.177906, 0.388964, 0.596604
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.128513, 0.452420, 0.563531
Valid average loss all      (Triplet)                 : 0.187724

== Recognize ==
Valid average loss Recognize     : 0.812502
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.415411

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.510582208633423 sec. =
Valid knn accuracy drums     : 73.6764705882353%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.79710340499878 sec. =
Valid knn accuracy bass      : 16.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.20940899848938 sec. =
Valid knn accuracy piano     : 35.67567567567568%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.238649368286133 sec. =
Valid knn accuracy guitar    : 39.61038961038961%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.951248168945312 sec. =
Valid knn accuracy residuals : 56.132075471698116%

Valid knn accuracy average   : 44.39101529245555%

                                                                        [AEpoch 15: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.660, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.343, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.868]Epoch 15: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.660, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.071234, 0.070957, 0.072092
Train average loss UNet            (all)              : 0.214283

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.033483, 0.358820, 0.834120
Train average loss bass     (Triplet, dist_p, dist_n) : 0.172879, 0.304142, 0.355245
Train average loss piano    (Triplet, dist_p, dist_n) : 0.159980, 0.361334, 0.429561
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.129673, 0.363367, 0.516934
Train average loss residuals(Triplet, dist_p, dist_n) : 0.120749, 0.444326, 0.598840
Train average loss all      (Triplet)                 : 0.124997

== Recognize ==
Train average loss Recognize     : 0.873272
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.339279

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.660, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.660, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]Epoch 16:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.660, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]Epoch 16:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.309, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.807, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]Epoch 16:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.309, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.807, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]Epoch 16:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.355, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.912, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]Epoch 16:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.355, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.912, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]Epoch 16:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.307, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.0887, Train/loss_recog_step=0.660, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]Epoch 16:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.307, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.0887, Train/loss_recog_step=0.660, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]Epoch 16:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.289, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.083, Train/loss_recog_step=0.860, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873] Epoch 16:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.289, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.083, Train/loss_recog_step=0.860, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]Epoch 16:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.308, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0944, Train/loss_recog_step=0.729, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]Epoch 16:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.308, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0944, Train/loss_recog_step=0.729, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]Epoch 16:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.040, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873] Epoch 16: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=1.040, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]Epoch 16: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.304, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0892, Train/loss_recog_step=0.693, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.267, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.188, Valid/loss_recog_epoch=0.813, Valid/knn_avr=0.444, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.74it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.13it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.22it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.077368, 0.075590, 0.076748
Valid average loss UNet            (all)              : 0.229706

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064918, 0.400548, 0.876945
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.223979, 0.334687, 0.352397
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.240423, 0.436151, 0.404887
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.225441, 0.453700, 0.605855
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.156501, 0.516904, 0.605677
Valid average loss all      (Triplet)                 : 0.189947

== Recognize ==
Valid average loss Recognize     : 0.829317
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.419653

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.206804513931274 sec. =
Valid knn accuracy drums     : 74.11764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.796492099761963 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.049940347671509 sec. =
Valid knn accuracy piano     : 22.702702702702705%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.442724466323853 sec. =
Valid knn accuracy guitar    : 33.116883116883116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.591744184494019 sec. =
Valid knn accuracy residuals : 55.188679245283026%

Valid knn accuracy average   : 40.22285684334313%

                                                                        [AEpoch 16: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.304, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0892, Train/loss_recog_step=0.693, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.125, Train/loss_recog_epoch=0.873]Epoch 16: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.304, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0892, Train/loss_recog_step=0.693, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.070966, 0.070633, 0.071845
Train average loss UNet            (all)              : 0.213443

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.032957, 0.383154, 0.874817
Train average loss bass     (Triplet, dist_p, dist_n) : 0.173492, 0.322271, 0.373144
Train average loss piano    (Triplet, dist_p, dist_n) : 0.154695, 0.380629, 0.458986
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.127386, 0.383526, 0.545619
Train average loss residuals(Triplet, dist_p, dist_n) : 0.116413, 0.468581, 0.631449
Train average loss all      (Triplet)                 : 0.122474

== Recognize ==
Train average loss Recognize     : 0.881945
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.335917

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.304, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0892, Train/loss_recog_step=0.693, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.304, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0892, Train/loss_recog_step=0.693, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]Epoch 17:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.304, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0892, Train/loss_recog_step=0.693, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]Epoch 17:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.293, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0976, Train/loss_recog_step=0.807, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]Epoch 17:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.293, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0976, Train/loss_recog_step=0.807, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]Epoch 17:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.343, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.928, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882] Epoch 17:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.343, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.928, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]Epoch 17:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.315, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0993, Train/loss_recog_step=0.678, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]Epoch 17:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.315, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0993, Train/loss_recog_step=0.678, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]Epoch 17:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.292, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0871, Train/loss_recog_step=0.861, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]Epoch 17:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.292, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0871, Train/loss_recog_step=0.861, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]Epoch 17:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0994, Train/loss_recog_step=0.724, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]Epoch 17:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0994, Train/loss_recog_step=0.724, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]Epoch 17:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=1.030, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882] Epoch 17: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=1.030, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]Epoch 17: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.681, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.420, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.829, Valid/knn_avr=0.402, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.95it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.66it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.64it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.01it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.82it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.27it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074951, 0.072943, 0.075882
Valid average loss UNet            (all)              : 0.223776

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.060198, 0.462204, 0.983693
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.262549, 0.471915, 0.455473
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.262508, 0.492635, 0.441708
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.199440, 0.504299, 0.705961
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.147287, 0.581944, 0.690645
Valid average loss all      (Triplet)                 : 0.204705

== Recognize ==
Valid average loss Recognize     : 0.823667
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.428481

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.238856077194214 sec. =
Valid knn accuracy drums     : 75.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.132188558578491 sec. =
Valid knn accuracy bass      : 12.209302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.452468395233154 sec. =
Valid knn accuracy piano     : 32.972972972972975%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.495146036148071 sec. =
Valid knn accuracy guitar    : 35.22727272727273%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.200651168823242 sec. =
Valid knn accuracy residuals : 50.314465408805034%

Valid knn accuracy average   : 41.14480268692643%

                                                                        [AEpoch 17: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.681, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.336, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.122, Train/loss_recog_epoch=0.882]Epoch 17: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.681, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.070788, 0.070533, 0.071644
Train average loss UNet            (all)              : 0.212965

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.029702, 0.405400, 0.914542
Train average loss bass     (Triplet, dist_p, dist_n) : 0.167983, 0.340026, 0.399030
Train average loss piano    (Triplet, dist_p, dist_n) : 0.152050, 0.393760, 0.477297
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.123137, 0.398240, 0.567026
Train average loss residuals(Triplet, dist_p, dist_n) : 0.113149, 0.487312, 0.656893
Train average loss all      (Triplet)                 : 0.118682

== Recognize ==
Train average loss Recognize     : 0.889080
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.331647

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.681, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.681, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.681, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.300, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.801, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.300, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.801, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.346, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.940, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.346, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.940, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.315, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.0943, Train/loss_recog_step=0.663, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.315, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.0943, Train/loss_recog_step=0.663, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0847, Train/loss_recog_step=0.870, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0847, Train/loss_recog_step=0.870, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.314, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.717, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889] Epoch 18:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.314, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.717, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.050, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=1.050, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0873, Train/loss_recog_step=0.677, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.304, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.428, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.824, Valid/knn_avr=0.411, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.79it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.37it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.68it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.43it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.12it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074355, 0.072406, 0.075147
Valid average loss UNet            (all)              : 0.221909

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067745, 0.435655, 0.940462
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.249833, 0.448142, 0.435440
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.263089, 0.495580, 0.446120
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.220641, 0.507446, 0.678456
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.198877, 0.602470, 0.654939
Valid average loss all      (Triplet)                 : 0.212390

== Recognize ==
Valid average loss Recognize     : 0.825652
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.434299

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.250495672225952 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.331768989562988 sec. =
Valid knn accuracy bass      : 15.55232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.514913558959961 sec. =
Valid knn accuracy piano     : 29.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.745466470718384 sec. =
Valid knn accuracy guitar    : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.0800142288208 sec. =
Valid knn accuracy residuals : 54.55974842767296%

Valid knn accuracy average   : 43.12018904664673%

                                                                        [AEpoch 18: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0873, Train/loss_recog_step=0.677, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.332, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.119, Train/loss_recog_epoch=0.889]Epoch 18: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0873, Train/loss_recog_step=0.677, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.070738, 0.070425, 0.071603
Train average loss UNet            (all)              : 0.212765

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.030133, 0.434429, 0.956798
Train average loss bass     (Triplet, dist_p, dist_n) : 0.163850, 0.360397, 0.426219
Train average loss piano    (Triplet, dist_p, dist_n) : 0.146917, 0.423732, 0.518049
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.122372, 0.423023, 0.599038
Train average loss residuals(Triplet, dist_p, dist_n) : 0.110548, 0.524402, 0.703212
Train average loss all      (Triplet)                 : 0.116218

== Recognize ==
Train average loss Recognize     : 0.893175
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.328983

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0873, Train/loss_recog_step=0.677, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0873, Train/loss_recog_step=0.677, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]Epoch 19:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0873, Train/loss_recog_step=0.677, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]Epoch 19:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0947, Train/loss_recog_step=0.790, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]Epoch 19:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0947, Train/loss_recog_step=0.790, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]Epoch 19:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=0.935, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893] Epoch 19:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=0.935, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]Epoch 19:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.319, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.670, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]Epoch 19:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.319, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.670, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]Epoch 19:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.273, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0692, Train/loss_recog_step=0.883, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]Epoch 19:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.273, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0692, Train/loss_recog_step=0.883, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]Epoch 19:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.312, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=0.721, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893] Epoch 19:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.312, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.100, Train/loss_recog_step=0.721, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]Epoch 19:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.307, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0957, Train/loss_recog_step=1.040, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]Epoch 19: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.307, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0957, Train/loss_recog_step=1.040, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]Epoch 19: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.091, Train/loss_recog_step=0.685, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.318, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.212, Valid/loss_recog_epoch=0.826, Valid/knn_avr=0.431, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.91it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.73it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.18it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.48it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073347, 0.071635, 0.072700
Valid average loss UNet            (all)              : 0.217681

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.055997, 0.482878, 1.030050
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.267588, 0.547793, 0.507227
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.295878, 0.569547, 0.486476
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.201916, 0.545385, 0.772480
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.129930, 0.652850, 0.806564
Valid average loss all      (Triplet)                 : 0.211283

== Recognize ==
Valid average loss Recognize     : 0.820044
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.428964

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.231564283370972 sec. =
Valid knn accuracy drums     : 77.64705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.887752056121826 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.82033920288086 sec. =
Valid knn accuracy piano     : 35.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.739905595779419 sec. =
Valid knn accuracy guitar    : 36.85064935064935%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.443516731262207 sec. =
Valid knn accuracy residuals : 53.144654088050316%

Valid knn accuracy average   : 44.27847245244582%

                                                                        [AEpoch 19: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.091, Train/loss_recog_step=0.685, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.329, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.116, Train/loss_recog_epoch=0.893]Epoch 19: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.091, Train/loss_recog_step=0.685, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.070314, 0.070042, 0.071244
Train average loss UNet            (all)              : 0.211600

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.027764, 0.456685, 0.993916
Train average loss bass     (Triplet, dist_p, dist_n) : 0.160727, 0.380005, 0.452499
Train average loss piano    (Triplet, dist_p, dist_n) : 0.142794, 0.444841, 0.546876
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.120458, 0.451730, 0.637323
Train average loss residuals(Triplet, dist_p, dist_n) : 0.106107, 0.543463, 0.733960
Train average loss all      (Triplet)                 : 0.112869

== Recognize ==
Train average loss Recognize     : 0.891397
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.324468

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.091, Train/loss_recog_step=0.685, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.091, Train/loss_recog_step=0.685, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.091, Train/loss_recog_step=0.685, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=0.822, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=0.822, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.335, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.928, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.335, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.928, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.302, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0864, Train/loss_recog_step=0.672, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.302, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0864, Train/loss_recog_step=0.672, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.281, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0775, Train/loss_recog_step=0.875, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.281, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0775, Train/loss_recog_step=0.875, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.306, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0962, Train/loss_recog_step=0.720, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.306, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0962, Train/loss_recog_step=0.720, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.316, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.030, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891] Epoch 20: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.316, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=1.030, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.081, Train/loss_recog_step=0.690, Valid/loss_all_step=0.584, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=0.991, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.820, Valid/knn_avr=0.443, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.58it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.15it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.32it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.85it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074409, 0.072486, 0.073075
Valid average loss UNet            (all)              : 0.219970

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.056979, 0.541276, 1.127976
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.230169, 0.520692, 0.506617
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.265231, 0.593543, 0.541024
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.223457, 0.597012, 0.801841
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.125152, 0.612071, 0.792178
Valid average loss all      (Triplet)                 : 0.194701

== Recognize ==
Valid average loss Recognize     : 0.823368
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.414672

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.012079238891602 sec. =
Valid knn accuracy drums     : 75.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.0364990234375 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.45457649230957 sec. =
Valid knn accuracy piano     : 36.351351351351354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.549148082733154 sec. =
Valid knn accuracy guitar    : 43.993506493506494%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.72454309463501 sec. =
Valid knn accuracy residuals : 53.459119496855344%

Valid knn accuracy average   : 45.3384288472756%

                                                                        [AEpoch 20: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.081, Train/loss_recog_step=0.690, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.324, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.113, Train/loss_recog_epoch=0.891]Epoch 20: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.081, Train/loss_recog_step=0.690, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.070268, 0.070005, 0.071161
Train average loss UNet            (all)              : 0.211435

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.025153, 0.484714, 1.052707
Train average loss bass     (Triplet, dist_p, dist_n) : 0.159846, 0.407178, 0.482664
Train average loss piano    (Triplet, dist_p, dist_n) : 0.141237, 0.466571, 0.577431
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.115558, 0.469128, 0.664195
Train average loss residuals(Triplet, dist_p, dist_n) : 0.104176, 0.566463, 0.761903
Train average loss all      (Triplet)                 : 0.110751

== Recognize ==
Train average loss Recognize     : 0.896182
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.322186

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.081, Train/loss_recog_step=0.690, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.081, Train/loss_recog_step=0.690, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.081, Train/loss_recog_step=0.690, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.276, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0797, Train/loss_recog_step=0.804, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.276, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0797, Train/loss_recog_step=0.804, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=0.918, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896] Epoch 21:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=0.918, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.311, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.097, Train/loss_recog_step=0.661, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.311, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.097, Train/loss_recog_step=0.661, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.276, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0735, Train/loss_recog_step=0.895, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.276, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0735, Train/loss_recog_step=0.895, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.312, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0995, Train/loss_recog_step=0.746, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.312, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0995, Train/loss_recog_step=0.746, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0886, Train/loss_recog_step=1.060, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0886, Train/loss_recog_step=1.060, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.293, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0828, Train/loss_recog_step=0.687, Valid/loss_all_step=0.541, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.287, Valid/loss_recog_step=0.999, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.195, Valid/loss_recog_epoch=0.823, Valid/knn_avr=0.453, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.70it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.85it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.59it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.70it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.075343, 0.073660, 0.073037
Valid average loss UNet            (all)              : 0.222039

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.054359, 0.586812, 1.187819
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.272348, 0.643507, 0.615987
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.269435, 0.644946, 0.598259
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.200368, 0.621878, 0.879545
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.161195, 0.747527, 0.873882
Valid average loss all      (Triplet)                 : 0.209459

== Recognize ==
Valid average loss Recognize     : 0.821444
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.431498

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.119343996047974 sec. =
Valid knn accuracy drums     : 80.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.811578750610352 sec. =
Valid knn accuracy bass      : 19.476744186046513%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.303886413574219 sec. =
Valid knn accuracy piano     : 32.83783783783784%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.550612688064575 sec. =
Valid knn accuracy guitar    : 41.23376623376623%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.75985598564148 sec. =
Valid knn accuracy residuals : 57.23270440251572%

Valid knn accuracy average   : 46.18562229673914%

                                                                        [AEpoch 21: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.293, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0828, Train/loss_recog_step=0.687, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.322, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.896]Epoch 21: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.293, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0828, Train/loss_recog_step=0.687, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.070145, 0.069810, 0.070990
Train average loss UNet            (all)              : 0.210945

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.023714, 0.529045, 1.128378
Train average loss bass     (Triplet, dist_p, dist_n) : 0.154306, 0.445113, 0.532181
Train average loss piano    (Triplet, dist_p, dist_n) : 0.133352, 0.491129, 0.614657
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.109837, 0.509193, 0.719650
Train average loss residuals(Triplet, dist_p, dist_n) : 0.098300, 0.607927, 0.818875
Train average loss all      (Triplet)                 : 0.105638

== Recognize ==
Train average loss Recognize     : 0.898731
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.316583

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.293, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0828, Train/loss_recog_step=0.687, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.293, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0828, Train/loss_recog_step=0.687, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]Epoch 22:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.293, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0828, Train/loss_recog_step=0.687, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]Epoch 22:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0782, Train/loss_recog_step=0.800, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]Epoch 22:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0782, Train/loss_recog_step=0.800, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]Epoch 22:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=0.922, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899] Epoch 22:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=0.922, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]Epoch 22:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.665, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]Epoch 22:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.665, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]Epoch 22:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.282, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=0.877, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]Epoch 22:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.282, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=0.877, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]Epoch 22:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0887, Train/loss_recog_step=0.727, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]Epoch 22:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0887, Train/loss_recog_step=0.727, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]Epoch 22:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=1.080, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899] Epoch 22: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=1.080, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]Epoch 22: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0748, Train/loss_recog_step=0.707, Valid/loss_all_step=0.552, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.296, Valid/loss_recog_step=0.989, Valid/loss_all_epoch=0.431, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.821, Valid/knn_avr=0.462, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.81it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.95it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.61it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.57it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.079615, 0.078664, 0.080687
Valid average loss UNet            (all)              : 0.238967

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062422, 0.664763, 1.248159
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.290990, 0.688656, 0.639861
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.219986, 0.680941, 0.715919
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.213825, 0.736254, 0.903509
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.148561, 0.781956, 0.957828
Valid average loss all      (Triplet)                 : 0.205121

== Recognize ==
Valid average loss Recognize     : 0.841221
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.444088

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.188467025756836 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.685918092727661 sec. =
Valid knn accuracy bass      : 15.55232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.558377504348755 sec. =
Valid knn accuracy piano     : 25.54054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.575998544692993 sec. =
Valid knn accuracy guitar    : 39.935064935064936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.951605796813965 sec. =
Valid knn accuracy residuals : 52.04402515723271%

Valid knn accuracy average   : 42.52615594872906%

                                                                        [AEpoch 22: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0748, Train/loss_recog_step=0.707, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.317, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.899]Epoch 22: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0748, Train/loss_recog_step=0.707, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069952, 0.069713, 0.070862
Train average loss UNet            (all)              : 0.210527

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.022209, 0.558230, 1.174540
Train average loss bass     (Triplet, dist_p, dist_n) : 0.153955, 0.470895, 0.561275
Train average loss piano    (Triplet, dist_p, dist_n) : 0.129837, 0.513607, 0.645387
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.104256, 0.536749, 0.766418
Train average loss residuals(Triplet, dist_p, dist_n) : 0.097320, 0.630508, 0.846127
Train average loss all      (Triplet)                 : 0.103196

== Recognize ==
Train average loss Recognize     : 0.894852
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.313723

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0748, Train/loss_recog_step=0.707, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0748, Train/loss_recog_step=0.707, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0748, Train/loss_recog_step=0.707, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.277, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0813, Train/loss_recog_step=0.796, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.277, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0813, Train/loss_recog_step=0.796, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.316, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.0986, Train/loss_recog_step=0.932, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.316, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.0986, Train/loss_recog_step=0.932, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0856, Train/loss_recog_step=0.670, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0856, Train/loss_recog_step=0.670, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.288, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0852, Train/loss_recog_step=0.920, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.288, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0852, Train/loss_recog_step=0.920, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0759, Train/loss_recog_step=0.722, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0759, Train/loss_recog_step=0.722, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0822, Train/loss_recog_step=1.090, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0822, Train/loss_recog_step=1.090, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0539, Train/loss_recog_step=0.714, Valid/loss_all_step=0.526, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.247, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.444, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.841, Valid/knn_avr=0.425, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.48it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.14it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.06it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074480, 0.073750, 0.074094
Valid average loss UNet            (all)              : 0.222324

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.064627, 0.610132, 1.162252
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.280977, 0.641502, 0.589729
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.243389, 0.696461, 0.685043
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.196534, 0.685343, 0.888810
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.123018, 0.662174, 0.876049
Valid average loss all      (Triplet)                 : 0.205019

== Recognize ==
Valid average loss Recognize     : 0.863373
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.427343

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.102229595184326 sec. =
Valid knn accuracy drums     : 75.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.878159284591675 sec. =
Valid knn accuracy bass      : 17.87790697674419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.295960664749146 sec. =
Valid knn accuracy piano     : 30.270270270270274%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.471550464630127 sec. =
Valid knn accuracy guitar    : 40.74675324675325%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.515429019927979 sec. =
Valid knn accuracy residuals : 48.742138364779876%

Valid knn accuracy average   : 42.70388435994481%

                                                                        [AEpoch 23: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0539, Train/loss_recog_step=0.714, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.314, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.103, Train/loss_recog_epoch=0.895]Epoch 23: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0539, Train/loss_recog_step=0.714, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069733, 0.069494, 0.070691
Train average loss UNet            (all)              : 0.209918

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.020164, 0.598571, 1.232082
Train average loss bass     (Triplet, dist_p, dist_n) : 0.150271, 0.506872, 0.604082
Train average loss piano    (Triplet, dist_p, dist_n) : 0.127330, 0.558956, 0.698732
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.100524, 0.581414, 0.824509
Train average loss residuals(Triplet, dist_p, dist_n) : 0.092016, 0.668243, 0.902134
Train average loss all      (Triplet)                 : 0.099598

== Recognize ==
Train average loss Recognize     : 0.909717
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.309516

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0539, Train/loss_recog_step=0.714, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0539, Train/loss_recog_step=0.714, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0539, Train/loss_recog_step=0.714, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.281, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0858, Train/loss_recog_step=0.804, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.281, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0858, Train/loss_recog_step=0.804, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.939, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910] Epoch 24:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.939, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.316, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.674, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.316, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.674, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0863, Train/loss_recog_step=0.886, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0863, Train/loss_recog_step=0.886, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0794, Train/loss_recog_step=0.762, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0794, Train/loss_recog_step=0.762, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.296, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0865, Train/loss_recog_step=1.090, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.296, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0865, Train/loss_recog_step=1.090, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0375, Train/loss_recog_step=0.703, Valid/loss_all_step=0.568, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.315, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.863, Valid/knn_avr=0.427, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.72it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.58it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.32it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074189, 0.074152, 0.075774
Valid average loss UNet            (all)              : 0.224115

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.069246, 0.667556, 1.174355
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.266729, 0.635873, 0.605763
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.250105, 0.692028, 0.670206
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.219226, 0.725074, 0.927687
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.125514, 0.673650, 0.862185
Valid average loss all      (Triplet)                 : 0.208811

== Recognize ==
Valid average loss Recognize     : 0.856023
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.432926

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.29900860786438 sec. =
Valid knn accuracy drums     : 74.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.753520488739014 sec. =
Valid knn accuracy bass      : 16.424418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.17159628868103 sec. =
Valid knn accuracy piano     : 34.18918918918919%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.053477048873901 sec. =
Valid knn accuracy guitar    : 43.66883116883117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.772189855575562 sec. =
Valid knn accuracy residuals : 51.41509433962265%

Valid knn accuracy average   : 44.021859601635306%

                                                                        [AEpoch 24: 100%|██████████| 313/313 [06:01<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0375, Train/loss_recog_step=0.703, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.310, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0996, Train/loss_recog_epoch=0.910]Epoch 24: 100%|██████████| 313/313 [06:01<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0375, Train/loss_recog_step=0.703, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069748, 0.069482, 0.070651
Train average loss UNet            (all)              : 0.209881

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.019068, 0.643185, 1.304106
Train average loss bass     (Triplet, dist_p, dist_n) : 0.145533, 0.542618, 0.649996
Train average loss piano    (Triplet, dist_p, dist_n) : 0.122620, 0.595186, 0.745444
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.092134, 0.635789, 0.906193
Train average loss residuals(Triplet, dist_p, dist_n) : 0.088945, 0.712363, 0.956610
Train average loss all      (Triplet)                 : 0.095247

== Recognize ==
Train average loss Recognize     : 0.917273
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.305128

Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0375, Train/loss_recog_step=0.703, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]          Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0375, Train/loss_recog_step=0.703, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0375, Train/loss_recog_step=0.703, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.277, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0813, Train/loss_recog_step=0.800, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.277, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0813, Train/loss_recog_step=0.800, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=0.941, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917] Epoch 25:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=0.941, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0762, Train/loss_recog_step=0.678, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0762, Train/loss_recog_step=0.678, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0551, Train/loss_recog_step=0.885, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0551, Train/loss_recog_step=0.885, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.287, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0768, Train/loss_recog_step=0.728, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.287, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0768, Train/loss_recog_step=0.728, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0892, Train/loss_recog_step=1.080, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0892, Train/loss_recog_step=1.080, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0273, Train/loss_recog_step=0.702, Valid/loss_all_step=0.564, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.313, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.433, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.209, Valid/loss_recog_epoch=0.856, Valid/knn_avr=0.440, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.57it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.04it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.18it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.04it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074658, 0.074478, 0.073657
Valid average loss UNet            (all)              : 0.222793

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.075283, 0.626795, 1.129128
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.229172, 0.604954, 0.604760
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.230509, 0.666434, 0.663470
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.193805, 0.680013, 0.850945
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.127822, 0.663899, 0.818909
Valid average loss all      (Triplet)                 : 0.189118

== Recognize ==
Valid average loss Recognize     : 0.849873
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.411911

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.38577914237976 sec. =
Valid knn accuracy drums     : 76.61764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.739960670471191 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.620131492614746 sec. =
Valid knn accuracy piano     : 31.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.421902179718018 sec. =
Valid knn accuracy guitar    : 43.34415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.092570543289185 sec. =
Valid knn accuracy residuals : 50.0%

Valid knn accuracy average   : 43.19663462207922%

                                                                        [AEpoch 25: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0273, Train/loss_recog_step=0.702, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0952, Train/loss_recog_epoch=0.917]Epoch 25: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0273, Train/loss_recog_step=0.702, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069777, 0.069550, 0.070718
Train average loss UNet            (all)              : 0.210045

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.017289, 0.721061, 1.424829
Train average loss bass     (Triplet, dist_p, dist_n) : 0.140281, 0.589787, 0.706430
Train average loss piano    (Triplet, dist_p, dist_n) : 0.114000, 0.648800, 0.818628
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.088294, 0.693187, 0.990937
Train average loss residuals(Triplet, dist_p, dist_n) : 0.085171, 0.782656, 1.045884
Train average loss all      (Triplet)                 : 0.090550

== Recognize ==
Train average loss Recognize     : 0.916627
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.300595

Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0273, Train/loss_recog_step=0.702, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]          Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0273, Train/loss_recog_step=0.702, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0273, Train/loss_recog_step=0.702, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.284, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0882, Train/loss_recog_step=0.816, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.284, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0882, Train/loss_recog_step=0.816, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.284, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.0657, Train/loss_recog_step=0.949, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.284, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.0657, Train/loss_recog_step=0.949, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0777, Train/loss_recog_step=0.681, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0777, Train/loss_recog_step=0.681, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.266, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0639, Train/loss_recog_step=0.908, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.266, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0639, Train/loss_recog_step=0.908, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.292, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0784, Train/loss_recog_step=0.739, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.292, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0784, Train/loss_recog_step=0.739, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0884, Train/loss_recog_step=1.080, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0884, Train/loss_recog_step=1.080, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.262, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0527, Train/loss_recog_step=0.709, Valid/loss_all_step=0.529, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.279, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.850, Valid/knn_avr=0.432, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.10it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.73it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.75it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.20it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.89it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.077074, 0.076687, 0.076329
Valid average loss UNet            (all)              : 0.230090

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.066376, 0.699537, 1.228238
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.271954, 0.649887, 0.613753
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.241818, 0.739871, 0.747265
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.185541, 0.726521, 0.908106
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.168143, 0.761617, 0.856305
Valid average loss all      (Triplet)                 : 0.209659

== Recognize ==
Valid average loss Recognize     : 0.851836
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.439749

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.182823181152344 sec. =
Valid knn accuracy drums     : 74.11764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.528993844985962 sec. =
Valid knn accuracy bass      : 20.348837209302324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.730283498764038 sec. =
Valid knn accuracy piano     : 30.945945945945947%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.25061321258545 sec. =
Valid knn accuracy guitar    : 43.506493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.806988000869751 sec. =
Valid knn accuracy residuals : 54.088050314465406%

Valid knn accuracy average   : 44.601394807006145%

                                                                        [AEpoch 26: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.262, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0527, Train/loss_recog_step=0.709, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.301, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0906, Train/loss_recog_epoch=0.917]Epoch 26: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.262, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0527, Train/loss_recog_step=0.709, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069764, 0.069512, 0.070697
Train average loss UNet            (all)              : 0.209973

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.013654, 0.760521, 1.493041
Train average loss bass     (Triplet, dist_p, dist_n) : 0.138627, 0.624116, 0.750467
Train average loss piano    (Triplet, dist_p, dist_n) : 0.107719, 0.688318, 0.876527
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.081875, 0.736563, 1.045757
Train average loss residuals(Triplet, dist_p, dist_n) : 0.079366, 0.820067, 1.099398
Train average loss all      (Triplet)                 : 0.085946

== Recognize ==
Train average loss Recognize     : 0.922988
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.295918

Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.262, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0527, Train/loss_recog_step=0.709, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]          Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.262, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0527, Train/loss_recog_step=0.709, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.262, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0527, Train/loss_recog_step=0.709, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.272, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0771, Train/loss_recog_step=0.823, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.272, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0771, Train/loss_recog_step=0.823, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.305, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0894, Train/loss_recog_step=0.958, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.305, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0894, Train/loss_recog_step=0.958, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.287, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0749, Train/loss_recog_step=0.697, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.287, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0749, Train/loss_recog_step=0.697, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.277, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.076, Train/loss_recog_step=0.915, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923] Epoch 27:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.277, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.076, Train/loss_recog_step=0.915, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.277, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0664, Train/loss_recog_step=0.742, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.277, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0664, Train/loss_recog_step=0.742, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0846, Train/loss_recog_step=1.110, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0846, Train/loss_recog_step=1.110, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0357, Train/loss_recog_step=0.726, Valid/loss_all_step=0.596, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.330, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.210, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.446, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.21it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.51it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.52it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073517, 0.072748, 0.072530
Valid average loss UNet            (all)              : 0.218794

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.072410, 0.799566, 1.401618
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.234432, 0.693753, 0.714994
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.209711, 0.819078, 0.857607
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.183184, 0.838095, 1.081354
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.176422, 0.904163, 1.024676
Valid average loss all      (Triplet)                 : 0.193092

== Recognize ==
Valid average loss Recognize     : 0.868797
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.411886

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.637636423110962 sec. =
Valid knn accuracy drums     : 75.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.125612497329712 sec. =
Valid knn accuracy bass      : 21.802325581395348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.67509388923645 sec. =
Valid knn accuracy piano     : 33.24324324324324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.082805395126343 sec. =
Valid knn accuracy guitar    : 45.77922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.798152208328247 sec. =
Valid knn accuracy residuals : 57.704402515723274%

Valid knn accuracy average   : 46.85289724744594%

                                                                        [AEpoch 27: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0357, Train/loss_recog_step=0.726, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.296, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0859, Train/loss_recog_epoch=0.923]Epoch 27: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0357, Train/loss_recog_step=0.726, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069748, 0.069464, 0.070575
Train average loss UNet            (all)              : 0.209786

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.012333, 0.846750, 1.643736
Train average loss bass     (Triplet, dist_p, dist_n) : 0.131166, 0.680056, 0.819795
Train average loss piano    (Triplet, dist_p, dist_n) : 0.101204, 0.748015, 0.959795
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.074686, 0.802946, 1.145708
Train average loss residuals(Triplet, dist_p, dist_n) : 0.072933, 0.893946, 1.200338
Train average loss all      (Triplet)                 : 0.080037

== Recognize ==
Train average loss Recognize     : 0.936467
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.289823

Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0357, Train/loss_recog_step=0.726, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]          Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0357, Train/loss_recog_step=0.726, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0357, Train/loss_recog_step=0.726, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.270, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0757, Train/loss_recog_step=0.820, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.270, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0757, Train/loss_recog_step=0.820, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.318, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.964, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936] Epoch 28:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.318, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.964, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.283, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.069, Train/loss_recog_step=0.691, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.283, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.069, Train/loss_recog_step=0.691, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.275, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0733, Train/loss_recog_step=0.902, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.275, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0733, Train/loss_recog_step=0.902, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.282, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0695, Train/loss_recog_step=0.753, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.282, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0695, Train/loss_recog_step=0.753, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.271, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0573, Train/loss_recog_step=1.090, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.271, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0573, Train/loss_recog_step=1.090, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.044, Train/loss_recog_step=0.720, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.268, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.193, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.469, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.97it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.42it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.54it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.17it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.075518, 0.075363, 0.078899
Valid average loss UNet            (all)              : 0.229781

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087167, 0.914671, 1.413080
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.222045, 0.779921, 0.789308
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.187123, 0.838792, 0.912854
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.218699, 0.942231, 1.131146
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.164821, 0.974417, 1.139893
Valid average loss all      (Triplet)                 : 0.188616

== Recognize ==
Valid average loss Recognize     : 0.863789
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.418397

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.657466888427734 sec. =
Valid knn accuracy drums     : 73.08823529411764%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.11110520362854 sec. =
Valid knn accuracy bass      : 22.093023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.558712244033813 sec. =
Valid knn accuracy piano     : 33.513513513513516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.270451545715332 sec. =
Valid knn accuracy guitar    : 47.24025974025974%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.800019979476929 sec. =
Valid knn accuracy residuals : 62.42138364779875%

Valid knn accuracy average   : 47.67128309030072%

                                                                        [AEpoch 28: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.044, Train/loss_recog_step=0.720, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.080, Train/loss_recog_epoch=0.936]Epoch 28: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.044, Train/loss_recog_step=0.720, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069642, 0.069380, 0.070532
Train average loss UNet            (all)              : 0.209554

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.011988, 0.910803, 1.743900
Train average loss bass     (Triplet, dist_p, dist_n) : 0.123819, 0.738524, 0.894051
Train average loss piano    (Triplet, dist_p, dist_n) : 0.095669, 0.819917, 1.047305
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.072159, 0.872543, 1.240620
Train average loss residuals(Triplet, dist_p, dist_n) : 0.071499, 0.970069, 1.296482
Train average loss all      (Triplet)                 : 0.076475

== Recognize ==
Train average loss Recognize     : 0.934440
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.286029

Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.044, Train/loss_recog_step=0.720, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]          Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.044, Train/loss_recog_step=0.720, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.044, Train/loss_recog_step=0.720, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=0.827, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=0.827, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.279, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.0615, Train/loss_recog_step=0.968, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.279, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.0615, Train/loss_recog_step=0.968, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.278, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0625, Train/loss_recog_step=0.679, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.278, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0625, Train/loss_recog_step=0.679, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.266, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0615, Train/loss_recog_step=0.907, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.266, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0615, Train/loss_recog_step=0.907, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.275, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0659, Train/loss_recog_step=0.744, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.275, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0659, Train/loss_recog_step=0.744, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0629, Train/loss_recog_step=1.100, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0629, Train/loss_recog_step=1.100, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0387, Train/loss_recog_step=0.730, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.221, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.418, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.477, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.01it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.47it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.36it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.25it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.075157, 0.073275, 0.074774
Valid average loss UNet            (all)              : 0.223206

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113353, 1.014009, 1.618680
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.254743, 0.862283, 0.840115
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.207079, 0.963038, 1.019999
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.179482, 1.018764, 1.213045
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.173299, 0.964631, 1.182161
Valid average loss all      (Triplet)                 : 0.201541

== Recognize ==
Valid average loss Recognize     : 0.864247
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.424748

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.156336545944214 sec. =
Valid knn accuracy drums     : 75.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.817089557647705 sec. =
Valid knn accuracy bass      : 20.78488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.801592111587524 sec. =
Valid knn accuracy piano     : 28.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.3735671043396 sec. =
Valid knn accuracy guitar    : 44.31818181818182%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.740828037261963 sec. =
Valid knn accuracy residuals : 58.64779874213837%

Valid knn accuracy average   : 45.65160369885739%

                                                                        [AEpoch 29: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0387, Train/loss_recog_step=0.730, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.286, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0765, Train/loss_recog_epoch=0.934]Epoch 29: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0387, Train/loss_recog_step=0.730, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069781, 0.069589, 0.070606
Train average loss UNet            (all)              : 0.209976

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010687, 1.008428, 1.898628
Train average loss bass     (Triplet, dist_p, dist_n) : 0.116272, 0.816460, 0.994734
Train average loss piano    (Triplet, dist_p, dist_n) : 0.087593, 0.902733, 1.159787
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.064421, 0.959200, 1.368714
Train average loss residuals(Triplet, dist_p, dist_n) : 0.066613, 1.062239, 1.413278
Train average loss all      (Triplet)                 : 0.070430

== Recognize ==
Train average loss Recognize     : 0.937481
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.280406

Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0387, Train/loss_recog_step=0.730, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]          Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0387, Train/loss_recog_step=0.730, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0387, Train/loss_recog_step=0.730, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.247, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0518, Train/loss_recog_step=0.835, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.247, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0518, Train/loss_recog_step=0.835, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0773, Train/loss_recog_step=0.980, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0773, Train/loss_recog_step=0.980, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0767, Train/loss_recog_step=0.695, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0767, Train/loss_recog_step=0.695, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.272, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0691, Train/loss_recog_step=0.914, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.272, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0691, Train/loss_recog_step=0.914, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.260, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=0.757, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.260, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0497, Train/loss_recog_step=0.757, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0559, Train/loss_recog_step=1.110, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0559, Train/loss_recog_step=1.110, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.229, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=0.731, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.262, Valid/loss_triplet_all_step=0.243, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.864, Valid/knn_avr=0.457, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.66it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.61it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.13it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.35it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073095, 0.072791, 0.073602
Valid average loss UNet            (all)              : 0.219488

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098553, 1.103045, 1.771947
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.255113, 1.028890, 1.041995
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.230845, 1.096861, 1.146652
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.246148, 1.180208, 1.343549
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.196015, 1.165168, 1.471711
Valid average loss all      (Triplet)                 : 0.223259

== Recognize ==
Valid average loss Recognize     : 0.866096
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.442747

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.12101149559021 sec. =
Valid knn accuracy drums     : 75.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.453392744064331 sec. =
Valid knn accuracy bass      : 18.168604651162788%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.188579797744751 sec. =
Valid knn accuracy piano     : 34.054054054054056%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.45971941947937 sec. =
Valid knn accuracy guitar    : 40.0974025974026%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.50147795677185 sec. =
Valid knn accuracy residuals : 59.11949685534591%

Valid knn accuracy average   : 45.405558690416605%

                                                                        [AEpoch 30: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.229, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=0.731, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.280, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0704, Train/loss_recog_epoch=0.937]Epoch 30: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.229, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=0.731, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069609, 0.069364, 0.070530
Train average loss UNet            (all)              : 0.209503

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.009358, 1.087644, 2.032620
Train average loss bass     (Triplet, dist_p, dist_n) : 0.109876, 0.885867, 1.083419
Train average loss piano    (Triplet, dist_p, dist_n) : 0.082035, 0.978177, 1.262831
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.060480, 1.038413, 1.477796
Train average loss residuals(Triplet, dist_p, dist_n) : 0.059087, 1.132891, 1.510636
Train average loss all      (Triplet)                 : 0.065073

== Recognize ==
Train average loss Recognize     : 0.943426
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.274575

Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.229, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=0.731, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]          Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.229, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=0.731, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.229, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=0.731, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0447, Train/loss_recog_step=0.853, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0447, Train/loss_recog_step=0.853, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.287, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0723, Train/loss_recog_step=0.993, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.287, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0723, Train/loss_recog_step=0.993, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.282, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0665, Train/loss_recog_step=0.697, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.282, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0665, Train/loss_recog_step=0.697, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0501, Train/loss_recog_step=0.931, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0501, Train/loss_recog_step=0.931, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=0.782, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0321, Train/loss_recog_step=0.782, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.264, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0508, Train/loss_recog_step=1.120, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.264, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0508, Train/loss_recog_step=1.120, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.739, Valid/loss_all_step=0.554, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.306, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.223, Valid/loss_recog_epoch=0.866, Valid/knn_avr=0.454, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.83it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.95it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.16it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.63it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074111, 0.074032, 0.075686
Valid average loss UNet            (all)              : 0.223830

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.116473, 1.190520, 1.861894
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.243521, 1.094769, 1.118357
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.174095, 1.158526, 1.275124
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.211649, 1.200564, 1.447670
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.219855, 1.248036, 1.504504
Valid average loss all      (Triplet)                 : 0.204688

== Recognize ==
Valid average loss Recognize     : 0.869992
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.428518

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.993388175964355 sec. =
Valid knn accuracy drums     : 77.64705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.895705223083496 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.543570280075073 sec. =
Valid knn accuracy piano     : 34.5945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.063703775405884 sec. =
Valid knn accuracy guitar    : 40.25974025974026%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.731433391571045 sec. =
Valid knn accuracy residuals : 54.088050314465406%

Valid knn accuracy average   : 44.45742368218687%

                                                                        [AEpoch 31: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.739, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.275, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0651, Train/loss_recog_epoch=0.943]Epoch 31: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.739, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069634, 0.069411, 0.070506
Train average loss UNet            (all)              : 0.209551

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010971, 1.224606, 2.239417
Train average loss bass     (Triplet, dist_p, dist_n) : 0.102154, 0.986072, 1.213190
Train average loss piano    (Triplet, dist_p, dist_n) : 0.072680, 1.097810, 1.421709
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.053340, 1.158247, 1.657989
Train average loss residuals(Triplet, dist_p, dist_n) : 0.052151, 1.270608, 1.689502
Train average loss all      (Triplet)                 : 0.059465

== Recognize ==
Train average loss Recognize     : 0.959665
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.269016

Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.739, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]          Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.739, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.739, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0405, Train/loss_recog_step=0.840, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0405, Train/loss_recog_step=0.840, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=0.991, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=0.991, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.265, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0525, Train/loss_recog_step=0.704, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.265, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0525, Train/loss_recog_step=0.704, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.259, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0576, Train/loss_recog_step=0.930, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.259, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0576, Train/loss_recog_step=0.930, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0353, Train/loss_recog_step=0.771, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0353, Train/loss_recog_step=0.771, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.269, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0569, Train/loss_recog_step=1.140, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.269, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0569, Train/loss_recog_step=1.140, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.750, Valid/loss_all_step=0.465, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.429, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.205, Valid/loss_recog_epoch=0.870, Valid/knn_avr=0.445, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.17it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.51it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.53it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.84it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074668, 0.073504, 0.073742
Valid average loss UNet            (all)              : 0.221914

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.146144, 1.352953, 2.136288
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.238051, 1.125854, 1.171038
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.203693, 1.153879, 1.216581
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.168204, 1.254429, 1.517208
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.220661, 1.400360, 1.661313
Valid average loss all      (Triplet)                 : 0.201839

== Recognize ==
Valid average loss Recognize     : 0.887318
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.423752

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.15179181098938 sec. =
Valid knn accuracy drums     : 73.08823529411764%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.025012254714966 sec. =
Valid knn accuracy bass      : 18.8953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.617258310317993 sec. =
Valid knn accuracy piano     : 30.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.870035886764526 sec. =
Valid knn accuracy guitar    : 40.58441558441558%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.467170476913452 sec. =
Valid knn accuracy residuals : 57.54716981132076%

Valid knn accuracy average   : 44.050060932439685%

                                                                        [AEpoch 32: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.750, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.269, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.0595, Train/loss_recog_epoch=0.960]Epoch 32: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.750, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069554, 0.069314, 0.070485
Train average loss UNet            (all)              : 0.209353

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.009409, 1.308885, 2.401517
Train average loss bass     (Triplet, dist_p, dist_n) : 0.093912, 1.065613, 1.322677
Train average loss piano    (Triplet, dist_p, dist_n) : 0.065859, 1.177631, 1.532114
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.048536, 1.233359, 1.774093
Train average loss residuals(Triplet, dist_p, dist_n) : 0.049700, 1.356820, 1.811031
Train average loss all      (Triplet)                 : 0.054527

== Recognize ==
Train average loss Recognize     : 0.958897
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.263880

Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.750, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]          Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.750, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.750, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0447, Train/loss_recog_step=0.845, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0447, Train/loss_recog_step=0.845, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0729, Train/loss_recog_step=1.000, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.286, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0729, Train/loss_recog_step=1.000, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.248, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0346, Train/loss_recog_step=0.719, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.248, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0346, Train/loss_recog_step=0.719, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.241, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0392, Train/loss_recog_step=0.944, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.241, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0392, Train/loss_recog_step=0.944, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0176, Train/loss_recog_step=0.787, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0176, Train/loss_recog_step=0.787, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.046, Train/loss_recog_step=1.130, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959] Epoch 33: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.046, Train/loss_recog_step=1.130, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.752, Valid/loss_all_step=0.395, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.151, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.202, Valid/loss_recog_epoch=0.887, Valid/knn_avr=0.441, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.41it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.21it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.51it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.75it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074758, 0.073167, 0.072765
Valid average loss UNet            (all)              : 0.220689

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.138553, 1.495229, 2.322525
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.349101, 1.413899, 1.345138
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.262662, 1.339902, 1.365577
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.157051, 1.446193, 1.788585
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.210444, 1.490365, 1.788481
Valid average loss all      (Triplet)                 : 0.241569

== Recognize ==
Valid average loss Recognize     : 0.883288
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.462258

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.373008728027344 sec. =
Valid knn accuracy drums     : 67.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.280802726745605 sec. =
Valid knn accuracy bass      : 23.11046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.778363466262817 sec. =
Valid knn accuracy piano     : 26.216216216216214%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.651723623275757 sec. =
Valid knn accuracy guitar    : 42.6948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.544103860855103 sec. =
Valid knn accuracy residuals : 59.11949685534591%

Valid knn accuracy average   : 43.81643197064692%

                                                                        [AEpoch 33: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.752, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0545, Train/loss_recog_epoch=0.959]Epoch 33: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.752, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069490, 0.069191, 0.070429
Train average loss UNet            (all)              : 0.209110

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008313, 1.449695, 2.628904
Train average loss bass     (Triplet, dist_p, dist_n) : 0.086035, 1.170236, 1.454235
Train average loss piano    (Triplet, dist_p, dist_n) : 0.061580, 1.304291, 1.697500
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.042862, 1.369777, 1.965090
Train average loss residuals(Triplet, dist_p, dist_n) : 0.042430, 1.494596, 2.001107
Train average loss all      (Triplet)                 : 0.049219

== Recognize ==
Train average loss Recognize     : 0.973645
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.258329

Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.752, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]          Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.752, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.752, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0297, Train/loss_recog_step=0.840, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0297, Train/loss_recog_step=0.840, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0773, Train/loss_recog_step=1.030, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0773, Train/loss_recog_step=1.030, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0778, Train/loss_recog_step=0.703, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.290, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0778, Train/loss_recog_step=0.703, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=0.942, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=0.942, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0362, Train/loss_recog_step=0.784, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0362, Train/loss_recog_step=0.784, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0197, Train/loss_recog_step=1.120, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0197, Train/loss_recog_step=1.120, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.033, Train/loss_recog_step=0.733, Valid/loss_all_step=0.482, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.234, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.462, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.242, Valid/loss_recog_epoch=0.883, Valid/knn_avr=0.438, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.33it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.60it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.97it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.94it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074837, 0.073937, 0.073523
Valid average loss UNet            (all)              : 0.222296

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.183562, 1.698740, 2.574859
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.310760, 1.491240, 1.462060
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.268840, 1.473881, 1.522124
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.223418, 1.581715, 1.864664
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.218637, 1.660505, 2.044040
Valid average loss all      (Triplet)                 : 0.256595

== Recognize ==
Valid average loss Recognize     : 0.877545
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.478892

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.938225746154785 sec. =
Valid knn accuracy drums     : 74.11764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.931421995162964 sec. =
Valid knn accuracy bass      : 20.78488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.43531847000122 sec. =
Valid knn accuracy piano     : 34.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.742658853530884 sec. =
Valid knn accuracy guitar    : 42.37012987012987%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.883333206176758 sec. =
Valid knn accuracy residuals : 58.17610062893082%

Valid knn accuracy average   : 45.98164414765478%

                                                                        [AEpoch 34: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.033, Train/loss_recog_step=0.733, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0492, Train/loss_recog_epoch=0.974]Epoch 34: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.033, Train/loss_recog_step=0.733, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069418, 0.069135, 0.070367
Train average loss UNet            (all)              : 0.208920

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010586, 1.571131, 2.825627
Train average loss bass     (Triplet, dist_p, dist_n) : 0.073658, 1.256783, 1.578185
Train average loss piano    (Triplet, dist_p, dist_n) : 0.053528, 1.410246, 1.842473
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.037292, 1.462409, 2.108948
Train average loss residuals(Triplet, dist_p, dist_n) : 0.038765, 1.601131, 2.137204
Train average loss all      (Triplet)                 : 0.043690

== Recognize ==
Train average loss Recognize     : 0.970121
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.252610

Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.033, Train/loss_recog_step=0.733, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]          Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.033, Train/loss_recog_step=0.733, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.033, Train/loss_recog_step=0.733, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=0.845, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=0.845, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0767, Train/loss_recog_step=1.020, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.291, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0767, Train/loss_recog_step=1.020, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.253, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0405, Train/loss_recog_step=0.710, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.253, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0405, Train/loss_recog_step=0.710, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0401, Train/loss_recog_step=0.936, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0401, Train/loss_recog_step=0.936, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=0.757, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970] Epoch 35:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=0.757, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0226, Train/loss_recog_step=1.140, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0226, Train/loss_recog_step=1.140, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=0.747, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.280, Valid/loss_recog_step=1.070, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.257, Valid/loss_recog_epoch=0.878, Valid/knn_avr=0.460, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.36it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.22it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.49it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.60it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073504, 0.072109, 0.072840
Valid average loss UNet            (all)              : 0.218453

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.169450, 1.892401, 2.769887
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.376398, 1.744632, 1.657761
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.262304, 1.718749, 1.778061
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.193651, 1.804866, 2.168486
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.235363, 1.965917, 2.385930
Valid average loss all      (Triplet)                 : 0.262452

== Recognize ==
Valid average loss Recognize     : 0.890901
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.480905

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.426046371459961 sec. =
Valid knn accuracy drums     : 76.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.831557750701904 sec. =
Valid knn accuracy bass      : 17.151162790697676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.99976658821106 sec. =
Valid knn accuracy piano     : 34.32432432432432%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.424428462982178 sec. =
Valid knn accuracy guitar    : 42.37012987012987%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.711683988571167 sec. =
Valid knn accuracy residuals : 61.63522012578616%

Valid knn accuracy average   : 46.33146153983466%

                                                                        [AEpoch 35: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=0.747, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.253, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0437, Train/loss_recog_epoch=0.970]Epoch 35: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=0.747, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069377, 0.069093, 0.070289
Train average loss UNet            (all)              : 0.208759

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008061, 1.695205, 3.007502
Train average loss bass     (Triplet, dist_p, dist_n) : 0.070400, 1.368303, 1.719198
Train average loss piano    (Triplet, dist_p, dist_n) : 0.048967, 1.525237, 2.009616
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.028871, 1.586987, 2.304909
Train average loss residuals(Triplet, dist_p, dist_n) : 0.033406, 1.739033, 2.334169
Train average loss all      (Triplet)                 : 0.038691

== Recognize ==
Train average loss Recognize     : 0.966039
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.247450

Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=0.747, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]          Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=0.747, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.029, Train/loss_recog_step=0.747, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0222, Train/loss_recog_step=0.838, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0222, Train/loss_recog_step=0.838, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.266, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0509, Train/loss_recog_step=1.030, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.266, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0509, Train/loss_recog_step=1.030, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.285, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0727, Train/loss_recog_step=0.725, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.285, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0727, Train/loss_recog_step=0.725, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0253, Train/loss_recog_step=0.966, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0253, Train/loss_recog_step=0.966, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0406, Train/loss_recog_step=0.783, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0406, Train/loss_recog_step=0.783, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0385, Train/loss_recog_step=1.130, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0385, Train/loss_recog_step=1.130, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00675, Train/loss_recog_step=0.741, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.227, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.481, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.262, Valid/loss_recog_epoch=0.891, Valid/knn_avr=0.463, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.29it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.22it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.03it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.89it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.077426, 0.075980, 0.075596
Valid average loss UNet            (all)              : 0.229003

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143572, 1.888915, 2.957440
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.356661, 1.679335, 1.663611
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.321646, 1.827065, 1.782811
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.225469, 1.768237, 2.121037
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.240252, 1.903730, 2.258505
Valid average loss all      (Triplet)                 : 0.283121

== Recognize ==
Valid average loss Recognize     : 0.890262
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.512124

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.140937566757202 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.576008081436157 sec. =
Valid knn accuracy bass      : 23.691860465116278%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.59607744216919 sec. =
Valid knn accuracy piano     : 29.864864864864867%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.592654943466187 sec. =
Valid knn accuracy guitar    : 44.8051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.861158609390259 sec. =
Valid knn accuracy residuals : 53.77358490566038%

Valid knn accuracy average   : 46.10357159640255%

                                                                        [AEpoch 36: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00675, Train/loss_recog_step=0.741, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.247, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0387, Train/loss_recog_epoch=0.966]Epoch 36: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00675, Train/loss_recog_step=0.741, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069321, 0.069098, 0.070314
Train average loss UNet            (all)              : 0.208734

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006797, 1.846164, 3.257335
Train average loss bass     (Triplet, dist_p, dist_n) : 0.066320, 1.514400, 1.908047
Train average loss piano    (Triplet, dist_p, dist_n) : 0.042810, 1.678002, 2.209454
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.029048, 1.740251, 2.511466
Train average loss residuals(Triplet, dist_p, dist_n) : 0.027704, 1.884855, 2.531062
Train average loss all      (Triplet)                 : 0.035307

== Recognize ==
Train average loss Recognize     : 0.982796
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.244041

Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00675, Train/loss_recog_step=0.741, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]          Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00675, Train/loss_recog_step=0.741, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00675, Train/loss_recog_step=0.741, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.859, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983] Epoch 37:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=0.859, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0299, Train/loss_recog_step=1.010, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0299, Train/loss_recog_step=1.010, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0204, Train/loss_recog_step=0.717, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0204, Train/loss_recog_step=0.717, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0185, Train/loss_recog_step=0.961, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0185, Train/loss_recog_step=0.961, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0325, Train/loss_recog_step=0.791, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0325, Train/loss_recog_step=0.791, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=1.140, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=1.140, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00628, Train/loss_recog_step=0.756, Valid/loss_all_step=0.599, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.350, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.283, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.461, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.89it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.46it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.94it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.73it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074934, 0.073694, 0.072576
Valid average loss UNet            (all)              : 0.221204

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.115926, 2.020327, 3.103170
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.267936, 1.775248, 1.797102
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.357865, 1.973710, 1.969609
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.174778, 2.003749, 2.413399
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.264679, 2.103376, 2.466946
Valid average loss all      (Triplet)                 : 0.243898

== Recognize ==
Valid average loss Recognize     : 0.889751
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.465102

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.14250111579895 sec. =
Valid knn accuracy drums     : 73.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.784407377243042 sec. =
Valid knn accuracy bass      : 21.802325581395348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.70890998840332 sec. =
Valid knn accuracy piano     : 32.83783783783784%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.92094612121582 sec. =
Valid knn accuracy guitar    : 43.18181818181818%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.582375764846802 sec. =
Valid knn accuracy residuals : 58.333333333333336%

Valid knn accuracy average   : 45.93694533981812%

                                                                        [AEpoch 37: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00628, Train/loss_recog_step=0.756, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0353, Train/loss_recog_epoch=0.983]Epoch 37: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00628, Train/loss_recog_step=0.756, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069287, 0.069005, 0.070244
Train average loss UNet            (all)              : 0.208536

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007295, 1.980703, 3.511771
Train average loss bass     (Triplet, dist_p, dist_n) : 0.055827, 1.584514, 2.011456
Train average loss piano    (Triplet, dist_p, dist_n) : 0.036377, 1.768558, 2.348561
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.027553, 1.862642, 2.698898
Train average loss residuals(Triplet, dist_p, dist_n) : 0.028190, 2.012679, 2.717789
Train average loss all      (Triplet)                 : 0.031555

== Recognize ==
Train average loss Recognize     : 0.979651
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.240092

Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00628, Train/loss_recog_step=0.756, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]          Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00628, Train/loss_recog_step=0.756, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]Epoch 38:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00628, Train/loss_recog_step=0.756, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]Epoch 38:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0264, Train/loss_recog_step=0.859, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980] Epoch 38:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0264, Train/loss_recog_step=0.859, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]Epoch 38:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.253, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0383, Train/loss_recog_step=1.020, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]Epoch 38:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.253, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0383, Train/loss_recog_step=1.020, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]Epoch 38:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.256, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.045, Train/loss_recog_step=0.715, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980] Epoch 38:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.256, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.045, Train/loss_recog_step=0.715, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]Epoch 38:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0377, Train/loss_recog_step=0.955, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]Epoch 38:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0377, Train/loss_recog_step=0.955, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]Epoch 38:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.779, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]Epoch 38:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.779, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]Epoch 38:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.255, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0449, Train/loss_recog_step=1.150, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]Epoch 38: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.255, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0449, Train/loss_recog_step=1.150, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]Epoch 38: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=0.755, Valid/loss_all_step=0.468, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.214, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.465, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.244, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.459, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.30it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.67it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.60it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.81it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073386, 0.071990, 0.072430
Valid average loss UNet            (all)              : 0.217807

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143186, 2.141102, 3.316200
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.359943, 1.834677, 1.793881
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.322296, 2.059615, 2.088425
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.167658, 1.986948, 2.375301
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.225359, 2.064022, 2.468615
Valid average loss all      (Triplet)                 : 0.264652

== Recognize ==
Valid average loss Recognize     : 0.899218
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.482459

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.593172311782837 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.750145196914673 sec. =
Valid knn accuracy bass      : 16.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.522672653198242 sec. =
Valid knn accuracy piano     : 28.64864864864865%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.53811240196228 sec. =
Valid knn accuracy guitar    : 44.31818181818182%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.779691696166992 sec. =
Valid knn accuracy residuals : 57.38993710691824%

Valid knn accuracy average   : 45.11991712624084%

                                                                        [AEpoch 38: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=0.755, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.240, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0316, Train/loss_recog_epoch=0.980]Epoch 38: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=0.755, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069048, 0.068883, 0.070022
Train average loss UNet            (all)              : 0.207954

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006390, 2.087119, 3.705498
Train average loss bass     (Triplet, dist_p, dist_n) : 0.048317, 1.691107, 2.166553
Train average loss piano    (Triplet, dist_p, dist_n) : 0.033697, 1.874854, 2.486319
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.025638, 1.956225, 2.842599
Train average loss residuals(Triplet, dist_p, dist_n) : 0.023548, 2.123609, 2.876659
Train average loss all      (Triplet)                 : 0.028138

== Recognize ==
Train average loss Recognize     : 0.980051
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.236091

Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=0.755, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]          Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=0.755, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=0.755, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.880, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=0.880, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0414, Train/loss_recog_step=1.030, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0414, Train/loss_recog_step=1.030, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.275, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0636, Train/loss_recog_step=0.718, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.275, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0636, Train/loss_recog_step=0.718, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0204, Train/loss_recog_step=0.958, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0204, Train/loss_recog_step=0.958, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.024, Train/loss_recog_step=0.781, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980] Epoch 39:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.024, Train/loss_recog_step=0.781, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.247, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0387, Train/loss_recog_step=1.130, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.247, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0387, Train/loss_recog_step=1.130, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00925, Train/loss_recog_step=0.752, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.285, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.482, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.899, Valid/knn_avr=0.451, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.14it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.96it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.70it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.44it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.12it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.84it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073888, 0.073426, 0.074818
Valid average loss UNet            (all)              : 0.222132

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.150985, 2.244795, 3.544786
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.376177, 2.024919, 1.951925
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.318790, 2.095749, 2.104296
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.248680, 2.170739, 2.592478
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.239021, 2.193238, 2.587212
Valid average loss all      (Triplet)                 : 0.295140

== Recognize ==
Valid average loss Recognize     : 0.888700
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.517272

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.384730100631714 sec. =
Valid knn accuracy drums     : 79.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.651300191879272 sec. =
Valid knn accuracy bass      : 23.982558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.21289348602295 sec. =
Valid knn accuracy piano     : 28.64864864864865%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.894436597824097 sec. =
Valid knn accuracy guitar    : 44.15584415584416%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.352541446685791 sec. =
Valid knn accuracy residuals : 56.132075471698116%

Valid knn accuracy average   : 46.55441351843928%

                                                                        [AEpoch 39: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00925, Train/loss_recog_step=0.752, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.236, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0281, Train/loss_recog_epoch=0.980]Epoch 39: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00925, Train/loss_recog_step=0.752, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068895, 0.068736, 0.069836
Train average loss UNet            (all)              : 0.207467

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006670, 2.203864, 3.872698
Train average loss bass     (Triplet, dist_p, dist_n) : 0.044571, 1.793726, 2.302580
Train average loss piano    (Triplet, dist_p, dist_n) : 0.030970, 1.979143, 2.635510
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.020441, 2.059819, 3.003391
Train average loss residuals(Triplet, dist_p, dist_n) : 0.025617, 2.227606, 3.016620
Train average loss all      (Triplet)                 : 0.026077

== Recognize ==
Train average loss Recognize     : 0.987021
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.233544

Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00925, Train/loss_recog_step=0.752, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]          Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00925, Train/loss_recog_step=0.752, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]Epoch 40:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00925, Train/loss_recog_step=0.752, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]Epoch 40:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=0.871, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987] Epoch 40:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=0.871, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]Epoch 40:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=1.020, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]Epoch 40:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=1.020, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]Epoch 40:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0276, Train/loss_recog_step=0.731, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]Epoch 40:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0276, Train/loss_recog_step=0.731, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]Epoch 40:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.962, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987] Epoch 40:  80%|███████▉  | 250/313 [03:32<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.962, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]Epoch 40:  80%|███████▉  | 250/313 [03:32<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00555, Train/loss_recog_step=0.789, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]Epoch 40:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00555, Train/loss_recog_step=0.789, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]Epoch 40:  96%|█████████▌| 300/313 [04:14<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0147, Train/loss_recog_step=1.160, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987] Epoch 40: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0147, Train/loss_recog_step=1.160, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]Epoch 40: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.762, Valid/loss_all_step=0.612, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.369, Valid/loss_recog_step=1.080, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.295, Valid/loss_recog_epoch=0.889, Valid/knn_avr=0.466, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.80it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.57it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.41it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.11it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.84it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.076255, 0.075358, 0.075209
Valid average loss UNet            (all)              : 0.226822

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.106486, 2.240028, 3.570559
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.297291, 1.952453, 1.950374
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.325897, 2.154497, 2.233207
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.238638, 2.185621, 2.672775
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.261130, 2.327480, 2.607160
Valid average loss all      (Triplet)                 : 0.264533

== Recognize ==
Valid average loss Recognize     : 0.908099
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.491355

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.416550397872925 sec. =
Valid knn accuracy drums     : 75.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.367475271224976 sec. =
Valid knn accuracy bass      : 22.819767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.96033763885498 sec. =
Valid knn accuracy piano     : 31.216216216216214%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.87121295928955 sec. =
Valid knn accuracy guitar    : 45.45454545454545%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.227110862731934 sec. =
Valid knn accuracy residuals : 56.60377358490566%

Valid knn accuracy average   : 46.277684068917324%

                                                                        [AEpoch 40: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.762, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0261, Train/loss_recog_epoch=0.987]Epoch 40: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.762, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068893, 0.068645, 0.069915
Train average loss UNet            (all)              : 0.207453

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007318, 2.268085, 4.012599
Train average loss bass     (Triplet, dist_p, dist_n) : 0.042817, 1.861530, 2.409191
Train average loss piano    (Triplet, dist_p, dist_n) : 0.027898, 2.051207, 2.754153
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.020762, 2.129538, 3.121499
Train average loss residuals(Triplet, dist_p, dist_n) : 0.018668, 2.295984, 3.125669
Train average loss all      (Triplet)                 : 0.023919

== Recognize ==
Train average loss Recognize     : 0.989965
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.231372

Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.762, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]          Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.762, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]Epoch 41:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.762, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]Epoch 41:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.870, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990] Epoch 41:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.870, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]Epoch 41:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0202, Train/loss_recog_step=1.020, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]Epoch 41:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0202, Train/loss_recog_step=1.020, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]Epoch 41:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0375, Train/loss_recog_step=0.719, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]Epoch 41:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0375, Train/loss_recog_step=0.719, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]Epoch 41:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=0.962, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]Epoch 41:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=0.962, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]Epoch 41:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=0.801, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990] Epoch 41:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=0.801, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]Epoch 41:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.027, Train/loss_recog_step=1.170, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990] Epoch 41: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.027, Train/loss_recog_step=1.170, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]Epoch 41: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=0.764, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.491, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.265, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.463, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.04it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.58it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.38it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.45it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.30it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072186, 0.072206, 0.072817
Valid average loss UNet            (all)              : 0.217209

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133426, 2.478620, 4.040060
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.347979, 2.218199, 2.174920
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.280963, 2.404144, 2.519370
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.324386, 2.494890, 2.842383
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.315657, 2.638430, 3.022901
Valid average loss all      (Triplet)                 : 0.304612

== Recognize ==
Valid average loss Recognize     : 0.918742
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.521821

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.39501404762268 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.733673095703125 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.885040521621704 sec. =
Valid knn accuracy piano     : 30.810810810810814%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.9416983127594 sec. =
Valid knn accuracy guitar    : 45.2922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.505717754364014 sec. =
Valid knn accuracy residuals : 58.9622641509434%

Valid knn accuracy average   : 46.23877474504685%

                                                                        [AEpoch 41: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=0.764, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.231, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0239, Train/loss_recog_epoch=0.990]Epoch 41: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=0.764, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068773, 0.068575, 0.069720
Train average loss UNet            (all)              : 0.207067

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005608, 2.318648, 4.040999
Train average loss bass     (Triplet, dist_p, dist_n) : 0.036677, 1.904998, 2.474999
Train average loss piano    (Triplet, dist_p, dist_n) : 0.025647, 2.105895, 2.837938
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.018971, 2.191514, 3.230482
Train average loss residuals(Triplet, dist_p, dist_n) : 0.019406, 2.354961, 3.191131
Train average loss all      (Triplet)                 : 0.021692

== Recognize ==
Train average loss Recognize     : 0.991006
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.228760

Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=0.764, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]          Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=0.764, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]Epoch 42:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=0.764, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]Epoch 42:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000615, Train/loss_recog_step=0.880, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]Epoch 42:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000615, Train/loss_recog_step=0.880, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]Epoch 42:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=1.030, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]  Epoch 42:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0251, Train/loss_recog_step=1.030, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]Epoch 42:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0266, Train/loss_recog_step=0.732, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]Epoch 42:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0266, Train/loss_recog_step=0.732, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]Epoch 42:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=0.975, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991] Epoch 42:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=0.975, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]Epoch 42:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=0.793, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]Epoch 42:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=0.793, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]Epoch 42:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=1.160, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]Epoch 42: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=1.160, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]Epoch 42: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=0.771, Valid/loss_all_step=0.567, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.522, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.305, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.462, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.13it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.13it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.07it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.98it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073154, 0.072147, 0.072225
Valid average loss UNet            (all)              : 0.217526

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.179909, 2.580512, 4.297067
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.402170, 2.318146, 2.246516
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.278321, 2.499704, 2.545817
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.249364, 2.612676, 3.115227
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.269377, 2.524526, 3.044103
Valid average loss all      (Triplet)                 : 0.302292

== Recognize ==
Valid average loss Recognize     : 0.905636
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.519817

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.158663749694824 sec. =
Valid knn accuracy drums     : 80.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.94577169418335 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.923019647598267 sec. =
Valid knn accuracy piano     : 30.945945945945947%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.44154167175293 sec. =
Valid knn accuracy guitar    : 43.993506493506494%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.849696159362793 sec. =
Valid knn accuracy residuals : 56.76100628930818%

Valid knn accuracy average   : 45.65541322318031%

                                                                        [AEpoch 42: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=0.771, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0217, Train/loss_recog_epoch=0.991]Epoch 42: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=0.771, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068729, 0.068474, 0.069679
Train average loss UNet            (all)              : 0.206882

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004070, 2.519994, 4.482398
Train average loss bass     (Triplet, dist_p, dist_n) : 0.033399, 2.083723, 2.720634
Train average loss piano    (Triplet, dist_p, dist_n) : 0.021178, 2.293013, 3.094229
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.018705, 2.383092, 3.492980
Train average loss residuals(Triplet, dist_p, dist_n) : 0.016610, 2.551687, 3.470045
Train average loss all      (Triplet)                 : 0.019217

== Recognize ==
Train average loss Recognize     : 0.999079
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.226099

Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=0.771, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]          Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=0.771, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=0.771, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=0.872, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=0.872, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=1.020, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=1.020, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=0.719, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=0.719, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0278, Train/loss_recog_step=0.951, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0278, Train/loss_recog_step=0.951, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.777, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.777, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=1.150, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=1.150, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.767, Valid/loss_all_step=0.532, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.290, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.302, Valid/loss_recog_epoch=0.906, Valid/knn_avr=0.457, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.33it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.59it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.62it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073143, 0.072497, 0.072979
Valid average loss UNet            (all)              : 0.218618

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.250427, 2.814781, 4.243536
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.345095, 2.506081, 2.516428
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.353667, 2.731707, 2.803828
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.299543, 2.808719, 3.216990
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.279745, 2.930047, 3.394869
Valid average loss all      (Triplet)                 : 0.316633

== Recognize ==
Valid average loss Recognize     : 0.902062
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.535252

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.132256507873535 sec. =
Valid knn accuracy drums     : 81.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.94264841079712 sec. =
Valid knn accuracy bass      : 13.517441860465116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.024279832839966 sec. =
Valid knn accuracy piano     : 34.5945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.625843048095703 sec. =
Valid knn accuracy guitar    : 43.993506493506494%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.79018759727478 sec. =
Valid knn accuracy residuals : 57.704402515723274%

Valid knn accuracy average   : 46.16787144579907%

                                                                        [AEpoch 43: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.767, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0192, Train/loss_recog_epoch=0.999]Epoch 43: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.767, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068593, 0.068344, 0.069523
Train average loss UNet            (all)              : 0.206461

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.006132, 2.478968, 4.323288
Train average loss bass     (Triplet, dist_p, dist_n) : 0.029914, 2.080028, 2.735523
Train average loss piano    (Triplet, dist_p, dist_n) : 0.019200, 2.269740, 3.061117
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.017328, 2.380658, 3.484286
Train average loss residuals(Triplet, dist_p, dist_n) : 0.021996, 2.543672, 3.448441
Train average loss all      (Triplet)                 : 0.019100

== Recognize ==
Train average loss Recognize     : 0.984416
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.225561

Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.767, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]          Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.767, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]Epoch 44:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.237, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0262, Train/loss_recog_step=0.767, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]Epoch 44:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=0.862, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]Epoch 44:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0215, Train/loss_recog_step=0.862, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]Epoch 44:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=1.020, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]Epoch 44:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=1.020, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]Epoch 44:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00765, Train/loss_recog_step=0.728, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]Epoch 44:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00765, Train/loss_recog_step=0.728, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]Epoch 44:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=0.971, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984] Epoch 44:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=0.971, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]Epoch 44:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00178, Train/loss_recog_step=0.807, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]Epoch 44:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00178, Train/loss_recog_step=0.807, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]Epoch 44:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=1.170, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984] Epoch 44: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0195, Train/loss_recog_step=1.170, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]Epoch 44: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.758, Valid/loss_all_step=0.516, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.535, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.317, Valid/loss_recog_epoch=0.902, Valid/knn_avr=0.462, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.24it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.15it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.92it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.35it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.63it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074131, 0.073030, 0.073005
Valid average loss UNet            (all)              : 0.220166

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.210722, 2.892276, 4.595943
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.378425, 2.579416, 2.564833
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.357542, 2.691967, 2.791974
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.300485, 2.772505, 3.275688
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.296840, 2.708830, 3.262158
Valid average loss all      (Triplet)                 : 0.324731

== Recognize ==
Valid average loss Recognize     : 0.913036
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.544897

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.196818113327026 sec. =
Valid knn accuracy drums     : 74.11764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.92726445198059 sec. =
Valid knn accuracy bass      : 13.517441860465116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.6626718044281 sec. =
Valid knn accuracy piano     : 30.675675675675674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.188640356063843 sec. =
Valid knn accuracy guitar    : 44.8051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.773549795150757 sec. =
Valid knn accuracy residuals : 54.87421383647799%

Valid knn accuracy average   : 43.598034647327424%

                                                                        [AEpoch 44: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.758, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0191, Train/loss_recog_epoch=0.984]Epoch 44: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.758, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068375, 0.068080, 0.069345
Train average loss UNet            (all)              : 0.205800

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005233, 2.512037, 4.452144
Train average loss bass     (Triplet, dist_p, dist_n) : 0.024569, 2.113160, 2.808538
Train average loss piano    (Triplet, dist_p, dist_n) : 0.020129, 2.318073, 3.137331
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.016601, 2.430386, 3.591562
Train average loss residuals(Triplet, dist_p, dist_n) : 0.014817, 2.587540, 3.534118
Train average loss all      (Triplet)                 : 0.016483

== Recognize ==
Train average loss Recognize     : 0.992837
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.222283

Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.758, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]          Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.758, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.758, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0209, Train/loss_recog_step=0.879, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0209, Train/loss_recog_step=0.879, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=1.040, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=1.040, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0248, Train/loss_recog_step=0.731, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0248, Train/loss_recog_step=0.731, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.976, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.976, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=0.804, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993] Epoch 45:  96%|█████████▌| 300/313 [04:15<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=0.804, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45:  96%|█████████▌| 300/313 [04:15<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0297, Train/loss_recog_step=1.170, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0297, Train/loss_recog_step=1.170, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.558, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.309, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.545, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.325, Valid/loss_recog_epoch=0.913, Valid/knn_avr=0.436, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.98it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.56it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.04it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.53it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.31it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.42it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073746, 0.072883, 0.073318
Valid average loss UNet            (all)              : 0.219947

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.178339, 2.766123, 4.670024
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.420214, 2.674174, 2.630355
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.507072, 2.711055, 2.657874
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.211453, 2.756093, 3.363801
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.292158, 2.589689, 3.148704
Valid average loss all      (Triplet)                 : 0.348474

== Recognize ==
Valid average loss Recognize     : 0.914384
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.568421

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.062165260314941 sec. =
Valid knn accuracy drums     : 77.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.776111364364624 sec. =
Valid knn accuracy bass      : 22.38372093023256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.05045771598816 sec. =
Valid knn accuracy piano     : 28.783783783783782%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.46147608757019 sec. =
Valid knn accuracy guitar    : 42.6948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.616528987884521 sec. =
Valid knn accuracy residuals : 52.67295597484277%

Valid knn accuracy average   : 44.89528847085051%

                                                                        [AEpoch 45: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.222, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0165, Train/loss_recog_epoch=0.993]Epoch 45: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068385, 0.068126, 0.069383
Train average loss UNet            (all)              : 0.205895

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005092, 2.706168, 4.781204
Train average loss bass     (Triplet, dist_p, dist_n) : 0.021515, 2.268223, 3.030273
Train average loss piano    (Triplet, dist_p, dist_n) : 0.022253, 2.518542, 3.404188
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.013831, 2.617488, 3.886631
Train average loss residuals(Triplet, dist_p, dist_n) : 0.012119, 2.792731, 3.831878
Train average loss all      (Triplet)                 : 0.015131

== Recognize ==
Train average loss Recognize     : 1.000002
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.221025

Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]          Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]Epoch 46:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.763, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]Epoch 46:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00957, Train/loss_recog_step=0.887, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]Epoch 46:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00957, Train/loss_recog_step=0.887, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]Epoch 46:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=1.040, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]Epoch 46:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=1.040, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]Epoch 46:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.252, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0442, Train/loss_recog_step=0.735, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000] Epoch 46:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.252, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0442, Train/loss_recog_step=0.735, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]Epoch 46:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=0.989, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]Epoch 46:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=0.989, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]Epoch 46:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0154, Train/loss_recog_step=0.809, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000] Epoch 46:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0154, Train/loss_recog_step=0.809, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]Epoch 46:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=1.180, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]Epoch 46: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0334, Train/loss_recog_step=1.180, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]Epoch 46: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.776, Valid/loss_all_step=0.642, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.399, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.914, Valid/knn_avr=0.449, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.12it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.39it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.39it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072674, 0.071553, 0.071703
Valid average loss UNet            (all)              : 0.215929

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.148219, 2.898555, 4.712709
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.417124, 2.771137, 2.732107
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.397006, 2.801594, 2.860544
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.217484, 2.896401, 3.425125
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.400895, 3.023342, 3.536766
Valid average loss all      (Triplet)                 : 0.333561

== Recognize ==
Valid average loss Recognize     : 0.924233
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.549489

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.495296239852905 sec. =
Valid knn accuracy drums     : 78.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.001616954803467 sec. =
Valid knn accuracy bass      : 22.38372093023256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.910982847213745 sec. =
Valid knn accuracy piano     : 32.83783783783784%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.642026901245117 sec. =
Valid knn accuracy guitar    : 39.935064935064936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.4012770652771 sec. =
Valid knn accuracy residuals : 55.81761006289309%

Valid knn accuracy average   : 45.95955263555862%

                                                                        [AEpoch 46: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.776, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.000]Epoch 46: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.776, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068421, 0.068151, 0.069304
Train average loss UNet            (all)              : 0.205876

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005251, 2.768389, 4.877249
Train average loss bass     (Triplet, dist_p, dist_n) : 0.022302, 2.329741, 3.102992
Train average loss piano    (Triplet, dist_p, dist_n) : 0.019581, 2.555686, 3.475556
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.015161, 2.639932, 3.909696
Train average loss residuals(Triplet, dist_p, dist_n) : 0.013993, 2.829207, 3.858454
Train average loss all      (Triplet)                 : 0.015351

== Recognize ==
Train average loss Recognize     : 1.006240
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.221228

Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.776, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]          Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.776, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.776, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0244, Train/loss_recog_step=0.897, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0244, Train/loss_recog_step=0.897, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.255, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0465, Train/loss_recog_step=1.050, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.255, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0465, Train/loss_recog_step=1.050, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.740, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0233, Train/loss_recog_step=0.740, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.990, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.990, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00409, Train/loss_recog_step=0.800, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00409, Train/loss_recog_step=0.800, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00922, Train/loss_recog_step=1.170, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00922, Train/loss_recog_step=1.170, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.772, Valid/loss_all_step=0.534, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.549, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.460, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.07it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.24it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.92it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072253, 0.071419, 0.071740
Valid average loss UNet            (all)              : 0.215413

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.185232, 2.658713, 4.119651
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.285182, 2.476328, 2.576233
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.277849, 2.519730, 2.705787
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.191664, 2.586590, 3.175423
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.301895, 2.809261, 3.249259
Valid average loss all      (Triplet)                 : 0.242582

== Recognize ==
Valid average loss Recognize     : 0.923242
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.457996

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.450143337249756 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.866752862930298 sec. =
Valid knn accuracy bass      : 17.587209302325583%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.661359071731567 sec. =
Valid knn accuracy piano     : 36.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.037673711776733 sec. =
Valid knn accuracy guitar    : 44.15584415584416%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.948777437210083 sec. =
Valid knn accuracy residuals : 63.36477987421384%

Valid knn accuracy average   : 48.4047145202128%

                                                                        [AEpoch 47: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.772, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 47: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.772, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068234, 0.068030, 0.069145
Train average loss UNet            (all)              : 0.205409

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003233, 2.785382, 4.968536
Train average loss bass     (Triplet, dist_p, dist_n) : 0.022276, 2.364458, 3.143751
Train average loss piano    (Triplet, dist_p, dist_n) : 0.018145, 2.571058, 3.516124
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012457, 2.675813, 3.961574
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011813, 2.875912, 3.950704
Train average loss all      (Triplet)                 : 0.013805

== Recognize ==
Train average loss Recognize     : 1.011129
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.219214

Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.772, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]          Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.772, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]Epoch 48:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.772, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]Epoch 48:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.021, Train/loss_recog_step=0.894, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]Epoch 48:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.021, Train/loss_recog_step=0.894, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]Epoch 48:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]Epoch 48:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]Epoch 48:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00705, Train/loss_recog_step=0.732, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]Epoch 48:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00705, Train/loss_recog_step=0.732, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]Epoch 48:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.976, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010] Epoch 48:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.976, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]Epoch 48:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.799, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]Epoch 48:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.799, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]Epoch 48:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.00579, Train/loss_recog_step=1.180, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]Epoch 48: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.00579, Train/loss_recog_step=1.180, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]Epoch 48: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000382, Train/loss_recog_step=0.782, Valid/loss_all_step=0.291, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.0492, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.458, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.243, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.484, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.97it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.13it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.86it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.41it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.47it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074955, 0.073515, 0.074408
Valid average loss UNet            (all)              : 0.222878

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.168198, 2.711019, 4.567666
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.422599, 2.644463, 2.637433
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.344468, 2.549338, 2.616929
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.199087, 2.594279, 3.230219
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.311324, 2.874073, 3.047688
Valid average loss all      (Triplet)                 : 0.319127

== Recognize ==
Valid average loss Recognize     : 0.919737
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.542006

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.379727363586426 sec. =
Valid knn accuracy drums     : 77.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.71161413192749 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.487001180648804 sec. =
Valid knn accuracy piano     : 31.891891891891895%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.554896116256714 sec. =
Valid knn accuracy guitar    : 42.2077922077922%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.272579431533813 sec. =
Valid knn accuracy residuals : 54.40251572327044%

Valid knn accuracy average   : 44.60160275528858%

                                                                        [AEpoch 48: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000382, Train/loss_recog_step=0.782, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0138, Train/loss_recog_epoch=1.010] Epoch 48: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000382, Train/loss_recog_step=0.782, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067981, 0.067756, 0.068992
Train average loss UNet            (all)              : 0.204729

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004001, 2.680197, 4.724868
Train average loss bass     (Triplet, dist_p, dist_n) : 0.018718, 2.295464, 3.093124
Train average loss piano    (Triplet, dist_p, dist_n) : 0.015145, 2.454895, 3.400201
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010134, 2.580420, 3.831945
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011213, 2.760170, 3.837017
Train average loss all      (Triplet)                 : 0.012221

== Recognize ==
Train average loss Recognize     : 1.005754
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.216950

Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000382, Train/loss_recog_step=0.782, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]          Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000382, Train/loss_recog_step=0.782, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]Epoch 49:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000382, Train/loss_recog_step=0.782, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]Epoch 49:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.882, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]   Epoch 49:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.882, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]Epoch 49:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0234, Train/loss_recog_step=1.050, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]Epoch 49:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0234, Train/loss_recog_step=1.050, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]Epoch 49:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=0.744, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]Epoch 49:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0192, Train/loss_recog_step=0.744, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]Epoch 49:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0269, Train/loss_recog_step=0.993, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]Epoch 49:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0269, Train/loss_recog_step=0.993, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]Epoch 49:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.823, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]Epoch 49:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.823, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]Epoch 49:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010] Epoch 49: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]Epoch 49: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=0.788, Valid/loss_all_step=0.559, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.323, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.542, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.319, Valid/loss_recog_epoch=0.920, Valid/knn_avr=0.446, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.19it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.80it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.08it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.40it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071533, 0.071263, 0.071877
Valid average loss UNet            (all)              : 0.214673

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.182036, 2.790010, 4.601507
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.420702, 2.634424, 2.626926
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.444328, 2.700854, 2.644879
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.210975, 2.704272, 3.534283
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.320453, 2.720676, 3.126312
Valid average loss all      (Triplet)                 : 0.333066

== Recognize ==
Valid average loss Recognize     : 0.927071
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.547739

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.877469062805176 sec. =
Valid knn accuracy drums     : 77.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.702629089355469 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.568812608718872 sec. =
Valid knn accuracy piano     : 26.756756756756754%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.503915309906006 sec. =
Valid knn accuracy guitar    : 45.2922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.793048620223999 sec. =
Valid knn accuracy residuals : 52.04402515723271%

Valid knn accuracy average   : 44.06859794123945%

                                                                        [AEpoch 49: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=0.788, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0122, Train/loss_recog_epoch=1.010]Epoch 49: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=0.788, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067930, 0.067700, 0.068956
Train average loss UNet            (all)              : 0.204586

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003060, 2.800910, 4.963468
Train average loss bass     (Triplet, dist_p, dist_n) : 0.018385, 2.407255, 3.248066
Train average loss piano    (Triplet, dist_p, dist_n) : 0.015357, 2.590119, 3.572447
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010983, 2.712884, 4.038129
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009230, 2.864641, 3.962527
Train average loss all      (Triplet)                 : 0.011626

== Recognize ==
Train average loss Recognize     : 1.019151
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.216212

Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=0.788, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]          Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=0.788, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]Epoch 50:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=0.788, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]Epoch 50:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.915, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020] Epoch 50:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=0.915, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]Epoch 50:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=1.060, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]Epoch 50:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.019, Train/loss_recog_step=1.060, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]Epoch 50:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00907, Train/loss_recog_step=0.745, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]Epoch 50:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00907, Train/loss_recog_step=0.745, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]Epoch 50:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0319, Train/loss_recog_step=0.992, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020] Epoch 50:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0319, Train/loss_recog_step=0.992, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]Epoch 50:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=0.816, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]Epoch 50:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00661, Train/loss_recog_step=0.816, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]Epoch 50:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0317, Train/loss_recog_step=1.190, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020] Epoch 50: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.238, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0317, Train/loss_recog_step=1.190, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]Epoch 50: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=0.788, Valid/loss_all_step=0.533, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.292, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.927, Valid/knn_avr=0.441, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.02it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.94it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.80it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.40it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.90it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073690, 0.072836, 0.072527
Valid average loss UNet            (all)              : 0.219054

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.163321, 3.292562, 5.306150
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.438445, 3.076783, 3.073921
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.512674, 3.056708, 3.044553
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.216096, 3.185216, 3.749192
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.366420, 3.280034, 3.626813
Valid average loss all      (Triplet)                 : 0.349440

== Recognize ==
Valid average loss Recognize     : 0.928269
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.568494

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.233840703964233 sec. =
Valid knn accuracy drums     : 76.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.824898481369019 sec. =
Valid knn accuracy bass      : 16.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.648197889328003 sec. =
Valid knn accuracy piano     : 26.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.5100257396698 sec. =
Valid knn accuracy guitar    : 43.34415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.630157232284546 sec. =
Valid knn accuracy residuals : 56.44654088050315%

Valid knn accuracy average   : 43.84056623146265%

                                                                        [AEpoch 50: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=0.788, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.216, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0116, Train/loss_recog_epoch=1.020]Epoch 50: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=0.788, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067894, 0.067581, 0.068822
Train average loss UNet            (all)              : 0.204297

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002220, 2.867733, 5.059843
Train average loss bass     (Triplet, dist_p, dist_n) : 0.018613, 2.453942, 3.316904
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012638, 2.646016, 3.640712
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009066, 2.769990, 4.111130
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011774, 2.939316, 4.026842
Train average loss all      (Triplet)                 : 0.011124

== Recognize ==
Train average loss Recognize     : 1.023736
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.215421

Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=0.788, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]          Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=0.788, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]Epoch 51:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=0.788, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]Epoch 51:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.897, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020] Epoch 51:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.897, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]Epoch 51:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=1.060, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]Epoch 51:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=1.060, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]Epoch 51:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00166, Train/loss_recog_step=0.740, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]Epoch 51:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00166, Train/loss_recog_step=0.740, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]Epoch 51:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.995, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]Epoch 51:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=0.995, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]Epoch 51:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0311, Train/loss_recog_step=0.822, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020] Epoch 51:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0311, Train/loss_recog_step=0.822, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]Epoch 51:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00681, Train/loss_recog_step=1.200, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]Epoch 51: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00681, Train/loss_recog_step=1.200, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]Epoch 51: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0348, Train/loss_recog_step=0.798, Valid/loss_all_step=0.514, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.260, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.349, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.02it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.70it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.02it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.97it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071798, 0.071429, 0.071709
Valid average loss UNet            (all)              : 0.214936

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.202163, 2.916833, 4.724957
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.403254, 2.707455, 2.694277
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.352262, 2.837970, 2.963026
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.259561, 2.865450, 3.629794
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.310295, 3.174236, 3.394476
Valid average loss all      (Triplet)                 : 0.326111

== Recognize ==
Valid average loss Recognize     : 0.940040
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.541047

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.481853485107422 sec. =
Valid knn accuracy drums     : 81.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.000470876693726 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.670630693435669 sec. =
Valid knn accuracy piano     : 30.270270270270274%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.722046613693237 sec. =
Valid knn accuracy guitar    : 44.967532467532465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.298711776733398 sec. =
Valid knn accuracy residuals : 54.40251572327044%

Valid knn accuracy average   : 45.24509515596293%

                                                                        [AEpoch 51: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0348, Train/loss_recog_step=0.798, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0111, Train/loss_recog_epoch=1.020]Epoch 51: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0348, Train/loss_recog_step=0.798, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067927, 0.067686, 0.068893
Train average loss UNet            (all)              : 0.204507

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003607, 3.005048, 5.311304
Train average loss bass     (Triplet, dist_p, dist_n) : 0.017861, 2.599783, 3.529948
Train average loss piano    (Triplet, dist_p, dist_n) : 0.017035, 2.820211, 3.882571
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010525, 2.942479, 4.381936
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011089, 3.124539, 4.307723
Train average loss all      (Triplet)                 : 0.012082

== Recognize ==
Train average loss Recognize     : 1.024328
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.216589

Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0348, Train/loss_recog_step=0.798, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]          Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0348, Train/loss_recog_step=0.798, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0348, Train/loss_recog_step=0.798, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.908, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.908, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=1.080, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020] Epoch 52:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=1.080, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0182, Train/loss_recog_step=0.750, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0182, Train/loss_recog_step=0.750, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=1.010, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0286, Train/loss_recog_step=1.010, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=0.816, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=0.816, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00321, Train/loss_recog_step=1.200, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00321, Train/loss_recog_step=1.200, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=0.791, Valid/loss_all_step=0.561, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.317, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.541, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.326, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.452, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.63it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.86it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.37it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.44it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.85it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073908, 0.072749, 0.072896
Valid average loss UNet            (all)              : 0.219552

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.132746, 2.692536, 4.505995
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.295935, 2.585457, 2.718280
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.442147, 2.721213, 2.621548
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.242291, 2.599673, 3.214689
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.316277, 2.638273, 2.948280
Valid average loss all      (Triplet)                 : 0.296225

== Recognize ==
Valid average loss Recognize     : 0.929778
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.515777

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.313603639602661 sec. =
Valid knn accuracy drums     : 77.20588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.028648614883423 sec. =
Valid knn accuracy bass      : 15.11627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.714905261993408 sec. =
Valid knn accuracy piano     : 36.891891891891895%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.98500370979309 sec. =
Valid knn accuracy guitar    : 40.74675324675325%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.074814319610596 sec. =
Valid knn accuracy residuals : 49.056603773584904%

Valid knn accuracy average   : 43.80348206698773%

                                                                        [AEpoch 52: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=0.791, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0121, Train/loss_recog_epoch=1.020]Epoch 52: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=0.791, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067710, 0.067524, 0.068824
Train average loss UNet            (all)              : 0.204058

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002535, 2.861837, 4.973835
Train average loss bass     (Triplet, dist_p, dist_n) : 0.017219, 2.463440, 3.339881
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012746, 2.667156, 3.686406
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012118, 2.775037, 4.143539
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010736, 2.955754, 4.078628
Train average loss all      (Triplet)                 : 0.011175

== Recognize ==
Train average loss Recognize     : 1.031254
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.215233

Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=0.791, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]          Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=0.791, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]Epoch 53:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=0.791, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]Epoch 53:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=0.911, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]Epoch 53:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=0.911, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]Epoch 53:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0209, Train/loss_recog_step=1.060, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030] Epoch 53:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0209, Train/loss_recog_step=1.060, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]Epoch 53:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.744, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]Epoch 53:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.744, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]Epoch 53:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030] Epoch 53:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]Epoch 53:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000757, Train/loss_recog_step=0.828, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]Epoch 53:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000757, Train/loss_recog_step=0.828, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]Epoch 53:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=1.200, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]  Epoch 53: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=1.200, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]Epoch 53: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.800, Valid/loss_all_step=0.512, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.272, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.516, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.296, Valid/loss_recog_epoch=0.930, Valid/knn_avr=0.438, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.21it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.01it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.11it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.60it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.33it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.077016, 0.074902, 0.075486
Valid average loss UNet            (all)              : 0.227404

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.170077, 2.918304, 4.850273
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.402599, 2.763498, 2.740666
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.363659, 2.907502, 3.084728
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.248948, 2.777778, 3.562552
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.272940, 3.000102, 3.541939
Valid average loss all      (Triplet)                 : 0.315129

== Recognize ==
Valid average loss Recognize     : 0.940293
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.542533

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.339421272277832 sec. =
Valid knn accuracy drums     : 75.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.818963766098022 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.520090818405151 sec. =
Valid knn accuracy piano     : 30.54054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.196200609207153 sec. =
Valid knn accuracy guitar    : 46.103896103896105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.014678716659546 sec. =
Valid knn accuracy residuals : 57.704402515723274%

Valid knn accuracy average   : 45.73741489085551%

                                                                        [AEpoch 53: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.800, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0112, Train/loss_recog_epoch=1.030]Epoch 53: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.800, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067729, 0.067543, 0.068776
Train average loss UNet            (all)              : 0.204048

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003711, 3.003182, 5.264198
Train average loss bass     (Triplet, dist_p, dist_n) : 0.017655, 2.590166, 3.541927
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012009, 2.775137, 3.828603
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010461, 2.911255, 4.350386
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009573, 3.084075, 4.263108
Train average loss all      (Triplet)                 : 0.010833

== Recognize ==
Train average loss Recognize     : 1.029292
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.214881

Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.800, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]          Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.800, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]Epoch 54:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.800, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]Epoch 54:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00273, Train/loss_recog_step=0.909, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]Epoch 54:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00273, Train/loss_recog_step=0.909, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]Epoch 54:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00713, Train/loss_recog_step=1.070, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]Epoch 54:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00713, Train/loss_recog_step=1.070, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]Epoch 54:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.755, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030] Epoch 54:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.755, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]Epoch 54:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0154, Train/loss_recog_step=1.000, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]Epoch 54:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0154, Train/loss_recog_step=1.000, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]Epoch 54:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.024, Train/loss_recog_step=0.822, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030] Epoch 54:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.024, Train/loss_recog_step=0.822, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]Epoch 54:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00639, Train/loss_recog_step=1.190, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]Epoch 54: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00639, Train/loss_recog_step=1.190, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]Epoch 54: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.790, Valid/loss_all_step=0.555, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.303, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.543, Valid/loss_unet_all_epoch=0.227, Valid/loss_triplet_all_epoch=0.315, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.457, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.88it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.77it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.03it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.92it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071026, 0.071655, 0.073296
Valid average loss UNet            (all)              : 0.215977

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.119002, 3.338194, 5.053625
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.553957, 3.139139, 2.981533
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.425044, 3.269227, 3.482208
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.219674, 3.197444, 3.930476
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.372276, 3.467500, 3.994615
Valid average loss all      (Triplet)                 : 0.367478

== Recognize ==
Valid average loss Recognize     : 0.932530
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.583454

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.876612901687622 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.676993131637573 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.475006818771362 sec. =
Valid knn accuracy piano     : 34.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.573010206222534 sec. =
Valid knn accuracy guitar    : 44.48051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.540900468826294 sec. =
Valid knn accuracy residuals : 59.43396226415094%

Valid knn accuracy average   : 46.2517561115695%

                                                                        [AEpoch 54: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.790, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.030]Epoch 54: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.790, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067630, 0.067424, 0.068557
Train average loss UNet            (all)              : 0.203611

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003742, 2.997170, 5.220786
Train average loss bass     (Triplet, dist_p, dist_n) : 0.015260, 2.574834, 3.520226
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013595, 2.777013, 3.851235
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010762, 2.905857, 4.330949
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008610, 3.068364, 4.253399
Train average loss all      (Triplet)                 : 0.010523

== Recognize ==
Train average loss Recognize     : 1.032433
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.214134

Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.790, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]          Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.790, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00408, Train/loss_recog_step=0.790, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00263, Train/loss_recog_step=0.903, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00263, Train/loss_recog_step=0.903, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=1.060, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030] Epoch 55:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=1.060, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=0.742, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=0.742, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.998, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.998, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=5.58e-6, Train/loss_recog_step=0.810, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=5.58e-6, Train/loss_recog_step=0.810, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00703, Train/loss_recog_step=1.180, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00703, Train/loss_recog_step=1.180, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=0.789, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.333, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.583, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.933, Valid/knn_avr=0.463, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.29it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.32it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.70it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.67it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.64it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070962, 0.070721, 0.070685
Valid average loss UNet            (all)              : 0.212368

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.198521, 2.915181, 4.504735
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.380222, 2.705172, 2.715239
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.303767, 2.728588, 2.910404
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.233226, 2.728262, 3.348851
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.322452, 2.957851, 3.378514
Valid average loss all      (Triplet)                 : 0.298022

== Recognize ==
Valid average loss Recognize     : 0.922540
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.510390

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.843098878860474 sec. =
Valid knn accuracy drums     : 77.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.03471302986145 sec. =
Valid knn accuracy bass      : 15.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.463773250579834 sec. =
Valid knn accuracy piano     : 27.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.173660039901733 sec. =
Valid knn accuracy guitar    : 48.214285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.948628425598145 sec. =
Valid knn accuracy residuals : 57.23270440251572%

Valid knn accuracy average   : 45.183280893918955%

                                                                        [AEpoch 55: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=0.789, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0105, Train/loss_recog_epoch=1.030]Epoch 55: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=0.789, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067475, 0.067194, 0.068422
Train average loss UNet            (all)              : 0.203091

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003830, 2.936740, 5.168111
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014959, 2.534601, 3.477194
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012679, 2.704549, 3.747259
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008788, 2.832596, 4.229479
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010092, 3.004286, 4.132587
Train average loss all      (Triplet)                 : 0.010370

== Recognize ==
Train average loss Recognize     : 1.021607
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.213461

Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=0.789, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]          Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=0.789, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]Epoch 56:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00851, Train/loss_recog_step=0.789, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]Epoch 56:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.902, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]Epoch 56:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.902, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]Epoch 56:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.00342, Train/loss_recog_step=1.060, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]Epoch 56:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.00342, Train/loss_recog_step=1.060, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]Epoch 56:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0086, Train/loss_recog_step=0.745, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020] Epoch 56:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0086, Train/loss_recog_step=0.745, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]Epoch 56:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=1.010, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]Epoch 56:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=1.010, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]Epoch 56:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00229, Train/loss_recog_step=0.820, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]Epoch 56:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00229, Train/loss_recog_step=0.820, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]Epoch 56:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.200, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020] Epoch 56: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.200, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]Epoch 56: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.783, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.510, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.452, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.14it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.18it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.89it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.12it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072797, 0.072214, 0.072064
Valid average loss UNet            (all)              : 0.217075

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.231706, 3.327369, 5.145334
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.486755, 3.142411, 3.056916
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.446599, 3.157584, 3.253751
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.274871, 3.112088, 3.856505
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.330109, 3.596832, 3.797925
Valid average loss all      (Triplet)                 : 0.386467

== Recognize ==
Valid average loss Recognize     : 0.932407
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.603542

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.01873517036438 sec. =
Valid knn accuracy drums     : 75.1470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.003737211227417 sec. =
Valid knn accuracy bass      : 17.296511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.624067306518555 sec. =
Valid knn accuracy piano     : 32.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.520992279052734 sec. =
Valid knn accuracy guitar    : 44.8051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.262463569641113 sec. =
Valid knn accuracy residuals : 61.79245283018868%

Valid knn accuracy average   : 46.34878415790452%

                                                                        [AEpoch 56: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.783, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0104, Train/loss_recog_epoch=1.020]Epoch 56: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.783, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067362, 0.067128, 0.068362
Train average loss UNet            (all)              : 0.202852

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003419, 3.020462, 5.274722
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014363, 2.621003, 3.589885
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010250, 2.808135, 3.899266
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007879, 2.944929, 4.409215
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009709, 3.099533, 4.293253
Train average loss all      (Triplet)                 : 0.009291

== Recognize ==
Train average loss Recognize     : 1.027964
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.212143

Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.783, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]          Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.783, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 57:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.783, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 57:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.916, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030] Epoch 57:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.916, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 57:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=1.060, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 57:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=1.060, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 57:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00657, Train/loss_recog_step=0.750, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 57:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00657, Train/loss_recog_step=0.750, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 57:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0252, Train/loss_recog_step=1.020, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030] Epoch 57:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0252, Train/loss_recog_step=1.020, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 57:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00187, Train/loss_recog_step=0.837, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 57:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00187, Train/loss_recog_step=0.837, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 57:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00394, Train/loss_recog_step=1.200, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 57: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00394, Train/loss_recog_step=1.200, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 57: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.450, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.932, Valid/knn_avr=0.463, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.81it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.04it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.18it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.03it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.06it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.10it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071416, 0.071067, 0.070811
Valid average loss UNet            (all)              : 0.213295

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.200923, 3.402148, 5.339458
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.543823, 3.361816, 3.304504
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.521903, 3.390411, 3.350997
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.290746, 3.360245, 3.856488
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.352225, 3.584991, 4.127656
Valid average loss all      (Triplet)                 : 0.411185

== Recognize ==
Valid average loss Recognize     : 0.940155
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.624480

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.728413581848145 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.982443809509277 sec. =
Valid knn accuracy bass      : 17.732558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.214223861694336 sec. =
Valid knn accuracy piano     : 31.891891891891895%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.489542484283447 sec. =
Valid knn accuracy guitar    : 40.0974025974026%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.828702688217163 sec. =
Valid knn accuracy residuals : 63.20754716981132%

Valid knn accuracy average   : 46.49764466561049%

                                                                        [AEpoch 57: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 57: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067274, 0.067011, 0.068253
Train average loss UNet            (all)              : 0.202537

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002989, 3.128603, 5.542021
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012822, 2.701284, 3.731442
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012518, 2.890261, 3.990179
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007837, 3.005699, 4.533063
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009857, 3.190986, 4.412567
Train average loss all      (Triplet)                 : 0.009293

== Recognize ==
Train average loss Recognize     : 1.033338
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.211830

Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]          Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00999, Train/loss_recog_step=0.916, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00999, Train/loss_recog_step=0.916, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00421, Train/loss_recog_step=1.070, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00421, Train/loss_recog_step=1.070, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00457, Train/loss_recog_step=0.752, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00457, Train/loss_recog_step=0.752, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00109, Train/loss_recog_step=1.000, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00109, Train/loss_recog_step=1.000, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.829, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030] Epoch 58:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.829, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=1.210, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=1.210, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.734, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.491, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.465, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.92it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.95it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.04it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.01it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.02it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071739, 0.070895, 0.070254
Valid average loss UNet            (all)              : 0.212888

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.195867, 3.521545, 5.530035
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.507465, 3.541761, 3.491217
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.463684, 3.630129, 3.694620
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.381082, 3.546932, 4.156704
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.385202, 3.906128, 4.158507
Valid average loss all      (Triplet)                 : 0.414417

== Recognize ==
Valid average loss Recognize     : 0.944267
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.627306

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.635284662246704 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.534962892532349 sec. =
Valid knn accuracy bass      : 12.645348837209303%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.486327409744263 sec. =
Valid knn accuracy piano     : 31.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.84863567352295 sec. =
Valid knn accuracy guitar    : 43.506493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.811014890670776 sec. =
Valid knn accuracy residuals : 58.80503144654088%

Valid knn accuracy average   : 44.75926029064016%

                                                                        [AEpoch 58: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.00929, Train/loss_recog_epoch=1.030]Epoch 58: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067244, 0.067004, 0.068198
Train average loss UNet            (all)              : 0.202446

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003059, 3.144008, 5.465005
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011207, 2.721056, 3.768626
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009376, 2.933459, 4.098528
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009811, 3.042212, 4.531590
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009397, 3.236939, 4.495359
Train average loss all      (Triplet)                 : 0.008675

== Recognize ==
Train average loss Recognize     : 1.033561
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.211121

Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]          Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]Epoch 59:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]Epoch 59:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00772, Train/loss_recog_step=0.908, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]Epoch 59:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00772, Train/loss_recog_step=0.908, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]Epoch 59:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]  Epoch 59:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]Epoch 59:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00876, Train/loss_recog_step=0.762, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]Epoch 59:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00876, Train/loss_recog_step=0.762, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]Epoch 59:  64%|██████▍   | 200/313 [02:53<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00229, Train/loss_recog_step=1.020, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]Epoch 59:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00229, Train/loss_recog_step=1.020, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]Epoch 59:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00771, Train/loss_recog_step=0.837, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]Epoch 59:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00771, Train/loss_recog_step=0.837, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]Epoch 59:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=1.210, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030] Epoch 59: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=1.210, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]Epoch 59: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.796, Valid/loss_all_step=0.696, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.944, Valid/knn_avr=0.448, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.96it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.17it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.02it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.68it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.92it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073794, 0.072399, 0.072105
Valid average loss UNet            (all)              : 0.218298

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.154739, 3.267679, 4.972144
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.395921, 3.198371, 3.183456
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.441928, 3.259648, 3.210684
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.296708, 3.227371, 3.816784
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.319617, 3.509498, 3.948776
Valid average loss all      (Triplet)                 : 0.333555

== Recognize ==
Valid average loss Recognize     : 0.939673
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.551853

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.193633794784546 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.786845445632935 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.394515037536621 sec. =
Valid knn accuracy piano     : 31.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.541258573532104 sec. =
Valid knn accuracy guitar    : 42.2077922077922%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.573566913604736 sec. =
Valid knn accuracy residuals : 60.37735849056604%

Valid knn accuracy average   : 46.128280925341045%

                                                                        [AEpoch 59: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.796, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00868, Train/loss_recog_epoch=1.030]Epoch 59: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.796, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067181, 0.066962, 0.068189
Train average loss UNet            (all)              : 0.202332

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001972, 3.146923, 5.495375
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011892, 2.750115, 3.811195
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011112, 2.904659, 4.048304
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009366, 3.031251, 4.538178
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008993, 3.239619, 4.489571
Train average loss all      (Triplet)                 : 0.008733

== Recognize ==
Train average loss Recognize     : 1.041088
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.211065

Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.796, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]          Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.796, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]Epoch 60:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.796, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]Epoch 60:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=0.924, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040] Epoch 60:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=0.924, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]Epoch 60:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00669, Train/loss_recog_step=1.090, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]Epoch 60:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00669, Train/loss_recog_step=1.090, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]Epoch 60:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=0.767, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040] Epoch 60:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=0.767, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]Epoch 60:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00807, Train/loss_recog_step=1.020, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]Epoch 60:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00807, Train/loss_recog_step=1.020, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]Epoch 60:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00105, Train/loss_recog_step=0.828, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]Epoch 60:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00105, Train/loss_recog_step=0.828, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]Epoch 60:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=1.220, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]Epoch 60: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=1.220, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]Epoch 60: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0229, Train/loss_recog_step=0.807, Valid/loss_all_step=0.509, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.253, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.552, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.461, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.00it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.88it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.52it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.75it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.96it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071022, 0.070231, 0.070100
Valid average loss UNet            (all)              : 0.211353

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.182756, 3.359762, 5.408630
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.452474, 3.341576, 3.308589
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.537150, 3.331450, 3.261783
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.338605, 3.435367, 4.106813
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.353638, 3.368954, 3.889712
Valid average loss all      (Triplet)                 : 0.397910

== Recognize ==
Valid average loss Recognize     : 0.954928
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.609262

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.933941125869751 sec. =
Valid knn accuracy drums     : 80.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.580397129058838 sec. =
Valid knn accuracy bass      : 21.36627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.775211572647095 sec. =
Valid knn accuracy piano     : 28.10810810810811%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.69267725944519 sec. =
Valid knn accuracy guitar    : 41.396103896103895%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.802923679351807 sec. =
Valid knn accuracy residuals : 59.905660377358494%

Valid knn accuracy average   : 46.18464205497347%

                                                                        [AEpoch 60: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0229, Train/loss_recog_step=0.807, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00873, Train/loss_recog_epoch=1.040]Epoch 60: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0229, Train/loss_recog_step=0.807, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067117, 0.066858, 0.068088
Train average loss UNet            (all)              : 0.202063

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003226, 3.212110, 5.577526
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012165, 2.772684, 3.848389
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010876, 2.938630, 4.086163
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009129, 3.067346, 4.607431
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008814, 3.250228, 4.485409
Train average loss all      (Triplet)                 : 0.009070

== Recognize ==
Train average loss Recognize     : 1.046687
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.211133

Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0229, Train/loss_recog_step=0.807, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]          Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0229, Train/loss_recog_step=0.807, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]Epoch 61:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0229, Train/loss_recog_step=0.807, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]Epoch 61:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00845, Train/loss_recog_step=0.925, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]Epoch 61:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00845, Train/loss_recog_step=0.925, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]Epoch 61:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=1.090, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050] Epoch 61:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=1.090, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]Epoch 61:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=0.758, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]Epoch 61:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=0.758, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]Epoch 61:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000534, Train/loss_recog_step=1.010, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]Epoch 61:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000534, Train/loss_recog_step=1.010, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]Epoch 61:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=0.824, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050] Epoch 61:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=0.824, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]Epoch 61:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=1.210, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]Epoch 61: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00146, Train/loss_recog_step=1.210, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]Epoch 61: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00406, Train/loss_recog_step=0.808, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.401, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.609, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.955, Valid/knn_avr=0.462, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.01it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.07it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.52it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.93it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.13it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.66it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070621, 0.070260, 0.070237
Valid average loss UNet            (all)              : 0.211118

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.153098, 3.138766, 5.355469
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.431673, 3.072611, 3.137101
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.283758, 3.009115, 3.280813
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.289198, 3.115567, 3.760397
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.297567, 3.408863, 3.813673
Valid average loss all      (Triplet)                 : 0.307810

== Recognize ==
Valid average loss Recognize     : 0.948394
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.518928

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.362910032272339 sec. =
Valid knn accuracy drums     : 77.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.858601093292236 sec. =
Valid knn accuracy bass      : 18.313953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.081527471542358 sec. =
Valid knn accuracy piano     : 33.78378378378378%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.692124605178833 sec. =
Valid knn accuracy guitar    : 46.75324675324675%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.689634799957275 sec. =
Valid knn accuracy residuals : 58.333333333333336%

Valid knn accuracy average   : 47.02509876586484%

                                                                        [AEpoch 61: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00406, Train/loss_recog_step=0.808, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00907, Train/loss_recog_epoch=1.050]Epoch 61: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00406, Train/loss_recog_step=0.808, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066961, 0.066693, 0.067990
Train average loss UNet            (all)              : 0.201644

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003620, 3.066371, 5.446963
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010746, 2.669190, 3.706241
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009106, 2.807508, 3.932441
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006786, 2.947851, 4.456735
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008049, 3.123147, 4.346798
Train average loss all      (Triplet)                 : 0.007631

== Recognize ==
Train average loss Recognize     : 1.044171
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.209275

Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00406, Train/loss_recog_step=0.808, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]          Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00406, Train/loss_recog_step=0.808, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00406, Train/loss_recog_step=0.808, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.918, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.918, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00186, Train/loss_recog_step=1.090, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00186, Train/loss_recog_step=1.090, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00884, Train/loss_recog_step=0.758, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00884, Train/loss_recog_step=0.758, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00527, Train/loss_recog_step=1.010, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00527, Train/loss_recog_step=1.010, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.838, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040] Epoch 62:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.838, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00967, Train/loss_recog_step=1.220, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00967, Train/loss_recog_step=1.220, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.409, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.519, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.948, Valid/knn_avr=0.470, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.32it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.57it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.44it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072351, 0.072513, 0.072184
Valid average loss UNet            (all)              : 0.217048

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.208400, 3.625954, 5.598060
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.455872, 3.480102, 3.541842
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.322393, 3.443443, 3.660971
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.307754, 3.636055, 4.137686
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.339474, 3.969760, 4.576878
Valid average loss all      (Triplet)                 : 0.345054

== Recognize ==
Valid average loss Recognize     : 0.950680
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.562102

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.914620399475098 sec. =
Valid knn accuracy drums     : 76.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.988149166107178 sec. =
Valid knn accuracy bass      : 17.151162790697676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.62684965133667 sec. =
Valid knn accuracy piano     : 31.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.320618629455566 sec. =
Valid knn accuracy guitar    : 43.34415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.016746520996094 sec. =
Valid knn accuracy residuals : 60.37735849056604%

Valid knn accuracy average   : 45.70712684002826%

                                                                        [AEpoch 62: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00763, Train/loss_recog_epoch=1.040]Epoch 62: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066881, 0.066522, 0.067800
Train average loss UNet            (all)              : 0.201204

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002853, 3.085056, 5.456719
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012212, 2.683848, 3.735712
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007740, 2.839803, 3.968406
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007563, 2.954169, 4.450373
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007327, 3.166462, 4.404766
Train average loss all      (Triplet)                 : 0.007669

== Recognize ==
Train average loss Recognize     : 1.047048
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.208873

Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]          Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]Epoch 63:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]Epoch 63:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.919, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]Epoch 63:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.919, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]Epoch 63:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00737, Train/loss_recog_step=1.080, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]Epoch 63:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00737, Train/loss_recog_step=1.080, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]Epoch 63:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0307, Train/loss_recog_step=0.761, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050] Epoch 63:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0307, Train/loss_recog_step=0.761, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]Epoch 63:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00035, Train/loss_recog_step=1.020, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]Epoch 63:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00035, Train/loss_recog_step=1.020, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]Epoch 63:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000451, Train/loss_recog_step=0.830, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]Epoch 63:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000451, Train/loss_recog_step=0.830, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]Epoch 63:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=1.220, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]   Epoch 63: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=1.220, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]Epoch 63: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0376, Train/loss_recog_step=0.804, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.262, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.345, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.457, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.59it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.51it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.82it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.82it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071142, 0.071198, 0.072557
Valid average loss UNet            (all)              : 0.214897

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.249185, 3.326059, 5.395912
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.447050, 3.675288, 3.698138
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.324815, 3.247486, 3.436166
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.443353, 3.519510, 4.015640
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.304146, 3.612621, 4.204578
Valid average loss all      (Triplet)                 : 0.372623

== Recognize ==
Valid average loss Recognize     : 0.950452
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.587520

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.632436275482178 sec. =
Valid knn accuracy drums     : 75.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.687886714935303 sec. =
Valid knn accuracy bass      : 19.767441860465116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.555697679519653 sec. =
Valid knn accuracy piano     : 27.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.412327527999878 sec. =
Valid knn accuracy guitar    : 45.616883116883116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.818435907363892 sec. =
Valid knn accuracy residuals : 60.84905660377359%

Valid knn accuracy average   : 45.84842512385553%

                                                                        [AEpoch 63: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0376, Train/loss_recog_step=0.804, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00767, Train/loss_recog_epoch=1.050]Epoch 63: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0376, Train/loss_recog_step=0.804, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066765, 0.066533, 0.067745
Train average loss UNet            (all)              : 0.201043

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002415, 3.192866, 5.542590
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014432, 2.819951, 3.898352
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009852, 2.972435, 4.133575
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006508, 3.091364, 4.648330
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007223, 3.286298, 4.555151
Train average loss all      (Triplet)                 : 0.008322

== Recognize ==
Train average loss Recognize     : 1.044472
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.209365

Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0376, Train/loss_recog_step=0.804, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]          Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0376, Train/loss_recog_step=0.804, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0376, Train/loss_recog_step=0.804, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00437, Train/loss_recog_step=0.935, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00437, Train/loss_recog_step=0.935, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]  Epoch 64:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.027, Train/loss_recog_step=0.768, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.027, Train/loss_recog_step=0.768, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00663, Train/loss_recog_step=0.843, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00663, Train/loss_recog_step=0.843, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.230, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.230, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.562, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.324, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.588, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.373, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.458, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.52it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.05it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.53it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.55it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072601, 0.071717, 0.071387
Valid average loss UNet            (all)              : 0.215705

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.228374, 3.579448, 5.757862
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.429181, 3.566961, 3.671731
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.479359, 3.495490, 3.583218
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.334723, 3.624430, 4.109034
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.328308, 3.778410, 4.316902
Valid average loss all      (Triplet)                 : 0.386186

== Recognize ==
Valid average loss Recognize     : 0.952612
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.601891

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.233682870864868 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.738280057907104 sec. =
Valid knn accuracy bass      : 18.168604651162788%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.145519733428955 sec. =
Valid knn accuracy piano     : 33.24324324324324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.33794093132019 sec. =
Valid knn accuracy guitar    : 49.35064935064935%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.030564546585083 sec. =
Valid knn accuracy residuals : 58.333333333333336%

Valid knn accuracy average   : 47.289754350971855%

                                                                        [AEpoch 64: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00832, Train/loss_recog_epoch=1.040]Epoch 64: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066702, 0.066435, 0.067605
Train average loss UNet            (all)              : 0.200742

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001581, 3.333067, 5.900263
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011254, 2.958665, 4.123851
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008970, 3.133959, 4.351994
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005583, 3.243860, 4.905128
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007267, 3.486396, 4.873538
Train average loss all      (Triplet)                 : 0.007123

== Recognize ==
Train average loss Recognize     : 1.057780
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.207865

Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]          Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.00789, Train/loss_recog_step=1.100, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.00789, Train/loss_recog_step=1.100, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.762, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]  Epoch 65:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.762, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.030, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.030, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.846, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0211, Train/loss_recog_step=0.846, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000287, Train/loss_recog_step=1.250, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000287, Train/loss_recog_step=1.250, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.602, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.473, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.14it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.62it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.55it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.50it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.50it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070334, 0.069500, 0.069491
Valid average loss UNet            (all)              : 0.209324

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.175872, 3.173060, 5.134383
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.433825, 3.226886, 3.371049
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.457745, 3.137712, 3.223839
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.297922, 3.182580, 3.856836
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.298432, 3.448119, 3.944754
Valid average loss all      (Triplet)                 : 0.356091

== Recognize ==
Valid average loss Recognize     : 0.964748
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.565415

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.997297525405884 sec. =
Valid knn accuracy drums     : 79.11764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.95575475692749 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.506634950637817 sec. =
Valid knn accuracy piano     : 29.18918918918919%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.878360271453857 sec. =
Valid knn accuracy guitar    : 46.91558441558442%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.490017652511597 sec. =
Valid knn accuracy residuals : 57.38993710691824%

Valid knn accuracy average   : 45.342238995963534%

                                                                        [AEpoch 65: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00712, Train/loss_recog_epoch=1.060]Epoch 65: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066769, 0.066523, 0.067728
Train average loss UNet            (all)              : 0.201020

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002975, 3.196325, 5.658796
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011585, 2.839985, 3.964132
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009974, 3.003043, 4.188140
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009787, 3.132693, 4.692199
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007352, 3.304407, 4.602920
Train average loss all      (Triplet)                 : 0.008241

== Recognize ==
Train average loss Recognize     : 1.057153
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.209260

Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]          Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]Epoch 66:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]Epoch 66:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00757, Train/loss_recog_step=0.932, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]Epoch 66:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00757, Train/loss_recog_step=0.932, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]Epoch 66:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=1.62e-5, Train/loss_recog_step=1.090, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]Epoch 66:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=1.62e-5, Train/loss_recog_step=1.090, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]Epoch 66:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.762, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]  Epoch 66:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.762, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]Epoch 66:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00325, Train/loss_recog_step=1.030, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]Epoch 66:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00325, Train/loss_recog_step=1.030, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]Epoch 66:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.846, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060] Epoch 66:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.846, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]Epoch 66:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00637, Train/loss_recog_step=1.230, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]Epoch 66: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00637, Train/loss_recog_step=1.230, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]Epoch 66: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.570, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.338, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.356, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.453, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.43it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.18it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.97it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072072, 0.070807, 0.070958
Valid average loss UNet            (all)              : 0.213837

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.153215, 3.243334, 5.337628
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.416397, 3.269456, 3.370531
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.526334, 3.360849, 3.306398
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.281587, 3.228140, 3.959941
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.330877, 3.384251, 3.931558
Valid average loss all      (Triplet)                 : 0.367578

== Recognize ==
Valid average loss Recognize     : 0.949683
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.581415

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.408772230148315 sec. =
Valid knn accuracy drums     : 79.11764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.657180070877075 sec. =
Valid knn accuracy bass      : 15.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.988952398300171 sec. =
Valid knn accuracy piano     : 25.945945945945947%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.876754522323608 sec. =
Valid knn accuracy guitar    : 39.77272727272727%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.870888471603394 sec. =
Valid knn accuracy residuals : 59.43396226415094%

Valid knn accuracy average   : 44.02266115949233%

                                                                        [AEpoch 66: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00824, Train/loss_recog_epoch=1.060]Epoch 66: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066603, 0.066325, 0.067543
Train average loss UNet            (all)              : 0.200471

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002120, 3.267183, 5.782518
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008892, 2.868272, 4.046474
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009028, 3.054787, 4.274948
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010069, 3.181781, 4.787344
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008383, 3.374971, 4.700963
Train average loss all      (Triplet)                 : 0.007789

== Recognize ==
Train average loss Recognize     : 1.053851
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.208260

Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]          Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=0.925, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=0.925, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00825, Train/loss_recog_step=1.080, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00825, Train/loss_recog_step=1.080, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00542, Train/loss_recog_step=0.759, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00542, Train/loss_recog_step=0.759, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00647, Train/loss_recog_step=1.030, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00647, Train/loss_recog_step=1.030, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=0.850, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=0.850, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=1.230, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050] Epoch 67: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=1.230, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.817, Valid/loss_all_step=0.628, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.389, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.368, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.440, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.96it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.87it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.56it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.24it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071197, 0.071122, 0.069882
Valid average loss UNet            (all)              : 0.212200

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.177450, 3.286928, 4.995525
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.456544, 3.465635, 3.496047
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.398861, 3.239702, 3.398085
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.227151, 3.420580, 4.075761
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.332517, 3.432290, 3.793215
Valid average loss all      (Triplet)                 : 0.333516

== Recognize ==
Valid average loss Recognize     : 0.957657
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.545717

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.18410849571228 sec. =
Valid knn accuracy drums     : 77.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.695752620697021 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.716863870620728 sec. =
Valid knn accuracy piano     : 27.297297297297295%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.344545125961304 sec. =
Valid knn accuracy guitar    : 42.2077922077922%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.743205785751343 sec. =
Valid knn accuracy residuals : 59.43396226415094%

Valid knn accuracy average   : 44.94957505973044%

                                                                        [AEpoch 67: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.817, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 67: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.817, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066546, 0.066212, 0.067462
Train average loss UNet            (all)              : 0.200220

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001639, 3.099410, 5.426597
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010073, 2.782446, 3.913633
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008492, 2.956345, 4.142953
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007469, 3.065414, 4.639311
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004772, 3.218042, 4.518371
Train average loss all      (Triplet)                 : 0.006435

== Recognize ==
Train average loss Recognize     : 1.051437
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.206655

Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.817, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]          Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.817, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]Epoch 68:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.817, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]Epoch 68:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000411, Train/loss_recog_step=0.932, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]Epoch 68:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000411, Train/loss_recog_step=0.932, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]Epoch 68:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=1.100, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]   Epoch 68:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=1.100, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]Epoch 68:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.765, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]Epoch 68:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.765, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]Epoch 68:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00982, Train/loss_recog_step=1.030, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]Epoch 68:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00982, Train/loss_recog_step=1.030, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]Epoch 68:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]  Epoch 68:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]Epoch 68:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=1.230, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]Epoch 68: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=1.230, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]Epoch 68: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.811, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.241, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.449, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.21it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.21it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.80it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.25it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.59it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.02it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069592, 0.070361, 0.070600
Valid average loss UNet            (all)              : 0.210552

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.155134, 3.426355, 5.465020
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.486517, 3.665214, 3.658566
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.453146, 3.423448, 3.496828
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.276520, 3.542773, 4.332114
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.386216, 3.695295, 4.029796
Valid average loss all      (Triplet)                 : 0.364494

== Recognize ==
Valid average loss Recognize     : 0.950439
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.575046

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.439393043518066 sec. =
Valid knn accuracy drums     : 79.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.041465997695923 sec. =
Valid knn accuracy bass      : 19.62209302325581%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.422827959060669 sec. =
Valid knn accuracy piano     : 31.891891891891895%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.773175954818726 sec. =
Valid knn accuracy guitar    : 42.6948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.401491165161133 sec. =
Valid knn accuracy residuals : 58.80503144654088%

Valid knn accuracy average   : 46.57335254659287%

                                                                        [AEpoch 68: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.811, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00644, Train/loss_recog_epoch=1.050]Epoch 68: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.811, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066351, 0.066064, 0.067355
Train average loss UNet            (all)              : 0.199770

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002307, 3.201389, 5.615337
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006985, 2.853280, 4.029662
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006119, 3.001862, 4.229879
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007349, 3.122167, 4.708301
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005958, 3.294505, 4.601020
Train average loss all      (Triplet)                 : 0.005745

== Recognize ==
Train average loss Recognize     : 1.055675
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.205515

Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.811, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]          Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.811, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.811, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.923, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=0.923, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=1.080, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=1.080, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.759, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]  Epoch 69:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.759, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0024, Train/loss_recog_step=0.834, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0024, Train/loss_recog_step=0.834, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00728, Train/loss_recog_step=1.230, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00728, Train/loss_recog_step=1.230, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.798, Valid/loss_all_step=0.484, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.249, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.575, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.466, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.54it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.84it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.76it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.52it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071144, 0.072946, 0.073061
Valid average loss UNet            (all)              : 0.217151

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.203371, 3.380397, 5.532940
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.515986, 3.301289, 3.316282
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.436090, 3.297468, 3.314166
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.393472, 3.496174, 4.023724
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.347581, 3.528095, 3.940275
Valid average loss all      (Triplet)                 : 0.403822

== Recognize ==
Valid average loss Recognize     : 0.949019
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.620973

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.393749475479126 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.731727838516235 sec. =
Valid knn accuracy bass      : 20.930232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.302396297454834 sec. =
Valid knn accuracy piano     : 30.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.70661973953247 sec. =
Valid knn accuracy guitar    : 47.07792207792208%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.969558954238892 sec. =
Valid knn accuracy residuals : 59.27672955974843%

Valid knn accuracy average   : 47.16047445442433%

                                                                        [AEpoch 69: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.798, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00574, Train/loss_recog_epoch=1.060]Epoch 69: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.798, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066267, 0.065996, 0.067300
Train average loss UNet            (all)              : 0.199563

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003643, 3.257689, 5.733387
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008573, 2.864278, 4.025554
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008715, 3.049544, 4.268538
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008668, 3.160399, 4.705938
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005267, 3.329871, 4.644460
Train average loss all      (Triplet)                 : 0.006805

== Recognize ==
Train average loss Recognize     : 1.048858
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.206368

Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.798, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]          Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.798, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]Epoch 70:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.798, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]Epoch 70:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.911, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]Epoch 70:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.911, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]Epoch 70:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00528, Train/loss_recog_step=1.080, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]Epoch 70:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00528, Train/loss_recog_step=1.080, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]Epoch 70:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0028, Train/loss_recog_step=0.753, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050] Epoch 70:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0028, Train/loss_recog_step=0.753, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]Epoch 70:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=1.010, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]Epoch 70:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=1.010, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]Epoch 70:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00527, Train/loss_recog_step=0.818, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]Epoch 70:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00527, Train/loss_recog_step=0.818, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]Epoch 70:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.017, Train/loss_recog_step=1.210, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]  Epoch 70: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.017, Train/loss_recog_step=1.210, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]Epoch 70: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.594, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.354, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.472, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.29it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.71it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.07it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071126, 0.071039, 0.069806
Valid average loss UNet            (all)              : 0.211972

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.158920, 3.751408, 6.011490
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.605290, 4.054664, 3.922536
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.723134, 4.051269, 3.906662
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.410403, 4.115172, 4.662214
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.379251, 4.161377, 4.479903
Valid average loss all      (Triplet)                 : 0.501812

== Recognize ==
Valid average loss Recognize     : 0.940672
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.713783

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.188998460769653 sec. =
Valid knn accuracy drums     : 74.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.882697105407715 sec. =
Valid knn accuracy bass      : 19.331395348837212%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.045197486877441 sec. =
Valid knn accuracy piano     : 33.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.504113912582397 sec. =
Valid knn accuracy guitar    : 43.18181818181818%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.978590965270996 sec. =
Valid knn accuracy residuals : 62.106918238993714%

Valid knn accuracy average   : 46.482054970781974%

                                                                        [AEpoch 70: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0068, Train/loss_recog_epoch=1.050]Epoch 70: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066213, 0.065858, 0.067081
Train average loss UNet            (all)              : 0.199151

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003066, 3.216951, 5.712617
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009818, 2.854560, 4.035851
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006533, 3.026236, 4.293024
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004367, 3.142171, 4.790151
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004869, 3.322998, 4.677188
Train average loss all      (Triplet)                 : 0.005812

== Recognize ==
Train average loss Recognize     : 1.036958
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.204963

Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]          Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]Epoch 71:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]Epoch 71:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00601, Train/loss_recog_step=0.905, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]Epoch 71:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00601, Train/loss_recog_step=0.905, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]Epoch 71:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00493, Train/loss_recog_step=1.060, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]Epoch 71:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00493, Train/loss_recog_step=1.060, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]Epoch 71:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.743, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040] Epoch 71:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.743, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]Epoch 71:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.996, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]Epoch 71:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.996, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]Epoch 71:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00604, Train/loss_recog_step=0.827, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]Epoch 71:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00604, Train/loss_recog_step=0.827, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]Epoch 71:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=1.230, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040] Epoch 71: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=1.230, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]Epoch 71: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.801, Valid/loss_all_step=0.898, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.654, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.465, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.84it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.81it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.22it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069700, 0.069509, 0.068987
Valid average loss UNet            (all)              : 0.208196

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.184899, 3.608428, 5.865842
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.411122, 3.678948, 3.767933
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.422534, 3.617700, 3.730945
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.298082, 3.608186, 4.147656
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.387997, 3.938251, 4.185655
Valid average loss all      (Triplet)                 : 0.353506

== Recognize ==
Valid average loss Recognize     : 0.951330
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.561702

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.348277568817139 sec. =
Valid knn accuracy drums     : 79.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.998456478118896 sec. =
Valid knn accuracy bass      : 19.040697674418606%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.29461407661438 sec. =
Valid knn accuracy piano     : 35.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.122664213180542 sec. =
Valid knn accuracy guitar    : 40.42207792207792%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.826178073883057 sec. =
Valid knn accuracy residuals : 59.74842767295597%

Valid knn accuracy average   : 46.81282888918462%

                                                                        [AEpoch 71: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.801, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00581, Train/loss_recog_epoch=1.040]Epoch 71: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.801, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066224, 0.065938, 0.067140
Train average loss UNet            (all)              : 0.199302

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002359, 3.338656, 5.931091
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010007, 3.012693, 4.242638
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007897, 3.145033, 4.429954
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007212, 3.270651, 4.909690
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006293, 3.441964, 4.795587
Train average loss all      (Triplet)                 : 0.006865

== Recognize ==
Train average loss Recognize     : 1.030424
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.206166

Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.801, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]          Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.801, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.801, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=0.924, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=0.924, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=1.090, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030] Epoch 72:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=1.090, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00658, Train/loss_recog_step=0.767, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00658, Train/loss_recog_step=0.767, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=1.030, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=1.030, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00719, Train/loss_recog_step=0.843, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00719, Train/loss_recog_step=0.843, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00791, Train/loss_recog_step=1.230, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00791, Train/loss_recog_step=1.230, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=0.809, Valid/loss_all_step=0.426, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.193, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.562, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.354, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.468, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.76it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.06it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.37it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.70it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.34it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070281, 0.071416, 0.072173
Valid average loss UNet            (all)              : 0.213870

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.199770, 3.482082, 5.408897
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.486738, 3.563868, 3.583313
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.434137, 3.412371, 3.467173
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.346561, 3.545612, 3.972083
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.344336, 3.896309, 4.160162
Valid average loss all      (Triplet)                 : 0.385604

== Recognize ==
Valid average loss Recognize     : 0.953196
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.599474

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.794952630996704 sec. =
Valid knn accuracy drums     : 77.64705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.541086435317993 sec. =
Valid knn accuracy bass      : 18.168604651162788%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.89945673942566 sec. =
Valid knn accuracy piano     : 35.4054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.322697639465332 sec. =
Valid knn accuracy guitar    : 43.506493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.679699420928955 sec. =
Valid knn accuracy residuals : 60.691823899371066%

Valid knn accuracy average   : 47.08387725719243%

                                                                        [AEpoch 72: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=0.809, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.030]Epoch 72: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=0.809, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066188, 0.065840, 0.067186
Train average loss UNet            (all)              : 0.199214

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003100, 3.160121, 5.645679
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011087, 2.848876, 4.023289
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010801, 3.008161, 4.214025
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006302, 3.083933, 4.687157
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007086, 3.256255, 4.541063
Train average loss all      (Triplet)                 : 0.007794

== Recognize ==
Train average loss Recognize     : 1.053473
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.207008

Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=0.809, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]          Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=0.809, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 73:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=0.809, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 73:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000196, Train/loss_recog_step=0.916, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 73:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000196, Train/loss_recog_step=0.916, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 73:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00627, Train/loss_recog_step=1.100, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050] Epoch 73:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00627, Train/loss_recog_step=1.100, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 73:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00593, Train/loss_recog_step=0.775, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 73:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00593, Train/loss_recog_step=0.775, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 73:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000531, Train/loss_recog_step=1.040, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 73:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000531, Train/loss_recog_step=1.040, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 73:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00327, Train/loss_recog_step=0.848, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050] Epoch 73:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00327, Train/loss_recog_step=0.848, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 73:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]  Epoch 73: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 73: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0081, Train/loss_recog_step=0.822, Valid/loss_all_step=0.575, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.336, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.386, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.471, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.78it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.88it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.17it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.80it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.34it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.70it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.077102, 0.074868, 0.073288
Valid average loss UNet            (all)              : 0.225258

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.211995, 3.795024, 6.088268
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.470242, 3.892690, 3.911995
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.510819, 3.771985, 3.751064
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.287178, 3.850085, 4.645785
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.324622, 4.087340, 4.698236
Valid average loss all      (Triplet)                 : 0.381206

== Recognize ==
Valid average loss Recognize     : 0.961180
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.606464

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.215030670166016 sec. =
Valid knn accuracy drums     : 79.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.968393802642822 sec. =
Valid knn accuracy bass      : 14.825581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.49200701713562 sec. =
Valid knn accuracy piano     : 28.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.491793632507324 sec. =
Valid knn accuracy guitar    : 41.72077922077922%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.621620178222656 sec. =
Valid knn accuracy residuals : 60.22012578616353%

Valid knn accuracy average   : 44.999561191428114%

                                                                        [AEpoch 73: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0081, Train/loss_recog_step=0.822, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00779, Train/loss_recog_epoch=1.050]Epoch 73: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0081, Train/loss_recog_step=0.822, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066130, 0.065820, 0.067090
Train average loss UNet            (all)              : 0.199041

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002819, 3.453328, 6.069294
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008357, 3.070217, 4.328684
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007740, 3.266505, 4.593335
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006387, 3.353718, 5.056293
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005966, 3.564903, 4.981823
Train average loss all      (Triplet)                 : 0.006095

== Recognize ==
Train average loss Recognize     : 1.060306
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.205136

Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0081, Train/loss_recog_step=0.822, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]          Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0081, Train/loss_recog_step=0.822, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0081, Train/loss_recog_step=0.822, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.925, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060] Epoch 74:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.925, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=1.090, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=1.090, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=0.758, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=0.758, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00337, Train/loss_recog_step=1.020, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00337, Train/loss_recog_step=1.020, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=0.842, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00233, Train/loss_recog_step=0.842, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00359, Train/loss_recog_step=1.230, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00359, Train/loss_recog_step=1.230, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.811, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.328, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.606, Valid/loss_unet_all_epoch=0.225, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.961, Valid/knn_avr=0.450, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.56it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.03it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.25it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.15it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070303, 0.069763, 0.068785
Valid average loss UNet            (all)              : 0.208851

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143540, 3.626313, 5.719753
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.543458, 3.785544, 3.613604
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.426587, 3.625714, 3.769893
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.309682, 3.828559, 4.476833
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.421178, 3.951301, 4.283464
Valid average loss all      (Triplet)                 : 0.395429

== Recognize ==
Valid average loss Recognize     : 0.952592
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.604280

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.962013244628906 sec. =
Valid knn accuracy drums     : 76.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.125136852264404 sec. =
Valid knn accuracy bass      : 14.825581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.36992621421814 sec. =
Valid knn accuracy piano     : 30.675675675675674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.397218704223633 sec. =
Valid knn accuracy guitar    : 43.01948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.887789964675903 sec. =
Valid knn accuracy residuals : 60.534591194968556%

Valid knn accuracy average   : 45.164006933565304%

                                                                        [AEpoch 74: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.811, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.0061, Train/loss_recog_epoch=1.060]Epoch 74: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.811, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065931, 0.065640, 0.066896
Train average loss UNet            (all)              : 0.198466

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002025, 3.259320, 5.776373
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007969, 2.927531, 4.159789
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006740, 3.081545, 4.351159
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005647, 3.187524, 4.880409
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005124, 3.384956, 4.745073
Train average loss all      (Triplet)                 : 0.005652

== Recognize ==
Train average loss Recognize     : 1.051866
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.204118

Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.811, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]          Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.811, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]Epoch 75:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.811, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]Epoch 75:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0221, Train/loss_recog_step=0.924, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]Epoch 75:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0221, Train/loss_recog_step=0.924, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]Epoch 75:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000186, Train/loss_recog_step=1.090, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]Epoch 75:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000186, Train/loss_recog_step=1.090, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]Epoch 75:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.758, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]  Epoch 75:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.758, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]Epoch 75:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00163, Train/loss_recog_step=1.020, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]Epoch 75:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00163, Train/loss_recog_step=1.020, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]Epoch 75:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=0.833, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]Epoch 75:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=0.833, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]Epoch 75:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0205, Train/loss_recog_step=1.220, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050] Epoch 75: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0205, Train/loss_recog_step=1.220, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]Epoch 75: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.601, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.363, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.604, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.01it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.41it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.83it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.68it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.79it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071146, 0.070655, 0.070310
Valid average loss UNet            (all)              : 0.212111

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.153944, 3.451016, 5.589184
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.644145, 3.857101, 3.654929
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.391564, 3.398695, 3.449259
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.343319, 3.530218, 4.195557
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.419462, 3.941098, 4.053056
Valid average loss all      (Triplet)                 : 0.441869

== Recognize ==
Valid average loss Recognize     : 0.945545
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.653980

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.702330827713013 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.804758310317993 sec. =
Valid knn accuracy bass      : 17.732558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.990687131881714 sec. =
Valid knn accuracy piano     : 29.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.323222398757935 sec. =
Valid knn accuracy guitar    : 45.45454545454545%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.93512487411499 sec. =
Valid knn accuracy residuals : 53.930817610062896%

Valid knn accuracy average   : 45.281294892656945%

                                                                        [AEpoch 75: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00565, Train/loss_recog_epoch=1.050]Epoch 75: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066144, 0.065817, 0.067039
Train average loss UNet            (all)              : 0.199001

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002343, 3.622894, 6.394636
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011208, 3.241673, 4.567352
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007548, 3.394953, 4.775370
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008464, 3.544046, 5.340890
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007644, 3.746358, 5.233602
Train average loss all      (Triplet)                 : 0.007437

== Recognize ==
Train average loss Recognize     : 1.047978
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.206438

Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]          Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]Epoch 76:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]Epoch 76:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=0.916, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]Epoch 76:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=0.916, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]Epoch 76:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=1.090, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050] Epoch 76:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=1.090, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]Epoch 76:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.764, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050] Epoch 76:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.764, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]Epoch 76:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00888, Train/loss_recog_step=1.030, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]Epoch 76:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00888, Train/loss_recog_step=1.030, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]Epoch 76:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=0.837, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]Epoch 76:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=0.837, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]Epoch 76:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=1.230, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050] Epoch 76: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=1.230, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]Epoch 76: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00819, Train/loss_recog_step=0.809, Valid/loss_all_step=0.840, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.600, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=0.946, Valid/knn_avr=0.453, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.14it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.17it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.79it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.61it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074810, 0.075036, 0.072596
Valid average loss UNet            (all)              : 0.222442

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.154851, 3.768937, 5.950016
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.653372, 3.931003, 3.680732
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.499887, 3.805711, 3.821402
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.230708, 3.986081, 4.560557
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.359754, 4.246747, 4.714032
Valid average loss all      (Triplet)                 : 0.427252

== Recognize ==
Valid average loss Recognize     : 0.956518
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.649694

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.273162126541138 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.559764623641968 sec. =
Valid knn accuracy bass      : 19.912790697674417%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.503482580184937 sec. =
Valid knn accuracy piano     : 30.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.133981943130493 sec. =
Valid knn accuracy guitar    : 43.18181818181818%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.659983158111572 sec. =
Valid knn accuracy residuals : 59.43396226415094%

Valid knn accuracy average   : 46.444505961638086%

                                                                        [AEpoch 76: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00819, Train/loss_recog_step=0.809, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00744, Train/loss_recog_epoch=1.050]Epoch 76: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00819, Train/loss_recog_step=0.809, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065861, 0.065495, 0.066813
Train average loss UNet            (all)              : 0.198170

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001776, 3.235880, 5.664302
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008787, 2.899684, 4.112084
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007954, 3.022004, 4.257816
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006654, 3.143492, 4.759765
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005979, 3.332173, 4.675417
Train average loss all      (Triplet)                 : 0.006216

== Recognize ==
Train average loss Recognize     : 1.052903
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.204386

Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00819, Train/loss_recog_step=0.809, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]          Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00819, Train/loss_recog_step=0.809, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]Epoch 77:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00819, Train/loss_recog_step=0.809, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]Epoch 77:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=0.931, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]Epoch 77:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=0.931, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]Epoch 77:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]  Epoch 77:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]Epoch 77:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0071, Train/loss_recog_step=0.758, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]Epoch 77:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0071, Train/loss_recog_step=0.758, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]Epoch 77:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050] Epoch 77:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]Epoch 77:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=0.832, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]Epoch 77:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=0.832, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]Epoch 77:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00683, Train/loss_recog_step=1.230, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]Epoch 77: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00683, Train/loss_recog_step=1.230, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]Epoch 77: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.806, Valid/loss_all_step=0.843, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.576, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.957, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.40it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.65it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.43it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.68it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.98it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072254, 0.070932, 0.070169
Valid average loss UNet            (all)              : 0.213355

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.121115, 3.418555, 5.456748
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.542453, 3.588079, 3.507988
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.415653, 3.382382, 3.527727
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.239625, 3.505465, 4.101912
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.335239, 3.834405, 4.191165
Valid average loss all      (Triplet)                 : 0.375631

== Recognize ==
Valid average loss Recognize     : 0.949057
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.588986

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.996940851211548 sec. =
Valid knn accuracy drums     : 76.3235294117647%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.721486568450928 sec. =
Valid knn accuracy bass      : 18.8953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.54737114906311 sec. =
Valid knn accuracy piano     : 33.78378378378378%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.267130374908447 sec. =
Valid knn accuracy guitar    : 44.8051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.416288137435913 sec. =
Valid knn accuracy residuals : 64.15094339622641%

Valid knn accuracy average   : 47.591760046835795%

                                                                        [AEpoch 77: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.806, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00622, Train/loss_recog_epoch=1.050]Epoch 77: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.806, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065682, 0.065396, 0.066716
Train average loss UNet            (all)              : 0.197794

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001831, 3.427754, 6.077778
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007728, 3.061008, 4.351733
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005111, 3.187862, 4.510992
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004318, 3.316129, 5.021377
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006335, 3.528574, 4.982293
Train average loss all      (Triplet)                 : 0.005195

== Recognize ==
Train average loss Recognize     : 1.046320
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.202989

Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.806, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]          Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.806, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]Epoch 78:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=0.806, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]Epoch 78:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00823, Train/loss_recog_step=0.921, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]Epoch 78:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00823, Train/loss_recog_step=0.921, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]Epoch 78:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]  Epoch 78:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]Epoch 78:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000642, Train/loss_recog_step=0.770, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]Epoch 78:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000642, Train/loss_recog_step=0.770, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]Epoch 78:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=1.030, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050] Epoch 78:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=1.030, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]Epoch 78:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=0.847, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]Epoch 78:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=0.847, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]Epoch 78:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=1.230, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050] Epoch 78: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=1.230, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]Epoch 78: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00476, Train/loss_recog_step=0.820, Valid/loss_all_step=0.736, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.487, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.589, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.476, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.32it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.04it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.58it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.75it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.41it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069322, 0.069051, 0.068478
Valid average loss UNet            (all)              : 0.206851

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.219321, 4.057904, 6.494427
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.659607, 4.237833, 4.113183
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.518963, 4.059183, 4.218180
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.273366, 4.076686, 4.885358
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.356592, 4.489518, 4.994122
Valid average loss all      (Triplet)                 : 0.461014

== Recognize ==
Valid average loss Recognize     : 0.958003
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.667865

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.244417428970337 sec. =
Valid knn accuracy drums     : 76.3235294117647%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.678275346755981 sec. =
Valid knn accuracy bass      : 14.244186046511627%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.858562469482422 sec. =
Valid knn accuracy piano     : 35.13513513513514%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.62714958190918 sec. =
Valid knn accuracy guitar    : 46.590909090909086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.64617395401001 sec. =
Valid knn accuracy residuals : 58.17610062893082%

Valid knn accuracy average   : 46.09397206265028%

                                                                        [AEpoch 78: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00476, Train/loss_recog_step=0.820, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.050]Epoch 78: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00476, Train/loss_recog_step=0.820, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065670, 0.065367, 0.066639
Train average loss UNet            (all)              : 0.197675

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001449, 3.453577, 6.106890
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005635, 3.089540, 4.415545
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006644, 3.248462, 4.593231
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005928, 3.377141, 5.122878
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004917, 3.567402, 5.048081
Train average loss all      (Triplet)                 : 0.005029

== Recognize ==
Train average loss Recognize     : 1.057034
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.202705

Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00476, Train/loss_recog_step=0.820, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]          Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00476, Train/loss_recog_step=0.820, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]Epoch 79:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00476, Train/loss_recog_step=0.820, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]Epoch 79:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.926, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]Epoch 79:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.926, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]Epoch 79:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]  Epoch 79:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]Epoch 79:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00174, Train/loss_recog_step=0.767, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]Epoch 79:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00174, Train/loss_recog_step=0.767, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]Epoch 79:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0083, Train/loss_recog_step=1.050, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060] Epoch 79:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0083, Train/loss_recog_step=1.050, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]Epoch 79:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060] Epoch 79:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]Epoch 79:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00742, Train/loss_recog_step=1.250, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]Epoch 79: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00742, Train/loss_recog_step=1.250, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]Epoch 79: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.645, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.958, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.80it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.76it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.93it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.20it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069512, 0.070411, 0.070078
Valid average loss UNet            (all)              : 0.210001

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.160860, 3.566205, 5.627204
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.540728, 3.541862, 3.447769
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.423780, 3.469030, 3.542821
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.272528, 3.524734, 4.026161
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.289379, 3.712417, 4.143339
Valid average loss all      (Triplet)                 : 0.383984

== Recognize ==
Valid average loss Recognize     : 0.977055
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.593985

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.246390342712402 sec. =
Valid knn accuracy drums     : 78.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.854249477386475 sec. =
Valid knn accuracy bass      : 16.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.94129204750061 sec. =
Valid knn accuracy piano     : 31.756756756756754%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.256887674331665 sec. =
Valid knn accuracy guitar    : 45.45454545454545%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.519647359848022 sec. =
Valid knn accuracy residuals : 57.38993710691824%

Valid knn accuracy average   : 46.05704676925285%

                                                                        [AEpoch 79: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00503, Train/loss_recog_epoch=1.060]Epoch 79: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065605, 0.065362, 0.066566
Train average loss UNet            (all)              : 0.197534

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002086, 3.443656, 6.054703
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011471, 3.122137, 4.410745
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006517, 3.272051, 4.645765
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004728, 3.369359, 5.126879
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005204, 3.584151, 5.052998
Train average loss all      (Triplet)                 : 0.006055

== Recognize ==
Train average loss Recognize     : 1.064009
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.203590

Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]          Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]Epoch 80:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]Epoch 80:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000132, Train/loss_recog_step=0.947, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]Epoch 80:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000132, Train/loss_recog_step=0.947, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]Epoch 80:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00345, Train/loss_recog_step=1.110, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060] Epoch 80:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00345, Train/loss_recog_step=1.110, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]Epoch 80:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00864, Train/loss_recog_step=0.774, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]Epoch 80:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00864, Train/loss_recog_step=0.774, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]Epoch 80:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0099, Train/loss_recog_step=1.040, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060] Epoch 80:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0099, Train/loss_recog_step=1.040, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]Epoch 80:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00112, Train/loss_recog_step=0.849, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]Epoch 80:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00112, Train/loss_recog_step=0.849, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]Epoch 80:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=1.240, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]Epoch 80: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=1.240, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]Epoch 80: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=0.778, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.544, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.594, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.977, Valid/knn_avr=0.461, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.64it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.06it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.94it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.44it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069388, 0.069087, 0.068832
Valid average loss UNet            (all)              : 0.207308

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.162376, 3.781140, 5.835520
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.554319, 4.121150, 4.124851
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.498646, 4.015566, 4.107909
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.241257, 3.872976, 4.672472
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.411326, 4.329861, 4.649042
Valid average loss all      (Triplet)                 : 0.413486

== Recognize ==
Valid average loss Recognize     : 0.968119
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.620794

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.62712574005127 sec. =
Valid knn accuracy drums     : 75.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.756462812423706 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.411361932754517 sec. =
Valid knn accuracy piano     : 30.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.495620012283325 sec. =
Valid knn accuracy guitar    : 47.72727272727273%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.701542854309082 sec. =
Valid knn accuracy residuals : 59.59119496855346%

Valid knn accuracy average   : 45.165139170843425%

                                                                        [AEpoch 80: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00606, Train/loss_recog_epoch=1.060]Epoch 80: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065534, 0.065145, 0.066406
Train average loss UNet            (all)              : 0.197086

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000949, 3.490074, 6.139628
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007420, 3.175551, 4.523335
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005411, 3.320026, 4.750954
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004271, 3.392636, 5.193251
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003841, 3.620538, 5.091536
Train average loss all      (Triplet)                 : 0.004455

== Recognize ==
Train average loss Recognize     : 1.069043
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.201540

Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]          Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]Epoch 81:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]Epoch 81:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00281, Train/loss_recog_step=0.943, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]Epoch 81:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00281, Train/loss_recog_step=0.943, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]Epoch 81:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]  Epoch 81:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]Epoch 81:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00105, Train/loss_recog_step=0.777, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]Epoch 81:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00105, Train/loss_recog_step=0.777, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]Epoch 81:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=1.040, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]Epoch 81:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=1.040, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]Epoch 81:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]  Epoch 81:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]Epoch 81:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=1.250, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]Epoch 81: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=1.250, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]Epoch 81: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.832, Valid/loss_all_step=0.756, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.520, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.968, Valid/knn_avr=0.452, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.79it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.03it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.84it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.73it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.02it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070652, 0.071392, 0.069663
Valid average loss UNet            (all)              : 0.211707

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.121831, 3.419825, 5.458254
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.584029, 3.611439, 3.585856
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.409092, 3.535246, 3.700622
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.311782, 3.603446, 4.148329
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.371864, 3.831977, 4.280802
Valid average loss all      (Triplet)                 : 0.399477

== Recognize ==
Valid average loss Recognize     : 0.978870
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.611184

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.138382196426392 sec. =
Valid knn accuracy drums     : 72.6470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.914635419845581 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.713186740875244 sec. =
Valid knn accuracy piano     : 26.756756756756754%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.341855525970459 sec. =
Valid knn accuracy guitar    : 42.532467532467535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.967230558395386 sec. =
Valid knn accuracy residuals : 62.735849056603776%

Valid knn accuracy average   : 43.84140317805755%

                                                                        [AEpoch 81: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.832, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00445, Train/loss_recog_epoch=1.070]Epoch 81: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.832, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065407, 0.065066, 0.066344
Train average loss UNet            (all)              : 0.196817

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001787, 3.348680, 5.922720
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007051, 3.043614, 4.315773
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005481, 3.178659, 4.507863
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006043, 3.251207, 4.923184
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005474, 3.496165, 4.907878
Train average loss all      (Triplet)                 : 0.005334

== Recognize ==
Train average loss Recognize     : 1.068332
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.202152

Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.832, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]          Epoch 82:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.832, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]Epoch 82:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.832, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]Epoch 82:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000146, Train/loss_recog_step=0.952, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]Epoch 82:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000146, Train/loss_recog_step=0.952, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]Epoch 82:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00176, Train/loss_recog_step=1.120, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070] Epoch 82:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00176, Train/loss_recog_step=1.120, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]Epoch 82:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0078, Train/loss_recog_step=0.792, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070] Epoch 82:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0078, Train/loss_recog_step=0.792, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]Epoch 82:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070] Epoch 82:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]Epoch 82:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00336, Train/loss_recog_step=0.860, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]Epoch 82:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00336, Train/loss_recog_step=0.860, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]Epoch 82:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00632, Train/loss_recog_step=1.260, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]Epoch 82: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00632, Train/loss_recog_step=1.260, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]Epoch 82: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.833, Valid/loss_all_step=0.716, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.399, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.88it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.17it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.41it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.51it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070389, 0.070214, 0.068896
Valid average loss UNet            (all)              : 0.209500

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.156080, 3.647631, 5.670070
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.707911, 4.052485, 3.800232
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.403515, 3.681435, 3.828086
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.293638, 3.726389, 4.351297
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.348369, 3.910791, 4.374335
Valid average loss all      (Triplet)                 : 0.425965

== Recognize ==
Valid average loss Recognize     : 0.982346
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.635464

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.148534297943115 sec. =
Valid knn accuracy drums     : 76.3235294117647%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.969536066055298 sec. =
Valid knn accuracy bass      : 15.55232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.466011762619019 sec. =
Valid knn accuracy piano     : 29.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.383845567703247 sec. =
Valid knn accuracy guitar    : 41.883116883116884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.452065706253052 sec. =
Valid knn accuracy residuals : 56.289308176100626%

Valid knn accuracy average   : 43.82046682128632%

                                                                        [AEpoch 82: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.833, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00533, Train/loss_recog_epoch=1.070]Epoch 82: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.833, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065322, 0.065022, 0.066294
Train average loss UNet            (all)              : 0.196638

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001805, 3.372375, 5.875615
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006543, 3.092421, 4.416106
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006677, 3.242769, 4.586814
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005451, 3.322779, 5.058188
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005606, 3.567134, 5.009728
Train average loss all      (Triplet)                 : 0.005227

== Recognize ==
Train average loss Recognize     : 1.084114
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.201865

Epoch 82:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.833, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]          Epoch 83:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.833, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=0.833, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0043, Train/loss_recog_step=0.954, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0043, Train/loss_recog_step=0.954, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.130, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.130, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00377, Train/loss_recog_step=0.785, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00377, Train/loss_recog_step=0.785, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=1.050, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080] Epoch 83:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=1.050, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00416, Train/loss_recog_step=0.860, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00416, Train/loss_recog_step=0.860, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00813, Train/loss_recog_step=1.260, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00813, Train/loss_recog_step=1.260, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.828, Valid/loss_all_step=0.714, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.472, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=0.982, Valid/knn_avr=0.438, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.04it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.95it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.87it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.01it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070372, 0.070168, 0.069928
Valid average loss UNet            (all)              : 0.210469

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143760, 3.817837, 6.123518
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.560091, 4.156037, 4.260847
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.436853, 3.901227, 3.991439
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.291052, 3.756552, 4.552325
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.333365, 4.157579, 4.598150
Valid average loss all      (Triplet)                 : 0.389764

== Recognize ==
Valid average loss Recognize     : 0.977905
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.600233

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.456843614578247 sec. =
Valid knn accuracy drums     : 72.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.714345216751099 sec. =
Valid knn accuracy bass      : 16.27906976744186%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.550157070159912 sec. =
Valid knn accuracy piano     : 29.18918918918919%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.931698560714722 sec. =
Valid knn accuracy guitar    : 43.83116883116883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.606541395187378 sec. =
Valid knn accuracy residuals : 56.91823899371069%

Valid knn accuracy average   : 43.74353335630211%

                                                                        [AEpoch 83: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.828, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.202, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00523, Train/loss_recog_epoch=1.080]Epoch 83: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.828, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065339, 0.065150, 0.066364
Train average loss UNet            (all)              : 0.196852

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002981, 3.446718, 6.008221
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009283, 3.170210, 4.518292
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007270, 3.304535, 4.663674
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005003, 3.408027, 5.176848
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005005, 3.612624, 5.070870
Train average loss all      (Triplet)                 : 0.006073

== Recognize ==
Train average loss Recognize     : 1.081924
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.202926

Epoch 83:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.828, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]          Epoch 84:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.828, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]Epoch 84:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00646, Train/loss_recog_step=0.828, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]Epoch 84:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000419, Train/loss_recog_step=0.952, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]Epoch 84:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000419, Train/loss_recog_step=0.952, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]Epoch 84:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00548, Train/loss_recog_step=1.120, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080] Epoch 84:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00548, Train/loss_recog_step=1.120, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]Epoch 84:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00609, Train/loss_recog_step=0.789, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]Epoch 84:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00609, Train/loss_recog_step=0.789, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]Epoch 84:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]  Epoch 84:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]Epoch 84:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000439, Train/loss_recog_step=0.863, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]Epoch 84:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000439, Train/loss_recog_step=0.863, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]Epoch 84:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]   Epoch 84: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]Epoch 84: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.831, Valid/loss_all_step=0.719, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.481, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.978, Valid/knn_avr=0.437, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.78it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.60it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.92it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.82it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.90it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071065, 0.071468, 0.069973
Valid average loss UNet            (all)              : 0.212507

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.208093, 3.543303, 5.563194
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.465135, 3.771239, 3.795780
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.488503, 3.596190, 3.611474
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.247533, 3.453858, 4.165658
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.382815, 3.867131, 4.136355
Valid average loss all      (Triplet)                 : 0.379493

== Recognize ==
Valid average loss Recognize     : 0.985859
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.591999

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.471219778060913 sec. =
Valid knn accuracy drums     : 73.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.135638236999512 sec. =
Valid knn accuracy bass      : 13.226744186046513%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.551906824111938 sec. =
Valid knn accuracy piano     : 30.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.273072719573975 sec. =
Valid knn accuracy guitar    : 41.55844155844156%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.281873226165771 sec. =
Valid knn accuracy residuals : 60.062893081761004%

Valid knn accuracy average   : 43.61667458877923%

                                                                        [AEpoch 84: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.831, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00607, Train/loss_recog_epoch=1.080]Epoch 84: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.831, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065239, 0.064842, 0.066157
Train average loss UNet            (all)              : 0.196239

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000742, 3.452976, 6.072802
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008528, 3.155977, 4.473610
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005468, 3.294971, 4.665506
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004620, 3.401297, 5.140671
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005740, 3.600213, 5.063787
Train average loss all      (Triplet)                 : 0.005193

== Recognize ==
Train average loss Recognize     : 1.080137
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.201432

Epoch 84:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.831, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]          Epoch 85:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.831, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 85:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=0.831, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 85:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=0.951, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 85:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00232, Train/loss_recog_step=0.951, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 85:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0219, Train/loss_recog_step=1.110, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080] Epoch 85:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0219, Train/loss_recog_step=1.110, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 85:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00498, Train/loss_recog_step=0.784, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 85:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00498, Train/loss_recog_step=0.784, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 85:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.0155, Train/loss_recog_step=1.050, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080] Epoch 85:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.0155, Train/loss_recog_step=1.050, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 85:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=0.867, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 85:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=0.867, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 85:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]  Epoch 85: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 85: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.643, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.408, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.379, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.44it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.36it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.52it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070968, 0.070111, 0.068309
Valid average loss UNet            (all)              : 0.209389

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.107840, 3.623897, 5.605939
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.548597, 3.826513, 3.741903
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.368465, 3.583741, 3.751597
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.191473, 3.671467, 4.426423
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.349860, 3.813067, 4.208727
Valid average loss all      (Triplet)                 : 0.352044

== Recognize ==
Valid average loss Recognize     : 0.982533
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.561433

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.158730030059814 sec. =
Valid knn accuracy drums     : 72.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.79685926437378 sec. =
Valid knn accuracy bass      : 16.13372093023256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.53791069984436 sec. =
Valid knn accuracy piano     : 27.16216216216216%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.014129400253296 sec. =
Valid knn accuracy guitar    : 48.86363636363637%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.749751329421997 sec. =
Valid knn accuracy residuals : 61.0062893081761%

Valid knn accuracy average   : 45.22139704695909%

                                                                        [AEpoch 85: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 85: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065104, 0.064788, 0.066148
Train average loss UNet            (all)              : 0.196040

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000943, 3.512011, 6.113228
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007530, 3.241495, 4.636840
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004761, 3.347503, 4.765962
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004061, 3.488854, 5.301580
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003858, 3.669116, 5.178111
Train average loss all      (Triplet)                 : 0.004309

== Recognize ==
Train average loss Recognize     : 1.079581
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.200349

Epoch 85:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]          Epoch 86:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=0.782, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=0.782, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=1.050, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=1.050, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00169, Train/loss_recog_step=0.861, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00169, Train/loss_recog_step=0.861, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00885, Train/loss_recog_step=1.260, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00885, Train/loss_recog_step=1.260, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.828, Valid/loss_all_step=0.671, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.427, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.561, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.352, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.41it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.09it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.44it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.18it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070558, 0.071281, 0.069690
Valid average loss UNet            (all)              : 0.211529

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.125300, 3.561017, 5.581158
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.610256, 3.791973, 3.604290
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.393565, 3.533849, 3.782115
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.261143, 3.734823, 4.340904
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.326095, 3.874521, 4.240933
Valid average loss all      (Triplet)                 : 0.384060

== Recognize ==
Valid average loss Recognize     : 0.979146
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.595589

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.243475437164307 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.719744682312012 sec. =
Valid knn accuracy bass      : 17.151162790697676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.363415479660034 sec. =
Valid knn accuracy piano     : 27.972972972972972%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.49983263015747 sec. =
Valid knn accuracy guitar    : 44.48051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.403772830963135 sec. =
Valid knn accuracy residuals : 59.43396226415094%

Valid knn accuracy average   : 45.27831173696234%

                                                                        [AEpoch 86: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.828, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00431, Train/loss_recog_epoch=1.080]Epoch 86: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.828, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065054, 0.064740, 0.066053
Train average loss UNet            (all)              : 0.195847

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001112, 3.417953, 6.022830
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007289, 3.174423, 4.579161
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006142, 3.305430, 4.705312
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005045, 3.382135, 5.146663
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003592, 3.546302, 5.011456
Train average loss all      (Triplet)                 : 0.004694

== Recognize ==
Train average loss Recognize     : 1.079785
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.200541

Epoch 86:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.828, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]          Epoch 87:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.828, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.828, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0255, Train/loss_recog_step=0.940, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0255, Train/loss_recog_step=0.940, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  32%|███▏      | 100/313 [01:32<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00396, Train/loss_recog_step=1.110, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00396, Train/loss_recog_step=1.110, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=0.776, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=0.776, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]  Epoch 87:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=1.250, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=1.250, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.440, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.384, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.453, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.81it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.42it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.58it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.37it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.10it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069539, 0.069544, 0.068252
Valid average loss UNet            (all)              : 0.207334

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.127740, 3.785216, 5.696432
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.629669, 3.977730, 3.818202
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.353862, 3.713821, 3.992285
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.232822, 3.927661, 4.649384
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.365270, 4.068880, 4.779233
Valid average loss all      (Triplet)                 : 0.391528

== Recognize ==
Valid average loss Recognize     : 0.969924
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.598862

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.171716690063477 sec. =
Valid knn accuracy drums     : 75.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.820806503295898 sec. =
Valid knn accuracy bass      : 19.767441860465116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.101322412490845 sec. =
Valid knn accuracy piano     : 34.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.868640422821045 sec. =
Valid knn accuracy guitar    : 47.4025974025974%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.121372938156128 sec. =
Valid knn accuracy residuals : 60.534591194968556%

Valid knn accuracy average   : 47.6092885717334%

                                                                        [AEpoch 87: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065044, 0.064708, 0.065979
Train average loss UNet            (all)              : 0.195731

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001293, 3.476726, 6.048965
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006859, 3.160432, 4.527781
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005779, 3.347581, 4.758314
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005480, 3.448145, 5.261997
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004126, 3.600859, 5.077762
Train average loss all      (Triplet)                 : 0.004840

== Recognize ==
Train average loss Recognize     : 1.070492
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.200571

Epoch 87:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]          Epoch 88:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]Epoch 88:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.822, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]Epoch 88:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=0.939, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]Epoch 88:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=0.939, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]Epoch 88:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000199, Train/loss_recog_step=1.110, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]Epoch 88:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000199, Train/loss_recog_step=1.110, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]Epoch 88:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=0.778, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070] Epoch 88:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=0.778, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]Epoch 88:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00356, Train/loss_recog_step=1.040, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]Epoch 88:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00356, Train/loss_recog_step=1.040, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]Epoch 88:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0052, Train/loss_recog_step=0.849, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070] Epoch 88:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0052, Train/loss_recog_step=0.849, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]Epoch 88:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00149, Train/loss_recog_step=1.250, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]Epoch 88: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00149, Train/loss_recog_step=1.250, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]Epoch 88: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00556, Train/loss_recog_step=0.824, Valid/loss_all_step=0.718, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.599, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.392, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.476, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.76it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.03it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.01it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.39it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.02it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.17it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069930, 0.068988, 0.068832
Valid average loss UNet            (all)              : 0.207750

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.119861, 3.526503, 5.912913
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.599807, 3.779366, 3.656841
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.393368, 3.307665, 3.460021
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.229952, 3.419116, 4.100423
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.317517, 3.808704, 4.134116
Valid average loss all      (Triplet)                 : 0.376143

== Recognize ==
Valid average loss Recognize     : 0.971477
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.583892

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.209954261779785 sec. =
Valid knn accuracy drums     : 76.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.833082914352417 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.132836103439331 sec. =
Valid knn accuracy piano     : 29.18918918918919%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.494455814361572 sec. =
Valid knn accuracy guitar    : 42.532467532467535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.384946346282959 sec. =
Valid knn accuracy residuals : 58.64779874213837%

Valid knn accuracy average   : 45.11800873981784%

                                                                        [AEpoch 88: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00556, Train/loss_recog_step=0.824, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00484, Train/loss_recog_epoch=1.070]Epoch 88: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00556, Train/loss_recog_step=0.824, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064897, 0.064630, 0.065888
Train average loss UNet            (all)              : 0.195415

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002353, 3.440026, 6.108203
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005566, 3.101706, 4.471012
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004735, 3.273782, 4.697873
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005020, 3.391069, 5.204870
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004716, 3.566555, 5.040226
Train average loss all      (Triplet)                 : 0.004634

== Recognize ==
Train average loss Recognize     : 1.070889
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.200049

Epoch 88:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00556, Train/loss_recog_step=0.824, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]          Epoch 89:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00556, Train/loss_recog_step=0.824, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]Epoch 89:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00556, Train/loss_recog_step=0.824, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]Epoch 89:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00896, Train/loss_recog_step=0.944, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]Epoch 89:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00896, Train/loss_recog_step=0.944, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]Epoch 89:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=1.120, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]Epoch 89:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=1.120, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]Epoch 89:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.780, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]  Epoch 89:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.780, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]Epoch 89:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000326, Train/loss_recog_step=1.050, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]Epoch 89:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000326, Train/loss_recog_step=1.050, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]Epoch 89:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=0.854, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070] Epoch 89:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=0.854, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]Epoch 89:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00284, Train/loss_recog_step=1.250, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]Epoch 89: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00284, Train/loss_recog_step=1.250, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]Epoch 89: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.702, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.471, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.24it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.86it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.81it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.35it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.85it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070573, 0.072033, 0.070834
Valid average loss UNet            (all)              : 0.213441

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.109742, 3.796874, 5.993734
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.641408, 3.940938, 3.845120
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.364745, 3.702240, 3.938109
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.291492, 3.928699, 4.651139
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.344019, 4.175439, 4.830238
Valid average loss all      (Triplet)                 : 0.397240

== Recognize ==
Valid average loss Recognize     : 0.972623
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.610681

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.025617122650146 sec. =
Valid knn accuracy drums     : 75.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.995734930038452 sec. =
Valid knn accuracy bass      : 15.11627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.35975980758667 sec. =
Valid knn accuracy piano     : 33.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.463256597518921 sec. =
Valid knn accuracy guitar    : 47.88961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.708051204681396 sec. =
Valid knn accuracy residuals : 58.9622641509434%

Valid knn accuracy average   : 46.06930639773992%

                                                                        [AEpoch 89: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00463, Train/loss_recog_epoch=1.070]Epoch 89: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064835, 0.064465, 0.065758
Train average loss UNet            (all)              : 0.195058

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002093, 3.553613, 6.229020
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005766, 3.206373, 4.603650
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005290, 3.358546, 4.801108
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003671, 3.481998, 5.329329
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004521, 3.657354, 5.166666
Train average loss all      (Triplet)                 : 0.004387

== Recognize ==
Train average loss Recognize     : 1.076848
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.199445

Epoch 89:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]          Epoch 90:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=0.778, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00564, Train/loss_recog_step=0.778, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]  Epoch 90:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=1.250, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=1.250, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.726, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.461, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.36it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.97it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.66it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.46it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068454, 0.068905, 0.067601
Valid average loss UNet            (all)              : 0.204959

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.114077, 3.481113, 5.885104
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.620963, 3.782508, 3.719561
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.589429, 3.479876, 3.425947
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.325898, 3.629487, 4.328814
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.346103, 3.768009, 4.552409
Valid average loss all      (Triplet)                 : 0.450244

== Recognize ==
Valid average loss Recognize     : 0.969700
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.655203

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.105601787567139 sec. =
Valid knn accuracy drums     : 76.91176470588236%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.03146243095398 sec. =
Valid knn accuracy bass      : 16.27906976744186%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.388144254684448 sec. =
Valid knn accuracy piano     : 32.83783783783784%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.452349424362183 sec. =
Valid knn accuracy guitar    : 42.37012987012987%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.373380899429321 sec. =
Valid knn accuracy residuals : 56.91823899371069%

Valid knn accuracy average   : 45.063408235000516%

                                                                        [AEpoch 90: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00439, Train/loss_recog_epoch=1.080]Epoch 90: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064860, 0.064468, 0.065818
Train average loss UNet            (all)              : 0.195145

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002053, 3.597769, 6.372373
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006216, 3.262584, 4.641960
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006238, 3.396119, 4.845265
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005546, 3.515035, 5.387071
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004825, 3.715132, 5.222728
Train average loss all      (Triplet)                 : 0.004938

== Recognize ==
Train average loss Recognize     : 1.073476
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.200083

Epoch 90:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]          Epoch 91:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]Epoch 91:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]Epoch 91:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000774, Train/loss_recog_step=0.939, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]Epoch 91:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000774, Train/loss_recog_step=0.939, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]Epoch 91:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=1.110, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070] Epoch 91:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00581, Train/loss_recog_step=1.110, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]Epoch 91:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00246, Train/loss_recog_step=0.780, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]Epoch 91:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00246, Train/loss_recog_step=0.780, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]Epoch 91:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]  Epoch 91:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]Epoch 91:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.851, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]Epoch 91:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.851, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]Epoch 91:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0052, Train/loss_recog_step=1.250, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070] Epoch 91: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0052, Train/loss_recog_step=1.250, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]Epoch 91: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.628, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.655, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.451, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.97it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.50it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.04it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.12it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.87it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069056, 0.069124, 0.068797
Valid average loss UNet            (all)              : 0.206976

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.127702, 3.431271, 5.601971
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.620646, 3.824949, 3.765122
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.360520, 3.412650, 3.602974
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.270907, 3.633107, 4.308208
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.370636, 3.687420, 4.601227
Valid average loss all      (Triplet)                 : 0.396476

== Recognize ==
Valid average loss Recognize     : 0.973049
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.603452

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.139604091644287 sec. =
Valid knn accuracy drums     : 76.3235294117647%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.56923794746399 sec. =
Valid knn accuracy bass      : 20.49418604651163%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.466702699661255 sec. =
Valid knn accuracy piano     : 34.054054054054056%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.41480302810669 sec. =
Valid knn accuracy guitar    : 47.07792207792208%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.660973310470581 sec. =
Valid knn accuracy residuals : 60.062893081761004%

Valid knn accuracy average   : 47.602516934402686%

                                                                        [AEpoch 91: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.070]Epoch 91: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064731, 0.064359, 0.065690
Train average loss UNet            (all)              : 0.194780

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000965, 3.483659, 6.240404
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006963, 3.208863, 4.587920
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004697, 3.312830, 4.733391
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004315, 3.449771, 5.286359
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004335, 3.653411, 5.195519
Train average loss all      (Triplet)                 : 0.004411

== Recognize ==
Train average loss Recognize     : 1.074313
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.199191

Epoch 91:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]          Epoch 92:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00942, Train/loss_recog_step=0.940, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00942, Train/loss_recog_step=0.940, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=1.120, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=1.120, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.780, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=0.780, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000622, Train/loss_recog_step=1.050, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000622, Train/loss_recog_step=1.050, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]   Epoch 92:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=1.260, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=1.260, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=0.831, Valid/loss_all_step=0.668, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.437, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.973, Valid/knn_avr=0.476, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.17it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.76it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.97it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.80it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.57it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068732, 0.068900, 0.067870
Valid average loss UNet            (all)              : 0.205502

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.175649, 3.937857, 6.334778
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.747909, 4.574110, 4.378339
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.506320, 4.132326, 4.238276
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.270488, 4.361137, 5.114279
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.395464, 4.638071, 5.133565
Valid average loss all      (Triplet)                 : 0.472988

== Recognize ==
Valid average loss Recognize     : 0.974886
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.678491

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.669275522232056 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.915534257888794 sec. =
Valid knn accuracy bass      : 14.825581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.441658020019531 sec. =
Valid knn accuracy piano     : 26.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.213665962219238 sec. =
Valid knn accuracy guitar    : 42.6948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.752660989761353 sec. =
Valid knn accuracy residuals : 54.24528301886793%

Valid knn accuracy average   : 43.14804648142284%

                                                                        [AEpoch 92: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=0.831, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.070]Epoch 92: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=0.831, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064672, 0.064297, 0.065630
Train average loss UNet            (all)              : 0.194599

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001673, 3.710229, 6.518706
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005241, 3.385630, 4.851059
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005425, 3.531111, 5.032005
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003564, 3.663695, 5.606444
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004946, 3.875736, 5.500463
Train average loss all      (Triplet)                 : 0.004241

== Recognize ==
Train average loss Recognize     : 1.076269
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.198840

Epoch 92:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=0.831, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]          Epoch 93:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=0.831, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=0.831, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.949, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080] Epoch 93:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.949, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00656, Train/loss_recog_step=1.130, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00656, Train/loss_recog_step=1.130, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00503, Train/loss_recog_step=0.783, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00503, Train/loss_recog_step=0.783, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00159, Train/loss_recog_step=1.060, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00159, Train/loss_recog_step=1.060, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00219, Train/loss_recog_step=0.871, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00219, Train/loss_recog_step=0.871, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00912, Train/loss_recog_step=1.280, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00912, Train/loss_recog_step=1.280, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.616, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.431, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.72it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.58it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.87it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.09it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.42it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069965, 0.069824, 0.068710
Valid average loss UNet            (all)              : 0.208498

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133859, 3.681962, 6.094627
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.603606, 3.997505, 3.798018
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.468795, 3.890494, 3.955615
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.270125, 3.834379, 4.462126
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.643524, 4.694772, 4.615383
Valid average loss all      (Triplet)                 : 0.439388

== Recognize ==
Valid average loss Recognize     : 0.991052
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.647886

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.923030614852905 sec. =
Valid knn accuracy drums     : 75.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.957090854644775 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.543719291687012 sec. =
Valid knn accuracy piano     : 28.64864864864865%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.497661828994751 sec. =
Valid knn accuracy guitar    : 43.34415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.263163089752197 sec. =
Valid knn accuracy residuals : 57.861635220125784%

Valid knn accuracy average   : 44.19865812042463%

                                                                        [AEpoch 93: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00424, Train/loss_recog_epoch=1.080]Epoch 93: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064693, 0.064414, 0.065655
Train average loss UNet            (all)              : 0.194763

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001554, 3.585305, 6.370197
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006411, 3.332798, 4.751047
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007117, 3.465785, 4.909820
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006310, 3.541149, 5.405057
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003835, 3.746446, 5.296604
Train average loss all      (Triplet)                 : 0.005107

== Recognize ==
Train average loss Recognize     : 1.088195
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.199870

Epoch 93:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]          Epoch 94:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]Epoch 94:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]Epoch 94:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.953, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]Epoch 94:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.953, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]Epoch 94:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00656, Train/loss_recog_step=1.130, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]Epoch 94:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00656, Train/loss_recog_step=1.130, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]Epoch 94:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.789, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]  Epoch 94:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.789, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]Epoch 94:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=1.060, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]Epoch 94:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=1.060, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]Epoch 94:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090] Epoch 94:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]Epoch 94:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=1.270, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]Epoch 94: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=1.270, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]Epoch 94: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.831, Valid/loss_all_step=0.812, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.442, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.62it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.11it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.20it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.04it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071548, 0.073938, 0.071778
Valid average loss UNet            (all)              : 0.217265

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.126309, 3.799910, 5.839998
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.564810, 4.144185, 4.002439
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.446463, 3.894072, 4.033329
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.242712, 3.900494, 4.747655
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.389609, 4.445603, 4.847556
Valid average loss all      (Triplet)                 : 0.392874

== Recognize ==
Valid average loss Recognize     : 0.979171
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.610138

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.113325357437134 sec. =
Valid knn accuracy drums     : 74.26470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.518787860870361 sec. =
Valid knn accuracy bass      : 19.62209302325581%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.597980260848999 sec. =
Valid knn accuracy piano     : 30.675675675675674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.707583665847778 sec. =
Valid knn accuracy guitar    : 43.83116883116883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.886878728866577 sec. =
Valid knn accuracy residuals : 57.704402515723274%

Valid knn accuracy average   : 45.2196091856353%

                                                                        [AEpoch 94: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.831, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00511, Train/loss_recog_epoch=1.090]Epoch 94: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.831, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064580, 0.064120, 0.065432
Train average loss UNet            (all)              : 0.194132

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001866, 3.569239, 6.296315
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006851, 3.285771, 4.701908
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005322, 3.430998, 4.900625
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003715, 3.510130, 5.403770
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004364, 3.711828, 5.277780
Train average loss all      (Triplet)                 : 0.004562

== Recognize ==
Train average loss Recognize     : 1.090166
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.198694

Epoch 94:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.831, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]          Epoch 95:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.831, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=0.831, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=0.944, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=0.944, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000973, Train/loss_recog_step=1.120, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000973, Train/loss_recog_step=1.120, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.782, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]   Epoch 95:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.782, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00812, Train/loss_recog_step=0.865, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00812, Train/loss_recog_step=0.865, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00725, Train/loss_recog_step=1.270, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00725, Train/loss_recog_step=1.270, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.833, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.393, Valid/loss_recog_epoch=0.979, Valid/knn_avr=0.452, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.98it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.35it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.48it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068560, 0.069025, 0.067984
Valid average loss UNet            (all)              : 0.205569

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.106792, 3.569459, 5.711483
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.646248, 3.992098, 3.778121
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.434458, 3.732988, 3.859030
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.259137, 3.737506, 4.610861
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.447314, 4.041152, 4.594904
Valid average loss all      (Triplet)                 : 0.429564

== Recognize ==
Valid average loss Recognize     : 0.980225
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.635134

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.113188028335571 sec. =
Valid knn accuracy drums     : 76.61764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.106992721557617 sec. =
Valid knn accuracy bass      : 17.296511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.375330448150635 sec. =
Valid knn accuracy piano     : 27.837837837837835%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.024483442306519 sec. =
Valid knn accuracy guitar    : 42.857142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.095894575119019 sec. =
Valid knn accuracy residuals : 59.11949685534591%

Valid knn accuracy average   : 44.74572724741142%

                                                                        [AEpoch 95: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.833, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.090]Epoch 95: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.833, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064554, 0.064168, 0.065437
Train average loss UNet            (all)              : 0.194159

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001805, 3.398856, 5.958779
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007359, 3.155698, 4.522608
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004359, 3.293768, 4.715618
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005105, 3.365552, 5.158140
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003609, 3.561515, 5.052567
Train average loss all      (Triplet)                 : 0.004522

== Recognize ==
Train average loss Recognize     : 1.083142
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.198681

Epoch 95:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.833, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]          Epoch 96:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.833, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 96:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.833, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 96:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00223, Train/loss_recog_step=0.949, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 96:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00223, Train/loss_recog_step=0.949, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 96:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]  Epoch 96:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 96:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00706, Train/loss_recog_step=0.783, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 96:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00706, Train/loss_recog_step=0.783, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 96:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00369, Train/loss_recog_step=1.060, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 96:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00369, Train/loss_recog_step=1.060, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 96:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]  Epoch 96:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 96:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00794, Train/loss_recog_step=1.270, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 96: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00794, Train/loss_recog_step=1.270, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 96: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=0.835, Valid/loss_all_step=0.798, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.561, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.447, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.29it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.77it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.92it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.39it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.43it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.66it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069373, 0.068522, 0.067268
Valid average loss UNet            (all)              : 0.205162

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.107444, 3.715480, 6.407195
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.520191, 3.963529, 3.993482
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.558632, 4.012057, 3.999733
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.322548, 3.977145, 4.819402
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.448634, 4.313365, 4.710143
Valid average loss all      (Triplet)                 : 0.435158

== Recognize ==
Valid average loss Recognize     : 0.983180
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.640321

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.607841968536377 sec. =
Valid knn accuracy drums     : 76.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.768929958343506 sec. =
Valid knn accuracy bass      : 16.424418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.466859102249146 sec. =
Valid knn accuracy piano     : 29.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.220798969268799 sec. =
Valid knn accuracy guitar    : 46.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.368712425231934 sec. =
Valid knn accuracy residuals : 58.17610062893082%

Valid knn accuracy average   : 45.35764643131781%

                                                                        [AEpoch 96: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=0.835, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 96: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=0.835, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064276, 0.063951, 0.065233
Train average loss UNet            (all)              : 0.193460

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001705, 3.623181, 6.413169
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005501, 3.315859, 4.778518
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003932, 3.475534, 4.984622
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002932, 3.574709, 5.500781
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003199, 3.737735, 5.302703
Train average loss all      (Triplet)                 : 0.003499

== Recognize ==
Train average loss Recognize     : 1.084575
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.196959

Epoch 96:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=0.835, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]          Epoch 97:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=0.835, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]Epoch 97:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0203, Train/loss_recog_step=0.835, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]Epoch 97:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080] Epoch 97:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]Epoch 97:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=1.130, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]Epoch 97:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=1.130, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]Epoch 97:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000858, Train/loss_recog_step=0.788, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]Epoch 97:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000858, Train/loss_recog_step=0.788, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]Epoch 97:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]   Epoch 97:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]Epoch 97:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=0.873, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]Epoch 97:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00181, Train/loss_recog_step=0.873, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]Epoch 97:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.270, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080] Epoch 97: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.270, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]Epoch 97: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.560, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.454, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.84it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.17it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.37it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069614, 0.068866, 0.067615
Valid average loss UNet            (all)              : 0.206095

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.122495, 3.924691, 6.533538
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.490298, 4.031971, 4.089561
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.598899, 4.187736, 4.090715
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.320898, 4.114679, 4.782813
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.383112, 4.534154, 4.939477
Valid average loss all      (Triplet)                 : 0.414193

== Recognize ==
Valid average loss Recognize     : 0.988153
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.620288

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.940128803253174 sec. =
Valid knn accuracy drums     : 79.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.321516752243042 sec. =
Valid knn accuracy bass      : 22.238372093023255%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.730736255645752 sec. =
Valid knn accuracy piano     : 28.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.615463972091675 sec. =
Valid knn accuracy guitar    : 37.98701298701299%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.566969871520996 sec. =
Valid knn accuracy residuals : 55.503144654088054%

Valid knn accuracy average   : 44.811842671785115%

                                                                        [AEpoch 97: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0035, Train/loss_recog_epoch=1.080]Epoch 97: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064370, 0.063997, 0.065259
Train average loss UNet            (all)              : 0.193627

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001923, 3.736491, 6.585302
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005102, 3.428286, 4.941748
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005480, 3.579719, 5.115927
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004170, 3.693602, 5.668558
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003808, 3.841227, 5.393280
Train average loss all      (Triplet)                 : 0.004171

== Recognize ==
Train average loss Recognize     : 1.090672
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.197797

Epoch 97:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]          Epoch 98:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]Epoch 98:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]Epoch 98:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.956, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]Epoch 98:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.956, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]Epoch 98:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00262, Train/loss_recog_step=1.120, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]Epoch 98:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00262, Train/loss_recog_step=1.120, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]Epoch 98:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]  Epoch 98:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.783, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]Epoch 98:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00531, Train/loss_recog_step=1.060, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]Epoch 98:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00531, Train/loss_recog_step=1.060, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]Epoch 98:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=0.858, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090] Epoch 98:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=0.858, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]Epoch 98:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0029, Train/loss_recog_step=1.270, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]Epoch 98: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0029, Train/loss_recog_step=1.270, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]Epoch 98: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.695, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.448, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.26it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.70it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.82it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.50it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069994, 0.071138, 0.070119
Valid average loss UNet            (all)              : 0.211251

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.129520, 3.957792, 6.221699
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.545010, 4.230845, 4.264204
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.575855, 4.277055, 4.227258
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.353767, 4.250150, 4.834503
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.400986, 4.450557, 4.997658
Valid average loss all      (Triplet)                 : 0.425092

== Recognize ==
Valid average loss Recognize     : 0.988381
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.636343

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.956358194351196 sec. =
Valid knn accuracy drums     : 74.55882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.06744384765625 sec. =
Valid knn accuracy bass      : 19.186046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.352829933166504 sec. =
Valid knn accuracy piano     : 32.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.235318660736084 sec. =
Valid knn accuracy guitar    : 46.590909090909086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.73013710975647 sec. =
Valid knn accuracy residuals : 57.861635220125784%

Valid knn accuracy average   : 46.18002341095544%

                                                                        [AEpoch 98: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00417, Train/loss_recog_epoch=1.090]Epoch 98: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064173, 0.063878, 0.065075
Train average loss UNet            (all)              : 0.193126

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001047, 3.674762, 6.465580
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005630, 3.409024, 4.899102
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004036, 3.549211, 5.072316
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003989, 3.688352, 5.620231
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005343, 3.850448, 5.440715
Train average loss all      (Triplet)                 : 0.004071

== Recognize ==
Train average loss Recognize     : 1.083893
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.197197

Epoch 98:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]          Epoch 99:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]Epoch 99:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]Epoch 99:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00321, Train/loss_recog_step=0.956, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]Epoch 99:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00321, Train/loss_recog_step=0.956, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]Epoch 99:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=1.130, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080] Epoch 99:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=1.130, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]Epoch 99:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.787, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080] Epoch 99:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.787, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]Epoch 99:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00701, Train/loss_recog_step=1.060, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]Epoch 99:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00701, Train/loss_recog_step=1.060, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]Epoch 99:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00209, Train/loss_recog_step=0.865, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]Epoch 99:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00209, Train/loss_recog_step=0.865, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]Epoch 99:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]  Epoch 99: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]Epoch 99: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.625, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.379, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.636, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.425, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.462, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.32it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.78it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.33it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.02it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.12it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.10it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070224, 0.069568, 0.068714
Valid average loss UNet            (all)              : 0.208505

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.191743, 3.976660, 6.375026
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.584238, 4.243344, 4.214118
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.658790, 4.329954, 4.168438
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.315648, 4.323443, 5.041058
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.387322, 4.804915, 5.139419
Valid average loss all      (Triplet)                 : 0.461194

== Recognize ==
Valid average loss Recognize     : 0.991298
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.669699

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.584275722503662 sec. =
Valid knn accuracy drums     : 74.26470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.043529510498047 sec. =
Valid knn accuracy bass      : 13.953488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.693930864334106 sec. =
Valid knn accuracy piano     : 29.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.626550912857056 sec. =
Valid knn accuracy guitar    : 43.18181818181818%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.77119255065918 sec. =
Valid knn accuracy residuals : 62.893081761006286%

Valid knn accuracy average   : 44.6694296502649%

                                                                        [AEpoch 99: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00407, Train/loss_recog_epoch=1.080]Epoch 99: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064054, 0.063719, 0.065063
Train average loss UNet            (all)              : 0.192836

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001026, 3.658742, 6.441657
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006002, 3.407771, 4.921037
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005176, 3.527474, 5.044961
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004769, 3.663028, 5.612219
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003314, 3.800050, 5.381052
Train average loss all      (Triplet)                 : 0.003983

== Recognize ==
Train average loss Recognize     : 1.087944
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.196819

Epoch 99:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]          Epoch 100:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]Epoch 100:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]Epoch 100:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]Epoch 100:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]Epoch 100:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=1.140, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]Epoch 100:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=1.140, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]Epoch 100:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=0.794, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]  Epoch 100:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=0.794, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]Epoch 100:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000585, Train/loss_recog_step=1.070, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]Epoch 100:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000585, Train/loss_recog_step=1.070, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]Epoch 100:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=0.870, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]  Epoch 100:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0242, Train/loss_recog_step=0.870, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]Epoch 100:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090] Epoch 100: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]Epoch 100: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00063, Train/loss_recog_step=0.840, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.447, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.08it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.34it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.63it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069342, 0.070107, 0.069090
Valid average loss UNet            (all)              : 0.208540

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.191822, 4.006865, 6.282175
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.569159, 4.374813, 4.354208
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.591957, 4.210269, 4.145372
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.308184, 4.335135, 5.021154
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.445807, 4.596935, 4.841394
Valid average loss all      (Triplet)                 : 0.448972

== Recognize ==
Valid average loss Recognize     : 0.994192
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.657512

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.221662759780884 sec. =
Valid knn accuracy drums     : 75.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.608382225036621 sec. =
Valid knn accuracy bass      : 16.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.417003870010376 sec. =
Valid knn accuracy piano     : 31.216216216216214%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.436326265335083 sec. =
Valid knn accuracy guitar    : 43.18181818181818%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.491085052490234 sec. =
Valid knn accuracy residuals : 55.0314465408805%

Valid knn accuracy average   : 44.31681274045056%

                                                                        [AEpoch 100: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00063, Train/loss_recog_step=0.840, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00398, Train/loss_recog_epoch=1.090]Epoch 100: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00063, Train/loss_recog_step=0.840, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064061, 0.063733, 0.064975
Train average loss UNet            (all)              : 0.192770

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001858, 3.797281, 6.654345
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005708, 3.538971, 5.078960
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004075, 3.685242, 5.243206
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004455, 3.818717, 5.837431
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002961, 3.954503, 5.600223
Train average loss all      (Triplet)                 : 0.003821

== Recognize ==
Train average loss Recognize     : 1.095973
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.196590

Epoch 100:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00063, Train/loss_recog_step=0.840, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]          Epoch 101:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00063, Train/loss_recog_step=0.840, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]Epoch 101:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00063, Train/loss_recog_step=0.840, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]Epoch 101:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000115, Train/loss_recog_step=0.964, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]Epoch 101:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000115, Train/loss_recog_step=0.964, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]Epoch 101:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=1.140, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100] Epoch 101:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=1.140, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]Epoch 101:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00376, Train/loss_recog_step=0.789, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]Epoch 101:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00376, Train/loss_recog_step=0.789, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]Epoch 101:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]  Epoch 101:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]Epoch 101:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]Epoch 101:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]Epoch 101:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000775, Train/loss_recog_step=1.270, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]Epoch 101: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000775, Train/loss_recog_step=1.270, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]Epoch 101: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.698, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.461, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.449, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.23it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.61it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.03it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.62it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069272, 0.068606, 0.067868
Valid average loss UNet            (all)              : 0.205747

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.146226, 3.883483, 6.251925
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.562702, 4.125787, 4.001868
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.526842, 4.127017, 4.108242
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.380967, 4.195251, 4.904093
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.374561, 4.142836, 4.847257
Valid average loss all      (Triplet)                 : 0.440749

== Recognize ==
Valid average loss Recognize     : 0.985644
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.646496

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.083278179168701 sec. =
Valid knn accuracy drums     : 75.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.26123833656311 sec. =
Valid knn accuracy bass      : 11.918604651162791%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.458147525787354 sec. =
Valid knn accuracy piano     : 27.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.463669061660767 sec. =
Valid knn accuracy guitar    : 42.04545454545455%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.558971166610718 sec. =
Valid knn accuracy residuals : 60.062893081761004%

Valid knn accuracy average   : 43.5224015844515%

                                                                        [AEpoch 101: 100%|██████████| 313/313 [06:01<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.100]Epoch 101: 100%|██████████| 313/313 [06:01<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063991, 0.063641, 0.064923
Train average loss UNet            (all)              : 0.192555

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001233, 3.880725, 6.777204
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006692, 3.617572, 5.201013
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003736, 3.785707, 5.388859
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003678, 3.904916, 5.976981
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003962, 4.118760, 5.831563
Train average loss all      (Triplet)                 : 0.004005

== Recognize ==
Train average loss Recognize     : 1.089882
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.196560

Epoch 101:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]          Epoch 102:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]Epoch 102:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]Epoch 102:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00755, Train/loss_recog_step=0.956, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]Epoch 102:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00755, Train/loss_recog_step=0.956, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]Epoch 102:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=1.130, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]Epoch 102:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=1.130, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]Epoch 102:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=0.790, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090] Epoch 102:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=0.790, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]Epoch 102:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090] Epoch 102:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]Epoch 102:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]Epoch 102:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]Epoch 102:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=1.280, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]Epoch 102: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=1.280, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]Epoch 102: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.845, Valid/loss_all_step=0.826, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.441, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.435, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.97it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.40it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.58it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.90it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.77it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068476, 0.067732, 0.067630
Valid average loss UNet            (all)              : 0.203838

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.175220, 3.853010, 5.984861
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.686094, 4.114483, 3.929731
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.555752, 3.998798, 3.955175
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.293764, 3.976964, 4.736981
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.368951, 4.073537, 4.679672
Valid average loss all      (Triplet)                 : 0.479722

== Recognize ==
Valid average loss Recognize     : 0.994296
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.683560

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.723382711410522 sec. =
Valid knn accuracy drums     : 75.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.797260284423828 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.298367977142334 sec. =
Valid knn accuracy piano     : 27.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.651291608810425 sec. =
Valid knn accuracy guitar    : 44.15584415584416%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.020559310913086 sec. =
Valid knn accuracy residuals : 58.01886792452831%

Valid knn accuracy average   : 44.32260093642795%

                                                                        [AEpoch 102: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.845, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.004, Train/loss_recog_epoch=1.090]Epoch 102: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.845, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063848, 0.063493, 0.064765
Train average loss UNet            (all)              : 0.192106

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001210, 3.545203, 6.222580
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005090, 3.315220, 4.803318
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005074, 3.457787, 4.921616
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003979, 3.551131, 5.442636
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004299, 3.736851, 5.274760
Train average loss all      (Triplet)                 : 0.003987

== Recognize ==
Train average loss Recognize     : 1.091490
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.196093

Epoch 102:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.845, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]          Epoch 103:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.845, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.845, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=0.970, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=0.970, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=1.150, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=1.150, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000944, Train/loss_recog_step=0.800, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000944, Train/loss_recog_step=0.800, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]   Epoch 103:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.006, Train/loss_recog_step=0.883, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.006, Train/loss_recog_step=0.883, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.480, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.443, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.76it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.33it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.05it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.34it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068913, 0.068092, 0.068207
Valid average loss UNet            (all)              : 0.205212

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.184013, 4.312736, 6.905828
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.648545, 4.694859, 4.693222
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.544236, 4.565281, 4.612465
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.430588, 4.590596, 5.328720
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.420907, 4.634954, 4.995246
Valid average loss all      (Triplet)                 : 0.494058

== Recognize ==
Valid average loss Recognize     : 1.004171
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.699270

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.14151930809021 sec. =
Valid knn accuracy drums     : 77.20588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.653834819793701 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.690566062927246 sec. =
Valid knn accuracy piano     : 31.756756756756754%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.993755340576172 sec. =
Valid knn accuracy guitar    : 47.564935064935064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.017588138580322 sec. =
Valid knn accuracy residuals : 59.27672955974843%

Valid knn accuracy average   : 46.474814235248374%

                                                                        [AEpoch 103: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00399, Train/loss_recog_epoch=1.090]Epoch 103: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063741, 0.063328, 0.064596
Train average loss UNet            (all)              : 0.191665

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000875, 3.646585, 6.441733
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005420, 3.396346, 4.924944
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005066, 3.504054, 5.005731
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001484, 3.599136, 5.529079
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003352, 3.756432, 5.312194
Train average loss all      (Triplet)                 : 0.003376

== Recognize ==
Train average loss Recognize     : 1.105019
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.195041

Epoch 103:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]          Epoch 104:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.976, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.976, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0026, Train/loss_recog_step=1.150, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0026, Train/loss_recog_step=1.150, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00576, Train/loss_recog_step=0.803, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00576, Train/loss_recog_step=0.803, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00203, Train/loss_recog_step=1.070, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00203, Train/loss_recog_step=1.070, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.874, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110] Epoch 104:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.874, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0152, Train/loss_recog_step=1.280, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0152, Train/loss_recog_step=1.280, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.843, Valid/loss_all_step=0.866, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.95it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.15it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.16it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.20it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.14it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070377, 0.069883, 0.069788
Valid average loss UNet            (all)              : 0.210047

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.129828, 3.795926, 5.920259
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.555412, 3.996785, 3.973320
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.496370, 3.867995, 3.969467
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.384079, 3.941397, 4.386198
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.361054, 4.059741, 4.230421
Valid average loss all      (Triplet)                 : 0.420463

== Recognize ==
Valid average loss Recognize     : 0.996845
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.630511

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.297776937484741 sec. =
Valid knn accuracy drums     : 75.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.824671030044556 sec. =
Valid knn accuracy bass      : 16.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.534680604934692 sec. =
Valid knn accuracy piano     : 32.2972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.560814619064331 sec. =
Valid knn accuracy guitar    : 44.48051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.578409194946289 sec. =
Valid knn accuracy residuals : 59.11949685534591%

Valid knn accuracy average   : 45.61037927930012%

                                                                        [AEpoch 104: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.843, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00338, Train/loss_recog_epoch=1.110]Epoch 104: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.843, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063565, 0.063226, 0.064465
Train average loss UNet            (all)              : 0.191256

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001494, 3.789629, 6.672969
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004329, 3.477839, 5.042193
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004882, 3.619521, 5.200567
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002864, 3.704511, 5.663477
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003540, 3.907149, 5.550944
Train average loss all      (Triplet)                 : 0.003665

== Recognize ==
Train average loss Recognize     : 1.103687
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.194921

Epoch 104:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.843, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]          Epoch 105:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.843, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]Epoch 105:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.843, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]Epoch 105:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00254, Train/loss_recog_step=0.965, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]Epoch 105:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00254, Train/loss_recog_step=0.965, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]Epoch 105:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]  Epoch 105:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]Epoch 105:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000283, Train/loss_recog_step=0.795, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]Epoch 105:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000283, Train/loss_recog_step=0.795, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]Epoch 105:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00149, Train/loss_recog_step=1.060, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100] Epoch 105:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00149, Train/loss_recog_step=1.060, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]Epoch 105:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]  Epoch 105:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]Epoch 105:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00238, Train/loss_recog_step=1.280, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]Epoch 105: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00238, Train/loss_recog_step=1.280, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]Epoch 105: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.832, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.462, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.997, Valid/knn_avr=0.456, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.95it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.85it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.70it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.93it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.07it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069069, 0.069723, 0.067902
Valid average loss UNet            (all)              : 0.206694

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.149234, 3.807631, 5.962851
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.498087, 4.109743, 4.104719
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.513896, 3.989588, 3.991214
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.339207, 4.213767, 4.664629
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.376619, 4.248718, 4.627705
Valid average loss all      (Triplet)                 : 0.393545

== Recognize ==
Valid average loss Recognize     : 0.988928
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.600239

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.794972658157349 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.749468326568604 sec. =
Valid knn accuracy bass      : 14.244186046511627%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.358180284500122 sec. =
Valid knn accuracy piano     : 28.783783783783782%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.22681212425232 sec. =
Valid knn accuracy guitar    : 44.967532467532465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.38672423362732 sec. =
Valid knn accuracy residuals : 57.38993710691824%

Valid knn accuracy average   : 44.782970233890396%

                                                                        [AEpoch 105: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.832, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00366, Train/loss_recog_epoch=1.100]Epoch 105: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.832, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063596, 0.063241, 0.064529
Train average loss UNet            (all)              : 0.191366

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001180, 3.626896, 6.307404
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006658, 3.371023, 4.880550
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005303, 3.486821, 4.999098
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003867, 3.596428, 5.483495
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004381, 3.753471, 5.316823
Train average loss all      (Triplet)                 : 0.004277

== Recognize ==
Train average loss Recognize     : 1.094174
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.195643

Epoch 105:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.832, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]          Epoch 106:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.832, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]Epoch 106:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.832, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]Epoch 106:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.953, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]  Epoch 106:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.953, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]Epoch 106:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]Epoch 106:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]Epoch 106:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.791, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]Epoch 106:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.791, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]Epoch 106:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090] Epoch 106:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]Epoch 106:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00808, Train/loss_recog_step=0.864, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]Epoch 106:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00808, Train/loss_recog_step=0.864, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]Epoch 106:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]  Epoch 106: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]Epoch 106: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.592, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.348, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.448, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.13it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.91it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.13it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.44it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.87it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070136, 0.070918, 0.069295
Valid average loss UNet            (all)              : 0.210349

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.168338, 3.948229, 6.150997
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.527385, 4.259660, 4.288476
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.715479, 4.362702, 4.175900
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.409968, 4.383689, 5.198185
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.351945, 4.413023, 4.881488
Valid average loss all      (Triplet)                 : 0.456105

== Recognize ==
Valid average loss Recognize     : 0.992867
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.666454

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.78473687171936 sec. =
Valid knn accuracy drums     : 74.55882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.131627559661865 sec. =
Valid knn accuracy bass      : 18.313953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.320343017578125 sec. =
Valid knn accuracy piano     : 34.054054054054056%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.498194932937622 sec. =
Valid knn accuracy guitar    : 45.94155844155844%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.591234922409058 sec. =
Valid knn accuracy residuals : 60.22012578616353%

Valid knn accuracy average   : 46.617703059911975%

                                                                        [AEpoch 106: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.090]Epoch 106: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063576, 0.063223, 0.064456
Train average loss UNet            (all)              : 0.191255

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001425, 3.806774, 6.688550
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005515, 3.519294, 5.093472
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005023, 3.636105, 5.197174
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004144, 3.742933, 5.689981
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003537, 3.910558, 5.537880
Train average loss all      (Triplet)                 : 0.003900

== Recognize ==
Train average loss Recognize     : 1.089824
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.195155

Epoch 106:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]          Epoch 107:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]Epoch 107:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]Epoch 107:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00539, Train/loss_recog_step=0.962, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]Epoch 107:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00539, Train/loss_recog_step=0.962, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]Epoch 107:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]  Epoch 107:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]Epoch 107:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.790, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]Epoch 107:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.790, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]Epoch 107:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000491, Train/loss_recog_step=1.060, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]Epoch 107:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000491, Train/loss_recog_step=1.060, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]Epoch 107:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]   Epoch 107:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]Epoch 107:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000508, Train/loss_recog_step=1.280, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]Epoch 107: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000508, Train/loss_recog_step=1.280, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]Epoch 107: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=0.836, Valid/loss_all_step=0.725, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.466, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.98it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.17it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.49it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069987, 0.068115, 0.067495
Valid average loss UNet            (all)              : 0.205597

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.137737, 4.160157, 6.869733
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.767326, 4.579474, 4.326538
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.508124, 4.510468, 4.554226
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.358059, 4.532645, 5.395576
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.364144, 4.516212, 5.110011
Valid average loss all      (Triplet)                 : 0.471033

== Recognize ==
Valid average loss Recognize     : 0.996289
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.676629

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.219553470611572 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.886140823364258 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.682286024093628 sec. =
Valid knn accuracy piano     : 31.216216216216214%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.132477045059204 sec. =
Valid knn accuracy guitar    : 47.24025974025974%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.682735443115234 sec. =
Valid knn accuracy residuals : 59.905660377358494%

Valid knn accuracy average   : 46.02092247880519%

                                                                        [AEpoch 107: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=0.836, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.0039, Train/loss_recog_epoch=1.090]Epoch 107: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=0.836, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063287, 0.062906, 0.064207
Train average loss UNet            (all)              : 0.190400

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000613, 3.934702, 6.921228
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004760, 3.651630, 5.313060
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002873, 3.795737, 5.494002
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002789, 3.914567, 6.027659
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002597, 4.072089, 5.784517
Train average loss all      (Triplet)                 : 0.002807

== Recognize ==
Train average loss Recognize     : 1.093037
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.193208

Epoch 107:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=0.836, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]          Epoch 108:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=0.836, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]Epoch 108:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=0.836, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]Epoch 108:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0063, Train/loss_recog_step=0.964, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090] Epoch 108:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0063, Train/loss_recog_step=0.964, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]Epoch 108:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00275, Train/loss_recog_step=1.140, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]Epoch 108:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00275, Train/loss_recog_step=1.140, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]Epoch 108:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=0.794, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]Epoch 108:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00741, Train/loss_recog_step=0.794, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]Epoch 108:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]  Epoch 108:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]Epoch 108:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.878, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]Epoch 108:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.878, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]Epoch 108:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00659, Train/loss_recog_step=1.290, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]Epoch 108: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00659, Train/loss_recog_step=1.290, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]Epoch 108: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00928, Train/loss_recog_step=0.844, Valid/loss_all_step=0.704, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.468, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.460, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.66it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.49it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.93it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.89it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073185, 0.070926, 0.070989
Valid average loss UNet            (all)              : 0.215100

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.165947, 3.728761, 6.201189
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.541275, 4.151070, 4.180660
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.545074, 4.000539, 3.910042
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.320749, 4.108737, 4.804760
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.338553, 4.153815, 4.590438
Valid average loss all      (Triplet)                 : 0.397663

== Recognize ==
Valid average loss Recognize     : 0.995924
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.612763

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.030489921569824 sec. =
Valid knn accuracy drums     : 76.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.989579916000366 sec. =
Valid knn accuracy bass      : 10.755813953488373%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.802253246307373 sec. =
Valid knn accuracy piano     : 31.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.886434078216553 sec. =
Valid knn accuracy guitar    : 43.01948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.391510963439941 sec. =
Valid knn accuracy residuals : 54.71698113207547%

Valid knn accuracy average   : 43.208788984283906%

                                                                        [AEpoch 108: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00928, Train/loss_recog_step=0.844, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.090]Epoch 108: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00928, Train/loss_recog_step=0.844, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063460, 0.063087, 0.064321
Train average loss UNet            (all)              : 0.190868

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001027, 3.893228, 6.878392
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006574, 3.571063, 5.166489
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005372, 3.718657, 5.329118
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003582, 3.848931, 5.884177
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005027, 4.010454, 5.673581
Train average loss all      (Triplet)                 : 0.004414

== Recognize ==
Train average loss Recognize     : 1.096875
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.195282

Epoch 108:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00928, Train/loss_recog_step=0.844, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]          Epoch 109:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00928, Train/loss_recog_step=0.844, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]Epoch 109:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00928, Train/loss_recog_step=0.844, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]Epoch 109:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]  Epoch 109:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]Epoch 109:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=1.150, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]Epoch 109:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=1.150, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]Epoch 109:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]  Epoch 109:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]Epoch 109:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=1.070, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]Epoch 109:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=1.070, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]Epoch 109:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00929, Train/loss_recog_step=0.865, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]Epoch 109:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00929, Train/loss_recog_step=0.865, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]Epoch 109:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]  Epoch 109: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]Epoch 109: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.530, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.274, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.398, Valid/loss_recog_epoch=0.996, Valid/knn_avr=0.432, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.82it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.78it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.33it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.16it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068633, 0.067863, 0.067006
Valid average loss UNet            (all)              : 0.203501

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.155810, 3.960435, 6.154039
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.546874, 4.247603, 4.153189
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.559256, 4.239249, 4.145123
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.255036, 4.329741, 5.095936
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.340164, 4.533308, 4.825342
Valid average loss all      (Triplet)                 : 0.388763

== Recognize ==
Valid average loss Recognize     : 0.989962
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.592264

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.18100357055664 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.675490856170654 sec. =
Valid knn accuracy bass      : 14.970930232558139%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.628827095031738 sec. =
Valid knn accuracy piano     : 33.24324324324324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.39664912223816 sec. =
Valid knn accuracy guitar    : 43.993506493506494%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.318447351455688 sec. =
Valid knn accuracy residuals : 59.74842767295597%

Valid knn accuracy average   : 46.450045057864536%

                                                                        [AEpoch 109: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00441, Train/loss_recog_epoch=1.100]Epoch 109: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063352, 0.062957, 0.064172
Train average loss UNet            (all)              : 0.190480

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000834, 3.692531, 6.452065
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004622, 3.403860, 4.943855
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004445, 3.543745, 5.087059
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004542, 3.656217, 5.572445
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004313, 3.825550, 5.426189
Train average loss all      (Triplet)                 : 0.003743

== Recognize ==
Train average loss Recognize     : 1.100910
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.194223

Epoch 109:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]          Epoch 110:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]Epoch 110:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]Epoch 110:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]Epoch 110:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]Epoch 110:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00509, Train/loss_recog_step=1.140, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]Epoch 110:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00509, Train/loss_recog_step=1.140, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]Epoch 110:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]  Epoch 110:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]Epoch 110:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=1.070, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]Epoch 110:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=1.070, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]Epoch 110:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=0.867, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]Epoch 110:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=0.867, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]Epoch 110:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]  Epoch 110: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]Epoch 110: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.836, Valid/loss_all_step=0.499, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.265, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.592, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.389, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.465, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.64it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.96it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.15it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.14it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069678, 0.069106, 0.068723
Valid average loss UNet            (all)              : 0.207507

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.158768, 3.929991, 6.317175
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.546077, 4.228456, 4.205867
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.516461, 4.180318, 4.320702
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.344983, 4.226455, 5.016633
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.381626, 4.378778, 4.742743
Valid average loss all      (Triplet)                 : 0.416336

== Recognize ==
Valid average loss Recognize     : 0.992352
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.623843

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.06697392463684 sec. =
Valid knn accuracy drums     : 76.3235294117647%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.327155590057373 sec. =
Valid knn accuracy bass      : 15.55232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.444449186325073 sec. =
Valid knn accuracy piano     : 35.67567567567568%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.70176887512207 sec. =
Valid knn accuracy guitar    : 47.72727272727273%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.686070680618286 sec. =
Valid knn accuracy residuals : 58.80503144654088%

Valid knn accuracy average   : 46.81676696852987%

                                                                        [AEpoch 110: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.836, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.100]Epoch 110: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.836, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063149, 0.062734, 0.064005
Train average loss UNet            (all)              : 0.189888

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001079, 3.831687, 6.707694
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003442, 3.529628, 5.170609
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003688, 3.704324, 5.381719
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003450, 3.813036, 5.951450
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003116, 4.016538, 5.741765
Train average loss all      (Triplet)                 : 0.002966

== Recognize ==
Train average loss Recognize     : 1.096203
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.192854

Epoch 110:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.836, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]          Epoch 111:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.836, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 111:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.836, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 111:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]  Epoch 111:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 111:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00362, Train/loss_recog_step=1.130, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 111:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00362, Train/loss_recog_step=1.130, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 111:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=0.790, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 111:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=0.790, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 111:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]  Epoch 111:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 111:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000353, Train/loss_recog_step=0.868, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 111:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000353, Train/loss_recog_step=0.868, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 111:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]   Epoch 111: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 111: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.621, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.375, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.624, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.992, Valid/knn_avr=0.468, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.54it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.68it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.42it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069753, 0.069029, 0.067272
Valid average loss UNet            (all)              : 0.206054

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.123365, 3.706402, 6.068455
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.490888, 4.084301, 4.143294
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.485423, 4.002372, 4.079245
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.222778, 4.076035, 4.874621
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.282826, 4.247684, 4.685394
Valid average loss all      (Triplet)                 : 0.334441

== Recognize ==
Valid average loss Recognize     : 0.990506
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.540495

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.219717264175415 sec. =
Valid knn accuracy drums     : 76.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.586668729782104 sec. =
Valid knn accuracy bass      : 12.354651162790697%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.409743309020996 sec. =
Valid knn accuracy piano     : 27.16216216216216%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.331264734268188 sec. =
Valid knn accuracy guitar    : 49.83766233766234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.472877740859985 sec. =
Valid knn accuracy residuals : 61.63522012578616%

Valid knn accuracy average   : 45.55088033415086%

                                                                        [AEpoch 111: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.100]Epoch 111: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063095, 0.062733, 0.063941
Train average loss UNet            (all)              : 0.189769

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001021, 3.778987, 6.732114
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005509, 3.505487, 5.093767
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003645, 3.608375, 5.215056
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004926, 3.765732, 5.831029
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003477, 3.915016, 5.569228
Train average loss all      (Triplet)                 : 0.003773

== Recognize ==
Train average loss Recognize     : 1.091309
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.193542

Epoch 111:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]          Epoch 112:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]Epoch 112:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]Epoch 112:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.964, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]Epoch 112:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.964, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]Epoch 112:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=1.140, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]Epoch 112:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=1.140, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]Epoch 112:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]  Epoch 112:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]Epoch 112:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]Epoch 112:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]Epoch 112:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00106, Train/loss_recog_step=0.878, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]Epoch 112:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00106, Train/loss_recog_step=0.878, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]Epoch 112:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]  Epoch 112: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]Epoch 112: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=0.840, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.540, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.334, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.456, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.88it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.32it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.11it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.65it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068876, 0.067743, 0.068188
Valid average loss UNet            (all)              : 0.204807

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.154839, 3.737881, 6.191219
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.514181, 3.987826, 3.911188
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.500281, 3.866847, 4.005765
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.253152, 3.964579, 4.707812
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.305499, 4.368960, 4.705028
Valid average loss all      (Triplet)                 : 0.366883

== Recognize ==
Valid average loss Recognize     : 0.987821
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.571690

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.49043869972229 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.049322843551636 sec. =
Valid knn accuracy bass      : 17.587209302325583%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.999994039535522 sec. =
Valid knn accuracy piano     : 29.864864864864867%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.211928367614746 sec. =
Valid knn accuracy guitar    : 46.103896103896105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.783632755279541 sec. =
Valid knn accuracy residuals : 61.16352201257862%

Valid knn accuracy average   : 46.414486692027154%

                                                                        [AEpoch 112: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=0.840, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00377, Train/loss_recog_epoch=1.090]Epoch 112: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=0.840, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063022, 0.062561, 0.063789
Train average loss UNet            (all)              : 0.189371

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001359, 3.672149, 6.508984
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006168, 3.406651, 4.942011
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004497, 3.541587, 5.106845
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003492, 3.644836, 5.602395
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003005, 3.801740, 5.399489
Train average loss all      (Triplet)                 : 0.003668

== Recognize ==
Train average loss Recognize     : 1.097407
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.193040

Epoch 112:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=0.840, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]          Epoch 113:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=0.840, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]Epoch 113:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=0.840, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]Epoch 113:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000609, Train/loss_recog_step=0.959, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]Epoch 113:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000609, Train/loss_recog_step=0.959, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]Epoch 113:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00423, Train/loss_recog_step=1.130, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100] Epoch 113:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00423, Train/loss_recog_step=1.130, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]Epoch 113:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.789, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100] Epoch 113:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.789, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]Epoch 113:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00498, Train/loss_recog_step=1.060, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]Epoch 113:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00498, Train/loss_recog_step=1.060, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]Epoch 113:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]  Epoch 113:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]Epoch 113:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]Epoch 113: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]Epoch 113: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=0.841, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.293, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.572, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.367, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.464, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.69it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.00it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.92it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.17it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068599, 0.070398, 0.067465
Valid average loss UNet            (all)              : 0.206462

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.138232, 3.817511, 6.133775
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.473713, 4.150392, 4.267280
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.473586, 4.052426, 4.085816
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.294369, 4.091585, 4.843832
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.405417, 4.717799, 4.837098
Valid average loss all      (Triplet)                 : 0.364446

== Recognize ==
Valid average loss Recognize     : 0.998045
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.570907

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.206213235855103 sec. =
Valid knn accuracy drums     : 77.64705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.912020921707153 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.448044776916504 sec. =
Valid knn accuracy piano     : 34.18918918918919%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.415386438369751 sec. =
Valid knn accuracy guitar    : 49.67532467532468%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.565009593963623 sec. =
Valid knn accuracy residuals : 60.534591194968556%

Valid knn accuracy average   : 47.46155835799771%

                                                                        [AEpoch 113: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=0.841, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00367, Train/loss_recog_epoch=1.100]Epoch 113: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=0.841, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062856, 0.062601, 0.063791
Train average loss UNet            (all)              : 0.189248

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001076, 3.820023, 6.656454
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004491, 3.526672, 5.153949
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003582, 3.634872, 5.271503
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004716, 3.793134, 5.835793
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003907, 3.945743, 5.611629
Train average loss all      (Triplet)                 : 0.003561

== Recognize ==
Train average loss Recognize     : 1.091018
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.192809

Epoch 113:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=0.841, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]          Epoch 114:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=0.841, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]Epoch 114:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=0.841, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]Epoch 114:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.967, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]  Epoch 114:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.967, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]Epoch 114:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=1.130, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]Epoch 114:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=1.130, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]Epoch 114:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00349, Train/loss_recog_step=0.793, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]Epoch 114:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00349, Train/loss_recog_step=0.793, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]Epoch 114:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]  Epoch 114:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]Epoch 114:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000425, Train/loss_recog_step=0.874, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]Epoch 114:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000425, Train/loss_recog_step=0.874, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]Epoch 114:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]   Epoch 114: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]Epoch 114: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.525, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.282, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.364, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.475, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.41it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.04it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.37it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.63it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068769, 0.070300, 0.067453
Valid average loss UNet            (all)              : 0.206522

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.140414, 4.087092, 6.644068
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.655997, 4.674388, 4.544144
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.619699, 4.532378, 4.490216
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.176068, 4.504803, 5.414685
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.335120, 4.873520, 5.416871
Valid average loss all      (Triplet)                 : 0.419273

== Recognize ==
Valid average loss Recognize     : 0.994996
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.625795

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.062946557998657 sec. =
Valid knn accuracy drums     : 81.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.823293924331665 sec. =
Valid knn accuracy bass      : 12.209302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.278111696243286 sec. =
Valid knn accuracy piano     : 30.945945945945947%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.589943885803223 sec. =
Valid knn accuracy guitar    : 45.2922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.71978759765625 sec. =
Valid knn accuracy residuals : 63.36477987421384%

Valid knn accuracy average   : 46.65656483464862%

                                                                        [AEpoch 114: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00356, Train/loss_recog_epoch=1.090]Epoch 114: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062757, 0.062396, 0.063643
Train average loss UNet            (all)              : 0.188796

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001139, 3.811032, 6.852800
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003883, 3.489415, 5.094018
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002604, 3.615243, 5.215319
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002883, 3.740494, 5.764732
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003090, 3.917224, 5.560155
Train average loss all      (Triplet)                 : 0.002741

== Recognize ==
Train average loss Recognize     : 1.094610
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.191537

Epoch 114:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]          Epoch 115:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]Epoch 115:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]Epoch 115:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=0.962, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]Epoch 115:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=0.962, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]Epoch 115:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]  Epoch 115:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]Epoch 115:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]Epoch 115:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]Epoch 115:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00218, Train/loss_recog_step=1.070, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]Epoch 115:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00218, Train/loss_recog_step=1.070, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]Epoch 115:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]  Epoch 115:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]Epoch 115:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00486, Train/loss_recog_step=1.270, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]Epoch 115: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00486, Train/loss_recog_step=1.270, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]Epoch 115: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=0.700, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.454, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.419, Valid/loss_recog_epoch=0.995, Valid/knn_avr=0.467, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.13it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.01it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.54it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.48it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067546, 0.067889, 0.067179
Valid average loss UNet            (all)              : 0.202614

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143952, 3.726978, 5.998819
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.621342, 4.277675, 4.201737
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.389211, 3.901462, 4.035045
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.316439, 4.193684, 4.784916
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.343074, 4.590292, 4.851089
Valid average loss all      (Triplet)                 : 0.396995

== Recognize ==
Valid average loss Recognize     : 0.989172
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.599609

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.091963052749634 sec. =
Valid knn accuracy drums     : 78.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.891409635543823 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.599811315536499 sec. =
Valid knn accuracy piano     : 34.32432432432432%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.943794965744019 sec. =
Valid knn accuracy guitar    : 43.993506493506494%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.680386781692505 sec. =
Valid knn accuracy residuals : 67.76729559748428%

Valid knn accuracy average   : 48.17940558402061%

                                                                        [AEpoch 115: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.090]Epoch 115: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062686, 0.062315, 0.063557
Train average loss UNet            (all)              : 0.188558

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001568, 3.787617, 6.605535
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005025, 3.543117, 5.187761
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003623, 3.641226, 5.243777
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003351, 3.767157, 5.816632
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002218, 3.939659, 5.618759
Train average loss all      (Triplet)                 : 0.003283

== Recognize ==
Train average loss Recognize     : 1.096860
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.191841

Epoch 115:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]          Epoch 116:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]Epoch 116:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]Epoch 116:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=0.959, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]Epoch 116:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=0.959, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]Epoch 116:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100] Epoch 116:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]Epoch 116:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=8.38e-5, Train/loss_recog_step=0.798, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]Epoch 116:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=8.38e-5, Train/loss_recog_step=0.798, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]Epoch 116:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0084, Train/loss_recog_step=1.070, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100] Epoch 116:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0084, Train/loss_recog_step=1.070, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]Epoch 116:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100] Epoch 116:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]Epoch 116:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=1.290, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]Epoch 116: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=1.290, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]Epoch 116: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.620, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.386, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.600, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.397, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.482, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.15it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.83it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.83it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.82it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.30it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070847, 0.069612, 0.068517
Valid average loss UNet            (all)              : 0.208975

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.121913, 4.070940, 6.521952
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.622768, 4.585565, 4.399076
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.456525, 4.132604, 4.363843
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.332829, 4.410767, 5.232397
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.354876, 4.740504, 5.206732
Valid average loss all      (Triplet)                 : 0.428279

== Recognize ==
Valid average loss Recognize     : 0.998598
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.637254

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.558252334594727 sec. =
Valid knn accuracy drums     : 78.08823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.389848470687866 sec. =
Valid knn accuracy bass      : 12.209302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.45123553276062 sec. =
Valid knn accuracy piano     : 28.243243243243242%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.54746413230896 sec. =
Valid knn accuracy guitar    : 43.18181818181818%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.523343324661255 sec. =
Valid knn accuracy residuals : 61.94968553459119%

Valid knn accuracy average   : 44.73445691587033%

                                                                        [AEpoch 116: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00328, Train/loss_recog_epoch=1.100]Epoch 116: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062632, 0.062250, 0.063489
Train average loss UNet            (all)              : 0.188371

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001773, 3.771781, 6.585497
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004309, 3.515613, 5.150026
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004338, 3.602150, 5.183854
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002544, 3.738356, 5.720170
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002066, 3.930660, 5.604315
Train average loss all      (Triplet)                 : 0.003046

== Recognize ==
Train average loss Recognize     : 1.096359
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.191417

Epoch 116:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]          Epoch 117:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]Epoch 117:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]Epoch 117:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=0.964, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]Epoch 117:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=0.964, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]Epoch 117:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]  Epoch 117:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]Epoch 117:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000956, Train/loss_recog_step=0.802, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]Epoch 117:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000956, Train/loss_recog_step=0.802, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]Epoch 117:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00442, Train/loss_recog_step=1.080, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100] Epoch 117:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00442, Train/loss_recog_step=1.080, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]Epoch 117:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.882, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]  Epoch 117:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.882, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]Epoch 117:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=1.300, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]Epoch 117: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0132, Train/loss_recog_step=1.300, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]Epoch 117: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.857, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.539, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.447, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.53it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.94it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.40it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.74it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.96it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070242, 0.070612, 0.068157
Valid average loss UNet            (all)              : 0.209011

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.137008, 3.697250, 5.844331
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.543651, 4.001081, 3.880344
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.429114, 3.785020, 3.938730
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.299225, 4.007196, 4.716044
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.283449, 4.419050, 4.846216
Valid average loss all      (Triplet)                 : 0.375642

== Recognize ==
Valid average loss Recognize     : 1.003577
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.584653

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.039146423339844 sec. =
Valid knn accuracy drums     : 80.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.579715728759766 sec. =
Valid knn accuracy bass      : 13.226744186046513%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.503807783126831 sec. =
Valid knn accuracy piano     : 36.75675675675676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.238288164138794 sec. =
Valid knn accuracy guitar    : 43.506493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.50588607788086 sec. =
Valid knn accuracy residuals : 58.64779874213837%

Valid knn accuracy average   : 46.54520569711056%

                                                                        [AEpoch 117: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.857, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.100]Epoch 117: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.857, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062440, 0.061996, 0.063319
Train average loss UNet            (all)              : 0.187755

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001588, 3.766103, 6.518296
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004488, 3.507325, 5.164280
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004077, 3.610319, 5.201860
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003228, 3.715188, 5.675437
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003271, 3.909543, 5.549369
Train average loss all      (Triplet)                 : 0.003199

== Recognize ==
Train average loss Recognize     : 1.109114
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.190954

Epoch 117:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.857, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]          Epoch 118:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.857, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]Epoch 118:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.857, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]Epoch 118:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00709, Train/loss_recog_step=0.970, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]Epoch 118:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00709, Train/loss_recog_step=0.970, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]Epoch 118:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]  Epoch 118:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]Epoch 118:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]Epoch 118:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]Epoch 118:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00912, Train/loss_recog_step=1.080, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]Epoch 118:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00912, Train/loss_recog_step=1.080, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]Epoch 118:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00132, Train/loss_recog_step=0.877, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]Epoch 118:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00132, Train/loss_recog_step=0.877, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]Epoch 118:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]  Epoch 118: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]Epoch 118: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.673, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.421, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.585, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.376, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.465, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.82it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.39it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.31it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067893, 0.067308, 0.067101
Valid average loss UNet            (all)              : 0.202302

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143250, 4.206355, 6.629578
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.778057, 4.619306, 4.288282
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.495417, 4.291333, 4.490590
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.266492, 4.522557, 5.528688
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.425825, 4.724512, 5.186319
Valid average loss all      (Triplet)                 : 0.474383

== Recognize ==
Valid average loss Recognize     : 0.988657
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.676685

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.056867361068726 sec. =
Valid knn accuracy drums     : 82.20588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.809268712997437 sec. =
Valid knn accuracy bass      : 13.08139534883721%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.448891401290894 sec. =
Valid knn accuracy piano     : 37.432432432432435%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.691531419754028 sec. =
Valid knn accuracy guitar    : 45.12987012987013%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.433287143707275 sec. =
Valid knn accuracy residuals : 57.38993710691824%

Valid knn accuracy average   : 47.047903474199835%

                                                                        [AEpoch 118: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.0032, Train/loss_recog_epoch=1.110]Epoch 118: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062322, 0.061956, 0.063184
Train average loss UNet            (all)              : 0.187463

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001113, 3.680974, 6.431076
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003162, 3.445006, 5.061224
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003526, 3.547569, 5.135292
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002993, 3.659998, 5.625783
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002391, 3.861595, 5.517476
Train average loss all      (Triplet)                 : 0.002609

== Recognize ==
Train average loss Recognize     : 1.109035
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.190072

Epoch 118:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]          Epoch 119:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00589, Train/loss_recog_step=0.793, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00589, Train/loss_recog_step=0.793, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00369, Train/loss_recog_step=1.070, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00369, Train/loss_recog_step=1.070, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.870, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.870, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=1.280, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110] Epoch 119: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=1.280, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00978, Train/loss_recog_step=0.846, Valid/loss_all_step=0.801, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.565, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.474, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.470, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.97it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.77it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.22it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068383, 0.067166, 0.066653
Valid average loss UNet            (all)              : 0.202201

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.144221, 4.094662, 6.444220
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.679856, 4.529606, 4.300784
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.552558, 4.221877, 4.381376
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.298132, 4.564559, 5.448452
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.444083, 4.822007, 5.226634
Valid average loss all      (Triplet)                 : 0.475496

== Recognize ==
Valid average loss Recognize     : 0.987839
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.677697

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.056121110916138 sec. =
Valid knn accuracy drums     : 75.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.82424807548523 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.888072729110718 sec. =
Valid knn accuracy piano     : 28.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.448202133178711 sec. =
Valid knn accuracy guitar    : 45.616883116883116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.539975643157959 sec. =
Valid knn accuracy residuals : 58.17610062893082%

Valid knn accuracy average   : 44.953082274359666%

                                                                        [AEpoch 119: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00978, Train/loss_recog_step=0.846, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.110]Epoch 119: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00978, Train/loss_recog_step=0.846, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062396, 0.062049, 0.063274
Train average loss UNet            (all)              : 0.187719

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000555, 3.802550, 6.615600
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004344, 3.576101, 5.237135
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004335, 3.657576, 5.253024
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003755, 3.802572, 5.854710
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003060, 4.013174, 5.711872
Train average loss all      (Triplet)                 : 0.003342

== Recognize ==
Train average loss Recognize     : 1.097143
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.191061

Epoch 119:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00978, Train/loss_recog_step=0.846, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]          Epoch 120:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00978, Train/loss_recog_step=0.846, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]Epoch 120:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00978, Train/loss_recog_step=0.846, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]Epoch 120:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0049, Train/loss_recog_step=0.956, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100] Epoch 120:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0049, Train/loss_recog_step=0.956, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]Epoch 120:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=1.140, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]Epoch 120:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00204, Train/loss_recog_step=1.140, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]Epoch 120:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000586, Train/loss_recog_step=0.801, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]Epoch 120:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000586, Train/loss_recog_step=0.801, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]Epoch 120:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00279, Train/loss_recog_step=1.070, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100] Epoch 120:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00279, Train/loss_recog_step=1.070, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]Epoch 120:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.875, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]Epoch 120:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.875, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]Epoch 120:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=1.280, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100] Epoch 120: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=1.280, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]Epoch 120: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.849, Valid/loss_all_step=0.855, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.623, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.475, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.450, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.92it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.56it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.90it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069051, 0.069188, 0.067224
Valid average loss UNet            (all)              : 0.205463

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.108674, 4.094619, 6.485324
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.591677, 4.442217, 4.333418
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.665994, 4.495274, 4.281642
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.324491, 4.430788, 5.207606
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.368971, 4.878276, 5.282226
Valid average loss all      (Triplet)                 : 0.447024

== Recognize ==
Valid average loss Recognize     : 0.998633
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.652488

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.611452579498291 sec. =
Valid knn accuracy drums     : 81.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.003822326660156 sec. =
Valid knn accuracy bass      : 15.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.323315858840942 sec. =
Valid knn accuracy piano     : 29.18918918918919%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.377152442932129 sec. =
Valid knn accuracy guitar    : 46.91558441558442%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.588886260986328 sec. =
Valid knn accuracy residuals : 59.905660377358494%

Valid knn accuracy average   : 46.57657380053038%

                                                                        [AEpoch 120: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.849, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.100]Epoch 120: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.849, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062357, 0.061985, 0.063238
Train average loss UNet            (all)              : 0.187580

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000903, 3.703561, 6.419976
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005429, 3.516660, 5.118020
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003963, 3.606784, 5.197662
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002893, 3.741067, 5.774866
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002748, 3.935676, 5.616223
Train average loss all      (Triplet)                 : 0.003220

== Recognize ==
Train average loss Recognize     : 1.102223
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.190801

Epoch 120:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.849, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]          Epoch 121:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.849, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.849, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.0026, Train/loss_recog_step=0.967, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.0026, Train/loss_recog_step=0.967, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00612, Train/loss_recog_step=1.150, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00612, Train/loss_recog_step=1.150, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00525, Train/loss_recog_step=0.798, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00525, Train/loss_recog_step=0.798, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]  Epoch 121:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.887, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.887, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.852, Valid/loss_all_step=0.741, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.494, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.98it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.57it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.87it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.32it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071387, 0.069401, 0.069954
Valid average loss UNet            (all)              : 0.210742

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.147616, 3.946852, 6.472151
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.567386, 4.141682, 4.216487
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.622659, 4.082979, 3.969353
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.274264, 4.185018, 5.113013
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.440579, 4.651978, 4.738871
Valid average loss all      (Triplet)                 : 0.438852

== Recognize ==
Valid average loss Recognize     : 1.002947
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.649594

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.567245721817017 sec. =
Valid knn accuracy drums     : 80.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.656678199768066 sec. =
Valid knn accuracy bass      : 17.732558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.732447385787964 sec. =
Valid knn accuracy piano     : 32.16216216216216%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.71250319480896 sec. =
Valid knn accuracy guitar    : 43.506493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.544286251068115 sec. =
Valid knn accuracy residuals : 59.11949685534591%

Valid knn accuracy average   : 46.621789191530816%

                                                                        [AEpoch 121: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.852, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00322, Train/loss_recog_epoch=1.100]Epoch 121: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.852, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062323, 0.061959, 0.063177
Train average loss UNet            (all)              : 0.187458

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001985, 4.157065, 7.238358
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003350, 3.895030, 5.684959
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004797, 3.993763, 5.777639
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003929, 4.158204, 6.363428
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003868, 4.386121, 6.227330
Train average loss all      (Triplet)                 : 0.003534

== Recognize ==
Train average loss Recognize     : 1.109690
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.190992

Epoch 121:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.852, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]          Epoch 122:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.852, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.852, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.969, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.969, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=1.140, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0296, Train/loss_recog_step=1.140, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=0.800, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=0.800, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00106, Train/loss_recog_step=1.080, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00106, Train/loss_recog_step=1.080, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=6.75e-5, Train/loss_recog_step=0.882, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=6.75e-5, Train/loss_recog_step=0.882, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]  Epoch 122: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=0.779, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.533, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.650, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.439, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.466, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.12it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.45it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.39it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.87it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073945, 0.073744, 0.072396
Valid average loss UNet            (all)              : 0.220085

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.128945, 3.941825, 6.393423
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.661525, 4.310274, 4.298642
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.576234, 4.232609, 4.277444
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.310092, 4.252131, 5.139239
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.325049, 4.663598, 4.997569
Valid average loss all      (Triplet)                 : 0.455904

== Recognize ==
Valid average loss Recognize     : 0.999427
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.675989

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.326166152954102 sec. =
Valid knn accuracy drums     : 76.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.628725051879883 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.863553285598755 sec. =
Valid knn accuracy piano     : 30.270270270270274%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.980347156524658 sec. =
Valid knn accuracy guitar    : 50.324675324675326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.76113510131836 sec. =
Valid knn accuracy residuals : 63.67924528301887%

Valid knn accuracy average   : 47.201281404047066%

                                                                        [AEpoch 122: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00353, Train/loss_recog_epoch=1.110]Epoch 122: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062181, 0.061868, 0.063037
Train average loss UNet            (all)              : 0.187086

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001394, 3.865752, 6.795826
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004582, 3.615402, 5.275856
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003454, 3.719773, 5.367805
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003880, 3.856639, 5.946384
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003135, 4.029367, 5.727002
Train average loss all      (Triplet)                 : 0.003345

== Recognize ==
Train average loss Recognize     : 1.106085
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.190431

Epoch 122:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]          Epoch 123:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]Epoch 123:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]Epoch 123:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.966, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]Epoch 123:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.966, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]Epoch 123:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00653, Train/loss_recog_step=1.150, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]Epoch 123:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00653, Train/loss_recog_step=1.150, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]Epoch 123:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.800, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]  Epoch 123:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.800, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]Epoch 123:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00779, Train/loss_recog_step=1.070, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]Epoch 123:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00779, Train/loss_recog_step=1.070, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]Epoch 123:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=0.879, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]Epoch 123:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=0.879, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]Epoch 123:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=1.290, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]  Epoch 123: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=1.290, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]Epoch 123: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.884, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.611, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=0.999, Valid/knn_avr=0.472, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.81it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.13it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.40it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068275, 0.068455, 0.066796
Valid average loss UNet            (all)              : 0.203526

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.149670, 4.151331, 6.652116
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.665518, 4.424320, 4.264871
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.576953, 4.355212, 4.483074
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.317104, 4.554006, 5.366118
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.312324, 4.862374, 5.176129
Valid average loss all      (Triplet)                 : 0.455120

== Recognize ==
Valid average loss Recognize     : 1.001758
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.658647

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.532299995422363 sec. =
Valid knn accuracy drums     : 77.64705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.63106918334961 sec. =
Valid knn accuracy bass      : 15.55232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.483396291732788 sec. =
Valid knn accuracy piano     : 35.54054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.410984516143799 sec. =
Valid knn accuracy guitar    : 46.75324675324675%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.827659845352173 sec. =
Valid knn accuracy residuals : 61.63522012578616%

Valid knn accuracy average   : 47.425678364899646%

                                                                        [AEpoch 123: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.110]Epoch 123: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061955, 0.061655, 0.062797
Train average loss UNet            (all)              : 0.186408

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001256, 3.841447, 6.834952
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004626, 3.567961, 5.199275
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003329, 3.675728, 5.331535
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002037, 3.837469, 5.943559
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003346, 3.984363, 5.676757
Train average loss all      (Triplet)                 : 0.002968

== Recognize ==
Train average loss Recognize     : 1.106144
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.189376

Epoch 123:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]          Epoch 124:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 124:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 124:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=0.971, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 124:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=0.971, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 124:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]  Epoch 124:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 124:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.804, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 124:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.804, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 124:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00521, Train/loss_recog_step=1.070, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 124:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00521, Train/loss_recog_step=1.070, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 124:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00214, Train/loss_recog_step=0.879, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 124:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00214, Train/loss_recog_step=0.879, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 124:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=1.290, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110] Epoch 124: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=1.290, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 124: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.817, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.575, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.659, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.474, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.19it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.15it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.70it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.66it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.66it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069803, 0.069786, 0.069399
Valid average loss UNet            (all)              : 0.208989

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.140777, 4.011329, 6.588578
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.550096, 4.319266, 4.262733
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.578083, 4.259994, 4.217494
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.409559, 4.405563, 5.178647
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.324403, 4.669095, 5.256985
Valid average loss all      (Triplet)                 : 0.432154

== Recognize ==
Valid average loss Recognize     : 1.002792
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.641143

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.186349153518677 sec. =
Valid knn accuracy drums     : 77.20588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.747103452682495 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.33985161781311 sec. =
Valid knn accuracy piano     : 24.324324324324326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.578989028930664 sec. =
Valid knn accuracy guitar    : 50.81168831168831%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.051013946533203 sec. =
Valid knn accuracy residuals : 58.490566037735846%

Valid knn accuracy average   : 44.8409108099891%

                                                                        [AEpoch 124: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00297, Train/loss_recog_epoch=1.110]Epoch 124: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062036, 0.061747, 0.062937
Train average loss UNet            (all)              : 0.186720

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000522, 3.939522, 6.981022
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005606, 3.694372, 5.337229
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004218, 3.790516, 5.463782
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003794, 3.902345, 6.006205
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002375, 4.090494, 5.830821
Train average loss all      (Triplet)                 : 0.003442

== Recognize ==
Train average loss Recognize     : 1.107740
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.190162

Epoch 124:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]          Epoch 125:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]Epoch 125:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]Epoch 125:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00258, Train/loss_recog_step=0.973, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]Epoch 125:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00258, Train/loss_recog_step=0.973, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]Epoch 125:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]  Epoch 125:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]Epoch 125:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000693, Train/loss_recog_step=0.802, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]Epoch 125:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000693, Train/loss_recog_step=0.802, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]Epoch 125:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]   Epoch 125:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]Epoch 125:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]Epoch 125:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]Epoch 125:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]Epoch 125: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]Epoch 125: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.442, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.432, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.93it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.38it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.28it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.66it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.31it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067342, 0.068294, 0.067433
Valid average loss UNet            (all)              : 0.203070

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.129758, 4.072962, 6.505740
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.636099, 4.389357, 4.251421
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.474589, 4.107852, 4.406574
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.340993, 4.493552, 5.398841
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.369966, 4.634665, 5.092849
Valid average loss all      (Triplet)                 : 0.430902

== Recognize ==
Valid average loss Recognize     : 1.006375
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.633971

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.402013063430786 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.749041080474854 sec. =
Valid knn accuracy bass      : 14.970930232558139%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.508683443069458 sec. =
Valid knn accuracy piano     : 30.945945945945947%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.494910955429077 sec. =
Valid knn accuracy guitar    : 46.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.479569911956787 sec. =
Valid knn accuracy residuals : 62.893081761006286%

Valid knn accuracy average   : 46.518294108910474%

                                                                        [AEpoch 125: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00344, Train/loss_recog_epoch=1.110]Epoch 125: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062065, 0.061674, 0.062892
Train average loss UNet            (all)              : 0.186631

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001021, 3.932698, 7.023516
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003914, 3.685436, 5.364819
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004666, 3.805701, 5.521262
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002182, 3.911578, 6.052929
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002886, 4.079605, 5.812849
Train average loss all      (Triplet)                 : 0.003063

== Recognize ==
Train average loss Recognize     : 1.110238
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.189695

Epoch 125:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]          Epoch 126:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]Epoch 126:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]Epoch 126:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00883, Train/loss_recog_step=0.974, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]Epoch 126:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00883, Train/loss_recog_step=0.974, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]Epoch 126:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=1.150, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]Epoch 126:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=1.150, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]Epoch 126:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]  Epoch 126:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]Epoch 126:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00728, Train/loss_recog_step=1.080, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]Epoch 126:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00728, Train/loss_recog_step=1.080, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]Epoch 126:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.887, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]  Epoch 126:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.887, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]Epoch 126:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]Epoch 126: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]Epoch 126: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.492, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.431, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.465, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.08it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.84it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.00it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.97it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071319, 0.072576, 0.070846
Valid average loss UNet            (all)              : 0.214740

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.107718, 3.812696, 6.007017
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.544323, 4.203239, 4.173329
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.473995, 4.077241, 4.267230
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.319473, 4.180139, 4.951365
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.426151, 4.574592, 4.713646
Valid average loss all      (Triplet)                 : 0.403864

== Recognize ==
Valid average loss Recognize     : 1.003551
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.618604

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.789201021194458 sec. =
Valid knn accuracy drums     : 76.61764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.172994375228882 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.209111452102661 sec. =
Valid knn accuracy piano     : 29.594594594594593%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.444075107574463 sec. =
Valid knn accuracy guitar    : 50.324675324675326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.118849277496338 sec. =
Valid knn accuracy residuals : 60.691823899371066%

Valid knn accuracy average   : 46.846910966190585%

                                                                        [AEpoch 126: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.110]Epoch 126: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061773, 0.061473, 0.062614
Train average loss UNet            (all)              : 0.185860

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000516, 3.826727, 6.706910
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004090, 3.600810, 5.254471
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002416, 3.728284, 5.424166
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001650, 3.837280, 5.971188
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002952, 4.022708, 5.738006
Train average loss all      (Triplet)                 : 0.002412

== Recognize ==
Train average loss Recognize     : 1.111105
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.188272

Epoch 126:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]          Epoch 127:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00422, Train/loss_recog_step=1.150, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00422, Train/loss_recog_step=1.150, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00264, Train/loss_recog_step=0.799, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00264, Train/loss_recog_step=0.799, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]  Epoch 127:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=0.851, Valid/loss_all_step=0.664, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.412, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.619, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.404, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.468, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.85it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.22it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.01it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.64it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068693, 0.068191, 0.067354
Valid average loss UNet            (all)              : 0.204239

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.106752, 3.876970, 6.189064
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.559079, 4.217752, 4.191116
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.566417, 4.136765, 4.190096
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.298215, 4.154628, 4.867308
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.383807, 4.730937, 5.110753
Valid average loss all      (Triplet)                 : 0.413872

== Recognize ==
Valid average loss Recognize     : 1.004160
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.618110

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.49369192123413 sec. =
Valid knn accuracy drums     : 77.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.752131223678589 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.582035541534424 sec. =
Valid knn accuracy piano     : 32.027027027027025%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.614546775817871 sec. =
Valid knn accuracy guitar    : 50.649350649350644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.937106609344482 sec. =
Valid knn accuracy residuals : 61.32075471698113%

Valid knn accuracy average   : 47.323708284417314%

                                                                        [AEpoch 127: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=0.851, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00241, Train/loss_recog_epoch=1.110]Epoch 127: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=0.851, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061752, 0.061435, 0.062556
Train average loss UNet            (all)              : 0.185743

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000873, 3.900878, 6.829193
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003992, 3.677315, 5.382201
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002543, 3.782996, 5.489084
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003062, 3.924298, 6.104609
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002902, 4.122580, 5.920852
Train average loss all      (Triplet)                 : 0.002729

== Recognize ==
Train average loss Recognize     : 1.106590
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.188472

Epoch 127:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=0.851, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]          Epoch 128:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=0.851, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]Epoch 128:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=0.851, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]Epoch 128:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]  Epoch 128:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]Epoch 128:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00742, Train/loss_recog_step=1.150, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]Epoch 128:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00742, Train/loss_recog_step=1.150, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]Epoch 128:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]  Epoch 128:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]Epoch 128:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]Epoch 128:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]Epoch 128:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]Epoch 128:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]Epoch 128:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=1.300, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]Epoch 128: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=1.300, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]Epoch 128: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=0.683, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.443, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.618, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.414, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.473, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.18it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.03it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.30it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.88it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070407, 0.069509, 0.068709
Valid average loss UNet            (all)              : 0.208624

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.169424, 3.985023, 6.533161
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.532569, 4.410398, 4.412625
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.498702, 4.159752, 4.188926
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.315225, 4.505569, 5.347330
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.371048, 4.745550, 4.960800
Valid average loss all      (Triplet)                 : 0.394762

== Recognize ==
Valid average loss Recognize     : 1.008345
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.603386

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.625367641448975 sec. =
Valid knn accuracy drums     : 75.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.819125890731812 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.670567512512207 sec. =
Valid knn accuracy piano     : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.563228845596313 sec. =
Valid knn accuracy guitar    : 44.31818181818182%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.804078340530396 sec. =
Valid knn accuracy residuals : 61.32075471698113%

Valid knn accuracy average   : 44.006378278304815%

                                                                        [AEpoch 128: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00273, Train/loss_recog_epoch=1.110]Epoch 128: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061740, 0.061408, 0.062625
Train average loss UNet            (all)              : 0.185773

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001072, 3.908854, 6.817204
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004446, 3.650355, 5.350584
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003411, 3.758850, 5.428147
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002523, 3.879156, 6.006213
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003116, 4.061228, 5.785275
Train average loss all      (Triplet)                 : 0.003035

== Recognize ==
Train average loss Recognize     : 1.109760
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.188808

Epoch 128:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]          Epoch 129:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]Epoch 129:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]Epoch 129:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00374, Train/loss_recog_step=0.982, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]Epoch 129:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00374, Train/loss_recog_step=0.982, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]Epoch 129:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]  Epoch 129:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]Epoch 129:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]Epoch 129:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]Epoch 129:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0036, Train/loss_recog_step=1.090, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]Epoch 129:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0036, Train/loss_recog_step=1.090, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]Epoch 129:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.0002, Train/loss_recog_step=0.887, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]Epoch 129:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.0002, Train/loss_recog_step=0.887, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]Epoch 129:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110] Epoch 129: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]Epoch 129: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.598, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.346, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.603, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.395, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.440, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.32it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.99it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.60it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.36it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.81it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067910, 0.067372, 0.066563
Valid average loss UNet            (all)              : 0.201845

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.175928, 3.964579, 6.108389
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.583239, 4.220261, 4.110639
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.620492, 3.986416, 3.984513
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.390970, 4.257513, 4.987095
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.327498, 4.486151, 4.810610
Valid average loss all      (Triplet)                 : 0.458029

== Recognize ==
Valid average loss Recognize     : 1.011680
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.659875

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.087455749511719 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.341065406799316 sec. =
Valid knn accuracy bass      : 12.354651162790697%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.991554260253906 sec. =
Valid knn accuracy piano     : 32.972972972972975%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.641871690750122 sec. =
Valid knn accuracy guitar    : 46.75324675324675%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.710682392120361 sec. =
Valid knn accuracy residuals : 61.94968553459119%

Valid knn accuracy average   : 46.364934814132084%

                                                                        [AEpoch 129: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.110]Epoch 129: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061742, 0.061382, 0.062558
Train average loss UNet            (all)              : 0.185682

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000560, 3.909731, 6.838337
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005053, 3.701593, 5.387067
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003368, 3.814984, 5.534120
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002584, 3.906056, 6.053839
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002660, 4.097929, 5.871858
Train average loss all      (Triplet)                 : 0.002988

== Recognize ==
Train average loss Recognize     : 1.119273
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.188670

Epoch 129:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]          Epoch 130:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 130:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 130:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=0.980, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 130:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00355, Train/loss_recog_step=0.980, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 130:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]  Epoch 130:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 130:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=0.810, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 130:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=0.810, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 130:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120] Epoch 130:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 130:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 130:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 130:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00517, Train/loss_recog_step=1.310, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 130: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00517, Train/loss_recog_step=1.310, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 130: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.591, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.660, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.464, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.93it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.85it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.04it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.43it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.43it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069389, 0.068431, 0.068070
Valid average loss UNet            (all)              : 0.205890

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.163852, 4.170479, 6.682190
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.662465, 4.485784, 4.340144
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.551916, 4.211241, 4.328678
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.309929, 4.391244, 5.504757
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.331927, 4.601946, 5.114227
Valid average loss all      (Triplet)                 : 0.451977

== Recognize ==
Valid average loss Recognize     : 1.008966
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.657867

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.130727529525757 sec. =
Valid knn accuracy drums     : 73.6764705882353%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.440765619277954 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.005088329315186 sec. =
Valid knn accuracy piano     : 30.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.48675537109375 sec. =
Valid knn accuracy guitar    : 48.214285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.037402629852295 sec. =
Valid knn accuracy residuals : 60.691823899371066%

Valid knn accuracy average   : 45.33628348223888%

                                                                        [AEpoch 130: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 130: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061481, 0.061204, 0.062369
Train average loss UNet            (all)              : 0.185054

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000572, 3.765969, 6.575650
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003129, 3.522519, 5.151228
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002496, 3.669561, 5.333593
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001980, 3.746883, 5.830911
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002069, 3.945968, 5.648865
Train average loss all      (Triplet)                 : 0.002094

== Recognize ==
Train average loss Recognize     : 1.122817
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.187147

Epoch 130:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]          Epoch 131:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]Epoch 131:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]Epoch 131:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]Epoch 131:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]Epoch 131:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=1.160, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]Epoch 131:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00696, Train/loss_recog_step=1.160, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]Epoch 131:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]  Epoch 131:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.804, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]Epoch 131:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]Epoch 131:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]Epoch 131:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.887, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]Epoch 131:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.887, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]Epoch 131:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]  Epoch 131: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]Epoch 131: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.844, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.453, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.76it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.63it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.68it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067466, 0.067456, 0.066415
Valid average loss UNet            (all)              : 0.201337

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.165492, 4.521413, 7.070763
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.635452, 4.694072, 4.714916
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.566685, 4.501592, 4.582323
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.410750, 4.825451, 5.727323
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.338710, 4.979513, 5.593491
Valid average loss all      (Triplet)                 : 0.471292

== Recognize ==
Valid average loss Recognize     : 1.004047
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.672629

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.848802328109741 sec. =
Valid knn accuracy drums     : 76.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.209741592407227 sec. =
Valid knn accuracy bass      : 13.80813953488372%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.437314987182617 sec. =
Valid knn accuracy piano     : 32.83783783783784%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.42380666732788 sec. =
Valid knn accuracy guitar    : 47.564935064935064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.284411907196045 sec. =
Valid knn accuracy residuals : 61.16352201257862%

Valid knn accuracy average   : 46.28076924298822%

                                                                        [AEpoch 131: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00209, Train/loss_recog_epoch=1.120]Epoch 131: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061561, 0.061175, 0.062372
Train average loss UNet            (all)              : 0.185108

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000455, 4.076686, 7.086189
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005085, 3.830753, 5.533355
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001342, 3.966488, 5.781466
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003064, 4.059034, 6.286605
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002431, 4.250324, 6.059787
Train average loss all      (Triplet)                 : 0.002533

== Recognize ==
Train average loss Recognize     : 1.117500
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.187642

Epoch 131:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]          Epoch 132:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00555, Train/loss_recog_step=1.300, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00555, Train/loss_recog_step=1.300, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.697, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.471, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.463, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.68it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.17it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.36it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.20it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.55it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067879, 0.068171, 0.067482
Valid average loss UNet            (all)              : 0.203532

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.157349, 4.269122, 6.704688
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.593971, 4.562396, 4.519120
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.628082, 4.385863, 4.534098
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.260094, 4.622454, 5.669839
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.367725, 4.891780, 5.236902
Valid average loss all      (Triplet)                 : 0.436826

== Recognize ==
Valid average loss Recognize     : 1.007755
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.640358

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.842342615127563 sec. =
Valid knn accuracy drums     : 77.20588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.130721092224121 sec. =
Valid knn accuracy bass      : 15.11627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.465826749801636 sec. =
Valid knn accuracy piano     : 35.67567567567568%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.719283103942871 sec. =
Valid knn accuracy guitar    : 53.57142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.130493402481079 sec. =
Valid knn accuracy residuals : 64.30817610062893%

Valid knn accuracy average   : 49.17548835408835%

                                                                        [AEpoch 132: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00253, Train/loss_recog_epoch=1.120]Epoch 132: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061450, 0.061046, 0.062278
Train average loss UNet            (all)              : 0.184774

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001027, 4.103329, 7.152522
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003653, 3.862054, 5.667047
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002036, 4.009404, 5.822451
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002940, 4.117619, 6.398478
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002951, 4.311498, 6.111274
Train average loss all      (Triplet)                 : 0.002552

== Recognize ==
Train average loss Recognize     : 1.109694
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.187326

Epoch 132:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]          Epoch 133:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]Epoch 133:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.852, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]Epoch 133:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]Epoch 133:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]Epoch 133:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]Epoch 133:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]Epoch 133:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.807, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]Epoch 133:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.807, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]Epoch 133:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00387, Train/loss_recog_step=1.100, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]Epoch 133:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00387, Train/loss_recog_step=1.100, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]Epoch 133:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0249, Train/loss_recog_step=0.894, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110] Epoch 133:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0249, Train/loss_recog_step=0.894, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]Epoch 133:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110] Epoch 133: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]Epoch 133: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.545, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.492, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.53it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.70it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.62it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067974, 0.068413, 0.067412
Valid average loss UNet            (all)              : 0.203800

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.161383, 4.300571, 6.469433
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.575763, 4.582112, 4.614893
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.636263, 4.340354, 4.304150
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.430967, 4.671361, 5.440563
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.343165, 4.691720, 5.245001
Valid average loss all      (Triplet)                 : 0.475785

== Recognize ==
Valid average loss Recognize     : 1.015362
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.679585

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.6632661819458 sec. =
Valid knn accuracy drums     : 74.55882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.768078804016113 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.250011920928955 sec. =
Valid knn accuracy piano     : 27.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.351385354995728 sec. =
Valid knn accuracy guitar    : 46.590909090909086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.768089532852173 sec. =
Valid knn accuracy residuals : 59.905660377358494%

Valid knn accuracy average   : 45.06557262844851%

                                                                        [AEpoch 133: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00255, Train/loss_recog_epoch=1.110]Epoch 133: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061323, 0.061048, 0.062184
Train average loss UNet            (all)              : 0.184555

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001547, 3.999583, 6.945230
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003293, 3.712664, 5.433511
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003928, 3.799578, 5.501560
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002721, 3.968449, 6.160733
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001787, 4.090271, 5.792943
Train average loss all      (Triplet)                 : 0.002682

== Recognize ==
Train average loss Recognize     : 1.117562
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.187237

Epoch 133:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]          Epoch 134:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000267, Train/loss_recog_step=0.891, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000267, Train/loss_recog_step=0.891, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]   Epoch 134: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.949, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.476, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.451, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.60it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.04it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.65it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069620, 0.069405, 0.067616
Valid average loss UNet            (all)              : 0.206641

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.206005, 4.473586, 6.882123
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.564687, 4.590857, 4.610345
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.681144, 4.508341, 4.501711
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.263686, 4.738992, 5.648885
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.339119, 4.825673, 5.179233
Valid average loss all      (Triplet)                 : 0.441910

== Recognize ==
Valid average loss Recognize     : 1.010638
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.648551

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.49311876296997 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.942697286605835 sec. =
Valid knn accuracy bass      : 13.953488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.190775871276855 sec. =
Valid knn accuracy piano     : 31.891891891891895%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.446478366851807 sec. =
Valid knn accuracy guitar    : 48.86363636363637%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.744113445281982 sec. =
Valid knn accuracy residuals : 61.16352201257862%

Valid knn accuracy average   : 46.88039008098116%

                                                                        [AEpoch 134: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00268, Train/loss_recog_epoch=1.120]Epoch 134: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061294, 0.060981, 0.062175
Train average loss UNet            (all)              : 0.184450

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001354, 4.214185, 7.458011
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003570, 3.882276, 5.652506
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002828, 3.992056, 5.775581
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002584, 4.123545, 6.415402
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003067, 4.358740, 6.213544
Train average loss all      (Triplet)                 : 0.002774

== Recognize ==
Train average loss Recognize     : 1.119788
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.187223

Epoch 134:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]          Epoch 135:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00921, Train/loss_recog_step=1.160, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00921, Train/loss_recog_step=1.160, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00513, Train/loss_recog_step=0.806, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00513, Train/loss_recog_step=0.806, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00551, Train/loss_recog_step=1.090, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00551, Train/loss_recog_step=1.090, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=0.888, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=0.888, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]  Epoch 135: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000977, Train/loss_recog_step=0.856, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.515, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.469, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.95it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.89it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.49it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.22it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067987, 0.068564, 0.067509
Valid average loss UNet            (all)              : 0.204059

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.153192, 4.335568, 6.985835
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.590845, 4.518672, 4.619144
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.677765, 4.395352, 4.393639
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.303976, 4.649601, 5.599806
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.330846, 4.819520, 5.390262
Valid average loss all      (Triplet)                 : 0.448136

== Recognize ==
Valid average loss Recognize     : 1.014263
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.652195

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.248913049697876 sec. =
Valid knn accuracy drums     : 75.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.95488715171814 sec. =
Valid knn accuracy bass      : 15.11627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.863912105560303 sec. =
Valid knn accuracy piano     : 25.54054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.11145544052124 sec. =
Valid knn accuracy guitar    : 46.75324675324675%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.96237850189209 sec. =
Valid knn accuracy residuals : 60.534591194968556%

Valid knn accuracy average   : 44.647755041116426%

                                                                        [AEpoch 135: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000977, Train/loss_recog_step=0.856, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00277, Train/loss_recog_epoch=1.120]Epoch 135: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000977, Train/loss_recog_step=0.856, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061345, 0.061034, 0.062167
Train average loss UNet            (all)              : 0.184546

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000947, 4.134506, 7.227034
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004280, 3.850746, 5.622228
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002777, 3.918206, 5.668848
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002280, 4.055019, 6.309779
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002766, 4.257736, 6.063332
Train average loss all      (Triplet)                 : 0.002671

== Recognize ==
Train average loss Recognize     : 1.115156
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.187217

Epoch 135:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000977, Train/loss_recog_step=0.856, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]          Epoch 136:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000977, Train/loss_recog_step=0.856, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]Epoch 136:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000977, Train/loss_recog_step=0.856, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]Epoch 136:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.977, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120] Epoch 136:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=0.977, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]Epoch 136:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]  Epoch 136:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]Epoch 136:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.803, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]Epoch 136:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.803, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]Epoch 136:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]Epoch 136:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]Epoch 136:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]Epoch 136:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]Epoch 136:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]Epoch 136: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]Epoch 136: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=0.811, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.566, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.448, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.446, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.98it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.13it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.48it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067740, 0.067038, 0.066737
Valid average loss UNet            (all)              : 0.201515

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.204746, 4.360128, 6.683215
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.590536, 4.524435, 4.574608
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.695415, 4.552762, 4.520003
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.386971, 4.782484, 5.512306
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.365634, 4.917925, 5.342363
Valid average loss all      (Triplet)                 : 0.495387

== Recognize ==
Valid average loss Recognize     : 1.008155
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.696902

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.07097315788269 sec. =
Valid knn accuracy drums     : 74.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.547672271728516 sec. =
Valid knn accuracy bass      : 12.645348837209303%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.613146305084229 sec. =
Valid knn accuracy piano     : 32.432432432432435%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.16745138168335 sec. =
Valid knn accuracy guitar    : 46.75324675324675%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.382304430007935 sec. =
Valid knn accuracy residuals : 62.57861635220125%

Valid knn accuracy average   : 45.85251711031207%

                                                                        [AEpoch 136: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.120]Epoch 136: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061282, 0.060947, 0.062042
Train average loss UNet            (all)              : 0.184271

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000618, 4.249202, 7.471573
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004664, 3.978321, 5.818849
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002844, 4.054599, 5.832897
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003579, 4.208710, 6.489700
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002103, 4.393082, 6.286476
Train average loss all      (Triplet)                 : 0.002757

== Recognize ==
Train average loss Recognize     : 1.110990
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.187029

Epoch 136:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]          Epoch 137:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00583, Train/loss_recog_step=0.805, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00583, Train/loss_recog_step=0.805, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00458, Train/loss_recog_step=1.080, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00458, Train/loss_recog_step=1.080, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]  Epoch 137:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.938, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.495, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.459, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.10it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.47it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.01it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.94it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.14it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069622, 0.068670, 0.068412
Valid average loss UNet            (all)              : 0.206704

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.202874, 4.499265, 6.944503
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.676030, 4.747714, 4.750758
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.617352, 4.563869, 4.760783
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.329020, 4.644409, 5.596547
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.353227, 4.985920, 5.488952
Valid average loss all      (Triplet)                 : 0.500462

== Recognize ==
Valid average loss Recognize     : 1.006831
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.707166

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.375419855117798 sec. =
Valid knn accuracy drums     : 74.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.738307476043701 sec. =
Valid knn accuracy bass      : 15.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.495044469833374 sec. =
Valid knn accuracy piano     : 33.108108108108105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.837650775909424 sec. =
Valid knn accuracy guitar    : 49.35064935064935%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.628906965255737 sec. =
Valid knn accuracy residuals : 61.0062893081761%

Valid knn accuracy average   : 46.832202239843625%

                                                                        [AEpoch 137: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.110]Epoch 137: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061146, 0.060883, 0.062039
Train average loss UNet            (all)              : 0.184068

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002039, 4.038036, 7.108488
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003351, 3.786425, 5.539033
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003397, 3.922026, 5.673823
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001769, 4.002847, 6.217749
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003563, 4.182850, 5.971059
Train average loss all      (Triplet)                 : 0.002829

== Recognize ==
Train average loss Recognize     : 1.109075
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.186898

Epoch 137:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]          Epoch 138:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]Epoch 138:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]Epoch 138:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.973, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]Epoch 138:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=0.973, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]Epoch 138:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00788, Train/loss_recog_step=1.150, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]Epoch 138:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00788, Train/loss_recog_step=1.150, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]Epoch 138:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0028, Train/loss_recog_step=0.808, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110] Epoch 138:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0028, Train/loss_recog_step=0.808, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]Epoch 138:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00203, Train/loss_recog_step=1.080, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]Epoch 138:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00203, Train/loss_recog_step=1.080, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]Epoch 138:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]  Epoch 138:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]Epoch 138:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000641, Train/loss_recog_step=1.310, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]Epoch 138: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000641, Train/loss_recog_step=1.310, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]Epoch 138: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00377, Train/loss_recog_step=0.855, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.787, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.468, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.95it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.83it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.67it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.58it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.42it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068164, 0.070427, 0.068733
Valid average loss UNet            (all)              : 0.207324

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143140, 4.398838, 7.205508
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.654557, 4.676325, 4.613895
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.656400, 4.553001, 4.690065
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.514668, 4.645910, 5.386641
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.333594, 4.722942, 5.313338
Valid average loss all      (Triplet)                 : 0.525641

== Recognize ==
Valid average loss Recognize     : 1.013995
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.732965

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.958611488342285 sec. =
Valid knn accuracy drums     : 76.3235294117647%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.702624797821045 sec. =
Valid knn accuracy bass      : 13.08139534883721%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.922507524490356 sec. =
Valid knn accuracy piano     : 32.2972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.384556293487549 sec. =
Valid knn accuracy guitar    : 50.97402597402597%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.578028917312622 sec. =
Valid knn accuracy residuals : 63.67924528301887%

Valid knn accuracy average   : 47.271098662988805%

                                                                        [AEpoch 138: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00377, Train/loss_recog_step=0.855, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00283, Train/loss_recog_epoch=1.110]Epoch 138: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00377, Train/loss_recog_step=0.855, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061095, 0.060775, 0.061979
Train average loss UNet            (all)              : 0.183849

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001395, 4.079377, 7.305804
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003210, 3.788532, 5.561643
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002651, 3.897700, 5.662614
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003331, 3.977129, 6.139739
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002433, 4.178888, 5.983924
Train average loss all      (Triplet)                 : 0.002597

== Recognize ==
Train average loss Recognize     : 1.112801
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.186446

Epoch 138:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00377, Train/loss_recog_step=0.855, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]          Epoch 139:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00377, Train/loss_recog_step=0.855, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]Epoch 139:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00377, Train/loss_recog_step=0.855, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]Epoch 139:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]  Epoch 139:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.989, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]Epoch 139:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00655, Train/loss_recog_step=1.160, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]Epoch 139:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00655, Train/loss_recog_step=1.160, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]Epoch 139:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]  Epoch 139:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]Epoch 139:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00451, Train/loss_recog_step=1.090, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]Epoch 139:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00451, Train/loss_recog_step=1.090, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]Epoch 139:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00226, Train/loss_recog_step=0.894, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]Epoch 139:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00226, Train/loss_recog_step=0.894, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]Epoch 139:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=1.310, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]Epoch 139: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=1.310, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]Epoch 139: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.903, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.733, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.473, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.24it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.56it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.11it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.64it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.40it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067626, 0.068797, 0.066278
Valid average loss UNet            (all)              : 0.202701

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.129943, 4.723449, 7.860247
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.630070, 5.111357, 5.030967
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.642444, 4.698123, 4.723300
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.289779, 4.893168, 6.012738
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.323663, 5.142278, 5.788005
Valid average loss all      (Triplet)                 : 0.454688

== Recognize ==
Valid average loss Recognize     : 1.015646
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.657389

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.019441366195679 sec. =
Valid knn accuracy drums     : 75.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.716628551483154 sec. =
Valid knn accuracy bass      : 12.209302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.504644870758057 sec. =
Valid knn accuracy piano     : 31.756756756756754%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.28136920928955 sec. =
Valid knn accuracy guitar    : 51.13636363636363%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.375322341918945 sec. =
Valid knn accuracy residuals : 59.74842767295597%

Valid knn accuracy average   : 46.11722890186097%

                                                                        [AEpoch 139: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0026, Train/loss_recog_epoch=1.110]Epoch 139: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061057, 0.060760, 0.061943
Train average loss UNet            (all)              : 0.183760

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000738, 4.498569, 8.012174
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002308, 4.165550, 6.123386
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002625, 4.277075, 6.207092
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003171, 4.408508, 6.837003
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002952, 4.586350, 6.509343
Train average loss all      (Triplet)                 : 0.002393

== Recognize ==
Train average loss Recognize     : 1.121462
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.186153

Epoch 139:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]          Epoch 140:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=1.160, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=1.160, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00398, Train/loss_recog_step=0.807, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00398, Train/loss_recog_step=0.807, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00351, Train/loss_recog_step=1.090, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00351, Train/loss_recog_step=1.090, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]  Epoch 140:  96%|█████████▌| 300/313 [04:15<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140:  96%|█████████▌| 300/313 [04:15<00:11,  1.18it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=1.310, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=1.310, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140: 100%|██████████| 313/313 [04:24<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.867, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.635, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.455, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.461, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.20it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.38it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.97it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.60it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070067, 0.072536, 0.070558
Valid average loss UNet            (all)              : 0.213161

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.171170, 4.368329, 6.943135
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.589304, 4.784637, 4.754866
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.613565, 4.445677, 4.521883
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.289017, 4.568283, 5.749181
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.354074, 4.817039, 5.593979
Valid average loss all      (Triplet)                 : 0.457921

== Recognize ==
Valid average loss Recognize     : 1.009312
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.671082

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.190737962722778 sec. =
Valid knn accuracy drums     : 76.61764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.940742492675781 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.394151210784912 sec. =
Valid knn accuracy piano     : 28.64864864864865%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.796226263046265 sec. =
Valid knn accuracy guitar    : 51.298701298701296%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.4736008644104 sec. =
Valid knn accuracy residuals : 60.22012578616353%

Valid knn accuracy average   : 46.176792000327865%

                                                                        [AEpoch 140: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00239, Train/loss_recog_epoch=1.120]Epoch 140: 100%|██████████| 313/313 [05:57<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061096, 0.060692, 0.061930
Train average loss UNet            (all)              : 0.183719

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000573, 4.476795, 8.047475
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004208, 4.167111, 6.088579
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003112, 4.296706, 6.185080
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003612, 4.389524, 6.848382
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002020, 4.611442, 6.590236
Train average loss all      (Triplet)                 : 0.002809

== Recognize ==
Train average loss Recognize     : 1.118085
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.186528

Epoch 140:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]          Epoch 141:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.813, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00576, Train/loss_recog_step=1.320, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00576, Train/loss_recog_step=1.320, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.689, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.462, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.01it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.47it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.60it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.93it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.17it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070743, 0.073806, 0.072617
Valid average loss UNet            (all)              : 0.217166

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.123507, 4.403380, 6.584297
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.595895, 4.783703, 4.717882
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.637715, 4.521380, 4.538507
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.284567, 4.629363, 5.700120
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.396900, 4.834567, 5.338909
Valid average loss all      (Triplet)                 : 0.452479

== Recognize ==
Valid average loss Recognize     : 1.019774
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.669645

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.385622024536133 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.200329780578613 sec. =
Valid knn accuracy bass      : 16.71511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.303110361099243 sec. =
Valid knn accuracy piano     : 31.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.52974247932434 sec. =
Valid knn accuracy guitar    : 48.86363636363637%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.295733213424683 sec. =
Valid knn accuracy residuals : 58.17610062893082%

Valid knn accuracy average   : 46.98705968453407%

                                                                        [AEpoch 141: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.120]Epoch 141: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060828, 0.060599, 0.061811
Train average loss UNet            (all)              : 0.183237

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000840, 4.292118, 7.533916
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002973, 4.020392, 5.892949
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003896, 4.156324, 6.030320
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002209, 4.263345, 6.632295
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002232, 4.486225, 6.417578
Train average loss all      (Triplet)                 : 0.002500

== Recognize ==
Train average loss Recognize     : 1.122639
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.185737

Epoch 141:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]          Epoch 142:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]Epoch 142:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]Epoch 142:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.991, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]Epoch 142:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.991, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]Epoch 142:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120] Epoch 142:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]Epoch 142:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.814, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]Epoch 142:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.814, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]Epoch 142:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00672, Train/loss_recog_step=1.100, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]Epoch 142:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00672, Train/loss_recog_step=1.100, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]Epoch 142:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00467, Train/loss_recog_step=0.902, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]Epoch 142:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00467, Train/loss_recog_step=0.902, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]Epoch 142:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=1.320, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120] Epoch 142: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=1.320, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]Epoch 142: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.825, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.569, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.452, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.470, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.42it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.19it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.21it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068936, 0.069453, 0.068807
Valid average loss UNet            (all)              : 0.207196

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.112841, 4.635329, 7.376034
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.634969, 5.070354, 4.963624
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.559094, 4.567949, 4.703087
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.381396, 4.819879, 5.749909
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.448829, 5.209702, 5.570043
Valid average loss all      (Triplet)                 : 0.469083

== Recognize ==
Valid average loss Recognize     : 1.022030
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.676279

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.005684614181519 sec. =
Valid knn accuracy drums     : 81.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.722187519073486 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.993386507034302 sec. =
Valid knn accuracy piano     : 25.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.41410756111145 sec. =
Valid knn accuracy guitar    : 49.35064935064935%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.535649061203003 sec. =
Valid knn accuracy residuals : 61.16352201257862%

Valid knn accuracy average   : 47.14456718202557%

                                                                        [AEpoch 142: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.120]Epoch 142: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060729, 0.060450, 0.061659
Train average loss UNet            (all)              : 0.182838

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001340, 4.273745, 7.467084
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001694, 3.990523, 5.923220
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002343, 4.136062, 6.001199
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002840, 4.244347, 6.622852
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002017, 4.464978, 6.386752
Train average loss all      (Triplet)                 : 0.001970

== Recognize ==
Train average loss Recognize     : 1.126740
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.184808

Epoch 142:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]          Epoch 143:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.991, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.991, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.018, Train/loss_recog_step=1.170, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.018, Train/loss_recog_step=1.170, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.818, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.818, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.007, Train/loss_recog_step=1.100, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.007, Train/loss_recog_step=1.100, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000713, Train/loss_recog_step=1.330, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000713, Train/loss_recog_step=1.330, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.759, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.471, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.29it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.97it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.93it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.18it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.97it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.87it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067178, 0.068248, 0.066405
Valid average loss UNet            (all)              : 0.201831

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.110350, 4.544368, 7.128019
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.630033, 5.009752, 4.944927
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.768504, 4.883507, 4.858960
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.334902, 4.963398, 6.027217
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.472796, 5.201215, 5.458437
Valid average loss all      (Triplet)                 : 0.511787

== Recognize ==
Valid average loss Recognize     : 1.027243
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.713618

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.194647550582886 sec. =
Valid knn accuracy drums     : 80.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.93132734298706 sec. =
Valid knn accuracy bass      : 17.587209302325583%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.469010591506958 sec. =
Valid knn accuracy piano     : 32.16216216216216%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.276641607284546 sec. =
Valid knn accuracy guitar    : 50.649350649350644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.049917697906494 sec. =
Valid knn accuracy residuals : 60.84905660377359%

Valid knn accuracy average   : 48.337791037640045%

                                                                        [AEpoch 143: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.130]Epoch 143: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060882, 0.060588, 0.061787
Train average loss UNet            (all)              : 0.183257

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001792, 4.414115, 7.948235
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005098, 4.148932, 6.134984
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002393, 4.245185, 6.154120
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002515, 4.398349, 6.892462
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001681, 4.565497, 6.534340
Train average loss all      (Triplet)                 : 0.002593

== Recognize ==
Train average loss Recognize     : 1.131115
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.185850

Epoch 143:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]          Epoch 144:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]Epoch 144:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]Epoch 144:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.996, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]Epoch 144:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.996, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]Epoch 144:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=1.170, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]Epoch 144:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=1.170, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]Epoch 144:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0023, Train/loss_recog_step=0.814, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130] Epoch 144:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0023, Train/loss_recog_step=0.814, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]Epoch 144:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130] Epoch 144:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]Epoch 144:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=0.896, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]Epoch 144:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=0.896, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]Epoch 144:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]  Epoch 144: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]Epoch 144: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.934, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.512, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.483, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.13it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.85it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.60it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.47it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067653, 0.069101, 0.066796
Valid average loss UNet            (all)              : 0.203549

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.178067, 4.417774, 6.873820
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.582333, 4.851276, 4.940174
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.677068, 4.475280, 4.469575
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.272497, 4.578369, 5.347560
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.444506, 4.909676, 5.349487
Valid average loss all      (Triplet)                 : 0.463964

== Recognize ==
Valid average loss Recognize     : 1.019483
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.667513

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.574788808822632 sec. =
Valid knn accuracy drums     : 81.91176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.00956106185913 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.500738620758057 sec. =
Valid knn accuracy piano     : 30.675675675675674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.621421575546265 sec. =
Valid knn accuracy guitar    : 50.324675324675326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.643622398376465 sec. =
Valid knn accuracy residuals : 60.37735849056604%

Valid knn accuracy average   : 48.40789483935987%

                                                                        [AEpoch 144: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.130]Epoch 144: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060942, 0.060658, 0.061778
Train average loss UNet            (all)              : 0.183378

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000863, 4.348680, 7.552731
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004144, 4.121917, 6.062845
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004797, 4.200787, 6.077286
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002225, 4.316824, 6.708012
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003347, 4.547021, 6.491293
Train average loss all      (Triplet)                 : 0.003028

== Recognize ==
Train average loss Recognize     : 1.129138
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.186406

Epoch 144:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]          Epoch 145:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]Epoch 145:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]Epoch 145:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00617, Train/loss_recog_step=0.987, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]Epoch 145:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00617, Train/loss_recog_step=0.987, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]Epoch 145:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000729, Train/loss_recog_step=1.170, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]Epoch 145:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000729, Train/loss_recog_step=1.170, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]Epoch 145:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]   Epoch 145:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]Epoch 145:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]Epoch 145:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]Epoch 145:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000616, Train/loss_recog_step=0.897, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]Epoch 145:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000616, Train/loss_recog_step=0.897, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]Epoch 145:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00954, Train/loss_recog_step=1.320, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130] Epoch 145: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00954, Train/loss_recog_step=1.320, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]Epoch 145: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.519, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.19it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.64it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.36it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.19it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.21it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066783, 0.066996, 0.066038
Valid average loss UNet            (all)              : 0.199817

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.162668, 4.266010, 6.685839
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.546999, 4.606805, 4.820405
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.672737, 4.552458, 4.586236
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.228214, 4.500655, 5.325634
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.359729, 4.851455, 5.294734
Valid average loss all      (Triplet)                 : 0.435430

== Recognize ==
Valid average loss Recognize     : 1.022497
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.635247

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.164899826049805 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.994768142700195 sec. =
Valid knn accuracy bass      : 14.825581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.602954626083374 sec. =
Valid knn accuracy piano     : 32.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.97822117805481 sec. =
Valid knn accuracy guitar    : 50.81168831168831%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.351816415786743 sec. =
Valid knn accuracy residuals : 63.83647798742138%

Valid knn accuracy average   : 48.141172432373416%

                                                                        [AEpoch 145: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00303, Train/loss_recog_epoch=1.130]Epoch 145: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060623, 0.060305, 0.061504
Train average loss UNet            (all)              : 0.182432

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001332, 4.006845, 6.994662
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003788, 3.799339, 5.610996
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002505, 3.869763, 5.617902
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001781, 3.965533, 6.144946
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001803, 4.219212, 6.061152
Train average loss all      (Triplet)                 : 0.002245

== Recognize ==
Train average loss Recognize     : 1.126513
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.184676

Epoch 145:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]          Epoch 146:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]Epoch 146:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]Epoch 146:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00149, Train/loss_recog_step=0.990, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]Epoch 146:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00149, Train/loss_recog_step=0.990, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]Epoch 146:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]  Epoch 146:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]Epoch 146:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.812, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]Epoch 146:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.812, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]Epoch 146:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]  Epoch 146:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]Epoch 146:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]Epoch 146:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]Epoch 146:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]Epoch 146: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]Epoch 146: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000203, Train/loss_recog_step=0.861, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.19it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.06it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.76it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.17it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.11it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067420, 0.066698, 0.065791
Valid average loss UNet            (all)              : 0.199908

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.146910, 4.328105, 6.776395
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.586945, 4.689127, 4.719759
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.612756, 4.470140, 4.602515
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.267603, 4.387886, 5.361203
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.310060, 4.797706, 5.122224
Valid average loss all      (Triplet)                 : 0.428531

== Recognize ==
Valid average loss Recognize     : 1.023189
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.628439

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.11801528930664 sec. =
Valid knn accuracy drums     : 80.88235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.721611976623535 sec. =
Valid knn accuracy bass      : 17.151162790697676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.41197419166565 sec. =
Valid knn accuracy piano     : 33.108108108108105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.402562856674194 sec. =
Valid knn accuracy guitar    : 48.701298701298704%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.656934976577759 sec. =
Valid knn accuracy residuals : 63.05031446540881%

Valid knn accuracy average   : 48.57864740133795%

                                                                        [AEpoch 146: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000203, Train/loss_recog_step=0.861, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.130]Epoch 146: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000203, Train/loss_recog_step=0.861, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060425, 0.060167, 0.061323
Train average loss UNet            (all)              : 0.181914

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000342, 3.991482, 7.091588
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002470, 3.739174, 5.532514
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002168, 3.859544, 5.635892
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001370, 3.938549, 6.128915
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002610, 4.152439, 5.958239
Train average loss all      (Triplet)                 : 0.001899

== Recognize ==
Train average loss Recognize     : 1.127327
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183813

Epoch 146:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000203, Train/loss_recog_step=0.861, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]          Epoch 147:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000203, Train/loss_recog_step=0.861, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]Epoch 147:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000203, Train/loss_recog_step=0.861, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]Epoch 147:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.993, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]   Epoch 147:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.993, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]Epoch 147:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]Epoch 147:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]Epoch 147:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.814, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]Epoch 147:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.814, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]Epoch 147:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=1.100, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]Epoch 147:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=1.100, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]Epoch 147:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.894, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]  Epoch 147:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.894, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]Epoch 147:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]Epoch 147: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]Epoch 147: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.516, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.628, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.486, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.93it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.69it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.08it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067957, 0.069695, 0.069588
Valid average loss UNet            (all)              : 0.207241

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.238374, 4.466082, 6.741518
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.572815, 4.842932, 4.916252
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.668578, 4.683415, 4.676095
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.307917, 4.575006, 5.377737
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.361132, 4.996877, 5.374175
Valid average loss all      (Triplet)                 : 0.457583

== Recognize ==
Valid average loss Recognize     : 1.018806
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.664824

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.125942707061768 sec. =
Valid knn accuracy drums     : 81.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.69443416595459 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.920536041259766 sec. =
Valid knn accuracy piano     : 33.24324324324324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.469874382019043 sec. =
Valid knn accuracy guitar    : 47.72727272727273%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.400885343551636 sec. =
Valid knn accuracy residuals : 59.11949685534591%

Valid knn accuracy average   : 47.626073700603285%

                                                                        [AEpoch 147: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.130]Epoch 147: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060350, 0.060044, 0.061204
Train average loss UNet            (all)              : 0.181598

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000550, 4.190414, 7.432076
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002085, 3.935453, 5.835921
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002386, 4.066562, 5.946682
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001551, 4.130653, 6.417007
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001498, 4.368943, 6.247230
Train average loss all      (Triplet)                 : 0.001628

== Recognize ==
Train average loss Recognize     : 1.127052
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183227

Epoch 147:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]          Epoch 148:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.861, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=1.100, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=1.100, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]  Epoch 148:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.458, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.32it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.92it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.44it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067331, 0.067261, 0.066751
Valid average loss UNet            (all)              : 0.201343

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.209103, 4.100013, 6.234496
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.571115, 4.399598, 4.459568
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.641539, 4.352971, 4.303014
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.247577, 4.278546, 5.093650
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.383654, 4.542662, 5.102491
Valid average loss all      (Triplet)                 : 0.444442

== Recognize ==
Valid average loss Recognize     : 1.012006
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.645785

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.081949710845947 sec. =
Valid knn accuracy drums     : 81.61764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.835527181625366 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.422406911849976 sec. =
Valid knn accuracy piano     : 34.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.39069414138794 sec. =
Valid knn accuracy guitar    : 46.75324675324675%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.016318082809448 sec. =
Valid knn accuracy residuals : 55.503144654088054%

Valid knn accuracy average   : 46.60274609675147%

                                                                        [AEpoch 148: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00163, Train/loss_recog_epoch=1.130]Epoch 148: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060461, 0.060197, 0.061293
Train average loss UNet            (all)              : 0.181952

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000404, 4.032125, 6.956189
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002218, 3.826091, 5.658787
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002629, 3.941994, 5.715082
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002697, 4.038959, 6.281741
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002452, 4.229956, 6.060589
Train average loss all      (Triplet)                 : 0.002115

== Recognize ==
Train average loss Recognize     : 1.125714
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.184066

Epoch 148:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]          Epoch 149:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]Epoch 149:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]Epoch 149:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]Epoch 149:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]Epoch 149:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00227, Train/loss_recog_step=1.160, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]Epoch 149:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00227, Train/loss_recog_step=1.160, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]Epoch 149:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=0.810, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130] Epoch 149:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=0.810, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]Epoch 149:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130] Epoch 149:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]Epoch 149:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]Epoch 149:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]Epoch 149:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000914, Train/loss_recog_step=1.310, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]Epoch 149: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000914, Train/loss_recog_step=1.310, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]Epoch 149: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.773, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.538, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.646, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.444, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.77it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.62it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.82it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067349, 0.066503, 0.065181
Valid average loss UNet            (all)              : 0.199033

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.173443, 4.329758, 6.707817
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.516075, 4.424191, 4.574718
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.647147, 4.595225, 4.583384
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.317850, 4.590103, 5.353838
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.398081, 4.875987, 5.351538
Valid average loss all      (Triplet)                 : 0.450227

== Recognize ==
Valid average loss Recognize     : 1.015160
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.649260

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.306421518325806 sec. =
Valid knn accuracy drums     : 77.64705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.667876243591309 sec. =
Valid knn accuracy bass      : 17.587209302325583%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.260313034057617 sec. =
Valid knn accuracy piano     : 35.810810810810814%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.399875402450562 sec. =
Valid knn accuracy guitar    : 45.94155844155844%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.363533735275269 sec. =
Valid knn accuracy residuals : 60.84905660377359%

Valid knn accuracy average   : 47.56713879639957%

                                                                        [AEpoch 149: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00211, Train/loss_recog_epoch=1.130]Epoch 149: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060409, 0.060001, 0.061222
Train average loss UNet            (all)              : 0.181633

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000346, 4.147126, 7.375560
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004612, 3.931197, 5.785167
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002516, 4.000447, 5.834225
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001575, 4.113166, 6.450275
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002079, 4.281407, 6.121014
Train average loss all      (Triplet)                 : 0.002277

== Recognize ==
Train average loss Recognize     : 1.124023
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183909

Epoch 149:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]          Epoch 150:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00656, Train/loss_recog_step=1.170, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00656, Train/loss_recog_step=1.170, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=0.814, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=0.814, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]  Epoch 150:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=0.893, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=0.893, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00141, Train/loss_recog_step=1.310, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00141, Train/loss_recog_step=1.310, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.789, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.556, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.476, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.29it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.85it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.30it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.38it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.48it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072080, 0.069188, 0.068905
Valid average loss UNet            (all)              : 0.210172

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.207575, 4.859147, 7.287622
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.557683, 5.033018, 5.183592
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.659831, 5.170715, 5.279567
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.336626, 5.198692, 5.976765
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.434995, 5.366101, 5.981917
Valid average loss all      (Triplet)                 : 0.477622

== Recognize ==
Valid average loss Recognize     : 1.016961
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.687794

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.257059574127197 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.95938491821289 sec. =
Valid knn accuracy bass      : 17.296511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.406479597091675 sec. =
Valid knn accuracy piano     : 33.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.401131868362427 sec. =
Valid knn accuracy guitar    : 46.75324675324675%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.674315214157104 sec. =
Valid knn accuracy residuals : 60.84905660377359%

Valid knn accuracy average   : 47.36132102560231%

                                                                        [AEpoch 150: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.120]Epoch 150: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060250, 0.059937, 0.061049
Train average loss UNet            (all)              : 0.181237

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000693, 4.241454, 7.407129
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002282, 3.995204, 5.902084
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002287, 4.120738, 6.004426
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002646, 4.183309, 6.480854
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001683, 4.425668, 6.361615
Train average loss all      (Triplet)                 : 0.001989

== Recognize ==
Train average loss Recognize     : 1.127067
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183226

Epoch 150:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]          Epoch 151:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]Epoch 151:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]Epoch 151:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]Epoch 151:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]Epoch 151:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000473, Train/loss_recog_step=1.160, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]Epoch 151:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000473, Train/loss_recog_step=1.160, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]Epoch 151:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.806, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]   Epoch 151:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.806, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]Epoch 151:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000408, Train/loss_recog_step=1.090, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]Epoch 151:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000408, Train/loss_recog_step=1.090, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]Epoch 151:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00497, Train/loss_recog_step=0.881, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130] Epoch 151:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00497, Train/loss_recog_step=0.881, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]Epoch 151:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]  Epoch 151: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]Epoch 151: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.858, Valid/loss_all_step=0.793, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.546, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.474, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.20it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.75it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.68it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.11it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.10it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067833, 0.067074, 0.065797
Valid average loss UNet            (all)              : 0.200703

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.187171, 4.443060, 6.915526
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.549509, 4.547282, 4.641051
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.438678, 4.574794, 4.681322
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.305866, 4.523250, 5.347656
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.400061, 4.870912, 5.435193
Valid average loss all      (Triplet)                 : 0.410864

== Recognize ==
Valid average loss Recognize     : 1.005869
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.611567

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.699647188186646 sec. =
Valid knn accuracy drums     : 81.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.79714322090149 sec. =
Valid knn accuracy bass      : 19.62209302325581%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.718653440475464 sec. =
Valid knn accuracy piano     : 39.054054054054056%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.411234378814697 sec. =
Valid knn accuracy guitar    : 47.24025974025974%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.553298711776733 sec. =
Valid knn accuracy residuals : 60.534591194968556%

Valid knn accuracy average   : 49.58431724956645%

                                                                        [AEpoch 151: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.858, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00199, Train/loss_recog_epoch=1.130]Epoch 151: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.858, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060473, 0.060132, 0.061227
Train average loss UNet            (all)              : 0.181832

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000667, 4.333886, 7.508552
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004658, 4.098373, 5.982824
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004269, 4.251774, 6.157740
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003051, 4.304365, 6.649096
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002650, 4.545397, 6.501494
Train average loss all      (Triplet)                 : 0.002987

== Recognize ==
Train average loss Recognize     : 1.120378
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.184819

Epoch 151:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.858, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]          Epoch 152:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.858, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 152:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=0.858, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 152:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]  Epoch 152:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 152:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 152:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 152:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.812, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 152:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=0.812, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 152:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120] Epoch 152:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 152:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000935, Train/loss_recog_step=0.898, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 152:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000935, Train/loss_recog_step=0.898, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 152:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]   Epoch 152: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 152: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.654, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.418, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.612, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.496, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.16it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.78it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.05it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.41it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.34it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069230, 0.069875, 0.067992
Valid average loss UNet            (all)              : 0.207097

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.138544, 4.354307, 6.498375
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.482487, 4.656528, 4.725273
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.538547, 4.601561, 4.859545
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.388328, 4.573928, 5.396706
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.396376, 5.000427, 5.554101
Valid average loss all      (Triplet)                 : 0.420085

== Recognize ==
Valid average loss Recognize     : 1.019863
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.627181

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.240495443344116 sec. =
Valid knn accuracy drums     : 81.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.716859579086304 sec. =
Valid knn accuracy bass      : 20.203488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.590994596481323 sec. =
Valid knn accuracy piano     : 33.78378378378378%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.514272212982178 sec. =
Valid knn accuracy guitar    : 49.35064935064935%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.78940725326538 sec. =
Valid knn accuracy residuals : 57.54716981132076%

Valid knn accuracy average   : 48.41231238121644%

                                                                        [AEpoch 152: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00299, Train/loss_recog_epoch=1.120]Epoch 152: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060295, 0.060049, 0.061136
Train average loss UNet            (all)              : 0.181480

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001076, 4.271682, 7.372615
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002506, 4.051229, 5.974049
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003298, 4.176283, 6.063894
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002044, 4.251691, 6.608079
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002743, 4.460444, 6.391449
Train average loss all      (Triplet)                 : 0.002296

== Recognize ==
Train average loss Recognize     : 1.127172
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183776

Epoch 152:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]          Epoch 153:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]Epoch 153:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]Epoch 153:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.985, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]Epoch 153:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.985, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]Epoch 153:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130] Epoch 153:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]Epoch 153:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]Epoch 153:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]Epoch 153:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]Epoch 153:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]Epoch 153:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00326, Train/loss_recog_step=0.895, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]Epoch 153:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00326, Train/loss_recog_step=0.895, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]Epoch 153:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]  Epoch 153: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]Epoch 153: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.868, Valid/loss_all_step=0.627, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.385, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.17it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.74it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.88it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.37it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068126, 0.066584, 0.066220
Valid average loss UNet            (all)              : 0.200930

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.158445, 4.568875, 7.267099
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.484892, 4.782363, 4.998537
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.574338, 4.819423, 4.973032
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.332207, 4.917168, 5.887215
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.395689, 5.012977, 5.538159
Valid average loss all      (Triplet)                 : 0.425577

== Recognize ==
Valid average loss Recognize     : 1.014885
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.626507

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.26498556137085 sec. =
Valid knn accuracy drums     : 81.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.021414041519165 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.002631425857544 sec. =
Valid knn accuracy piano     : 33.108108108108105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.39881682395935 sec. =
Valid knn accuracy guitar    : 51.13636363636363%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.596803188323975 sec. =
Valid knn accuracy residuals : 61.16352201257862%

Valid knn accuracy average   : 48.51525128218982%

                                                                        [AEpoch 153: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.868, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.130]Epoch 153: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.868, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060428, 0.060094, 0.061204
Train average loss UNet            (all)              : 0.181726

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000951, 4.383285, 7.704893
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004253, 4.108675, 6.025648
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002367, 4.230712, 6.198935
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001709, 4.346853, 6.731212
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002570, 4.522311, 6.481942
Train average loss all      (Triplet)                 : 0.002504

== Recognize ==
Train average loss Recognize     : 1.129654
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.184230

Epoch 153:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.868, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]          Epoch 154:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.868, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.868, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=0.983, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=0.983, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]  Epoch 154:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.807, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.807, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00104, Train/loss_recog_step=1.090, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00104, Train/loss_recog_step=1.090, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00732, Train/loss_recog_step=0.886, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00732, Train/loss_recog_step=0.886, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000615, Train/loss_recog_step=1.300, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000615, Train/loss_recog_step=1.300, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=0.707, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.474, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.426, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.485, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.95it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.56it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.70it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.99it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.03it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067647, 0.067796, 0.066714
Valid average loss UNet            (all)              : 0.202157

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.148918, 4.573515, 7.152088
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.689547, 4.947324, 4.774689
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.701124, 4.789818, 4.861146
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.343615, 4.875552, 5.853673
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.379074, 5.071728, 5.452315
Valid average loss all      (Triplet)                 : 0.527665

== Recognize ==
Valid average loss Recognize     : 1.007874
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.729823

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.955826759338379 sec. =
Valid knn accuracy drums     : 79.26470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.882199764251709 sec. =
Valid knn accuracy bass      : 16.71511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.585806369781494 sec. =
Valid knn accuracy piano     : 28.243243243243242%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.96294641494751 sec. =
Valid knn accuracy guitar    : 50.97402597402597%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.580305576324463 sec. =
Valid knn accuracy residuals : 59.905660377358494%

Valid knn accuracy average   : 47.020550351210076%

                                                                        [AEpoch 154: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0025, Train/loss_recog_epoch=1.130]Epoch 154: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060307, 0.059934, 0.061081
Train average loss UNet            (all)              : 0.181322

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001031, 4.492873, 7.753304
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002832, 4.254710, 6.275022
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002674, 4.395518, 6.398740
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002024, 4.462139, 6.896310
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002752, 4.686689, 6.683462
Train average loss all      (Triplet)                 : 0.002214

== Recognize ==
Train average loss Recognize     : 1.122332
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183536

Epoch 154:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]          Epoch 155:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000853, Train/loss_recog_step=1.160, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000853, Train/loss_recog_step=1.160, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.803, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]   Epoch 155:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.803, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.883, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.883, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00759, Train/loss_recog_step=0.858, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.470, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.13it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.15it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  6.00it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066879, 0.067209, 0.065509
Valid average loss UNet            (all)              : 0.199597

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.187254, 4.966091, 7.934827
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.625239, 5.343322, 5.340335
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.553041, 5.215394, 5.533193
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.350228, 5.336664, 6.496292
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.462078, 5.499737, 6.219339
Valid average loss all      (Triplet)                 : 0.478460

== Recognize ==
Valid average loss Recognize     : 1.010329
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.678057

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.325265407562256 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.68390679359436 sec. =
Valid knn accuracy bass      : 23.401162790697676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.477235078811646 sec. =
Valid knn accuracy piano     : 30.810810810810814%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.108909845352173 sec. =
Valid knn accuracy guitar    : 50.324675324675326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.264585733413696 sec. =
Valid knn accuracy residuals : 65.09433962264151%

Valid knn accuracy average   : 49.48502123917683%

                                                                        [AEpoch 155: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00759, Train/loss_recog_step=0.858, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.120]Epoch 155: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00759, Train/loss_recog_step=0.858, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060139, 0.059827, 0.060900
Train average loss UNet            (all)              : 0.180867

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001106, 4.421609, 7.880802
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001732, 4.148928, 6.105996
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003119, 4.284365, 6.211901
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001975, 4.391925, 6.861696
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001512, 4.578153, 6.538495
Train average loss all      (Triplet)                 : 0.001952

== Recognize ==
Train average loss Recognize     : 1.116079
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.182819

Epoch 155:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00759, Train/loss_recog_step=0.858, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]          Epoch 156:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00759, Train/loss_recog_step=0.858, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00759, Train/loss_recog_step=0.858, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]  Epoch 156:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.807, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.807, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.755, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.495, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.10it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.07it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.04it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.79it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.27it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070640, 0.068799, 0.068112
Valid average loss UNet            (all)              : 0.207551

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.168861, 4.769591, 7.446548
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.674964, 5.126311, 5.062898
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.760940, 5.130343, 5.129011
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.268386, 5.158068, 6.093110
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.470014, 5.446674, 6.095898
Valid average loss all      (Triplet)                 : 0.528452

== Recognize ==
Valid average loss Recognize     : 1.023929
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.736003

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.413036823272705 sec. =
Valid knn accuracy drums     : 80.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.760099172592163 sec. =
Valid knn accuracy bass      : 21.36627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.15484619140625 sec. =
Valid knn accuracy piano     : 30.270270270270274%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.43336534500122 sec. =
Valid knn accuracy guitar    : 45.45454545454545%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.27277946472168 sec. =
Valid knn accuracy residuals : 62.893081761006286%

Valid knn accuracy average   : 48.026247075823775%

                                                                        [AEpoch 156: 100%|██████████| 313/313 [06:01<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.120]Epoch 156: 100%|██████████| 313/313 [06:01<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060363, 0.060092, 0.061125
Train average loss UNet            (all)              : 0.181580

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000785, 4.603620, 8.135612
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004934, 4.357465, 6.400442
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004601, 4.478716, 6.501396
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002223, 4.556999, 7.063516
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003710, 4.786567, 6.816037
Train average loss all      (Triplet)                 : 0.003235

== Recognize ==
Train average loss Recognize     : 1.124760
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.184815

Epoch 156:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]          Epoch 157:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]Epoch 157:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]Epoch 157:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=0.992, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]Epoch 157:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=0.992, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]Epoch 157:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120] Epoch 157:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]Epoch 157:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00482, Train/loss_recog_step=0.811, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]Epoch 157:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00482, Train/loss_recog_step=0.811, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]Epoch 157:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]  Epoch 157:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]Epoch 157:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]Epoch 157:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]Epoch 157:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]Epoch 157: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]Epoch 157: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.480, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.19it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.67it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.76it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067328, 0.065934, 0.065767
Valid average loss UNet            (all)              : 0.199030

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.154276, 4.399289, 6.992734
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.606663, 4.805020, 4.784823
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.677856, 4.709703, 4.788547
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.249065, 4.814787, 5.696458
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.417892, 4.778208, 5.435009
Valid average loss all      (Triplet)                 : 0.467293

== Recognize ==
Valid average loss Recognize     : 1.018185
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.666322

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.051700353622437 sec. =
Valid knn accuracy drums     : 79.26470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.602250814437866 sec. =
Valid knn accuracy bass      : 17.732558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.854995250701904 sec. =
Valid knn accuracy piano     : 31.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.492516040802002 sec. =
Valid knn accuracy guitar    : 48.214285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.750206708908081 sec. =
Valid knn accuracy residuals : 61.79245283018868%

Valid knn accuracy average   : 47.725124837596766%

                                                                        [AEpoch 157: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00323, Train/loss_recog_epoch=1.120]Epoch 157: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060084, 0.059723, 0.060838
Train average loss UNet            (all)              : 0.180645

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000523, 4.281222, 7.471313
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003927, 4.029553, 5.960590
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002977, 4.182663, 6.098405
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001319, 4.221982, 6.540260
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001974, 4.425132, 6.365958
Train average loss all      (Triplet)                 : 0.002278

== Recognize ==
Train average loss Recognize     : 1.128628
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.182924

Epoch 157:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]          Epoch 158:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]Epoch 158:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]Epoch 158:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]Epoch 158:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]Epoch 158:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]Epoch 158:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]Epoch 158:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00052, Train/loss_recog_step=0.812, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]Epoch 158:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00052, Train/loss_recog_step=0.812, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]Epoch 158:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]  Epoch 158:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]Epoch 158:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=4.09e-5, Train/loss_recog_step=0.896, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]Epoch 158:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=4.09e-5, Train/loss_recog_step=0.896, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]Epoch 158:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]  Epoch 158: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]Epoch 158: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.866, Valid/loss_all_step=0.870, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.638, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.666, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.477, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.33it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.07it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.71it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.48it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.43it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067261, 0.066404, 0.066317
Valid average loss UNet            (all)              : 0.199982

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.108303, 4.325499, 7.149685
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.704979, 4.866601, 4.751303
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.647043, 4.672635, 4.726925
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.245743, 4.765451, 5.648446
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.426015, 4.849899, 5.309396
Valid average loss all      (Triplet)                 : 0.482558

== Recognize ==
Valid average loss Recognize     : 1.022899
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.682541

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.2238187789917 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.78162169456482 sec. =
Valid knn accuracy bass      : 20.63953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.63096833229065 sec. =
Valid knn accuracy piano     : 33.648648648648646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.575743198394775 sec. =
Valid knn accuracy guitar    : 47.88961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.740086555480957 sec. =
Valid knn accuracy residuals : 63.67924528301887%

Valid knn accuracy average   : 48.87729019394095%

                                                                        [AEpoch 158: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.866, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00228, Train/loss_recog_epoch=1.130]Epoch 158: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.866, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059788, 0.059539, 0.060670
Train average loss UNet            (all)              : 0.179997

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001003, 4.308043, 7.598904
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001451, 4.066161, 6.032637
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002387, 4.175959, 6.127337
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002921, 4.306939, 6.669528
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001595, 4.438186, 6.375634
Train average loss all      (Triplet)                 : 0.001880

== Recognize ==
Train average loss Recognize     : 1.130672
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.181877

Epoch 158:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.866, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]          Epoch 159:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.866, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.866, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.170, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.170, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.807, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.807, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.890, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.890, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=1.320, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=1.320, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00686, Train/loss_recog_step=0.862, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.672, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.489, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.53it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.81it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.48it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.15it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072603, 0.070834, 0.070364
Valid average loss UNet            (all)              : 0.213802

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.151878, 4.514290, 7.084282
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.801998, 4.900437, 4.697000
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.681895, 4.915868, 4.824542
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.214603, 5.021305, 5.817700
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.439483, 4.903208, 5.395200
Valid average loss all      (Triplet)                 : 0.530962

== Recognize ==
Valid average loss Recognize     : 1.016621
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.744763

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.188470363616943 sec. =
Valid knn accuracy drums     : 78.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.701842069625854 sec. =
Valid knn accuracy bass      : 18.023255813953487%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.452400922775269 sec. =
Valid knn accuracy piano     : 34.054054054054056%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.397931575775146 sec. =
Valid knn accuracy guitar    : 47.07792207792208%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.453242301940918 sec. =
Valid knn accuracy residuals : 63.05031446540881%

Valid knn accuracy average   : 48.0881681057971%

                                                                        [AEpoch 159: 100%|██████████| 313/313 [06:01<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00686, Train/loss_recog_step=0.862, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.130]Epoch 159: 100%|██████████| 313/313 [06:01<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00686, Train/loss_recog_step=0.862, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059810, 0.059518, 0.060654
Train average loss UNet            (all)              : 0.179983

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000663, 4.276464, 7.571718
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003077, 4.044606, 6.016314
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002288, 4.187872, 6.178547
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002316, 4.284551, 6.684442
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001154, 4.436708, 6.384360
Train average loss all      (Triplet)                 : 0.001927

== Recognize ==
Train average loss Recognize     : 1.128331
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.181910

Epoch 159:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00686, Train/loss_recog_step=0.862, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]          Epoch 160:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00686, Train/loss_recog_step=0.862, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]Epoch 160:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00686, Train/loss_recog_step=0.862, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]Epoch 160:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]  Epoch 160:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]Epoch 160:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=1.170, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]Epoch 160:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=1.170, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]Epoch 160:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.811, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]  Epoch 160:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.811, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]Epoch 160:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]Epoch 160:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]Epoch 160:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]Epoch 160:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]Epoch 160:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]Epoch 160: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]Epoch 160: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000338, Train/loss_recog_step=0.866, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.858, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.481, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.33it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.89it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.93it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.11it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.48it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.02it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066625, 0.066790, 0.066102
Valid average loss UNet            (all)              : 0.199518

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.170014, 4.980394, 7.254148
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.850053, 5.554713, 5.265613
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.807632, 5.404085, 5.290378
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.220661, 5.250169, 6.316132
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.553028, 5.504160, 6.095633
Valid average loss all      (Triplet)                 : 0.588275

== Recognize ==
Valid average loss Recognize     : 1.023096
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.787793

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.431426286697388 sec. =
Valid knn accuracy drums     : 82.20588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.824078559875488 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.695417404174805 sec. =
Valid knn accuracy piano     : 35.270270270270274%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.687777280807495 sec. =
Valid knn accuracy guitar    : 48.37662337662338%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.752203941345215 sec. =
Valid knn accuracy residuals : 61.47798742138365%

Valid knn accuracy average   : 48.547548033080915%

                                                                        [AEpoch 160: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000338, Train/loss_recog_step=0.866, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.130]Epoch 160: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000338, Train/loss_recog_step=0.866, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059676, 0.059335, 0.060542
Train average loss UNet            (all)              : 0.179553

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000186, 4.474863, 7.830236
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001302, 4.248637, 6.350038
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001915, 4.376954, 6.449903
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001354, 4.512440, 7.080518
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001361, 4.650797, 6.694838
Train average loss all      (Triplet)                 : 0.001262

== Recognize ==
Train average loss Recognize     : 1.130270
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.180815

Epoch 160:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000338, Train/loss_recog_step=0.866, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]          Epoch 161:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000338, Train/loss_recog_step=0.866, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]Epoch 161:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000338, Train/loss_recog_step=0.866, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]Epoch 161:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00995, Train/loss_recog_step=0.991, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130] Epoch 161:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00995, Train/loss_recog_step=0.991, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]Epoch 161:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00898, Train/loss_recog_step=1.180, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]Epoch 161:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00898, Train/loss_recog_step=1.180, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]Epoch 161:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=0.817, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]Epoch 161:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=0.817, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]Epoch 161:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000141, Train/loss_recog_step=1.120, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]Epoch 161:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000141, Train/loss_recog_step=1.120, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]Epoch 161:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]   Epoch 161:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]Epoch 161:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00269, Train/loss_recog_step=1.330, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]Epoch 161: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00269, Train/loss_recog_step=1.330, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]Epoch 161: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.842, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.788, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.50it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.39it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.73it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.67it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067567, 0.066823, 0.065990
Valid average loss UNet            (all)              : 0.200380

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.146832, 4.419933, 7.114967
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.705886, 4.795742, 4.626801
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.626685, 4.699080, 4.776507
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.228961, 4.767300, 5.630599
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.470837, 4.893250, 5.322908
Valid average loss all      (Triplet)                 : 0.488374

== Recognize ==
Valid average loss Recognize     : 1.030636
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.688753

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.672707557678223 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.637898921966553 sec. =
Valid knn accuracy bass      : 16.71511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.39601469039917 sec. =
Valid knn accuracy piano     : 34.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.267639398574829 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.664461374282837 sec. =
Valid knn accuracy residuals : 63.67924528301887%

Valid knn accuracy average   : 49.083641787775434%

                                                                        [AEpoch 161: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.130]Epoch 161: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059921, 0.059607, 0.060754
Train average loss UNet            (all)              : 0.180282

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001141, 4.512012, 7.917655
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004048, 4.251078, 6.322922
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002724, 4.409338, 6.454387
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003090, 4.517209, 7.045290
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002999, 4.707349, 6.763241
Train average loss all      (Triplet)                 : 0.002869

== Recognize ==
Train average loss Recognize     : 1.137598
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183150

Epoch 161:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]          Epoch 162:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00186, Train/loss_recog_step=0.999, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00186, Train/loss_recog_step=0.999, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]  Epoch 162:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.815, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.630, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.491, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.95it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.21it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.15it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066780, 0.066148, 0.064971
Valid average loss UNet            (all)              : 0.197900

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.127589, 4.134268, 6.531895
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.688208, 4.511097, 4.375305
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.617522, 4.497213, 4.500638
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.260113, 4.298461, 5.236562
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.431742, 4.445734, 4.915215
Valid average loss all      (Triplet)                 : 0.485466

== Recognize ==
Valid average loss Recognize     : 1.032922
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.683366

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.317323446273804 sec. =
Valid knn accuracy drums     : 80.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.229459524154663 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.414196014404297 sec. =
Valid knn accuracy piano     : 32.83783783783784%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.419394254684448 sec. =
Valid knn accuracy guitar    : 50.97402597402597%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.450288772583008 sec. =
Valid knn accuracy residuals : 64.15094339622641%

Valid knn accuracy average   : 48.70336855516114%

                                                                        [AEpoch 162: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00287, Train/loss_recog_epoch=1.140]Epoch 162: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059732, 0.059417, 0.060524
Train average loss UNet            (all)              : 0.179673

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001140, 4.112092, 7.254341
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003249, 3.890046, 5.782146
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002294, 4.008648, 5.880485
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001364, 4.096341, 6.390615
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002375, 4.270695, 6.129497
Train average loss all      (Triplet)                 : 0.002125

== Recognize ==
Train average loss Recognize     : 1.138690
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.181798

Epoch 162:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]          Epoch 163:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.871, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.997, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.997, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00599, Train/loss_recog_step=1.180, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00599, Train/loss_recog_step=1.180, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]  Epoch 163:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.890, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.890, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=1.320, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00322, Train/loss_recog_step=1.320, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.925, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.683, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.487, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.96it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.64it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.83it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.14it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.51it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066155, 0.066362, 0.065402
Valid average loss UNet            (all)              : 0.197920

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.120163, 4.283044, 6.501465
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.645591, 4.737841, 4.542906
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.654086, 4.595368, 4.563416
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.250185, 4.606598, 5.356318
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.376070, 4.734887, 5.151336
Valid average loss all      (Triplet)                 : 0.454386

== Recognize ==
Valid average loss Recognize     : 1.021381
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.652306

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.067906856536865 sec. =
Valid knn accuracy drums     : 80.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.707228422164917 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.211301326751709 sec. =
Valid knn accuracy piano     : 35.54054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.474844694137573 sec. =
Valid knn accuracy guitar    : 46.91558441558442%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.684828519821167 sec. =
Valid knn accuracy residuals : 64.77987421383648%

Valid knn accuracy average   : 48.44275386956%

                                                                        [AEpoch 163: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.140]Epoch 163: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059568, 0.059291, 0.060426
Train average loss UNet            (all)              : 0.179285

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000709, 3.971740, 6.979880
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003172, 3.735192, 5.557006
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001697, 3.835399, 5.647644
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001550, 3.911877, 6.110104
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001400, 4.081671, 5.864936
Train average loss all      (Triplet)                 : 0.001725

== Recognize ==
Train average loss Recognize     : 1.136789
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.181010

Epoch 163:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]          Epoch 164:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]Epoch 164:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]Epoch 164:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.991, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]Epoch 164:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.991, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]Epoch 164:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=1.180, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]Epoch 164:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=1.180, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]Epoch 164:  48%|████▊     | 150/313 [02:09<02:21,  1.16it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.812, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140] Epoch 164:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.812, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]Epoch 164:  64%|██████▍   | 200/313 [02:51<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=1.110, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140] Epoch 164:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.016, Train/loss_recog_step=1.110, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]Epoch 164:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000188, Train/loss_recog_step=0.897, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]Epoch 164:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000188, Train/loss_recog_step=0.897, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]Epoch 164:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000159, Train/loss_recog_step=1.330, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]Epoch 164: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000159, Train/loss_recog_step=1.330, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]Epoch 164: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=0.768, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.542, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.484, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.42it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.75it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.82it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.36it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066265, 0.065916, 0.065697
Valid average loss UNet            (all)              : 0.197878

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.126274, 4.729888, 7.693444
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.657091, 5.144356, 5.026340
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.791849, 5.074977, 5.199909
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.273101, 5.073978, 6.010544
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.429685, 5.085219, 5.736286
Valid average loss all      (Triplet)                 : 0.509213

== Recognize ==
Valid average loss Recognize     : 1.021455
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.707092

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.48021650314331 sec. =
Valid knn accuracy drums     : 81.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.840090990066528 sec. =
Valid knn accuracy bass      : 18.459302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.890812158584595 sec. =
Valid knn accuracy piano     : 31.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.591353178024292 sec. =
Valid knn accuracy guitar    : 46.91558441558442%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.495198488235474 sec. =
Valid knn accuracy residuals : 63.9937106918239%

Valid knn accuracy average   : 48.46274969327521%

                                                                        [AEpoch 164: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.140]Epoch 164: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059619, 0.059353, 0.060486
Train average loss UNet            (all)              : 0.179458

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001065, 4.243487, 7.416707
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002460, 4.006990, 5.905139
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002722, 4.104295, 5.980471
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001489, 4.188295, 6.474884
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002044, 4.340535, 6.202013
Train average loss all      (Triplet)                 : 0.002005

== Recognize ==
Train average loss Recognize     : 1.134205
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.181463

Epoch 164:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]          Epoch 165:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]Epoch 165:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]Epoch 165:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000244, Train/loss_recog_step=0.985, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]Epoch 165:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000244, Train/loss_recog_step=0.985, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]Epoch 165:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00343, Train/loss_recog_step=1.180, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130] Epoch 165:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00343, Train/loss_recog_step=1.180, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]Epoch 165:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00165, Train/loss_recog_step=0.813, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]Epoch 165:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00165, Train/loss_recog_step=0.813, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]Epoch 165:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00103, Train/loss_recog_step=1.110, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]Epoch 165:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00103, Train/loss_recog_step=1.110, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]Epoch 165:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00337, Train/loss_recog_step=0.899, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]Epoch 165:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00337, Train/loss_recog_step=0.899, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]Epoch 165:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]  Epoch 165: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]Epoch 165: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.920, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.485, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.14it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.00it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.71it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.24it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066335, 0.065626, 0.065460
Valid average loss UNet            (all)              : 0.197420

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098997, 4.464612, 7.336838
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.627686, 4.917487, 4.861888
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.717115, 4.814839, 4.919413
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.235894, 4.800876, 5.900728
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.343354, 4.773886, 5.514329
Valid average loss all      (Triplet)                 : 0.454254

== Recognize ==
Valid average loss Recognize     : 1.032377
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.651674

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.185485363006592 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.92478060722351 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.234163761138916 sec. =
Valid knn accuracy piano     : 30.675675675675674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.531500816345215 sec. =
Valid knn accuracy guitar    : 50.81168831168831%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.830275297164917 sec. =
Valid knn accuracy residuals : 62.264150943396224%

Valid knn accuracy average   : 47.890521864401016%

                                                                        [AEpoch 165: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.130]Epoch 165: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059700, 0.059480, 0.060566
Train average loss UNet            (all)              : 0.179745

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000683, 4.456300, 7.866604
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003385, 4.206972, 6.227322
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003681, 4.363310, 6.403848
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002157, 4.420471, 6.851513
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003241, 4.643399, 6.671090
Train average loss all      (Triplet)                 : 0.002739

== Recognize ==
Train average loss Recognize     : 1.136315
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.182484

Epoch 165:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]          Epoch 166:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.819, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.819, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166:  80%|███████▉  | 250/313 [03:34<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00858, Train/loss_recog_step=0.901, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00858, Train/loss_recog_step=0.901, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]  Epoch 166: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=0.814, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.586, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.60it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.29it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.31it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.33it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066026, 0.066765, 0.065461
Valid average loss UNet            (all)              : 0.198252

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.135343, 4.490953, 7.305988
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.748997, 5.024262, 4.850365
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.631516, 4.792614, 4.900615
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.286610, 4.893709, 5.753736
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.332681, 5.125657, 5.896169
Valid average loss all      (Triplet)                 : 0.499874

== Recognize ==
Valid average loss Recognize     : 1.031457
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.698126

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.15272307395935 sec. =
Valid knn accuracy drums     : 79.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.826823472976685 sec. =
Valid knn accuracy bass      : 16.424418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.744697570800781 sec. =
Valid knn accuracy piano     : 33.24324324324324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.741092443466187 sec. =
Valid knn accuracy guitar    : 49.02597402597403%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.60436463356018 sec. =
Valid knn accuracy residuals : 60.84905660377359%

Valid knn accuracy average   : 47.87912673082253%

                                                                        [AEpoch 166: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00274, Train/loss_recog_epoch=1.140]Epoch 166: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059428, 0.059124, 0.060326
Train average loss UNet            (all)              : 0.178878

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000459, 4.328864, 7.736876
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003011, 4.100953, 6.133921
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001805, 4.189403, 6.150915
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001870, 4.294295, 6.685194
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001999, 4.457309, 6.400821
Train average loss all      (Triplet)                 : 0.001887

== Recognize ==
Train average loss Recognize     : 1.143726
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.180765

Epoch 166:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]          Epoch 167:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.996, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.996, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00698, Train/loss_recog_step=0.819, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00698, Train/loss_recog_step=0.819, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]  Epoch 167:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.903, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.903, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.500, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.479, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.94it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.30it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.64it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067668, 0.066956, 0.066135
Valid average loss UNet            (all)              : 0.200760

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.140296, 4.256634, 6.832043
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.791832, 4.861818, 4.566800
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.570969, 4.596994, 4.796296
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.222294, 4.707930, 5.614312
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.350720, 4.705216, 5.311999
Valid average loss all      (Triplet)                 : 0.494110

== Recognize ==
Valid average loss Recognize     : 1.028341
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.694869

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.613707542419434 sec. =
Valid knn accuracy drums     : 81.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.022275686264038 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.521400690078735 sec. =
Valid knn accuracy piano     : 33.513513513513516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.41692566871643 sec. =
Valid knn accuracy guitar    : 52.27272727272727%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.724578619003296 sec. =
Valid knn accuracy residuals : 62.893081761006286%

Valid knn accuracy average   : 49.28648010452466%

                                                                        [AEpoch 167: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00189, Train/loss_recog_epoch=1.140]Epoch 167: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059456, 0.059125, 0.060275
Train average loss UNet            (all)              : 0.178856

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000861, 4.273010, 7.605669
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003378, 4.070669, 6.029943
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002408, 4.177919, 6.121349
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002065, 4.298529, 6.645180
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002318, 4.446373, 6.392907
Train average loss all      (Triplet)                 : 0.002294

== Recognize ==
Train average loss Recognize     : 1.141351
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.181149

Epoch 167:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]          Epoch 168:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=1.330, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=1.330, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.816, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.695, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.494, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.493, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.04it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.90it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.58it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.33it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.13it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067423, 0.066505, 0.065359
Valid average loss UNet            (all)              : 0.199287

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133983, 4.077030, 6.502304
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.697171, 4.610156, 4.497704
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.591339, 4.534540, 4.522794
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.241616, 4.626904, 5.412113
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.348960, 4.512718, 5.228706
Valid average loss all      (Triplet)                 : 0.463932

== Recognize ==
Valid average loss Recognize     : 1.028726
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.663219

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.254570960998535 sec. =
Valid knn accuracy drums     : 81.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.607784748077393 sec. =
Valid knn accuracy bass      : 17.587209302325583%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.920831680297852 sec. =
Valid knn accuracy piano     : 31.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.760293006896973 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.580031633377075 sec. =
Valid knn accuracy residuals : 65.88050314465409%

Valid knn accuracy average   : 49.226133904340294%

                                                                        [AEpoch 168: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00229, Train/loss_recog_epoch=1.140]Epoch 168: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059293, 0.059028, 0.060121
Train average loss UNet            (all)              : 0.178443

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000415, 3.972395, 7.170578
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003247, 3.787473, 5.634580
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001051, 3.905487, 5.749472
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002292, 4.001754, 6.264513
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002187, 4.169375, 5.991544
Train average loss all      (Triplet)                 : 0.001788

== Recognize ==
Train average loss Recognize     : 1.138844
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.180231

Epoch 168:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]          Epoch 169:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.996, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.996, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.819, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.819, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00921, Train/loss_recog_step=1.340, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00921, Train/loss_recog_step=1.340, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.707, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.492, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.03it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.46it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.91it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.37it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066223, 0.067243, 0.065403
Valid average loss UNet            (all)              : 0.198869

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.126185, 4.372864, 6.951766
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.671578, 5.009027, 4.866888
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.712981, 4.886055, 4.854070
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.257715, 4.803629, 5.467921
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.337675, 4.996941, 5.812719
Valid average loss all      (Triplet)                 : 0.488128

== Recognize ==
Valid average loss Recognize     : 1.032751
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.686996

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.122424840927124 sec. =
Valid knn accuracy drums     : 77.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.733848810195923 sec. =
Valid knn accuracy bass      : 19.186046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.375919580459595 sec. =
Valid knn accuracy piano     : 29.594594594594593%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.025012493133545 sec. =
Valid knn accuracy guitar    : 49.83766233766234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.730201721191406 sec. =
Valid knn accuracy residuals : 64.77987421383648%

Valid knn accuracy average   : 48.179635531544264%

                                                                        [AEpoch 169: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.140]Epoch 169: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059242, 0.058930, 0.059970
Train average loss UNet            (all)              : 0.178142

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000528, 3.936514, 6.949296
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002729, 3.775804, 5.678154
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000834, 3.858428, 5.711205
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001525, 3.973934, 6.211250
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001302, 4.161688, 6.016808
Train average loss all      (Triplet)                 : 0.001345

== Recognize ==
Train average loss Recognize     : 1.143561
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179487

Epoch 169:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]          Epoch 170:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=0.996, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=0.996, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]  Epoch 170:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00298, Train/loss_recog_step=1.120, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00298, Train/loss_recog_step=1.120, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00539, Train/loss_recog_step=0.910, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00539, Train/loss_recog_step=0.910, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=1.340, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00354, Train/loss_recog_step=1.340, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.979, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.752, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.687, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.482, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.14it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.40it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.49it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.50it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.72it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.12it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069746, 0.068828, 0.068343
Valid average loss UNet            (all)              : 0.206917

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.075936, 4.371733, 7.311005
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.664595, 5.067507, 4.911438
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.681752, 4.774028, 4.766053
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.269271, 4.784278, 5.530971
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.254823, 4.906343, 5.607110
Valid average loss all      (Triplet)                 : 0.453938

== Recognize ==
Valid average loss Recognize     : 1.030741
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.660855

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.18271517753601 sec. =
Valid knn accuracy drums     : 78.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.805758237838745 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.85384202003479 sec. =
Valid knn accuracy piano     : 29.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.333491086959839 sec. =
Valid knn accuracy guitar    : 44.48051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.529590129852295 sec. =
Valid knn accuracy residuals : 62.57861635220125%

Valid knn accuracy average   : 45.865250836452084%

                                                                        [AEpoch 170: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.140]Epoch 170: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059291, 0.059076, 0.060171
Train average loss UNet            (all)              : 0.178538

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001213, 4.266286, 7.492876
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003077, 4.068774, 6.077943
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003043, 4.199050, 6.147853
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002527, 4.280414, 6.661612
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001409, 4.487057, 6.474185
Train average loss all      (Triplet)                 : 0.002265

== Recognize ==
Train average loss Recognize     : 1.145221
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.180803

Epoch 170:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]          Epoch 171:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=0.996, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=0.996, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00161, Train/loss_recog_step=1.180, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00161, Train/loss_recog_step=1.180, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]  Epoch 171:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=0.906, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=0.906, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00051, Train/loss_recog_step=1.340, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00051, Train/loss_recog_step=1.340, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.459, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.38it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.54it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.51it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067780, 0.067134, 0.065606
Valid average loss UNet            (all)              : 0.200520

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.076234, 4.378266, 7.322228
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.828181, 5.198205, 4.896116
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.645467, 4.973282, 5.000659
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.220199, 4.776753, 5.543610
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.297337, 5.141007, 5.931324
Valid average loss all      (Triplet)                 : 0.498848

== Recognize ==
Valid average loss Recognize     : 1.029342
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.699368

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.995198965072632 sec. =
Valid knn accuracy drums     : 82.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.112396001815796 sec. =
Valid knn accuracy bass      : 17.296511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.411963701248169 sec. =
Valid knn accuracy piano     : 32.567567567567565%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.18536376953125 sec. =
Valid knn accuracy guitar    : 46.103896103896105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.48276948928833 sec. =
Valid knn accuracy residuals : 65.72327044025157%

Valid knn accuracy average   : 48.83824914792445%

                                                                        [AEpoch 171: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00227, Train/loss_recog_epoch=1.150]Epoch 171: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059206, 0.058933, 0.060010
Train average loss UNet            (all)              : 0.178149

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000900, 4.324889, 7.678908
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001887, 4.093128, 6.120347
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003351, 4.214514, 6.157692
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000962, 4.290774, 6.690295
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002266, 4.523689, 6.504817
Train average loss all      (Triplet)                 : 0.001864

== Recognize ==
Train average loss Recognize     : 1.141300
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.180014

Epoch 171:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]          Epoch 172:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]Epoch 172:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]Epoch 172:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00664, Train/loss_recog_step=0.994, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]Epoch 172:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00664, Train/loss_recog_step=0.994, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]Epoch 172:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000327, Train/loss_recog_step=1.190, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]Epoch 172:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000327, Train/loss_recog_step=1.190, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]Epoch 172:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=0.821, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140] Epoch 172:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00177, Train/loss_recog_step=0.821, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]Epoch 172:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=1.110, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140] Epoch 172:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=1.110, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]Epoch 172:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140] Epoch 172:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]Epoch 172:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]Epoch 172: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]Epoch 172: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.850, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.488, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.21it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.53it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.95it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.15it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068763, 0.070573, 0.069236
Valid average loss UNet            (all)              : 0.208572

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083749, 4.557862, 7.225752
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.650696, 5.127055, 5.006034
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.705074, 5.075077, 5.129135
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.282112, 4.815479, 5.534911
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.385729, 5.212795, 5.850690
Valid average loss all      (Triplet)                 : 0.469851

== Recognize ==
Valid average loss Recognize     : 1.025334
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.678423

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.932642459869385 sec. =
Valid knn accuracy drums     : 80.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.808194875717163 sec. =
Valid knn accuracy bass      : 16.13372093023256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.76924180984497 sec. =
Valid knn accuracy piano     : 32.83783783783784%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.928861856460571 sec. =
Valid knn accuracy guitar    : 46.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.291233539581299 sec. =
Valid knn accuracy residuals : 60.062893081761004%

Valid knn accuracy average   : 47.21025171450409%

                                                                        [AEpoch 172: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.140]Epoch 172: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059037, 0.058805, 0.059874
Train average loss UNet            (all)              : 0.177717

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000232, 4.353885, 7.676904
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002324, 4.138654, 6.199318
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002191, 4.248941, 6.214700
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001498, 4.367306, 6.817934
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001951, 4.559840, 6.571528
Train average loss all      (Triplet)                 : 0.001648

== Recognize ==
Train average loss Recognize     : 1.142458
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179365

Epoch 172:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]          Epoch 173:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00081, Train/loss_recog_step=1.180, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00081, Train/loss_recog_step=1.180, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.819, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]  Epoch 173:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.819, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=0.863, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.639, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.472, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.17it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.84it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.89it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.65it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.97it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068742, 0.068952, 0.068056
Valid average loss UNet            (all)              : 0.205750

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.070633, 4.429035, 7.077603
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.708605, 5.179437, 5.066736
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.746530, 4.930592, 4.893943
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.231599, 4.631338, 5.567269
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.371528, 5.031815, 5.491970
Valid average loss all      (Triplet)                 : 0.499080

== Recognize ==
Valid average loss Recognize     : 1.029291
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.704830

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.503277778625488 sec. =
Valid knn accuracy drums     : 77.20588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.653011083602905 sec. =
Valid knn accuracy bass      : 16.13372093023256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.293278694152832 sec. =
Valid knn accuracy piano     : 27.432432432432428%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.327724695205688 sec. =
Valid knn accuracy guitar    : 49.83766233766234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.482384443283081 sec. =
Valid knn accuracy residuals : 60.691823899371066%

Valid knn accuracy average   : 46.26030439052792%

                                                                        [AEpoch 173: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.140]Epoch 173: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059119, 0.058864, 0.059944
Train average loss UNet            (all)              : 0.177927

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000565, 4.445861, 7.779290
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003556, 4.239315, 6.301750
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001693, 4.340238, 6.358943
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002232, 4.461781, 6.951951
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001834, 4.642460, 6.656934
Train average loss all      (Triplet)                 : 0.002054

== Recognize ==
Train average loss Recognize     : 1.140554
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179981

Epoch 173:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]          Epoch 174:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]Epoch 174:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]Epoch 174:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=0.994, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]Epoch 174:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=0.994, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]Epoch 174:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=1.190, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140] Epoch 174:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.0139, Train/loss_recog_step=1.190, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]Epoch 174:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00334, Train/loss_recog_step=0.823, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]Epoch 174:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00334, Train/loss_recog_step=0.823, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]Epoch 174:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=2.87e-5, Train/loss_recog_step=1.120, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]Epoch 174:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=2.87e-5, Train/loss_recog_step=1.120, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]Epoch 174:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000934, Train/loss_recog_step=0.912, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]Epoch 174:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000934, Train/loss_recog_step=0.912, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]Epoch 174:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]   Epoch 174: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]Epoch 174: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.882, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.839, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.463, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.56it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.20it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.59it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071413, 0.072889, 0.071688
Valid average loss UNet            (all)              : 0.215990

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.111401, 4.279131, 6.781180
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.649552, 4.781495, 4.629445
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.656202, 4.846654, 4.815677
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.232936, 4.690298, 5.398976
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.309896, 4.779993, 5.662139
Valid average loss all      (Triplet)                 : 0.461146

== Recognize ==
Valid average loss Recognize     : 1.036644
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.677136

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.438920021057129 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.989534378051758 sec. =
Valid knn accuracy bass      : 16.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.186201810836792 sec. =
Valid knn accuracy piano     : 30.675675675675674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.405983448028564 sec. =
Valid knn accuracy guitar    : 53.246753246753244%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.41590690612793 sec. =
Valid knn accuracy residuals : 66.0377358490566%

Valid knn accuracy average   : 48.92294950696468%

                                                                        [AEpoch 174: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.882, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00205, Train/loss_recog_epoch=1.140]Epoch 174: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.882, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059270, 0.058916, 0.060070
Train average loss UNet            (all)              : 0.178256

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001286, 4.440385, 7.767638
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003189, 4.242752, 6.293539
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005337, 4.393268, 6.381502
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002092, 4.519644, 7.029405
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001300, 4.657038, 6.685115
Train average loss all      (Triplet)                 : 0.002617

== Recognize ==
Train average loss Recognize     : 1.145819
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.180873

Epoch 174:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.882, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]          Epoch 175:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.882, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]Epoch 175:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.882, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]Epoch 175:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]Epoch 175:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]Epoch 175:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00546, Train/loss_recog_step=1.190, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]Epoch 175:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00546, Train/loss_recog_step=1.190, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]Epoch 175:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.827, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150] Epoch 175:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.0124, Train/loss_recog_step=0.827, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]Epoch 175:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000538, Train/loss_recog_step=1.120, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]Epoch 175:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000538, Train/loss_recog_step=1.120, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]Epoch 175:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]   Epoch 175:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]Epoch 175:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=1.350, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]Epoch 175: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=1.350, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]Epoch 175: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.997, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.749, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.489, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.05it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.29it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.91it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.18it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067427, 0.066504, 0.065326
Valid average loss UNet            (all)              : 0.199258

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.146913, 4.410897, 6.797375
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.753455, 5.008113, 4.783636
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.591322, 4.768595, 4.873530
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.246382, 4.761730, 5.527623
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.386376, 4.956624, 5.632043
Valid average loss all      (Triplet)                 : 0.484918

== Recognize ==
Valid average loss Recognize     : 1.041196
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.684176

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.261581659317017 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.75548529624939 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.524784803390503 sec. =
Valid knn accuracy piano     : 28.10810810810811%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.68855357170105 sec. =
Valid knn accuracy guitar    : 47.4025974025974%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.600197792053223 sec. =
Valid knn accuracy residuals : 63.9937106918239%

Valid knn accuracy average   : 46.658749177578386%

                                                                        [AEpoch 175: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.150]Epoch 175: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059125, 0.058835, 0.059941
Train average loss UNet            (all)              : 0.177901

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000605, 4.292946, 7.443304
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002736, 4.162146, 6.213008
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002811, 4.288626, 6.302999
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002287, 4.359231, 6.834866
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002022, 4.565509, 6.587276
Train average loss all      (Triplet)                 : 0.002002

== Recognize ==
Train average loss Recognize     : 1.149265
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179904

Epoch 175:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]          Epoch 176:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]Epoch 176:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]Epoch 176:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]Epoch 176:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]Epoch 176:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000887, Train/loss_recog_step=1.190, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]Epoch 176:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000887, Train/loss_recog_step=1.190, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]Epoch 176:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=0.825, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150] Epoch 176:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=0.825, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]Epoch 176:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]  Epoch 176:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]Epoch 176:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]Epoch 176:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]Epoch 176:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]Epoch 176: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]Epoch 176: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.877, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.467, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.89it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.34it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.74it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.14it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067193, 0.067578, 0.066480
Valid average loss UNet            (all)              : 0.201251

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.121964, 4.292300, 6.797659
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.682904, 4.776512, 4.578538
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.498186, 4.518709, 4.582440
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.249098, 4.584947, 5.141515
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.339615, 4.884747, 5.347005
Valid average loss all      (Triplet)                 : 0.437666

== Recognize ==
Valid average loss Recognize     : 1.041043
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.638917

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.117557048797607 sec. =
Valid knn accuracy drums     : 79.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.286722898483276 sec. =
Valid knn accuracy bass      : 18.313953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.2796049118042 sec. =
Valid knn accuracy piano     : 30.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.886123418807983 sec. =
Valid knn accuracy guitar    : 49.67532467532468%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.763336181640625 sec. =
Valid knn accuracy residuals : 65.09433962264151%

Valid knn accuracy average   : 48.58731179256176%

                                                                        [AEpoch 176: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.002, Train/loss_recog_epoch=1.150]Epoch 176: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058888, 0.058583, 0.059623
Train average loss UNet            (all)              : 0.177095

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000308, 4.124235, 7.277242
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001653, 3.949842, 5.954430
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001490, 4.027471, 5.942806
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001461, 4.144331, 6.436342
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001869, 4.292454, 6.163585
Train average loss all      (Triplet)                 : 0.001413

== Recognize ==
Train average loss Recognize     : 1.149652
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178508

Epoch 176:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]          Epoch 177:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.828, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.828, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.916, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.916, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.881, Valid/loss_all_step=0.829, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.602, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.486, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.29it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.72it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.98it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.67it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.52it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066912, 0.068334, 0.066825
Valid average loss UNet            (all)              : 0.202071

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113138, 4.473117, 6.960732
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.700689, 5.075629, 4.909359
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.645206, 4.974351, 4.952548
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.222714, 4.872346, 5.649993
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.395273, 5.025580, 5.666130
Valid average loss all      (Triplet)                 : 0.469826

== Recognize ==
Valid average loss Recognize     : 1.044860
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.671897

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.142848253250122 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.770696640014648 sec. =
Valid knn accuracy bass      : 20.058139534883722%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.514718532562256 sec. =
Valid knn accuracy piano     : 37.972972972972975%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.546844482421875 sec. =
Valid knn accuracy guitar    : 51.298701298701296%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.643513917922974 sec. =
Valid knn accuracy residuals : 66.82389937106919%

Valid knn accuracy average   : 50.78956616493719%

                                                                        [AEpoch 177: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.881, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.150]Epoch 177: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.881, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058720, 0.058503, 0.059529
Train average loss UNet            (all)              : 0.176752

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000338, 4.373888, 7.621669
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002765, 4.137072, 6.161442
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001524, 4.260333, 6.282916
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001084, 4.364814, 6.772086
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001537, 4.549984, 6.569770
Train average loss all      (Triplet)                 : 0.001530

== Recognize ==
Train average loss Recognize     : 1.150533
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178282

Epoch 177:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.881, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]          Epoch 178:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.881, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]Epoch 178:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=0.881, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]Epoch 178:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=1.020, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]Epoch 178:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=1.020, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]Epoch 178:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]  Epoch 178:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]Epoch 178:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000541, Train/loss_recog_step=0.832, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]Epoch 178:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000541, Train/loss_recog_step=0.832, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]Epoch 178:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]   Epoch 178:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]Epoch 178:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=0.917, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]Epoch 178:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00826, Train/loss_recog_step=0.917, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]Epoch 178:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00475, Train/loss_recog_step=1.350, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]Epoch 178: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00475, Train/loss_recog_step=1.350, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]Epoch 178: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.879, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.646, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.672, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.508, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.30it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.13it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.32it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.57it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.30it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066374, 0.067397, 0.065162
Valid average loss UNet            (all)              : 0.198932

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.111740, 4.715230, 7.428001
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.680639, 5.415209, 5.305607
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.774941, 5.420959, 5.399481
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.285805, 5.199234, 6.038869
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.396450, 5.283947, 6.118979
Valid average loss all      (Triplet)                 : 0.501918

== Recognize ==
Valid average loss Recognize     : 1.047683
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.700850

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.984621286392212 sec. =
Valid knn accuracy drums     : 77.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.425456285476685 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.492931604385376 sec. =
Valid knn accuracy piano     : 31.351351351351354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.142625570297241 sec. =
Valid knn accuracy guitar    : 49.51298701298701%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.717250108718872 sec. =
Valid knn accuracy residuals : 63.05031446540881%

Valid knn accuracy average   : 47.77232865076476%

                                                                        [AEpoch 178: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.150]Epoch 178: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058821, 0.058562, 0.059635
Train average loss UNet            (all)              : 0.177019

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001056, 4.493470, 7.775820
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002448, 4.280221, 6.379225
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002335, 4.412266, 6.480912
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001753, 4.499820, 7.021480
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001446, 4.701878, 6.756059
Train average loss all      (Triplet)                 : 0.001816

== Recognize ==
Train average loss Recognize     : 1.155633
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178835

Epoch 178:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]          Epoch 179:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0045, Train/loss_recog_step=1.020, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0045, Train/loss_recog_step=1.020, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160] Epoch 179:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.836, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.705, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.478, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.18it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.59it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.27it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066651, 0.066328, 0.064577
Valid average loss UNet            (all)              : 0.197556

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.085381, 4.290949, 6.687062
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.694583, 4.976959, 4.766175
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.667472, 4.844720, 4.816535
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.253095, 4.720907, 5.615584
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.333773, 4.848790, 5.417554
Valid average loss all      (Triplet)                 : 0.464045

== Recognize ==
Valid average loss Recognize     : 1.057157
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.661601

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.176494598388672 sec. =
Valid knn accuracy drums     : 76.61764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.886297225952148 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.028106451034546 sec. =
Valid knn accuracy piano     : 32.16216216216216%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.297576665878296 sec. =
Valid knn accuracy guitar    : 50.48701298701299%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.295652389526367 sec. =
Valid knn accuracy residuals : 63.52201257861635%

Valid knn accuracy average   : 47.43567393406719%

                                                                        [AEpoch 179: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.160]Epoch 179: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058875, 0.058543, 0.059651
Train average loss UNet            (all)              : 0.177070

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000888, 4.225642, 7.341896
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002339, 4.074236, 6.089486
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002161, 4.168203, 6.129936
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000896, 4.298011, 6.726912
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002641, 4.500916, 6.496028
Train average loss all      (Triplet)                 : 0.001831

== Recognize ==
Train average loss Recognize     : 1.163592
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178901

Epoch 179:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]          Epoch 180:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00305, Train/loss_recog_step=1.020, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00305, Train/loss_recog_step=1.020, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]  Epoch 180:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00206, Train/loss_recog_step=1.360, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00206, Train/loss_recog_step=1.360, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000765, Train/loss_recog_step=0.886, Valid/loss_all_step=0.886, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.98it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.10it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.40it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.51it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069002, 0.069420, 0.067610
Valid average loss UNet            (all)              : 0.206033

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062902, 4.282516, 6.970789
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.606028, 4.874637, 4.784306
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.565100, 4.642870, 4.582248
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.298297, 4.579062, 5.339139
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.374362, 4.713603, 5.264064
Valid average loss all      (Triplet)                 : 0.428266

== Recognize ==
Valid average loss Recognize     : 1.045974
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.634299

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.358309745788574 sec. =
Valid knn accuracy drums     : 77.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.840537309646606 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.813568115234375 sec. =
Valid knn accuracy piano     : 32.16216216216216%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.2743821144104 sec. =
Valid knn accuracy guitar    : 51.62337662337663%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.621568441390991 sec. =
Valid knn accuracy residuals : 61.32075471698113%

Valid knn accuracy average   : 47.63069782499099%

                                                                        [AEpoch 180: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000765, Train/loss_recog_step=0.886, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.160]Epoch 180: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000765, Train/loss_recog_step=0.886, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058785, 0.058558, 0.059654
Train average loss UNet            (all)              : 0.176997

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000778, 4.294711, 7.630462
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001735, 4.104668, 6.142569
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001631, 4.227767, 6.231555
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003600, 4.345217, 6.782742
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001537, 4.529809, 6.524970
Train average loss all      (Triplet)                 : 0.001866

== Recognize ==
Train average loss Recognize     : 1.162114
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178863

Epoch 180:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000765, Train/loss_recog_step=0.886, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]          Epoch 181:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000765, Train/loss_recog_step=0.886, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]Epoch 181:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000765, Train/loss_recog_step=0.886, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]Epoch 181:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=1.010, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160] Epoch 181:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00727, Train/loss_recog_step=1.010, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]Epoch 181:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=1.210, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]Epoch 181:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00455, Train/loss_recog_step=1.210, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]Epoch 181:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]  Epoch 181:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]Epoch 181:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]Epoch 181:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]Epoch 181:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]Epoch 181:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]Epoch 181:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]Epoch 181: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]Epoch 181: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.761, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.526, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.634, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.476, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.91it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.04it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.67it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.43it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067357, 0.068052, 0.066431
Valid average loss UNet            (all)              : 0.201841

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.075786, 4.351256, 7.005595
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.625689, 4.898099, 4.759135
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.641985, 4.866966, 4.893080
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.239626, 4.713836, 5.357227
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.355666, 4.798438, 5.586983
Valid average loss all      (Triplet)                 : 0.437620

== Recognize ==
Valid average loss Recognize     : 1.051482
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.639461

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.35645055770874 sec. =
Valid knn accuracy drums     : 78.08823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.938820600509644 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.80266523361206 sec. =
Valid knn accuracy piano     : 30.675675675675674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.189091920852661 sec. =
Valid knn accuracy guitar    : 46.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.815528869628906 sec. =
Valid knn accuracy residuals : 61.47798742138365%

Valid knn accuracy average   : 46.64804745232177%

                                                                        [AEpoch 181: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.160]Epoch 181: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058872, 0.058622, 0.059723
Train average loss UNet            (all)              : 0.177217

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001032, 4.329646, 7.560236
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003209, 4.153854, 6.173362
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002785, 4.251427, 6.214570
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002543, 4.370258, 6.790866
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001680, 4.547829, 6.550829
Train average loss all      (Triplet)                 : 0.002315

== Recognize ==
Train average loss Recognize     : 1.162436
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179532

Epoch 181:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]          Epoch 182:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]Epoch 182:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]Epoch 182:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00426, Train/loss_recog_step=1.010, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]Epoch 182:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00426, Train/loss_recog_step=1.010, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]Epoch 182:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]  Epoch 182:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]Epoch 182:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00541, Train/loss_recog_step=0.837, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]Epoch 182:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00541, Train/loss_recog_step=0.837, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]Epoch 182:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]  Epoch 182:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]Epoch 182:  80%|███████▉  | 250/313 [03:34<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]Epoch 182:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]Epoch 182:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]Epoch 182: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]Epoch 182: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=0.901, Valid/loss_all_step=0.828, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.597, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.639, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.438, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.466, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.44it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.36it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.55it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.03it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.065950, 0.065525, 0.064073
Valid average loss UNet            (all)              : 0.195549

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.085469, 4.438440, 7.189827
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.581201, 4.932273, 4.851202
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.609433, 4.977272, 5.126792
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.377699, 4.875398, 5.475090
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.356668, 5.159461, 5.765360
Valid average loss all      (Triplet)                 : 0.444959

== Recognize ==
Valid average loss Recognize     : 1.055897
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.640507

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.670076370239258 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.900013446807861 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.6358003616333 sec. =
Valid knn accuracy piano     : 32.16216216216216%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.553664445877075 sec. =
Valid knn accuracy guitar    : 48.86363636363637%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.839885234832764 sec. =
Valid knn accuracy residuals : 65.09433962264151%

Valid knn accuracy average   : 47.60432858728034%

                                                                        [AEpoch 182: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=0.901, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.160]Epoch 182: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=0.901, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058670, 0.058375, 0.059424
Train average loss UNet            (all)              : 0.176470

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000678, 4.176739, 7.333654
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002535, 3.990267, 5.964115
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001918, 4.094537, 5.996170
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001856, 4.208624, 6.588898
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002154, 4.374870, 6.320069
Train average loss all      (Triplet)                 : 0.001866

== Recognize ==
Train average loss Recognize     : 1.167386
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178336

Epoch 182:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=0.901, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]          Epoch 183:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=0.901, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]Epoch 183:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=0.901, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]Epoch 183:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]  Epoch 183:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]Epoch 183:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]Epoch 183:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]Epoch 183:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.842, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]Epoch 183:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.842, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]Epoch 183:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=1.140, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]Epoch 183:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=1.140, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]Epoch 183:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170] Epoch 183:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]Epoch 183:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]Epoch 183: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]Epoch 183: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.88it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.55it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.16it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.55it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.23it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068225, 0.066793, 0.065285
Valid average loss UNet            (all)              : 0.200304

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.115411, 4.794641, 7.932913
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.799629, 5.482885, 5.238074
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.693346, 5.460182, 5.501892
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.457796, 5.261395, 5.943869
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.424393, 5.452771, 5.961822
Valid average loss all      (Triplet)                 : 0.578544

== Recognize ==
Valid average loss Recognize     : 1.049685
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.778848

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.189697027206421 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.720187664031982 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.503363847732544 sec. =
Valid knn accuracy piano     : 32.432432432432435%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.491076469421387 sec. =
Valid knn accuracy guitar    : 51.461038961038966%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.332524299621582 sec. =
Valid knn accuracy residuals : 63.20754716981132%

Valid knn accuracy average   : 48.38019003276598%

                                                                        [AEpoch 183: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00187, Train/loss_recog_epoch=1.170]Epoch 183: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058517, 0.058333, 0.059367
Train average loss UNet            (all)              : 0.176218

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000641, 4.408286, 7.875928
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002000, 4.192719, 6.286234
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002096, 4.308409, 6.300572
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001407, 4.370546, 6.789556
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001528, 4.584482, 6.640585
Train average loss all      (Triplet)                 : 0.001550

== Recognize ==
Train average loss Recognize     : 1.170230
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.177767

Epoch 183:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]          Epoch 184:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.922, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00375, Train/loss_recog_step=0.922, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.360, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170] Epoch 184: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.360, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.995, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.484, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.36it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.47it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.22it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.09it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071198, 0.068828, 0.069347
Valid average loss UNet            (all)              : 0.209373

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.100205, 4.789186, 8.167617
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.649555, 5.499430, 5.444090
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.581829, 5.254818, 5.531100
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.383882, 5.268273, 5.953527
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.411575, 5.505403, 6.003974
Valid average loss all      (Triplet)                 : 0.482707

== Recognize ==
Valid average loss Recognize     : 1.047266
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.692080

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.146557807922363 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.131072044372559 sec. =
Valid knn accuracy bass      : 16.424418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.515562057495117 sec. =
Valid knn accuracy piano     : 31.891891891891895%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.944000482559204 sec. =
Valid knn accuracy guitar    : 46.103896103896105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.960169076919556 sec. =
Valid knn accuracy residuals : 62.264150943396224%

Valid knn accuracy average   : 47.01334209700237%

                                                                        [AEpoch 184: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.170]Epoch 184: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058608, 0.058437, 0.059411
Train average loss UNet            (all)              : 0.176457

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001000, 4.689631, 8.318366
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003035, 4.461400, 6.681422
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001624, 4.566667, 6.707660
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000762, 4.620788, 7.216245
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001389, 4.869506, 7.055855
Train average loss all      (Triplet)                 : 0.001640

== Recognize ==
Train average loss Recognize     : 1.166529
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178097

Epoch 184:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]          Epoch 185:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185:  16%|█▌        | 50/313 [00:46<04:06,  1.06it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00937, Train/loss_recog_step=1.010, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00937, Train/loss_recog_step=1.010, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00996, Train/loss_recog_step=1.210, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00996, Train/loss_recog_step=1.210, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.835, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]  Epoch 185:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.835, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=1.350, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=1.350, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.714, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.470, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.13it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.18it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.75it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.35it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066374, 0.065928, 0.065507
Valid average loss UNet            (all)              : 0.197808

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.125938, 4.262718, 6.739695
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.582872, 4.942316, 4.938760
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.524425, 4.683523, 4.946804
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.407561, 4.818243, 5.654475
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.357697, 4.799555, 5.145574
Valid average loss all      (Triplet)                 : 0.444802

== Recognize ==
Valid average loss Recognize     : 1.044185
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.642610

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.079163551330566 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.706942081451416 sec. =
Valid knn accuracy bass      : 13.662790697674417%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.544509172439575 sec. =
Valid knn accuracy piano     : 31.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.38519287109375 sec. =
Valid knn accuracy guitar    : 50.649350649350644%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.326156616210938 sec. =
Valid knn accuracy residuals : 61.63522012578616%

Valid knn accuracy average   : 46.876276746072584%

                                                                        [AEpoch 185: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00164, Train/loss_recog_epoch=1.170]Epoch 185: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058666, 0.058417, 0.059475
Train average loss UNet            (all)              : 0.176558

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000762, 4.447251, 7.828211
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002322, 4.277001, 6.441146
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002452, 4.360147, 6.377753
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002147, 4.453034, 6.951443
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003125, 4.653141, 6.703043
Train average loss all      (Triplet)                 : 0.002231

== Recognize ==
Train average loss Recognize     : 1.162773
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178788

Epoch 185:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]          Epoch 186:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00366, Train/loss_recog_step=1.200, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00366, Train/loss_recog_step=1.200, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00674, Train/loss_recog_step=0.832, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00674, Train/loss_recog_step=0.832, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00092, Train/loss_recog_step=1.130, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00092, Train/loss_recog_step=1.130, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]  Epoch 186:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.824, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.596, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.643, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.445, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.469, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.78it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.00it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.90it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.89it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067204, 0.068003, 0.066340
Valid average loss UNet            (all)              : 0.201547

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.131342, 4.145818, 6.657146
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.607375, 4.759185, 4.653650
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.636408, 4.648492, 4.689775
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.526826, 4.582372, 5.117746
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.484340, 4.800164, 4.963412
Valid average loss all      (Triplet)                 : 0.517794

== Recognize ==
Valid average loss Recognize     : 1.043396
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.719342

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.339218616485596 sec. =
Valid knn accuracy drums     : 76.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.637845993041992 sec. =
Valid knn accuracy bass      : 16.424418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.397895336151123 sec. =
Valid knn accuracy piano     : 32.16216216216216%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.09948182106018 sec. =
Valid knn accuracy guitar    : 49.188311688311686%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.287100791931152 sec. =
Valid knn accuracy residuals : 60.22012578616353%

Valid knn accuracy average   : 46.834297765904765%

                                                                        [AEpoch 186: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00223, Train/loss_recog_epoch=1.160]Epoch 186: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058376, 0.058104, 0.059134
Train average loss UNet            (all)              : 0.175613

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001292, 4.168880, 7.307675
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001578, 4.014430, 6.041276
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002608, 4.100167, 6.009113
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001577, 4.176989, 6.533223
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002091, 4.371423, 6.323644
Train average loss all      (Triplet)                 : 0.001714

== Recognize ==
Train average loss Recognize     : 1.160000
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.177327

Epoch 186:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]          Epoch 187:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 187:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 187:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 187:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 187:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.0015, Train/loss_recog_step=1.210, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 187:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.0015, Train/loss_recog_step=1.210, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 187:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160] Epoch 187:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 187:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 187:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 187:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=0.923, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 187:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=0.923, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 187:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160] Epoch 187: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 187: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.894, Valid/loss_all_step=0.995, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.33it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.97it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.87it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067405, 0.067930, 0.066723
Valid average loss UNet            (all)              : 0.202058

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.131212, 4.010478, 6.298859
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.533211, 4.634501, 4.666214
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.532442, 4.490764, 4.603683
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.430397, 4.503920, 5.038062
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.436878, 4.710910, 4.843256
Valid average loss all      (Triplet)                 : 0.442417

== Recognize ==
Valid average loss Recognize     : 1.045573
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.644475

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.329370260238647 sec. =
Valid knn accuracy drums     : 78.08823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.571995973587036 sec. =
Valid knn accuracy bass      : 16.71511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.381629943847656 sec. =
Valid knn accuracy piano     : 31.351351351351354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.59127140045166 sec. =
Valid knn accuracy guitar    : 48.701298701298704%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.883031368255615 sec. =
Valid knn accuracy residuals : 62.42138364779875%

Valid knn accuracy average   : 47.45547705472724%

                                                                        [AEpoch 187: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.894, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 187: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.894, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058305, 0.058046, 0.059137
Train average loss UNet            (all)              : 0.175487

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000835, 4.109485, 7.218730
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002194, 3.949549, 5.957617
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001933, 4.015826, 5.934042
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001776, 4.095975, 6.405980
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001687, 4.293595, 6.219805
Train average loss all      (Triplet)                 : 0.001715

== Recognize ==
Train average loss Recognize     : 1.163449
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.177202

Epoch 187:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.894, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]          Epoch 188:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.894, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.894, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188:  80%|███████▉  | 250/313 [03:34<00:54,  1.17it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.916, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.916, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188:  96%|█████████▌| 300/313 [04:17<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=1.350, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=1.350, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.745, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.509, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.644, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.442, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.475, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.76it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.59it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  6.00it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.98it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.91it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.065951, 0.066294, 0.064322
Valid average loss UNet            (all)              : 0.196567

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.107835, 4.312999, 7.025487
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.657764, 5.106017, 4.973259
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.660927, 4.911377, 4.934991
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.362121, 4.838528, 5.618847
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.365829, 4.976044, 5.236000
Valid average loss all      (Triplet)                 : 0.483452

== Recognize ==
Valid average loss Recognize     : 1.043220
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.680019

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.215070962905884 sec. =
Valid knn accuracy drums     : 76.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.857810974121094 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.763155221939087 sec. =
Valid knn accuracy piano     : 29.864864864864867%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.073941230773926 sec. =
Valid knn accuracy guitar    : 51.62337662337663%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.590067148208618 sec. =
Valid knn accuracy residuals : 63.36477987421384%

Valid knn accuracy average   : 47.63749893733375%

                                                                        [AEpoch 188: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.160]Epoch 188: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058188, 0.057904, 0.058970
Train average loss UNet            (all)              : 0.175062

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000571, 4.329288, 7.590999
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001325, 4.143349, 6.252044
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002249, 4.230664, 6.234353
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001356, 4.325047, 6.737471
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001295, 4.503232, 6.538370
Train average loss all      (Triplet)                 : 0.001320

== Recognize ==
Train average loss Recognize     : 1.158930
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176382

Epoch 188:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]          Epoch 189:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.833, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.833, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=1.140, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=1.140, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160] Epoch 189:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=0.885, Valid/loss_unet_all_step=0.221, Valid/loss_triplet_all_step=0.664, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.476, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.17it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.60it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.02it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.54it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066689, 0.066351, 0.064913
Valid average loss UNet            (all)              : 0.197954

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090127, 4.355857, 7.040263
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.622505, 5.169878, 5.082901
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.646965, 4.857808, 4.935650
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.468791, 5.034662, 5.643219
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.346821, 4.974711, 5.199450
Valid average loss all      (Triplet)                 : 0.488078

== Recognize ==
Valid average loss Recognize     : 1.046021
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.686031

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.074903011322021 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.890678405761719 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.444669485092163 sec. =
Valid knn accuracy piano     : 31.351351351351354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.765231847763062 sec. =
Valid knn accuracy guitar    : 52.1103896103896%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.448426246643066 sec. =
Valid knn accuracy residuals : 62.57861635220125%

Valid knn accuracy average   : 48.05588268029871%

                                                                        [AEpoch 189: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.160]Epoch 189: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058194, 0.057996, 0.059047
Train average loss UNet            (all)              : 0.175237

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000482, 4.289426, 7.395553
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002416, 4.179780, 6.291530
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001675, 4.245748, 6.258437
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001638, 4.351922, 6.772463
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000987, 4.514808, 6.552781
Train average loss all      (Triplet)                 : 0.001502

== Recognize ==
Train average loss Recognize     : 1.163290
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176739

Epoch 189:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]          Epoch 190:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]Epoch 190:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]Epoch 190:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]Epoch 190:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]Epoch 190:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000629, Train/loss_recog_step=1.210, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]Epoch 190:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000629, Train/loss_recog_step=1.210, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]Epoch 190:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=0.836, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160] Epoch 190:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=0.836, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]Epoch 190:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]  Epoch 190:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]Epoch 190:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00136, Train/loss_recog_step=0.930, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]Epoch 190:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00136, Train/loss_recog_step=0.930, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]Epoch 190:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]  Epoch 190: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]Epoch 190: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=0.901, Valid/loss_all_step=0.845, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.615, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.481, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.20it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.15it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.92it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.75it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069265, 0.067182, 0.065708
Valid average loss UNet            (all)              : 0.202155

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.146610, 4.487383, 7.144594
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.653974, 5.253825, 5.268209
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.773762, 5.123947, 5.151045
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.405594, 5.041279, 5.724759
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.396098, 5.398907, 5.732678
Valid average loss all      (Triplet)                 : 0.527314

== Recognize ==
Valid average loss Recognize     : 1.050547
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.729468

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.799607992172241 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.80863881111145 sec. =
Valid knn accuracy bass      : 14.244186046511627%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.342384576797485 sec. =
Valid knn accuracy piano     : 29.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.428516149520874 sec. =
Valid knn accuracy guitar    : 49.35064935064935%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.139548540115356 sec. =
Valid knn accuracy residuals : 62.57861635220125%

Valid knn accuracy average   : 46.68540577117611%

                                                                        [AEpoch 190: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=0.901, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.0015, Train/loss_recog_epoch=1.160]Epoch 190: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=0.901, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058416, 0.058161, 0.059273
Train average loss UNet            (all)              : 0.175850

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000885, 4.319303, 7.522342
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003791, 4.197042, 6.315279
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001663, 4.251561, 6.257589
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003170, 4.367550, 6.807974
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002012, 4.537057, 6.557889
Train average loss all      (Triplet)                 : 0.002370

== Recognize ==
Train average loss Recognize     : 1.166295
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178220

Epoch 190:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=0.901, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]          Epoch 191:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=0.901, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]Epoch 191:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=0.901, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]Epoch 191:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]  Epoch 191:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]Epoch 191:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]Epoch 191:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]Epoch 191:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00633, Train/loss_recog_step=0.841, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]Epoch 191:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00633, Train/loss_recog_step=0.841, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]Epoch 191:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]  Epoch 191:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]Epoch 191:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]Epoch 191:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]Epoch 191:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]Epoch 191: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]Epoch 191: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.973, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.732, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.527, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.19it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.87it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.82it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.69it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066703, 0.066711, 0.065850
Valid average loss UNet            (all)              : 0.199263

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.174343, 4.446535, 7.085445
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.537079, 5.263273, 5.356599
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.693233, 5.010270, 5.142845
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.357024, 4.878498, 5.683336
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.572629, 5.295116, 5.289567
Valid average loss all      (Triplet)                 : 0.490524

== Recognize ==
Valid average loss Recognize     : 1.058614
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.689787

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.229745149612427 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.534966707229614 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.717116594314575 sec. =
Valid knn accuracy piano     : 31.216216216216214%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.799997806549072 sec. =
Valid knn accuracy guitar    : 47.72727272727273%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.70522665977478 sec. =
Valid knn accuracy residuals : 61.16352201257862%

Valid knn accuracy average   : 46.841169633073974%

                                                                        [AEpoch 191: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.170]Epoch 191: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058332, 0.058064, 0.059144
Train average loss UNet            (all)              : 0.175540

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000689, 4.377992, 7.667112
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002390, 4.219397, 6.334664
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001899, 4.269531, 6.245136
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001786, 4.362173, 6.823565
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001645, 4.540188, 6.550440
Train average loss all      (Triplet)                 : 0.001747

== Recognize ==
Train average loss Recognize     : 1.173799
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.177288

Epoch 191:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]          Epoch 192:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.837, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0029, Train/loss_recog_step=1.140, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0029, Train/loss_recog_step=1.140, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.930, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170] Epoch 192:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.930, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.691, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.690, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.57it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.36it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.39it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.96it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068614, 0.067070, 0.066074
Valid average loss UNet            (all)              : 0.201758

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.146961, 4.511320, 7.418858
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.635888, 5.072773, 5.053123
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.651794, 5.088716, 5.161383
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.319197, 4.894866, 5.921099
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.435539, 5.127992, 5.612447
Valid average loss all      (Triplet)                 : 0.481937

== Recognize ==
Valid average loss Recognize     : 1.051430
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.683696

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.173588275909424 sec. =
Valid knn accuracy drums     : 80.88235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.207273006439209 sec. =
Valid knn accuracy bass      : 16.13372093023256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.883326292037964 sec. =
Valid knn accuracy piano     : 30.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.370674133300781 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.787612676620483 sec. =
Valid knn accuracy residuals : 61.32075471698113%

Valid knn accuracy average   : 47.69439274470505%

                                                                        [AEpoch 192: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00175, Train/loss_recog_epoch=1.170]Epoch 192: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058171, 0.057894, 0.059010
Train average loss UNet            (all)              : 0.175075

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000938, 4.473938, 7.872740
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002313, 4.302736, 6.450111
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001839, 4.393028, 6.477586
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001706, 4.458521, 6.966401
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001487, 4.657210, 6.778577
Train average loss all      (Triplet)                 : 0.001667

== Recognize ==
Train average loss Recognize     : 1.169961
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176742

Epoch 192:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]          Epoch 193:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.835, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00126, Train/loss_recog_step=0.835, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]  Epoch 193:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.858, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.626, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.684, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.477, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.92it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.19it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.02it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.34it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.43it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.84it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071583, 0.069980, 0.069585
Valid average loss UNet            (all)              : 0.211147

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.144168, 4.463905, 7.497432
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.516646, 5.111192, 5.258409
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.716270, 4.993865, 5.019720
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.406856, 4.883993, 5.882668
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.405506, 5.150308, 5.684374
Valid average loss all      (Triplet)                 : 0.459183

== Recognize ==
Valid average loss Recognize     : 1.060723
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.670331

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.09179425239563 sec. =
Valid knn accuracy drums     : 81.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.945796489715576 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.57508134841919 sec. =
Valid knn accuracy piano     : 30.675675675675674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.87181305885315 sec. =
Valid knn accuracy guitar    : 49.188311688311686%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.364109754562378 sec. =
Valid knn accuracy residuals : 61.79245283018868%

Valid knn accuracy average   : 47.21158899642755%

                                                                        [AEpoch 193: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00167, Train/loss_recog_epoch=1.170]Epoch 193: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058075, 0.057816, 0.058877
Train average loss UNet            (all)              : 0.174768

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000330, 4.424547, 7.826385
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002347, 4.237064, 6.370127
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001723, 4.332304, 6.391238
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001438, 4.418649, 6.947864
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001237, 4.625365, 6.718496
Train average loss all      (Triplet)                 : 0.001469

== Recognize ==
Train average loss Recognize     : 1.169344
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176237

Epoch 193:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]          Epoch 194:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=1.370, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=1.370, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.687, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.438, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.670, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.55it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.47it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.81it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.79it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.98it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067536, 0.066350, 0.065410
Valid average loss UNet            (all)              : 0.199295

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.147491, 4.799670, 7.625358
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.589816, 5.524852, 5.502647
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.659941, 5.393919, 5.417925
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.339862, 5.167233, 5.998478
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.412176, 5.435705, 6.010388
Valid average loss all      (Triplet)                 : 0.456265

== Recognize ==
Valid average loss Recognize     : 1.060865
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.655560

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.179924488067627 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.853317022323608 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.548713684082031 sec. =
Valid knn accuracy piano     : 29.324324324324323%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.203897476196289 sec. =
Valid knn accuracy guitar    : 50.97402597402597%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.111445903778076 sec. =
Valid knn accuracy residuals : 66.0377358490566%

Valid knn accuracy average   : 47.8534005400149%

                                                                        [AEpoch 194: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.170]Epoch 194: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058220, 0.058031, 0.059032
Train average loss UNet            (all)              : 0.175283

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000536, 4.589321, 7.944018
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003426, 4.423032, 6.618176
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002635, 4.541697, 6.629291
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001443, 4.553246, 7.093992
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001479, 4.827826, 6.981877
Train average loss all      (Triplet)                 : 0.001946

== Recognize ==
Train average loss Recognize     : 1.179133
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.177230

Epoch 194:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]          Epoch 195:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00524, Train/loss_recog_step=0.844, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00524, Train/loss_recog_step=0.844, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]  Epoch 195:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.928, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.646, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.419, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.656, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.87it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.41it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.29it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.79it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.70it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066991, 0.065817, 0.064413
Valid average loss UNet            (all)              : 0.197222

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.104379, 4.822915, 7.868482
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.707577, 5.572467, 5.446151
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.715148, 5.458478, 5.455919
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.355343, 5.315495, 6.193610
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.427329, 5.418204, 6.088919
Valid average loss all      (Triplet)                 : 0.514947

== Recognize ==
Valid average loss Recognize     : 1.059765
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.712168

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.225759744644165 sec. =
Valid knn accuracy drums     : 81.91176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.815252304077148 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.564546585083008 sec. =
Valid knn accuracy piano     : 28.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.94999647140503 sec. =
Valid knn accuracy guitar    : 51.62337662337663%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.360791206359863 sec. =
Valid knn accuracy residuals : 64.30817610062893%

Valid knn accuracy average   : 48.15131590583931%

                                                                        [AEpoch 195: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.180]Epoch 195: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058082, 0.057846, 0.058966
Train average loss UNet            (all)              : 0.174894

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000499, 4.680029, 8.326679
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002221, 4.511544, 6.794356
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002396, 4.591963, 6.765787
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000531, 4.644409, 7.311706
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001760, 4.878912, 7.057546
Train average loss all      (Triplet)                 : 0.001560

== Recognize ==
Train average loss Recognize     : 1.175796
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176454

Epoch 195:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]          Epoch 196:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=1.220, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=1.220, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.842, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]  Epoch 196:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.842, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=1.150, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=1.150, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00619, Train/loss_recog_step=0.928, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00619, Train/loss_recog_step=0.928, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=1.370, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00386, Train/loss_recog_step=1.370, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.515, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.69it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.68it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.54it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.69it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068883, 0.068042, 0.066351
Valid average loss UNet            (all)              : 0.203276

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.092866, 4.409782, 7.293274
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.684334, 5.221044, 5.188131
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.658774, 5.019631, 5.152869
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.376264, 4.828472, 5.797396
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.390456, 4.990898, 5.515518
Valid average loss all      (Triplet)                 : 0.498621

== Recognize ==
Valid average loss Recognize     : 1.059608
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.701897

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.279918432235718 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.826130151748657 sec. =
Valid knn accuracy bass      : 11.918604651162791%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.712494611740112 sec. =
Valid knn accuracy piano     : 33.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.346730709075928 sec. =
Valid knn accuracy guitar    : 46.91558441558442%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.800311803817749 sec. =
Valid knn accuracy residuals : 61.63522012578616%

Valid knn accuracy average   : 46.93648915170222%

                                                                        [AEpoch 196: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 196: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058027, 0.057774, 0.058822
Train average loss UNet            (all)              : 0.174622

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001129, 4.494820, 7.990682
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002703, 4.315238, 6.520599
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002440, 4.391354, 6.477367
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001831, 4.474285, 7.099807
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001275, 4.635197, 6.678100
Train average loss all      (Triplet)                 : 0.001927

== Recognize ==
Train average loss Recognize     : 1.175379
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176549

Epoch 196:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]          Epoch 197:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=1.150, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.0173, Train/loss_recog_step=1.150, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.930, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180] Epoch 197:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.930, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.688, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.702, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.469, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.62it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.65it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.86it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066240, 0.065210, 0.064372
Valid average loss UNet            (all)              : 0.195822

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113877, 4.563726, 7.203705
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.550270, 5.244104, 5.235878
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.785702, 5.308044, 5.288919
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.319743, 4.860137, 5.795124
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.418993, 5.228847, 5.847687
Valid average loss all      (Triplet)                 : 0.467092

== Recognize ==
Valid average loss Recognize     : 1.060693
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.662914

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.44895076751709 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.987844944000244 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.478480815887451 sec. =
Valid knn accuracy piano     : 30.810810810810814%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.77135705947876 sec. =
Valid knn accuracy guitar    : 48.701298701298704%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.744441986083984 sec. =
Valid knn accuracy residuals : 64.77987421383648%

Valid knn accuracy average   : 47.645674446967575%

                                                                        [AEpoch 197: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00193, Train/loss_recog_epoch=1.180]Epoch 197: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057803, 0.057558, 0.058578
Train average loss UNet            (all)              : 0.173939

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000007, 4.461900, 7.959117
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001482, 4.273826, 6.491405
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001237, 4.327618, 6.402771
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001945, 4.428995, 6.949858
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001180, 4.629877, 6.684860
Train average loss all      (Triplet)                 : 0.001243

== Recognize ==
Train average loss Recognize     : 1.176130
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175182

Epoch 197:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]          Epoch 198:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000454, Train/loss_recog_step=0.846, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000454, Train/loss_recog_step=0.846, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]   Epoch 198:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=0.684, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.460, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.663, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.467, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.476, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.38it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.87it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.48it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067690, 0.066415, 0.065492
Valid average loss UNet            (all)              : 0.199596

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.117637, 4.660320, 7.799765
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.699870, 5.267398, 5.138358
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.878956, 5.382493, 5.285632
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.368929, 4.998369, 5.966498
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.387412, 5.233878, 5.783375
Valid average loss all      (Triplet)                 : 0.549939

== Recognize ==
Valid average loss Recognize     : 1.063298
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.749536

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.826102018356323 sec. =
Valid knn accuracy drums     : 81.61764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.809360980987549 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.744251012802124 sec. =
Valid knn accuracy piano     : 29.18918918918919%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.699198722839355 sec. =
Valid knn accuracy guitar    : 45.616883116883116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.391554594039917 sec. =
Valid knn accuracy residuals : 59.74842767295597%

Valid knn accuracy average   : 46.112336384314546%

                                                                        [AEpoch 198: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.180]Epoch 198: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057649, 0.057391, 0.058427
Train average loss UNet            (all)              : 0.173468

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000284, 4.491190, 7.947258
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001853, 4.288374, 6.459456
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001389, 4.398450, 6.478838
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001337, 4.464457, 6.926471
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000650, 4.640512, 6.697438
Train average loss all      (Triplet)                 : 0.001106

== Recognize ==
Train average loss Recognize     : 1.179609
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174574

Epoch 198:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]          Epoch 199:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=1.380, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=1.380, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.775, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.461, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.02it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.80it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.05it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.56it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.93it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071044, 0.071264, 0.069573
Valid average loss UNet            (all)              : 0.211881

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.124434, 4.630122, 7.253172
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.580543, 5.229681, 5.213690
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.827167, 5.132168, 5.047941
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.433146, 4.841187, 5.646803
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.452922, 5.031390, 5.614166
Valid average loss all      (Triplet)                 : 0.526080

== Recognize ==
Valid average loss Recognize     : 1.060454
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.737961

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.511701583862305 sec. =
Valid knn accuracy drums     : 78.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.509798765182495 sec. =
Valid knn accuracy bass      : 10.174418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.620611906051636 sec. =
Valid knn accuracy piano     : 31.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.499287128448486 sec. =
Valid knn accuracy guitar    : 49.51298701298701%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.543204545974731 sec. =
Valid knn accuracy residuals : 60.37735849056604%

Valid knn accuracy average   : 45.96446315550412%

                                                                        [AEpoch 199: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.180]Epoch 199: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057803, 0.057612, 0.058617
Train average loss UNet            (all)              : 0.174032

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000217, 4.669020, 8.174208
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002877, 4.494143, 6.773792
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002466, 4.604651, 6.772200
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002014, 4.653621, 7.282151
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002003, 4.802594, 6.911390
Train average loss all      (Triplet)                 : 0.001884

== Recognize ==
Train average loss Recognize     : 1.182001
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175916

Epoch 199:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]          Epoch 200:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]Epoch 200:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]Epoch 200:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=1.030, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]Epoch 200:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00137, Train/loss_recog_step=1.030, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]Epoch 200:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]  Epoch 200:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]Epoch 200:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]Epoch 200:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]Epoch 200:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00129, Train/loss_recog_step=1.160, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]Epoch 200:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00129, Train/loss_recog_step=1.160, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]Epoch 200:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]  Epoch 200:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]Epoch 200:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000539, Train/loss_recog_step=1.380, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]Epoch 200: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000539, Train/loss_recog_step=1.380, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]Epoch 200: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.650, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.24it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.42it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.20it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.17it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.85it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070052, 0.069016, 0.067736
Valid average loss UNet            (all)              : 0.206805

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.153420, 4.608973, 7.542723
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.697577, 5.177762, 5.030885
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.771414, 5.185080, 5.224893
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.500225, 5.145216, 5.834201
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.405256, 5.033076, 5.715670
Valid average loss all      (Triplet)                 : 0.579075

== Recognize ==
Valid average loss Recognize     : 1.062153
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.785880

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.936432123184204 sec. =
Valid knn accuracy drums     : 76.91176470588236%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.83168077468872 sec. =
Valid knn accuracy bass      : 13.08139534883721%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.156371355056763 sec. =
Valid knn accuracy piano     : 32.16216216216216%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.713230609893799 sec. =
Valid knn accuracy guitar    : 45.45454545454545%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.753428936004639 sec. =
Valid knn accuracy residuals : 61.47798742138365%

Valid knn accuracy average   : 45.81757101856216%

                                                                        [AEpoch 200: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00188, Train/loss_recog_epoch=1.180]Epoch 200: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057813, 0.057587, 0.058647
Train average loss UNet            (all)              : 0.174047

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000300, 4.613822, 8.125668
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003451, 4.456381, 6.668435
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002013, 4.541521, 6.670844
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001368, 4.612713, 7.207910
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001567, 4.808627, 6.954480
Train average loss all      (Triplet)                 : 0.001694

== Recognize ==
Train average loss Recognize     : 1.181694
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175742

Epoch 200:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]          Epoch 201:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 201:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 201:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=1.020, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 201:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=1.020, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 201:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]  Epoch 201:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 201:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000445, Train/loss_recog_step=0.843, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 201:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000445, Train/loss_recog_step=0.843, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 201:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]   Epoch 201:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 201:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=0.927, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 201:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=0.927, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 201:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]  Epoch 201: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 201: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.936, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.458, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.80it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.80it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.17it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.86it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.45it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069769, 0.067993, 0.067688
Valid average loss UNet            (all)              : 0.205450

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133422, 4.349041, 6.926194
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.564500, 4.973120, 5.001774
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.815726, 4.820755, 4.698532
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.350021, 4.754013, 5.560582
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.398677, 4.766733, 5.296707
Valid average loss all      (Triplet)                 : 0.501890

== Recognize ==
Valid average loss Recognize     : 1.061777
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.707340

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.166390895843506 sec. =
Valid knn accuracy drums     : 77.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.986170291900635 sec. =
Valid knn accuracy bass      : 19.912790697674417%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.82453203201294 sec. =
Valid knn accuracy piano     : 29.324324324324323%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.239323377609253 sec. =
Valid knn accuracy guitar    : 48.538961038961034%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.573487997055054 sec. =
Valid knn accuracy residuals : 60.691823899371066%

Valid knn accuracy average   : 47.19357999206616%

                                                                        [AEpoch 201: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 201: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057869, 0.057667, 0.058665
Train average loss UNet            (all)              : 0.174202

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000564, 4.515196, 7.921415
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002960, 4.360048, 6.554476
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002421, 4.428427, 6.493013
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002681, 4.496430, 6.988533
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002199, 4.732439, 6.845256
Train average loss all      (Triplet)                 : 0.002116

== Recognize ==
Train average loss Recognize     : 1.180912
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176318

Epoch 201:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]          Epoch 202:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00992, Train/loss_recog_step=1.230, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00992, Train/loss_recog_step=1.230, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]  Epoch 202:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=1.380, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=1.380, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.984, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.707, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.472, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.13it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.10it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.71it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.38it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.50it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.73it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067137, 0.066133, 0.065428
Valid average loss UNet            (all)              : 0.198698

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113135, 4.634074, 7.545165
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.585214, 5.225050, 5.238354
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.801189, 5.145771, 5.200328
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.411358, 5.003761, 5.699247
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.418498, 5.093990, 5.567025
Valid average loss all      (Triplet)                 : 0.506757

== Recognize ==
Valid average loss Recognize     : 1.065117
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.705454

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.162869930267334 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.0939359664917 sec. =
Valid knn accuracy bass      : 14.244186046511627%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.464422702789307 sec. =
Valid knn accuracy piano     : 30.810810810810814%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.306128978729248 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.116077899932861 sec. =
Valid knn accuracy residuals : 65.72327044025157%

Valid knn accuracy average   : 48.21447698892657%

                                                                        [AEpoch 202: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.180]Epoch 202: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057707, 0.057446, 0.058484
Train average loss UNet            (all)              : 0.173638

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000639, 4.388424, 7.799444
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002128, 4.193832, 6.347856
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001908, 4.274651, 6.287295
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001634, 4.376291, 6.915785
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000933, 4.573625, 6.639478
Train average loss all      (Triplet)                 : 0.001446

== Recognize ==
Train average loss Recognize     : 1.184871
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175084

Epoch 202:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]          Epoch 203:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 203:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 203:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000619, Train/loss_recog_step=1.030, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 203:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000619, Train/loss_recog_step=1.030, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 203:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=1.230, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180] Epoch 203:  48%|████▊     | 150/313 [02:09<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=1.230, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 203:  48%|████▊     | 150/313 [02:09<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]  Epoch 203:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 203:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 203:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 203:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000243, Train/loss_recog_step=0.933, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 203:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000243, Train/loss_recog_step=0.933, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 203:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=1.380, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]  Epoch 203: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=1.380, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 203: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.868, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.634, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.705, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.482, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.29it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.17it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.51it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.30it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.34it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069353, 0.067173, 0.066088
Valid average loss UNet            (all)              : 0.202614

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.128745, 4.453265, 7.387061
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.556427, 5.012908, 5.121057
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.680631, 4.805253, 4.893308
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.348779, 4.765934, 5.754297
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.378764, 4.804024, 5.180035
Valid average loss all      (Triplet)                 : 0.464470

== Recognize ==
Valid average loss Recognize     : 1.065651
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.667084

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.698212623596191 sec. =
Valid knn accuracy drums     : 77.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.943390846252441 sec. =
Valid knn accuracy bass      : 13.80813953488372%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.872230291366577 sec. =
Valid knn accuracy piano     : 29.324324324324323%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.390304327011108 sec. =
Valid knn accuracy guitar    : 46.590909090909086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.480701923370361 sec. =
Valid knn accuracy residuals : 63.9937106918239%

Valid knn accuracy average   : 46.33165202250586%

                                                                        [AEpoch 203: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 203: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057657, 0.057427, 0.058491
Train average loss UNet            (all)              : 0.173575

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000783, 4.452121, 7.757099
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002363, 4.225945, 6.333259
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001771, 4.309854, 6.311145
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001141, 4.420261, 6.995191
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000910, 4.597548, 6.663311
Train average loss all      (Triplet)                 : 0.001429

== Recognize ==
Train average loss Recognize     : 1.188017
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175004

Epoch 203:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]          Epoch 204:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=1.030, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00193, Train/loss_recog_step=1.030, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00502, Train/loss_recog_step=1.230, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00502, Train/loss_recog_step=1.230, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]  Epoch 204:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00942, Train/loss_recog_step=0.912, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.587, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.464, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.463, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.17it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.49it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.28it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.29it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.87it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067364, 0.066218, 0.064955
Valid average loss UNet            (all)              : 0.198536

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.117744, 4.811435, 7.949691
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.597868, 5.547809, 5.554613
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.676325, 5.207752, 5.408739
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.341494, 5.202486, 5.952262
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.441454, 5.466633, 5.845531
Valid average loss all      (Triplet)                 : 0.481016

== Recognize ==
Valid average loss Recognize     : 1.065008
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.679552

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.383657693862915 sec. =
Valid knn accuracy drums     : 77.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.976675987243652 sec. =
Valid knn accuracy bass      : 12.645348837209303%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.508189678192139 sec. =
Valid knn accuracy piano     : 28.243243243243242%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.894830226898193 sec. =
Valid knn accuracy guitar    : 47.07792207792208%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.600812435150146 sec. =
Valid knn accuracy residuals : 61.63522012578616%

Valid knn accuracy average   : 45.508582150949806%

                                                                        [AEpoch 204: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00942, Train/loss_recog_step=0.912, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00143, Train/loss_recog_epoch=1.190]Epoch 204: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00942, Train/loss_recog_step=0.912, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057501, 0.057215, 0.058280
Train average loss UNet            (all)              : 0.172996

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000341, 4.577754, 8.179672
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002294, 4.352568, 6.571001
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000881, 4.442027, 6.534536
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001661, 4.574123, 7.251658
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000883, 4.730138, 6.856133
Train average loss all      (Triplet)                 : 0.001304

== Recognize ==
Train average loss Recognize     : 1.187848
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174300

Epoch 204:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00942, Train/loss_recog_step=0.912, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]          Epoch 205:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00942, Train/loss_recog_step=0.912, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]Epoch 205:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00942, Train/loss_recog_step=0.912, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]Epoch 205:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]  Epoch 205:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]Epoch 205:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00624, Train/loss_recog_step=1.230, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]Epoch 205:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00624, Train/loss_recog_step=1.230, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]Epoch 205:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]  Epoch 205:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]Epoch 205:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]Epoch 205:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]Epoch 205:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000398, Train/loss_recog_step=0.938, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]Epoch 205:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000398, Train/loss_recog_step=0.938, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]Epoch 205:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00528, Train/loss_recog_step=1.390, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190] Epoch 205: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00528, Train/loss_recog_step=1.390, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]Epoch 205: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.917, Valid/loss_all_step=0.832, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.603, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.680, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.455, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.34it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.81it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.25it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.35it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066183, 0.065763, 0.064012
Valid average loss UNet            (all)              : 0.195958

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.115744, 4.532659, 7.215263
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.496752, 5.146987, 5.388134
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.793248, 5.100636, 5.207088
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.277001, 5.012655, 5.860272
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.433832, 5.227829, 5.514062
Valid average loss all      (Triplet)                 : 0.450747

== Recognize ==
Valid average loss Recognize     : 1.069792
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.646704

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.113903522491455 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.625201940536499 sec. =
Valid knn accuracy bass      : 18.459302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.280173540115356 sec. =
Valid knn accuracy piano     : 26.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.316383600234985 sec. =
Valid knn accuracy guitar    : 49.83766233766234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.687175750732422 sec. =
Valid knn accuracy residuals : 67.9245283018868%

Valid knn accuracy average   : 48.12744644676219%

                                                                        [AEpoch 205: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.917, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0013, Train/loss_recog_epoch=1.190]Epoch 205: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.917, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057577, 0.057311, 0.058371
Train average loss UNet            (all)              : 0.173259

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000246, 4.543083, 7.988882
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001677, 4.371211, 6.605973
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002647, 4.442249, 6.489222
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001885, 4.540430, 7.115574
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001417, 4.718780, 6.816791
Train average loss all      (Triplet)                 : 0.001561

== Recognize ==
Train average loss Recognize     : 1.189823
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174820

Epoch 205:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.917, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]          Epoch 206:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.917, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.917, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000537, Train/loss_recog_step=1.030, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000537, Train/loss_recog_step=1.030, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]   Epoch 206:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.790, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.564, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.29it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.89it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.93it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.05it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.12it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.69it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067965, 0.067387, 0.066063
Valid average loss UNet            (all)              : 0.201415

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143481, 4.650779, 6.905965
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.571192, 5.174118, 5.160357
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.847135, 5.238763, 5.218422
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.576903, 5.158956, 5.750502
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.364867, 5.159723, 5.895205
Valid average loss all      (Triplet)                 : 0.557834

== Recognize ==
Valid average loss Recognize     : 1.064980
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.759249

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.248681545257568 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.152693271636963 sec. =
Valid knn accuracy bass      : 19.040697674418606%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.623384952545166 sec. =
Valid knn accuracy piano     : 33.78378378378378%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.354165315628052 sec. =
Valid knn accuracy guitar    : 53.246753246753244%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.483797311782837 sec. =
Valid knn accuracy residuals : 64.15094339622641%

Valid knn accuracy average   : 49.603259149648174%

                                                                        [AEpoch 206: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.190]Epoch 206: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057578, 0.057344, 0.058387
Train average loss UNet            (all)              : 0.173308

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000598, 4.631807, 8.125158
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002619, 4.445189, 6.681687
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002548, 4.526914, 6.697308
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001909, 4.655717, 7.377604
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001233, 4.817243, 7.028968
Train average loss all      (Triplet)                 : 0.001812

== Recognize ==
Train average loss Recognize     : 1.189641
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175120

Epoch 206:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]          Epoch 207:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 207:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 207:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=1.030, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 207:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00428, Train/loss_recog_step=1.030, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 207:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]  Epoch 207:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 207:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.843, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 207:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.843, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 207:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00024, Train/loss_recog_step=1.150, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 207:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00024, Train/loss_recog_step=1.150, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 207:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.927, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190] Epoch 207:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.927, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 207:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190] Epoch 207: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 207: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.890, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.759, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.558, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.496, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.32it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.15it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068472, 0.066981, 0.066157
Valid average loss UNet            (all)              : 0.201609

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.109808, 5.005195, 8.097449
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.649299, 5.501422, 5.455245
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.807919, 5.434574, 5.492502
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.503326, 5.353363, 6.288576
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.402685, 5.471314, 6.052169
Valid average loss all      (Triplet)                 : 0.546754

== Recognize ==
Valid average loss Recognize     : 1.058418
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.748363

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.46293568611145 sec. =
Valid knn accuracy drums     : 79.26470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.072892904281616 sec. =
Valid knn accuracy bass      : 17.587209302325583%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.04438304901123 sec. =
Valid knn accuracy piano     : 31.216216216216214%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.532905340194702 sec. =
Valid knn accuracy guitar    : 47.88961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.759214639663696 sec. =
Valid knn accuracy residuals : 64.30817610062893%

Valid knn accuracy average   : 48.053183578226815%

                                                                        [AEpoch 207: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.190]Epoch 207: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057602, 0.057364, 0.058484
Train average loss UNet            (all)              : 0.173449

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000969, 4.575334, 8.036133
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002142, 4.396483, 6.627707
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001332, 4.497649, 6.645247
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002618, 4.581938, 7.218276
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001424, 4.781287, 6.949977
Train average loss all      (Triplet)                 : 0.001695

== Recognize ==
Train average loss Recognize     : 1.182434
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175144

Epoch 207:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]          Epoch 208:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.0012, Train/loss_recog_step=1.380, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.0012, Train/loss_recog_step=1.380, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.905, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.770, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.481, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.96it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.48it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.02it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.98it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.76it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067459, 0.065972, 0.065021
Valid average loss UNet            (all)              : 0.198452

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090724, 4.849181, 7.485316
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.668647, 5.561410, 5.489861
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.990556, 5.613512, 5.287398
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.478325, 5.391796, 6.288951
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.405972, 5.517347, 6.050008
Valid average loss all      (Triplet)                 : 0.585962

== Recognize ==
Valid average loss Recognize     : 1.058323
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.784414

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.383262872695923 sec. =
Valid knn accuracy drums     : 76.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.53627872467041 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.413105010986328 sec. =
Valid knn accuracy piano     : 31.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.468783378601074 sec. =
Valid knn accuracy guitar    : 47.564935064935064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.548659563064575 sec. =
Valid knn accuracy residuals : 62.735849056603776%

Valid knn accuracy average   : 47.26166715817104%

                                                                        [AEpoch 208: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.905, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00169, Train/loss_recog_epoch=1.180]Epoch 208: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.905, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057427, 0.057124, 0.058216
Train average loss UNet            (all)              : 0.172767

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000317, 4.683378, 8.272841
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002014, 4.464163, 6.755925
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000968, 4.618525, 6.866724
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001707, 4.695557, 7.400002
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001454, 4.927146, 7.205771
Train average loss all      (Triplet)                 : 0.001254

== Recognize ==
Train average loss Recognize     : 1.178861
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174021

Epoch 208:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.905, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]          Epoch 209:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.905, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 209:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=0.905, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 209:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]  Epoch 209:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 209:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 209:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 209:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 209:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 209:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00432, Train/loss_recog_step=1.150, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 209:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00432, Train/loss_recog_step=1.150, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 209:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=0.924, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180] Epoch 209:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=0.924, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 209:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180] Epoch 209: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 209: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.903, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.878, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.784, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.93it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.66it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.14it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.75it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.20it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.30it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067300, 0.065822, 0.064181
Valid average loss UNet            (all)              : 0.197303

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.126453, 5.181711, 8.216976
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.697867, 5.920379, 5.957345
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.117712, 5.936853, 5.570031
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.358861, 5.546568, 6.598707
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.433346, 5.967549, 6.303854
Valid average loss all      (Triplet)                 : 0.606816

== Recognize ==
Valid average loss Recognize     : 1.057697
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.804119

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.77139663696289 sec. =
Valid knn accuracy drums     : 76.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.687337875366211 sec. =
Valid knn accuracy bass      : 19.040697674418606%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.446178913116455 sec. =
Valid knn accuracy piano     : 33.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.502881526947021 sec. =
Valid knn accuracy guitar    : 49.67532467532468%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.627281665802002 sec. =
Valid knn accuracy residuals : 60.22012578616353%

Valid knn accuracy average   : 47.92395458743573%

                                                                        [AEpoch 209: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.903, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 209: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.903, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057481, 0.057261, 0.058269
Train average loss UNet            (all)              : 0.173010

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000436, 4.859639, 8.462363
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001967, 4.664261, 7.055267
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001737, 4.796280, 7.094610
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001899, 4.869128, 7.677189
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001498, 5.120918, 7.482380
Train average loss all      (Triplet)                 : 0.001563

== Recognize ==
Train average loss Recognize     : 1.176854
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174574

Epoch 209:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.903, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]          Epoch 210:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.903, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.903, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.0141, Train/loss_recog_step=1.020, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.0141, Train/loss_recog_step=1.020, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180] Epoch 210:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.843, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.843, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.926, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.926, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.804, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.479, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.58it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.49it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.75it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.35it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066391, 0.065831, 0.063785
Valid average loss UNet            (all)              : 0.196008

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.109585, 5.038390, 8.158521
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.719024, 5.782593, 5.734113
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.950953, 5.715529, 5.365360
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.398120, 5.465569, 6.498617
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.404661, 5.619223, 6.487515
Valid average loss all      (Triplet)                 : 0.587395

== Recognize ==
Valid average loss Recognize     : 1.056745
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.783403

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.132450103759766 sec. =
Valid knn accuracy drums     : 78.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.487040996551514 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.115283966064453 sec. =
Valid knn accuracy piano     : 31.351351351351354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.518371343612671 sec. =
Valid knn accuracy guitar    : 48.86363636363637%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.294157266616821 sec. =
Valid knn accuracy residuals : 59.74842767295597%

Valid knn accuracy average   : 46.5467186453042%

                                                                        [AEpoch 210: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00156, Train/loss_recog_epoch=1.180]Epoch 210: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057372, 0.057145, 0.058174
Train average loss UNet            (all)              : 0.172691

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000616, 4.736742, 8.478929
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001695, 4.562050, 6.928743
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000977, 4.623615, 6.822365
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002284, 4.693803, 7.357494
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001853, 4.945192, 7.160992
Train average loss all      (Triplet)                 : 0.001516

== Recognize ==
Train average loss Recognize     : 1.179387
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174207

Epoch 210:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]          Epoch 211:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=1.020, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=1.020, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00617, Train/loss_recog_step=1.220, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00617, Train/loss_recog_step=1.220, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]  Epoch 211:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.841, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.926, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.926, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00569, Train/loss_recog_step=1.380, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00569, Train/loss_recog_step=1.380, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.465, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.72it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.33it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069429, 0.069843, 0.069179
Valid average loss UNet            (all)              : 0.208451

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.169188, 4.961806, 8.215883
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.728437, 5.750970, 5.660608
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.738134, 5.503111, 5.433241
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.319691, 5.477349, 6.280365
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.396594, 5.745811, 6.412453
Valid average loss all      (Triplet)                 : 0.534702

== Recognize ==
Valid average loss Recognize     : 1.058633
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.743153

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.257445096969604 sec. =
Valid knn accuracy drums     : 76.3235294117647%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.346754550933838 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.547857284545898 sec. =
Valid knn accuracy piano     : 30.405405405405407%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.607657670974731 sec. =
Valid knn accuracy guitar    : 45.616883116883116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.923760890960693 sec. =
Valid knn accuracy residuals : 60.84905660377359%

Valid knn accuracy average   : 45.952928395937455%

                                                                        [AEpoch 211: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.180]Epoch 211: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057267, 0.057110, 0.058109
Train average loss UNet            (all)              : 0.172486

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000943, 4.773592, 8.405358
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001759, 4.597578, 6.964954
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002171, 4.699885, 6.933694
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001037, 4.761958, 7.483611
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001449, 5.073111, 7.372779
Train average loss all      (Triplet)                 : 0.001458

== Recognize ==
Train average loss Recognize     : 1.178339
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.173945

Epoch 211:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]          Epoch 212:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 212:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 212:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00597, Train/loss_recog_step=1.020, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 212:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00597, Train/loss_recog_step=1.020, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 212:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]  Epoch 212:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 212:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000728, Train/loss_recog_step=0.843, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 212:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000728, Train/loss_recog_step=0.843, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 212:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]   Epoch 212:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 212:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000182, Train/loss_recog_step=0.929, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 212:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000182, Train/loss_recog_step=0.929, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 212:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=5.28e-5, Train/loss_recog_step=1.380, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180] Epoch 212: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=5.28e-5, Train/loss_recog_step=1.380, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 212: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.989, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.743, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.460, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.21it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.89it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.36it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.17it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.57it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.065990, 0.065229, 0.064749
Valid average loss UNet            (all)              : 0.195968

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.140595, 4.933943, 7.843985
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.719601, 5.695682, 5.605678
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.706867, 5.429006, 5.389062
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.287483, 5.515044, 6.726088
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.384840, 5.579597, 5.937612
Valid average loss all      (Triplet)                 : 0.513982

== Recognize ==
Valid average loss Recognize     : 1.058056
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.709951

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.125793933868408 sec. =
Valid knn accuracy drums     : 75.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.878419876098633 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.349335670471191 sec. =
Valid knn accuracy piano     : 34.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.582690715789795 sec. =
Valid knn accuracy guitar    : 48.86363636363637%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.620710849761963 sec. =
Valid knn accuracy residuals : 60.84905660377359%

Valid knn accuracy average   : 47.378908616035325%

                                                                        [AEpoch 212: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00146, Train/loss_recog_epoch=1.180]Epoch 212: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057085, 0.056889, 0.057873
Train average loss UNet            (all)              : 0.171847

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000296, 4.668359, 8.216867
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000942, 4.544654, 6.919414
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000944, 4.619879, 6.823308
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001121, 4.740008, 7.452092
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001033, 4.934314, 7.121359
Train average loss all      (Triplet)                 : 0.000910

== Recognize ==
Train average loss Recognize     : 1.179603
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.172757

Epoch 212:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]          Epoch 213:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]Epoch 213:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]Epoch 213:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=1.020, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]Epoch 213:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=1.020, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]Epoch 213:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00933, Train/loss_recog_step=1.220, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]Epoch 213:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00933, Train/loss_recog_step=1.220, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]Epoch 213:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.843, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180] Epoch 213:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.843, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]Epoch 213:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180] Epoch 213:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]Epoch 213:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]Epoch 213:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]Epoch 213:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.380, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]Epoch 213: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.380, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]Epoch 213: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.474, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.33it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.84it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.01it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.67it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066336, 0.065325, 0.063979
Valid average loss UNet            (all)              : 0.195640

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.137546, 5.491065, 8.863807
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.888611, 6.376895, 6.139114
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.901579, 6.110558, 5.936479
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.272423, 5.929618, 7.148369
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.393827, 6.084336, 6.519848
Valid average loss all      (Triplet)                 : 0.595701

== Recognize ==
Valid average loss Recognize     : 1.062090
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.791341

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.014007329940796 sec. =
Valid knn accuracy drums     : 77.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.791098833084106 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.515344142913818 sec. =
Valid knn accuracy piano     : 30.405405405405407%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.444257974624634 sec. =
Valid knn accuracy guitar    : 51.13636363636363%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.466689348220825 sec. =
Valid knn accuracy residuals : 62.106918238993714%

Valid knn accuracy average   : 47.51564716887485%

                                                                        [AEpoch 213: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00091, Train/loss_recog_epoch=1.180]Epoch 213: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057246, 0.056951, 0.058055
Train average loss UNet            (all)              : 0.172252

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000255, 4.905957, 8.657203
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002337, 4.756935, 7.188122
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001465, 4.915629, 7.250947
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000996, 4.969765, 7.889262
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001135, 5.197007, 7.533835
Train average loss all      (Triplet)                 : 0.001253

== Recognize ==
Train average loss Recognize     : 1.181533
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.173505

Epoch 213:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]          Epoch 214:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00469, Train/loss_recog_step=1.230, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00469, Train/loss_recog_step=1.230, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]  Epoch 214:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.914, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.596, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.475, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.51it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.77it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.98it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068197, 0.066680, 0.066438
Valid average loss UNet            (all)              : 0.201315

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.159516, 4.890474, 7.645618
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.724208, 5.525321, 5.355445
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.855619, 5.494243, 5.275640
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.238926, 5.366058, 6.555172
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.621006, 5.721995, 5.800610
Valid average loss all      (Triplet)                 : 0.567907

== Recognize ==
Valid average loss Recognize     : 1.063849
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.769222

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.788289546966553 sec. =
Valid knn accuracy drums     : 76.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.602963209152222 sec. =
Valid knn accuracy bass      : 17.151162790697676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.868410110473633 sec. =
Valid knn accuracy piano     : 30.54054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.504980564117432 sec. =
Valid knn accuracy guitar    : 46.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.206130027770996 sec. =
Valid knn accuracy residuals : 63.52201257861635%

Valid knn accuracy average   : 46.76375158533226%

                                                                        [AEpoch 214: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.180]Epoch 214: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057328, 0.056975, 0.058095
Train average loss UNet            (all)              : 0.172398

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000945, 4.880071, 8.542247
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002357, 4.760526, 7.185609
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002202, 4.895077, 7.231562
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001438, 4.912438, 7.756734
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000949, 5.173122, 7.485050
Train average loss all      (Triplet)                 : 0.001453

== Recognize ==
Train average loss Recognize     : 1.184703
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.173851

Epoch 214:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]          Epoch 215:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 215:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 215:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 215:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 215:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0049, Train/loss_recog_step=1.230, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 215:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0049, Train/loss_recog_step=1.230, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 215:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00425, Train/loss_recog_step=0.847, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 215:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00425, Train/loss_recog_step=0.847, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 215:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=1.160, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180] Epoch 215:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=1.160, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 215:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180] Epoch 215:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 215:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 215: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 215: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.568, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.468, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.19it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.80it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.31it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.14it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.53it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067680, 0.066074, 0.066480
Valid average loss UNet            (all)              : 0.200235

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.165406, 4.760305, 7.340080
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.783221, 5.417836, 5.189379
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.818958, 5.334000, 5.145913
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.247272, 5.185319, 6.289279
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.324095, 5.331391, 5.791016
Valid average loss all      (Triplet)                 : 0.546278

== Recognize ==
Valid average loss Recognize     : 1.065196
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.746513

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.44202470779419 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.52838921546936 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.022802591323853 sec. =
Valid knn accuracy piano     : 30.405405405405407%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.458982467651367 sec. =
Valid knn accuracy guitar    : 48.05194805194805%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.821505546569824 sec. =
Valid knn accuracy residuals : 60.22012578616353%

Valid knn accuracy average   : 46.60964085554335%

                                                                        [AEpoch 215: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.180]Epoch 215: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057222, 0.056972, 0.057998
Train average loss UNet            (all)              : 0.172192

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000208, 4.703060, 8.252540
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003408, 4.517067, 6.817838
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002024, 4.634606, 6.860126
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001551, 4.702804, 7.443153
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001611, 4.916294, 7.121179
Train average loss all      (Triplet)                 : 0.001778

== Recognize ==
Train average loss Recognize     : 1.185620
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.173970

Epoch 215:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]          Epoch 216:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]Epoch 216:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]Epoch 216:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.0018, Train/loss_recog_step=1.030, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]Epoch 216:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.0018, Train/loss_recog_step=1.030, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]Epoch 216:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000804, Train/loss_recog_step=1.230, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]Epoch 216:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000804, Train/loss_recog_step=1.230, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]Epoch 216:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]   Epoch 216:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]Epoch 216:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=1.160, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]Epoch 216:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=1.160, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]Epoch 216:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190] Epoch 216:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]Epoch 216:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]Epoch 216: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]Epoch 216: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.941, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.98it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.49it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.51it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.97it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.13it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.52it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066912, 0.066098, 0.064922
Valid average loss UNet            (all)              : 0.197933

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.168308, 4.907080, 7.715110
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.794752, 5.641483, 5.402432
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.870630, 5.538212, 5.395163
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.220748, 5.333356, 6.373450
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.407897, 5.439824, 5.935244
Valid average loss all      (Triplet)                 : 0.562100

== Recognize ==
Valid average loss Recognize     : 1.066317
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.760033

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.949042081832886 sec. =
Valid knn accuracy drums     : 76.3235294117647%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.761265516281128 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.221035718917847 sec. =
Valid knn accuracy piano     : 32.972972972972975%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.40261173248291 sec. =
Valid knn accuracy guitar    : 49.02597402597403%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.548082828521729 sec. =
Valid knn accuracy residuals : 62.42138364779875%

Valid knn accuracy average   : 46.96853945356255%

                                                                        [AEpoch 216: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.190]Epoch 216: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057091, 0.056862, 0.057922
Train average loss UNet            (all)              : 0.171875

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000154, 4.737430, 8.309062
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002056, 4.582427, 6.910776
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001433, 4.676786, 7.006213
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001206, 4.749990, 7.553417
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001433, 4.980622, 7.256620
Train average loss all      (Triplet)                 : 0.001245

== Recognize ==
Train average loss Recognize     : 1.185094
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.173119

Epoch 216:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]          Epoch 217:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.904, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.470, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.44it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.21it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.49it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067145, 0.066034, 0.065861
Valid average loss UNet            (all)              : 0.199040

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.152341, 4.829024, 7.673588
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.751038, 5.681735, 5.598552
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.841497, 5.560032, 5.510931
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.222810, 5.204365, 6.409198
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.345157, 5.512300, 6.255172
Valid average loss all      (Triplet)                 : 0.535144

== Recognize ==
Valid average loss Recognize     : 1.068176
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.734184

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.425838708877563 sec. =
Valid knn accuracy drums     : 74.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.126041173934937 sec. =
Valid knn accuracy bass      : 20.203488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.635819435119629 sec. =
Valid knn accuracy piano     : 31.351351351351354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.198991537094116 sec. =
Valid knn accuracy guitar    : 48.37662337662338%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.558919906616211 sec. =
Valid knn accuracy residuals : 62.893081761006286%

Valid knn accuracy average   : 47.53549720750893%

                                                                        [AEpoch 217: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00124, Train/loss_recog_epoch=1.190]Epoch 217: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056948, 0.056747, 0.057760
Train average loss UNet            (all)              : 0.171456

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000051, 4.708604, 8.260611
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002316, 4.526872, 6.862689
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001110, 4.640288, 6.951399
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001572, 4.744446, 7.471610
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000901, 4.945638, 7.246105
Train average loss all      (Triplet)                 : 0.001235

== Recognize ==
Train average loss Recognize     : 1.187689
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.172691

Epoch 217:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]          Epoch 218:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=1.030, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=1.030, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=1.230, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=1.230, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]  Epoch 218:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.916, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.897, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.535, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.475, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.93it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.00it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.71it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.81it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.77it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070859, 0.069543, 0.069254
Valid average loss UNet            (all)              : 0.209656

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.148434, 4.717384, 7.551388
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.728693, 5.387560, 5.291357
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.704501, 5.315317, 5.288818
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.269665, 5.239598, 6.097851
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.409106, 5.336543, 5.694921
Valid average loss all      (Triplet)                 : 0.529769

== Recognize ==
Valid average loss Recognize     : 1.073527
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.739425

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.983177185058594 sec. =
Valid knn accuracy drums     : 76.61764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.835220098495483 sec. =
Valid knn accuracy bass      : 17.151162790697676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.491510391235352 sec. =
Valid knn accuracy piano     : 33.24324324324324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.814459800720215 sec. =
Valid knn accuracy guitar    : 46.590909090909086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.555640459060669 sec. =
Valid knn accuracy residuals : 62.893081761006286%

Valid knn accuracy average   : 47.29920878893596%

                                                                        [AEpoch 218: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.916, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.190]Epoch 218: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.916, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056985, 0.056746, 0.057808
Train average loss UNet            (all)              : 0.171538

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000422, 4.621387, 7.997411
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002529, 4.463736, 6.746563
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001278, 4.526338, 6.721130
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001176, 4.636645, 7.283188
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001640, 4.817755, 6.964028
Train average loss all      (Triplet)                 : 0.001452

== Recognize ==
Train average loss Recognize     : 1.190567
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.172990

Epoch 218:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.916, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]          Epoch 219:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.916, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.916, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219:  32%|███▏      | 100/313 [01:28<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00593, Train/loss_recog_step=1.240, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00593, Train/loss_recog_step=1.240, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=0.852, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=0.852, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]  Epoch 219:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.530, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.20it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.38it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.40it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.50it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069027, 0.068090, 0.066099
Valid average loss UNet            (all)              : 0.203216

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.152933, 5.058606, 7.953897
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.746188, 5.635158, 5.486553
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.795264, 5.572604, 5.511721
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.418872, 5.498539, 6.182356
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.405040, 5.771541, 6.194238
Valid average loss all      (Triplet)                 : 0.586795

== Recognize ==
Valid average loss Recognize     : 1.075341
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.790012

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.128472328186035 sec. =
Valid knn accuracy drums     : 74.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.837328433990479 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.099085092544556 sec. =
Valid knn accuracy piano     : 31.756756756756754%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.519480228424072 sec. =
Valid knn accuracy guitar    : 44.15584415584416%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.592348337173462 sec. =
Valid knn accuracy residuals : 61.79245283018868%

Valid knn accuracy average   : 45.5047590385716%

                                                                        [AEpoch 219: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.00145, Train/loss_recog_epoch=1.190]Epoch 219: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057049, 0.056761, 0.057792
Train average loss UNet            (all)              : 0.171601

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000400, 4.845685, 8.508282
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001551, 4.635167, 7.002653
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001581, 4.696605, 7.023044
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001038, 4.788268, 7.535218
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000823, 4.996402, 7.268393
Train average loss all      (Triplet)                 : 0.001102

== Recognize ==
Train average loss Recognize     : 1.193319
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.172703

Epoch 219:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]          Epoch 220:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]Epoch 220:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]Epoch 220:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]Epoch 220:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]Epoch 220:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00724, Train/loss_recog_step=1.240, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]Epoch 220:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00724, Train/loss_recog_step=1.240, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]Epoch 220:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]  Epoch 220:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]Epoch 220:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00703, Train/loss_recog_step=1.170, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]Epoch 220:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00703, Train/loss_recog_step=1.170, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]Epoch 220:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]  Epoch 220:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]Epoch 220:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=1.400, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]Epoch 220: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00245, Train/loss_recog_step=1.400, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]Epoch 220: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0252, Train/loss_recog_step=0.918, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.790, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.15it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.21it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.95it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.13it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.32it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066885, 0.067389, 0.065699
Valid average loss UNet            (all)              : 0.199973

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.203867, 4.839608, 7.437271
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.689701, 5.431319, 5.295163
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.915066, 5.588655, 5.342027
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.295379, 5.259168, 6.214313
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.403130, 5.656082, 5.987986
Valid average loss all      (Triplet)                 : 0.573309

== Recognize ==
Valid average loss Recognize     : 1.072293
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.773282

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.210024356842041 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.050328969955444 sec. =
Valid knn accuracy bass      : 21.075581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.502689361572266 sec. =
Valid knn accuracy piano     : 33.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.5839102268219 sec. =
Valid knn accuracy guitar    : 48.05194805194805%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.441067218780518 sec. =
Valid knn accuracy residuals : 64.30817610062893%

Valid knn accuracy average   : 49.02974842278071%

                                                                        [AEpoch 220: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0252, Train/loss_recog_step=0.918, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.0011, Train/loss_recog_epoch=1.190]Epoch 220: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0252, Train/loss_recog_step=0.918, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057337, 0.057049, 0.058130
Train average loss UNet            (all)              : 0.172516

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000808, 4.977208, 8.574830
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003069, 4.821650, 7.210261
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001775, 4.922511, 7.290333
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002610, 5.019638, 7.836288
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001382, 5.235672, 7.572177
Train average loss all      (Triplet)                 : 0.001939

== Recognize ==
Train average loss Recognize     : 1.194972
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174455

Epoch 220:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0252, Train/loss_recog_step=0.918, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]          Epoch 221:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0252, Train/loss_recog_step=0.918, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0252, Train/loss_recog_step=0.918, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190] Epoch 221:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000879, Train/loss_recog_step=0.918, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.906, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.490, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.14it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.00it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.75it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.66it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.73it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066043, 0.066107, 0.064062
Valid average loss UNet            (all)              : 0.196213

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.185296, 4.491210, 7.054632
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.797186, 5.114679, 4.879819
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.866664, 5.121619, 5.025105
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.292930, 4.944317, 5.906843
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.403155, 5.056738, 5.361642
Valid average loss all      (Triplet)                 : 0.586724

== Recognize ==
Valid average loss Recognize     : 1.069390
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.782937

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.157771348953247 sec. =
Valid knn accuracy drums     : 77.20588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.811429977416992 sec. =
Valid knn accuracy bass      : 17.296511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.506791830062866 sec. =
Valid knn accuracy piano     : 30.810810810810814%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.830159664154053 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.273437738418579 sec. =
Valid knn accuracy residuals : 61.32075471698113%

Valid knn accuracy average   : 47.32679190172802%

                                                                        [AEpoch 221: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000879, Train/loss_recog_step=0.918, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00194, Train/loss_recog_epoch=1.190]Epoch 221: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000879, Train/loss_recog_step=0.918, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056754, 0.056480, 0.057547
Train average loss UNet            (all)              : 0.170780

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000300, 4.488757, 7.893135
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001479, 4.312212, 6.510632
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000825, 4.370361, 6.496409
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001107, 4.472827, 7.030247
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001156, 4.703327, 6.824476
Train average loss all      (Triplet)                 : 0.000990

== Recognize ==
Train average loss Recognize     : 1.194223
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.171770

Epoch 221:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000879, Train/loss_recog_step=0.918, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]          Epoch 222:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000879, Train/loss_recog_step=0.918, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]Epoch 222:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000879, Train/loss_recog_step=0.918, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]Epoch 222:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]   Epoch 222:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]Epoch 222:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=1.240, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]Epoch 222:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=1.240, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]Epoch 222:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]  Epoch 222:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]Epoch 222:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]Epoch 222:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]Epoch 222:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]Epoch 222:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]Epoch 222:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]Epoch 222: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]Epoch 222: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.783, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.84it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.86it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.92it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.59it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.54it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066976, 0.066004, 0.065410
Valid average loss UNet            (all)              : 0.198390

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.175700, 5.319347, 8.710148
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.716871, 5.972096, 5.932884
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.922864, 5.956148, 5.865676
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.300884, 5.756231, 6.834277
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.524427, 6.208977, 6.367933
Valid average loss all      (Triplet)                 : 0.589077

== Recognize ==
Valid average loss Recognize     : 1.070553
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.787467

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.085973501205444 sec. =
Valid knn accuracy drums     : 73.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.899765491485596 sec. =
Valid knn accuracy bass      : 18.023255813953487%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.64911937713623 sec. =
Valid knn accuracy piano     : 30.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.417129755020142 sec. =
Valid knn accuracy guitar    : 50.16233766233766%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.572067737579346 sec. =
Valid knn accuracy residuals : 64.62264150943396%

Valid knn accuracy average   : 47.2675293500862%

                                                                        [AEpoch 222: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00099, Train/loss_recog_epoch=1.190]Epoch 222: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056850, 0.056592, 0.057644
Train average loss UNet            (all)              : 0.171086

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000635, 4.843440, 8.440377
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001291, 4.669302, 7.052984
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001635, 4.791903, 7.134536
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000728, 4.858826, 7.677011
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000960, 5.109543, 7.423898
Train average loss all      (Triplet)                 : 0.001066

== Recognize ==
Train average loss Recognize     : 1.194239
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.172152

Epoch 222:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]          Epoch 223:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]Epoch 223:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]Epoch 223:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]Epoch 223:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]Epoch 223:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00058, Train/loss_recog_step=1.240, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]Epoch 223:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00058, Train/loss_recog_step=1.240, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]Epoch 223:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]  Epoch 223:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]Epoch 223:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]Epoch 223:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]Epoch 223:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00255, Train/loss_recog_step=0.945, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]Epoch 223:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00255, Train/loss_recog_step=0.945, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]Epoch 223:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=1.390, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190] Epoch 223: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=1.390, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]Epoch 223: 100%|██████████| 313/313 [04:26<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.14it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.65it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.99it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.29it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.04it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066067, 0.065947, 0.064853
Valid average loss UNet            (all)              : 0.196867

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.193182, 5.270350, 8.272156
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.753896, 5.942133, 5.789657
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.740691, 5.830011, 5.921653
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.329339, 5.789212, 6.810965
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.432548, 6.296187, 6.481006
Valid average loss all      (Triplet)                 : 0.553031

== Recognize ==
Valid average loss Recognize     : 1.069311
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.749898

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.26297926902771 sec. =
Valid knn accuracy drums     : 76.91176470588236%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.767283916473389 sec. =
Valid knn accuracy bass      : 14.825581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.813804626464844 sec. =
Valid knn accuracy piano     : 28.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.652484893798828 sec. =
Valid knn accuracy guitar    : 51.13636363636363%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.473079442977905 sec. =
Valid knn accuracy residuals : 61.63522012578616%

Valid knn accuracy average   : 46.685569756459984%

                                                                        [AEpoch 223: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.190]Epoch 223: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056865, 0.056665, 0.057692
Train average loss UNet            (all)              : 0.171223

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000399, 5.121492, 9.040906
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001735, 4.979111, 7.512483
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002051, 5.056357, 7.478003
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000821, 5.148939, 8.057775
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001381, 5.386167, 7.816957
Train average loss all      (Triplet)                 : 0.001282

== Recognize ==
Train average loss Recognize     : 1.194022
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.172504

Epoch 223:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]          Epoch 224:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.230, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.230, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190] Epoch 224:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.467, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.33it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.23it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.60it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.15it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.62it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066772, 0.066198, 0.064871
Valid average loss UNet            (all)              : 0.197841

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.182600, 4.713973, 7.655547
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.586631, 5.331382, 5.336936
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.768873, 5.424090, 5.398819
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.268860, 5.315869, 6.307174
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.353493, 5.750628, 6.144680
Valid average loss all      (Triplet)                 : 0.477816

== Recognize ==
Valid average loss Recognize     : 1.066406
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.675658

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.174503087997437 sec. =
Valid knn accuracy drums     : 77.64705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.757501125335693 sec. =
Valid knn accuracy bass      : 17.151162790697676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.311241149902344 sec. =
Valid knn accuracy piano     : 32.027027027027025%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.281013250350952 sec. =
Valid knn accuracy guitar    : 48.86363636363637%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.104640483856201 sec. =
Valid knn accuracy residuals : 60.84905660377359%

Valid knn accuracy average   : 47.307588321732815%

                                                                        [AEpoch 224: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00128, Train/loss_recog_epoch=1.190]Epoch 224: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056992, 0.056721, 0.057741
Train average loss UNet            (all)              : 0.171453

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000647, 4.814003, 8.368653
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002627, 4.733074, 7.115739
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001895, 4.812994, 7.055766
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002254, 4.920810, 7.667083
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002043, 5.111537, 7.399100
Train average loss all      (Triplet)                 : 0.001974

== Recognize ==
Train average loss Recognize     : 1.188934
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.173427

Epoch 224:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]          Epoch 225:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.850, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=1.170, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=1.170, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190] Epoch 225:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=0.922, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.676, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.478, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.473, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.85it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.21it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.12it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.01it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.66it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.69it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066419, 0.065530, 0.063737
Valid average loss UNet            (all)              : 0.195686

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.140478, 4.755823, 7.563028
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.607968, 5.285129, 5.224333
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.708129, 5.406534, 5.422277
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.282314, 5.405680, 6.438684
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.333287, 5.456189, 5.852543
Valid average loss all      (Triplet)                 : 0.456525

== Recognize ==
Valid average loss Recognize     : 1.070469
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.652211

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.270177125930786 sec. =
Valid knn accuracy drums     : 75.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.513488531112671 sec. =
Valid knn accuracy bass      : 17.151162790697676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.369287967681885 sec. =
Valid knn accuracy piano     : 29.864864864864867%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.194366455078125 sec. =
Valid knn accuracy guitar    : 48.86363636363637%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.762703895568848 sec. =
Valid knn accuracy residuals : 61.47798742138365%

Valid knn accuracy average   : 46.6480008763518%

                                                                        [AEpoch 225: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00197, Train/loss_recog_epoch=1.190]Epoch 225: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056562, 0.056358, 0.057431
Train average loss UNet            (all)              : 0.170352

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000224, 4.572160, 8.018235
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001419, 4.458571, 6.730480
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002354, 4.551891, 6.719797
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000591, 4.617745, 7.218989
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001207, 4.830460, 7.043887
Train average loss all      (Triplet)                 : 0.001174

== Recognize ==
Train average loss Recognize     : 1.191476
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.171526

Epoch 225:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]          Epoch 226:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 226:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 226:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.00176, Train/loss_recog_step=1.040, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 226:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.00176, Train/loss_recog_step=1.040, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 226:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]  Epoch 226:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 226:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00511, Train/loss_recog_step=0.852, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 226:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00511, Train/loss_recog_step=0.852, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 226:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00771, Train/loss_recog_step=1.170, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 226:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00771, Train/loss_recog_step=1.170, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 226:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00318, Train/loss_recog_step=0.948, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 226:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00318, Train/loss_recog_step=0.948, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 226:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]  Epoch 226: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 226: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=0.800, Valid/loss_unet_all_step=0.223, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.457, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.99it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.08it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.81it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.59it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.51it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.065336, 0.065569, 0.064109
Valid average loss UNet            (all)              : 0.195014

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.137642, 5.004608, 8.064332
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.650510, 5.605029, 5.558549
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.803620, 5.621720, 5.547642
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.304576, 5.489124, 6.599979
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.367498, 5.778722, 6.309246
Valid average loss all      (Triplet)                 : 0.512850

== Recognize ==
Valid average loss Recognize     : 1.076479
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.707864

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.09208869934082 sec. =
Valid knn accuracy drums     : 73.08823529411764%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.888065576553345 sec. =
Valid knn accuracy bass      : 17.732558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.824558734893799 sec. =
Valid knn accuracy piano     : 31.351351351351354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.258021831512451 sec. =
Valid knn accuracy guitar    : 52.922077922077925%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.523467302322388 sec. =
Valid knn accuracy residuals : 63.67924528301887%

Valid knn accuracy average   : 47.75469359802013%

                                                                        [AEpoch 226: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.190]Epoch 226: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056528, 0.056260, 0.057279
Train average loss UNet            (all)              : 0.170067

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000328, 4.639789, 8.084965
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000967, 4.509451, 6.820724
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000582, 4.601803, 6.835406
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001575, 4.685299, 7.319649
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001089, 4.912972, 7.162212
Train average loss all      (Triplet)                 : 0.000859

== Recognize ==
Train average loss Recognize     : 1.196884
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.170926

Epoch 226:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]          Epoch 227:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]Epoch 227:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]Epoch 227:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]Epoch 227:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]Epoch 227:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000546, Train/loss_recog_step=1.240, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]Epoch 227:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000546, Train/loss_recog_step=1.240, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]Epoch 227:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]   Epoch 227:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]Epoch 227:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]Epoch 227:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]Epoch 227:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000744, Train/loss_recog_step=0.950, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]Epoch 227:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000744, Train/loss_recog_step=0.950, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]Epoch 227:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]   Epoch 227: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]Epoch 227: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.784, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.91it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.21it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.73it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.30it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066087, 0.065546, 0.064459
Valid average loss UNet            (all)              : 0.196092

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.122969, 5.421608, 8.585014
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.747544, 6.339483, 6.259078
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.835086, 6.307209, 6.422751
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.448328, 6.103140, 7.262685
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.487024, 6.573962, 6.970627
Valid average loss all      (Triplet)                 : 0.605240

== Recognize ==
Valid average loss Recognize     : 1.077155
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.801332

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.608770370483398 sec. =
Valid knn accuracy drums     : 71.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.058846950531006 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.5730562210083 sec. =
Valid knn accuracy piano     : 31.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.925337791442871 sec. =
Valid knn accuracy guitar    : 51.62337662337663%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.888893604278564 sec. =
Valid knn accuracy residuals : 65.09433962264151%

Valid knn accuracy average   : 47.31386343258811%

                                                                        [AEpoch 227: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.000859, Train/loss_recog_epoch=1.200]Epoch 227: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056633, 0.056394, 0.057443
Train average loss UNet            (all)              : 0.170470

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000524, 5.041102, 8.744304
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001300, 4.874246, 7.367004
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001290, 4.954546, 7.321652
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001233, 5.055294, 7.988569
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002133, 5.298839, 7.694664
Train average loss all      (Triplet)                 : 0.001266

== Recognize ==
Train average loss Recognize     : 1.201458
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.171737

Epoch 227:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]          Epoch 228:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.857, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.857, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.950, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.950, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.969, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.605, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.33it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.62it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.75it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.59it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.33it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067031, 0.065598, 0.064431
Valid average loss UNet            (all)              : 0.197060

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.122057, 5.051244, 8.178565
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.546673, 5.689195, 5.831123
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.796823, 5.850044, 5.813859
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.227083, 5.558870, 6.776908
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.399060, 5.558878, 6.150534
Valid average loss all      (Triplet)                 : 0.469929

== Recognize ==
Valid average loss Recognize     : 1.079351
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.666989

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.211368560791016 sec. =
Valid knn accuracy drums     : 75.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.788023948669434 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.593608856201172 sec. =
Valid knn accuracy piano     : 31.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.42674970626831 sec. =
Valid knn accuracy guitar    : 49.35064935064935%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.41550087928772 sec. =
Valid knn accuracy residuals : 63.83647798742138%

Valid knn accuracy average   : 47.334526809722334%

                                                                        [AEpoch 228: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.200]Epoch 228: 100%|██████████| 313/313 [05:59<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056638, 0.056452, 0.057469
Train average loss UNet            (all)              : 0.170558

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000558, 4.915689, 8.477512
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001720, 4.728628, 7.124091
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001774, 4.827113, 7.142606
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001564, 4.939583, 7.833869
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000960, 5.142211, 7.534056
Train average loss all      (Triplet)                 : 0.001405

== Recognize ==
Train average loss Recognize     : 1.200768
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.171963

Epoch 228:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]          Epoch 229:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.953, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.953, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.919, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=0.695, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.473, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.21it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.99it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.74it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.57it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.14it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.29it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066586, 0.065122, 0.063829
Valid average loss UNet            (all)              : 0.195536

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.140980, 4.862671, 7.712599
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.598852, 5.469309, 5.435156
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.659625, 5.405769, 5.476264
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.226420, 5.228454, 6.386791
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.382812, 5.255600, 5.911939
Valid average loss all      (Triplet)                 : 0.453657

== Recognize ==
Valid average loss Recognize     : 1.085297
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.649194

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.484598875045776 sec. =
Valid knn accuracy drums     : 77.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.633121728897095 sec. =
Valid knn accuracy bass      : 17.87790697674419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.575871706008911 sec. =
Valid knn accuracy piano     : 29.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.518268823623657 sec. =
Valid knn accuracy guitar    : 49.02597402597403%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.358429670333862 sec. =
Valid knn accuracy residuals : 60.534591194968556%

Valid knn accuracy average   : 46.79135103731159%

                                                                        [AEpoch 229: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.0014, Train/loss_recog_epoch=1.200]Epoch 229: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056670, 0.056425, 0.057439
Train average loss UNet            (all)              : 0.170534

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000538, 4.713730, 8.244441
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002372, 4.565353, 6.860812
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001711, 4.637556, 6.856130
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001714, 4.741092, 7.458962
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000830, 4.905090, 7.156648
Train average loss all      (Triplet)                 : 0.001510

== Recognize ==
Train average loss Recognize     : 1.202757
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.172044

Epoch 229:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]          Epoch 230:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 230:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 230:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 230:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 230:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00379, Train/loss_recog_step=1.250, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 230:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00379, Train/loss_recog_step=1.250, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 230:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]  Epoch 230:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 230:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000534, Train/loss_recog_step=1.180, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 230:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000534, Train/loss_recog_step=1.180, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 230:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.956, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]   Epoch 230:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.956, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 230:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 230: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 230: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.649, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.454, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.468, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.52it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.52it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.52it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.70it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066760, 0.065657, 0.063958
Valid average loss UNet            (all)              : 0.196375

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.149512, 5.206505, 7.982920
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.583512, 5.820774, 5.891486
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.755302, 6.020326, 6.181274
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.368831, 5.734996, 6.831099
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.577667, 6.139587, 6.360590
Valid average loss all      (Triplet)                 : 0.514352

== Recognize ==
Valid average loss Recognize     : 1.083804
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.710727

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.526789903640747 sec. =
Valid knn accuracy drums     : 75.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.717367887496948 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.64399766921997 sec. =
Valid knn accuracy piano     : 32.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.32224702835083 sec. =
Valid knn accuracy guitar    : 49.02597402597403%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.597851991653442 sec. =
Valid knn accuracy residuals : 59.74842767295597%

Valid knn accuracy average   : 46.697609662816284%

                                                                        [AEpoch 230: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.171, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.200]Epoch 230: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056656, 0.056338, 0.057376
Train average loss UNet            (all)              : 0.170370

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000373, 4.717910, 8.374398
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001490, 4.552328, 6.875908
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001890, 4.649576, 6.878813
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001455, 4.750153, 7.452415
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001801, 4.932075, 7.134644
Train average loss all      (Triplet)                 : 0.001405

== Recognize ==
Train average loss Recognize     : 1.207187
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.171775

Epoch 230:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]          Epoch 231:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.00667, Train/loss_recog_step=1.180, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.00667, Train/loss_recog_step=1.180, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000156, Train/loss_recog_step=0.957, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000156, Train/loss_recog_step=0.957, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000856, Train/loss_recog_step=1.410, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000856, Train/loss_recog_step=1.410, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.467, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.15it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.44it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.60it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.64it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.76it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.065643, 0.065335, 0.064455
Valid average loss UNet            (all)              : 0.195433

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.198675, 5.088903, 8.028160
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.586169, 5.704212, 5.831274
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.731342, 5.760670, 5.800389
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.360494, 5.604158, 6.768834
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.474160, 5.817521, 6.169281
Valid average loss all      (Triplet)                 : 0.516423

== Recognize ==
Valid average loss Recognize     : 1.085056
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.711856

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.475088596343994 sec. =
Valid knn accuracy drums     : 75.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.364221096038818 sec. =
Valid knn accuracy bass      : 21.802325581395348%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.46762466430664 sec. =
Valid knn accuracy piano     : 27.297297297297295%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.555615663528442 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.647574424743652 sec. =
Valid knn accuracy residuals : 64.937106918239%

Valid knn accuracy average   : 47.89558125350397%

                                                                        [AEpoch 231: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00141, Train/loss_recog_epoch=1.210]Epoch 231: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056416, 0.056215, 0.057193
Train average loss UNet            (all)              : 0.169824

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000323, 4.799196, 8.365085
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001731, 4.652664, 7.055737
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001345, 4.722528, 6.993680
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001770, 4.831357, 7.554031
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001300, 5.022967, 7.314642
Train average loss all      (Triplet)                 : 0.001333

== Recognize ==
Train average loss Recognize     : 1.205780
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.171157

Epoch 231:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]          Epoch 232:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]Epoch 232:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.929, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]Epoch 232:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]Epoch 232:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]Epoch 232:  32%|███▏      | 100/313 [01:27<03:06,  1.14it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000404, Train/loss_recog_step=1.250, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]Epoch 232:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000404, Train/loss_recog_step=1.250, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]Epoch 232:  48%|████▊     | 150/313 [02:08<02:19,  1.17it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]   Epoch 232:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]Epoch 232:  64%|██████▍   | 200/313 [02:50<01:36,  1.17it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000315, Train/loss_recog_step=1.180, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]Epoch 232:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000315, Train/loss_recog_step=1.180, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]Epoch 232:  80%|███████▉  | 250/313 [03:33<00:53,  1.17it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]   Epoch 232:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.958, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]Epoch 232:  96%|█████████▌| 300/313 [04:15<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]Epoch 232: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]Epoch 232: 100%|██████████| 313/313 [04:25<00:00,  1.18it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.992, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.32it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.22it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.35it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.99it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067711, 0.065896, 0.064238
Valid average loss UNet            (all)              : 0.197844

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.128990, 5.251549, 8.076518
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.616110, 5.857854, 5.953236
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.801162, 5.958736, 6.033970
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.235275, 5.564519, 6.847160
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.532459, 6.122655, 6.431642
Valid average loss all      (Triplet)                 : 0.505157

== Recognize ==
Valid average loss Recognize     : 1.087296
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.703001

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.0861234664917 sec. =
Valid knn accuracy drums     : 76.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.727855682373047 sec. =
Valid knn accuracy bass      : 18.459302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.393800258636475 sec. =
Valid knn accuracy piano     : 28.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.614216566085815 sec. =
Valid knn accuracy guitar    : 52.1103896103896%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.816412448883057 sec. =
Valid knn accuracy residuals : 63.83647798742138%

Valid knn accuracy average   : 47.90031188610932%

                                                                        [AEpoch 232: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.210]Epoch 232: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056242, 0.056039, 0.057094
Train average loss UNet            (all)              : 0.169375

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000702, 4.857358, 8.617430
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001064, 4.665385, 7.127420
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001679, 4.739813, 7.052655
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001304, 4.868690, 7.638701
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000745, 5.056044, 7.419615
Train average loss all      (Triplet)                 : 0.001068

== Recognize ==
Train average loss Recognize     : 1.208312
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.170443

Epoch 232:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]          Epoch 233:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233:  16%|█▌        | 50/313 [00:44<03:56,  1.11it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233:  16%|█▌        | 50/313 [00:44<03:56,  1.11it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233:  32%|███▏      | 100/313 [01:27<03:05,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233:  48%|████▊     | 150/313 [02:09<02:20,  1.16it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233:  64%|██████▍   | 200/313 [02:50<01:36,  1.18it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.864, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233:  64%|██████▍   | 200/313 [02:50<01:36,  1.18it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233:  80%|███████▉  | 250/313 [03:32<00:53,  1.18it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233:  96%|█████████▌| 300/313 [04:13<00:10,  1.18it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=1.420, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=1.420, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233: 100%|██████████| 313/313 [04:23<00:00,  1.19it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=0.935, Valid/loss_all_step=0.947, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.505, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.479, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.21it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.58it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.95it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.51it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068317, 0.067054, 0.064950
Valid average loss UNet            (all)              : 0.200321

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.140727, 4.993251, 7.832798
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.523465, 5.327035, 5.419174
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.705425, 5.399152, 5.482737
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.292570, 5.363540, 6.437593
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.372784, 5.349102, 5.746721
Valid average loss all      (Triplet)                 : 0.439591

== Recognize ==
Valid average loss Recognize     : 1.091896
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.639912

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.06840991973877 sec. =
Valid knn accuracy drums     : 77.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.193646430969238 sec. =
Valid knn accuracy bass      : 16.27906976744186%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.009089946746826 sec. =
Valid knn accuracy piano     : 27.972972972972972%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.340258836746216 sec. =
Valid knn accuracy guitar    : 45.12987012987013%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.888835906982422 sec. =
Valid knn accuracy residuals : 64.46540880503144%

Valid knn accuracy average   : 46.26946433506328%

                                                                        [AEpoch 233: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=0.935, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00107, Train/loss_recog_epoch=1.210]Epoch 233: 100%|██████████| 313/313 [05:56<00:00,  0.88it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=0.935, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056519, 0.056297, 0.057295
Train average loss UNet            (all)              : 0.170110

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000831, 4.838892, 8.456495
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001799, 4.677586, 7.124956
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002491, 4.748498, 7.020237
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001436, 4.848522, 7.599424
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001344, 5.011832, 7.314926
Train average loss all      (Triplet)                 : 0.001585

== Recognize ==
Train average loss Recognize     : 1.211894
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.171695

Epoch 233:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=0.935, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]          Epoch 234:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=0.935, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=0.935, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00512, Train/loss_recog_step=1.060, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00512, Train/loss_recog_step=1.060, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=1.260, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00158, Train/loss_recog_step=1.260, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.868, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]  Epoch 234:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.868, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=1.420, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=1.420, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.767, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.537, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.640, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.463, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.95it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.11it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.67it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.51it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.46it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068766, 0.067692, 0.066244
Valid average loss UNet            (all)              : 0.202701

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.136461, 5.045784, 7.753674
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.762808, 5.802269, 5.769642
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.669869, 5.532371, 5.816001
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.270497, 5.601388, 6.701280
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.507019, 5.764632, 6.146037
Valid average loss all      (Triplet)                 : 0.534404

== Recognize ==
Valid average loss Recognize     : 1.090485
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.737105

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.262518882751465 sec. =
Valid knn accuracy drums     : 75.1470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.818970680236816 sec. =
Valid knn accuracy bass      : 19.767441860465116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.542935848236084 sec. =
Valid knn accuracy piano     : 29.864864864864867%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.550042390823364 sec. =
Valid knn accuracy guitar    : 50.81168831168831%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.894999980926514 sec. =
Valid knn accuracy residuals : 59.59119496855346%

Valid knn accuracy average   : 47.03644976582024%

                                                                        [AEpoch 234: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.210]Epoch 234: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056599, 0.056375, 0.057363
Train average loss UNet            (all)              : 0.170337

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000518, 4.696309, 8.291135
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002964, 4.540064, 6.842836
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002428, 4.573523, 6.744099
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001213, 4.700148, 7.386251
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001182, 4.806164, 6.966415
Train average loss all      (Triplet)                 : 0.001655

== Recognize ==
Train average loss Recognize     : 1.214757
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.171993

Epoch 234:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]          Epoch 235:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]Epoch 235:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]Epoch 235:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000755, Train/loss_recog_step=1.060, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]Epoch 235:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000755, Train/loss_recog_step=1.060, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]Epoch 235:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]   Epoch 235:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]Epoch 235:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00519, Train/loss_recog_step=0.868, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]Epoch 235:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00519, Train/loss_recog_step=0.868, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]Epoch 235:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=1.190, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]Epoch 235:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00195, Train/loss_recog_step=1.190, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]Epoch 235:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]  Epoch 235:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]Epoch 235:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]Epoch 235: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]Epoch 235: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.470, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.99it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.08it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.49it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.95it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.05it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.63it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070070, 0.067540, 0.067194
Valid average loss UNet            (all)              : 0.204804

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.135159, 4.838017, 7.559968
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.663553, 5.539711, 5.551171
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.756412, 5.372909, 5.488257
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.221856, 5.381632, 6.448982
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.438744, 5.351974, 5.687370
Valid average loss all      (Triplet)                 : 0.498811

== Recognize ==
Valid average loss Recognize     : 1.092123
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.703615

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.093860864639282 sec. =
Valid knn accuracy drums     : 73.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.71216869354248 sec. =
Valid knn accuracy bass      : 20.203488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.932409524917603 sec. =
Valid knn accuracy piano     : 30.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.833666324615479 sec. =
Valid knn accuracy guitar    : 47.88961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.680745840072632 sec. =
Valid knn accuracy residuals : 61.32075471698113%

Valid knn accuracy average   : 46.58865304867808%

                                                                        [AEpoch 235: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.172, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00166, Train/loss_recog_epoch=1.210]Epoch 235: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056358, 0.056146, 0.057165
Train average loss UNet            (all)              : 0.169668

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000096, 4.665640, 8.047279
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002274, 4.551177, 6.910532
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001720, 4.633351, 6.891193
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001013, 4.715865, 7.396721
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001127, 4.868911, 7.088497
Train average loss all      (Triplet)                 : 0.001272

== Recognize ==
Train average loss Recognize     : 1.216077
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.170940

Epoch 235:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]          Epoch 236:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.499, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.466, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.94it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.42it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.07it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067141, 0.066511, 0.067256
Valid average loss UNet            (all)              : 0.200908

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.173605, 4.889471, 7.608012
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.692822, 5.720062, 5.649604
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.764850, 5.511188, 5.538146
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.284256, 5.492284, 6.568758
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.470051, 5.526508, 5.958137
Valid average loss all      (Triplet)                 : 0.539823

== Recognize ==
Valid average loss Recognize     : 1.090151
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.740731

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.756264925003052 sec. =
Valid knn accuracy drums     : 76.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.026853799819946 sec. =
Valid knn accuracy bass      : 16.424418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.616097211837769 sec. =
Valid knn accuracy piano     : 26.351351351351347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.536482334136963 sec. =
Valid knn accuracy guitar    : 46.75324675324675%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.809409856796265 sec. =
Valid knn accuracy residuals : 63.83647798742138%

Valid knn accuracy average   : 45.87898129227531%

                                                                        [AEpoch 236: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.170, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.220]Epoch 236: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056332, 0.056049, 0.057098
Train average loss UNet            (all)              : 0.169480

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000368, 4.804346, 8.273501
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002030, 4.631419, 7.007913
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000916, 4.766113, 7.100195
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001530, 4.890385, 7.709960
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001329, 5.029058, 7.307996
Train average loss all      (Triplet)                 : 0.001251

== Recognize ==
Train average loss Recognize     : 1.217112
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.170730

Epoch 236:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]          Epoch 237:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=0.938, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.846, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.459, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.30it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.57it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.95it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067675, 0.066538, 0.066227
Valid average loss UNet            (all)              : 0.200440

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.129070, 4.879105, 7.420822
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.654075, 5.685836, 5.704073
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.918491, 5.520266, 5.519379
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.336694, 5.373000, 6.432747
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.405282, 5.578620, 5.953928
Valid average loss all      (Triplet)                 : 0.541120

== Recognize ==
Valid average loss Recognize     : 1.094069
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.741560

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.331611633300781 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.252776861190796 sec. =
Valid knn accuracy bass      : 18.459302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.446528911590576 sec. =
Valid knn accuracy piano     : 27.027027027027028%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.753607749938965 sec. =
Valid knn accuracy guitar    : 45.77922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.349451065063477 sec. =
Valid knn accuracy residuals : 62.264150943396224%

Valid knn accuracy average   : 46.176528450339205%

                                                                        [AEpoch 237: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=0.938, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00125, Train/loss_recog_epoch=1.220]Epoch 237: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=0.938, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056198, 0.055978, 0.056928
Train average loss UNet            (all)              : 0.169103

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001214, 4.590399, 7.929112
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000874, 4.437436, 6.725686
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002177, 4.540047, 6.737805
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001841, 4.660427, 7.283401
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001062, 4.769854, 6.943758
Train average loss all      (Triplet)                 : 0.001383

== Recognize ==
Train average loss Recognize     : 1.217432
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.170486

Epoch 237:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=0.938, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]          Epoch 238:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=0.938, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]Epoch 238:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=0.938, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]Epoch 238:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]  Epoch 238:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]Epoch 238:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]Epoch 238:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]Epoch 238:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]Epoch 238:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.873, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]Epoch 238:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]Epoch 238:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]Epoch 238:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00432, Train/loss_recog_step=0.966, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]Epoch 238:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00432, Train/loss_recog_step=0.966, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]Epoch 238:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]  Epoch 238: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]Epoch 238: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.462, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.31it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.29it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.20it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.48it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069393, 0.067681, 0.066101
Valid average loss UNet            (all)              : 0.203176

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.118712, 4.506529, 7.286140
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.552264, 5.160881, 5.230064
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.767396, 5.057526, 5.162038
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.316411, 5.026696, 5.998161
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.448890, 5.156248, 5.319207
Valid average loss all      (Triplet)                 : 0.486176

== Recognize ==
Valid average loss Recognize     : 1.097146
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.689351

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.60471796989441 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.455852508544922 sec. =
Valid knn accuracy bass      : 18.168604651162788%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.770430564880371 sec. =
Valid knn accuracy piano     : 26.891891891891888%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.240612983703613 sec. =
Valid knn accuracy guitar    : 45.45454545454545%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.607752323150635 sec. =
Valid knn accuracy residuals : 63.67924528301887%

Valid knn accuracy average   : 46.30944569141791%

                                                                        [AEpoch 238: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.220]Epoch 238: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056088, 0.055846, 0.056845
Train average loss UNet            (all)              : 0.168779

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001064, 4.425084, 7.655538
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001423, 4.331517, 6.578897
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001216, 4.405921, 6.551941
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000984, 4.485003, 7.035491
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001446, 4.655303, 6.762877
Train average loss all      (Triplet)                 : 0.001129

== Recognize ==
Train average loss Recognize     : 1.222200
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.169908

Epoch 238:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]          Epoch 239:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]Epoch 239:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]Epoch 239:  16%|█▌        | 50/313 [00:45<04:00,  1.09it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]Epoch 239:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]Epoch 239:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000641, Train/loss_recog_step=1.270, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]Epoch 239:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000641, Train/loss_recog_step=1.270, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]Epoch 239:  48%|████▊     | 150/313 [02:10<02:22,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.874, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220] Epoch 239:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=0.874, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]Epoch 239:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]  Epoch 239:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]Epoch 239:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]Epoch 239:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]Epoch 239:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=1.430, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]Epoch 239: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=1.430, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]Epoch 239: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.794, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.689, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.486, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.15it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.92it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.83it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.25it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.89it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066667, 0.065641, 0.065479
Valid average loss UNet            (all)              : 0.197786

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.098169, 4.735156, 7.656548
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.567860, 5.624036, 5.649122
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.866201, 5.505891, 5.464962
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.269297, 5.363790, 6.503664
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.517815, 5.655538, 5.858880
Valid average loss all      (Triplet)                 : 0.498409

== Recognize ==
Valid average loss Recognize     : 1.101149
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.696195

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.825750589370728 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.362363576889038 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.504700422286987 sec. =
Valid knn accuracy piano     : 28.10810810810811%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.18618130683899 sec. =
Valid knn accuracy guitar    : 44.642857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.575286626815796 sec. =
Valid knn accuracy residuals : 61.79245283018868%

Valid knn accuracy average   : 45.75410085289289%

                                                                        [AEpoch 239: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.220]Epoch 239: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056062, 0.055838, 0.056787
Train average loss UNet            (all)              : 0.168688

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000025, 4.631083, 8.166386
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001772, 4.493253, 6.820007
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001370, 4.564642, 6.818247
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000688, 4.673955, 7.357995
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001038, 4.844975, 7.062104
Train average loss all      (Triplet)                 : 0.000996

== Recognize ==
Train average loss Recognize     : 1.224148
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.169683

Epoch 239:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]          Epoch 240:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=1.200, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00145, Train/loss_recog_step=1.200, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.963, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]  Epoch 240:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.963, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.430, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.430, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.924, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.696, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.458, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.02it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.67it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.02it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070571, 0.069252, 0.069279
Valid average loss UNet            (all)              : 0.209101

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.140599, 5.056050, 7.765474
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.604380, 5.884461, 5.961390
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.926657, 5.699205, 5.609351
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.444948, 5.526759, 6.641654
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.453812, 5.739958, 6.120800
Valid average loss all      (Triplet)                 : 0.564050

== Recognize ==
Valid average loss Recognize     : 1.098975
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.773151

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.993240594863892 sec. =
Valid knn accuracy drums     : 76.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.33208680152893 sec. =
Valid knn accuracy bass      : 17.732558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.651015996932983 sec. =
Valid knn accuracy piano     : 27.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.847733497619629 sec. =
Valid knn accuracy guitar    : 45.45454545454545%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.718856573104858 sec. =
Valid knn accuracy residuals : 61.0062893081761%

Valid knn accuracy average   : 45.732160297462414%

                                                                        [AEpoch 240: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.000996, Train/loss_recog_epoch=1.220]Epoch 240: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056020, 0.055806, 0.056710
Train average loss UNet            (all)              : 0.168536

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000255, 4.817810, 8.260037
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001599, 4.725301, 7.192164
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001159, 4.772877, 7.121349
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001163, 4.885399, 7.689371
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001644, 5.060138, 7.352210
Train average loss all      (Triplet)                 : 0.001186

== Recognize ==
Train average loss Recognize     : 1.222982
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.169722

Epoch 240:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]          Epoch 241:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]Epoch 241:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]Epoch 241:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00922, Train/loss_recog_step=1.060, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]Epoch 241:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00922, Train/loss_recog_step=1.060, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]Epoch 241:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]  Epoch 241:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]Epoch 241:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00391, Train/loss_recog_step=0.875, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]Epoch 241:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00391, Train/loss_recog_step=0.875, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]Epoch 241:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]  Epoch 241:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]Epoch 241:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.966, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]Epoch 241:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.966, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]Epoch 241:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]Epoch 241: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]Epoch 241: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.868, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.773, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.457, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.00it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.75it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.52it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.71it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.51it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.27it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067607, 0.066418, 0.065353
Valid average loss UNet            (all)              : 0.199378

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.129501, 4.714811, 7.529881
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.619899, 5.367552, 5.341785
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.705900, 5.391754, 5.358834
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.287485, 5.159548, 6.184089
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.363440, 5.485773, 5.990896
Valid average loss all      (Triplet)                 : 0.469966

== Recognize ==
Valid average loss Recognize     : 1.100194
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.669344

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.119976282119751 sec. =
Valid knn accuracy drums     : 76.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.666208505630493 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.272053718566895 sec. =
Valid knn accuracy piano     : 34.86486486486486%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.653123378753662 sec. =
Valid knn accuracy guitar    : 46.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.003098726272583 sec. =
Valid knn accuracy residuals : 60.84905660377359%

Valid knn accuracy average   : 47.064955487786705%

                                                                        [AEpoch 241: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00119, Train/loss_recog_epoch=1.220]Epoch 241: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056044, 0.055831, 0.056887
Train average loss UNet            (all)              : 0.168762

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000352, 4.644781, 7.974101
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002025, 4.514733, 6.851161
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001443, 4.606843, 6.851943
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001570, 4.694518, 7.325435
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001734, 4.890926, 7.122914
Train average loss all      (Triplet)                 : 0.001420

== Recognize ==
Train average loss Recognize     : 1.224226
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.170182

Epoch 241:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]          Epoch 242:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]Epoch 242:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]Epoch 242:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]Epoch 242:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]Epoch 242:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000506, Train/loss_recog_step=1.270, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]Epoch 242:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000506, Train/loss_recog_step=1.270, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]Epoch 242:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]   Epoch 242:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]Epoch 242:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]Epoch 242:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]Epoch 242:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00229, Train/loss_recog_step=0.963, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]Epoch 242:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00229, Train/loss_recog_step=0.963, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]Epoch 242:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]  Epoch 242: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]Epoch 242: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.895, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.666, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.669, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.471, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.92it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.76it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.69it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.83it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.01it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066002, 0.065958, 0.065496
Valid average loss UNet            (all)              : 0.197455

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.120027, 4.445902, 7.239920
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.549346, 4.983665, 5.075280
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.697480, 5.121271, 5.167688
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.331794, 4.855026, 5.901969
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.401481, 5.197614, 5.534725
Valid average loss all      (Triplet)                 : 0.469425

== Recognize ==
Valid average loss Recognize     : 1.097635
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.666880

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.824759483337402 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.98029637336731 sec. =
Valid knn accuracy bass      : 17.732558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.274325370788574 sec. =
Valid knn accuracy piano     : 28.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.510514497756958 sec. =
Valid knn accuracy guitar    : 49.188311688311686%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.643500804901123 sec. =
Valid knn accuracy residuals : 60.691823899371066%

Valid knn accuracy average   : 46.874685009354494%

                                                                        [AEpoch 242: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.220]Epoch 242: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055808, 0.055623, 0.056592
Train average loss UNet            (all)              : 0.168022

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000100, 4.535759, 7.977759
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001654, 4.417353, 6.757163
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001264, 4.498628, 6.714368
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000810, 4.627268, 7.323329
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000533, 4.761829, 6.946951
Train average loss all      (Triplet)                 : 0.000869

== Recognize ==
Train average loss Recognize     : 1.222246
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.168891

Epoch 242:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]          Epoch 243:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243:  80%|███████▉  | 250/313 [03:35<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00979, Train/loss_recog_step=0.968, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00979, Train/loss_recog_step=0.968, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243:  96%|█████████▌| 300/313 [04:16<00:11,  1.17it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]  Epoch 243: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243: 100%|██████████| 313/313 [04:26<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=0.931, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.704, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.667, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.469, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.469, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.05it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.52it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.62it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.065758, 0.065221, 0.064547
Valid average loss UNet            (all)              : 0.195527

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.126312, 4.568796, 7.036242
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.566901, 5.149128, 5.273541
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.674737, 5.136504, 5.139022
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.355817, 5.216040, 6.136761
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.357235, 5.103202, 5.658059
Valid average loss all      (Triplet)                 : 0.456400

== Recognize ==
Valid average loss Recognize     : 1.102338
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.651927

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.663734674453735 sec. =
Valid knn accuracy drums     : 74.11764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.816056728363037 sec. =
Valid knn accuracy bass      : 19.186046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.756818056106567 sec. =
Valid knn accuracy piano     : 29.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.42819094657898 sec. =
Valid knn accuracy guitar    : 50.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.349979639053345 sec. =
Valid knn accuracy residuals : 58.80503144654088%

Valid knn accuracy average   : 46.36769094934441%

                                                                        [AEpoch 243: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000869, Train/loss_recog_epoch=1.220]Epoch 243: 100%|██████████| 313/313 [05:58<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055805, 0.055598, 0.056580
Train average loss UNet            (all)              : 0.167983

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000287, 4.361145, 7.637742
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001379, 4.247277, 6.508531
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001196, 4.320717, 6.443948
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001472, 4.416423, 6.959987
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001145, 4.547247, 6.622579
Train average loss all      (Triplet)                 : 0.001112

== Recognize ==
Train average loss Recognize     : 1.224955
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.169095

Epoch 243:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]          Epoch 244:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]Epoch 244:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]Epoch 244:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.00822, Train/loss_recog_step=1.070, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]Epoch 244:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.00822, Train/loss_recog_step=1.070, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]Epoch 244:  32%|███▏      | 100/313 [01:28<03:07,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]  Epoch 244:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]Epoch 244:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=0.878, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]Epoch 244:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.00175, Train/loss_recog_step=0.878, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]Epoch 244:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]  Epoch 244:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]Epoch 244:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]Epoch 244:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]Epoch 244:  96%|█████████▌| 300/313 [04:17<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00185, Train/loss_recog_step=1.430, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]Epoch 244: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00185, Train/loss_recog_step=1.430, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]Epoch 244: 100%|██████████| 313/313 [04:27<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.856, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=0.629, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.652, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.456, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.464, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.79it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.07it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.79it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.10it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.53it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066116, 0.065708, 0.064749
Valid average loss UNet            (all)              : 0.196572

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.161610, 5.242008, 8.172732
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.694118, 5.961313, 5.914870
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.863834, 5.951511, 5.914051
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.607305, 5.886885, 6.852603
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.450917, 5.903483, 6.572473
Valid average loss all      (Triplet)                 : 0.625959

== Recognize ==
Valid average loss Recognize     : 1.100493
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.822531

= T-SNE...
T-SNE was finished!
= T-SNE time is 10.78522276878357 sec. =
Valid knn accuracy drums     : 77.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.969158411026001 sec. =
Valid knn accuracy bass      : 17.296511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.432087898254395 sec. =
Valid knn accuracy piano     : 30.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.073234796524048 sec. =
Valid knn accuracy guitar    : 50.324675324675326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.809846878051758 sec. =
Valid knn accuracy residuals : 64.46540880503144%

Valid knn accuracy average   : 48.032581472667424%

                                                                        [AEpoch 244: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00111, Train/loss_recog_epoch=1.220]Epoch 244: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055944, 0.055762, 0.056726
Train average loss UNet            (all)              : 0.168432

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000438, 4.520077, 7.806639
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001659, 4.433030, 6.768967
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001865, 4.527912, 6.747810
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001123, 4.635080, 7.290969
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001572, 4.775595, 6.970655
Train average loss all      (Triplet)                 : 0.001314

== Recognize ==
Train average loss Recognize     : 1.229655
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.169746

Epoch 244:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]          Epoch 245:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00285, Train/loss_recog_step=0.938, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.823, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.13it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.16it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.56it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.53it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.98it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066047, 0.065635, 0.064090
Valid average loss UNet            (all)              : 0.195772

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.140969, 5.318032, 8.635433
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.629586, 5.905907, 5.914897
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.837455, 5.795865, 5.784199
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.396916, 5.754360, 6.858224
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.430659, 5.846896, 6.465642
Valid average loss all      (Triplet)                 : 0.536138

== Recognize ==
Valid average loss Recognize     : 1.099897
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.731910

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.193171501159668 sec. =
Valid knn accuracy drums     : 77.20588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.893943786621094 sec. =
Valid knn accuracy bass      : 18.168604651162788%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.513896226882935 sec. =
Valid knn accuracy piano     : 33.648648648648646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.701920509338379 sec. =
Valid knn accuracy guitar    : 45.12987012987013%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.615435600280762 sec. =
Valid knn accuracy residuals : 64.30817610062893%

Valid knn accuracy average   : 47.692236376650335%

                                                                        [AEpoch 245: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00285, Train/loss_recog_step=0.938, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.230]Epoch 245: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00285, Train/loss_recog_step=0.938, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055971, 0.055808, 0.056735
Train average loss UNet            (all)              : 0.168513

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001131, 5.009484, 8.703436
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001633, 4.828175, 7.358374
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000934, 4.920266, 7.289309
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001098, 5.026680, 7.893052
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001375, 5.186384, 7.503261
Train average loss all      (Triplet)                 : 0.001210

== Recognize ==
Train average loss Recognize     : 1.223730
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.169724

Epoch 245:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00285, Train/loss_recog_step=0.938, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]          Epoch 246:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00285, Train/loss_recog_step=0.938, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00285, Train/loss_recog_step=0.938, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.00288, Train/loss_recog_step=1.070, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.00288, Train/loss_recog_step=1.070, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]  Epoch 246:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00323, Train/loss_recog_step=1.440, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00323, Train/loss_recog_step=1.440, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.222, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.477, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.00it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.95it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.43it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.50it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.077809, 0.074821, 0.075494
Valid average loss UNet            (all)              : 0.228124

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.114540, 5.092241, 8.169093
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.630431, 5.490502, 5.498798
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.799205, 5.476603, 5.432372
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.505179, 5.565382, 6.383382
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.280300, 5.707263, 6.426320
Valid average loss all      (Triplet)                 : 0.537045

== Recognize ==
Valid average loss Recognize     : 1.108722
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.765169

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.096831560134888 sec. =
Valid knn accuracy drums     : 74.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.767926931381226 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.492112874984741 sec. =
Valid knn accuracy piano     : 30.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.447979927062988 sec. =
Valid knn accuracy guitar    : 40.0974025974026%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.184136390686035 sec. =
Valid knn accuracy residuals : 61.79245283018868%

Valid knn accuracy average   : 44.28256309202545%

                                                                        [AEpoch 246: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.220]Epoch 246: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056211, 0.055955, 0.056989
Train average loss UNet            (all)              : 0.169156

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000623, 5.079745, 8.894533
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002622, 4.883050, 7.440199
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001184, 4.967838, 7.334037
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001606, 5.083598, 7.919608
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001699, 5.263089, 7.637904
Train average loss all      (Triplet)                 : 0.001567

== Recognize ==
Train average loss Recognize     : 1.228561
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.170722

Epoch 246:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]          Epoch 247:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=1.200, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=1.200, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00484, Train/loss_recog_step=0.972, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00484, Train/loss_recog_step=0.972, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]  Epoch 247: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247: 100%|██████████| 313/313 [04:28<00:00,  1.17it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.230, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.962, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.443, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.06it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.09it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.53it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.36it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069120, 0.067585, 0.066947
Valid average loss UNet            (all)              : 0.203653

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.104138, 5.354353, 8.477042
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.749965, 6.146892, 6.060004
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.858268, 5.956335, 5.998127
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.610467, 6.326131, 7.174609
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.441342, 6.278179, 6.868600
Valid average loss all      (Triplet)                 : 0.632046

== Recognize ==
Valid average loss Recognize     : 1.106334
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.835699

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.012823104858398 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.690823554992676 sec. =
Valid knn accuracy bass      : 16.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.748670816421509 sec. =
Valid knn accuracy piano     : 33.513513513513516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.198314905166626 sec. =
Valid knn accuracy guitar    : 47.564935064935064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.938267469406128 sec. =
Valid knn accuracy residuals : 63.05031446540881%

Valid knn accuracy average   : 47.75666916143905%

                                                                        [AEpoch 247: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.171, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 247: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.056080, 0.055835, 0.056859
Train average loss UNet            (all)              : 0.168774

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001298, 4.958153, 8.586516
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002268, 4.760762, 7.237986
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001905, 4.844432, 7.140360
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001519, 4.978945, 7.842022
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001132, 5.144959, 7.482616
Train average loss all      (Triplet)                 : 0.001581

== Recognize ==
Train average loss Recognize     : 1.229083
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.170355

Epoch 247:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]          Epoch 248:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.876, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248:  64%|██████▍   | 200/313 [02:53<01:37,  1.15it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.380, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.150, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.836, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.632, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.478, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.62it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.94it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.36it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.95it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067030, 0.066464, 0.065570
Valid average loss UNet            (all)              : 0.199064

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.150489, 4.924388, 7.625494
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.723293, 5.523561, 5.413571
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.782875, 5.513319, 5.492234
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.586715, 5.532458, 6.107805
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.376244, 5.601182, 6.111197
Valid average loss all      (Triplet)                 : 0.609377

== Recognize ==
Valid average loss Recognize     : 1.105451
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.808441

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.262882947921753 sec. =
Valid knn accuracy drums     : 75.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.488571882247925 sec. =
Valid knn accuracy bass      : 17.87790697674419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.443403244018555 sec. =
Valid knn accuracy piano     : 30.810810810810814%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.461704730987549 sec. =
Valid knn accuracy guitar    : 52.75974025974026%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.807865619659424 sec. =
Valid knn accuracy residuals : 63.20754716981132%

Valid knn accuracy average   : 48.10767163165661%

                                                                        [AEpoch 248: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.169, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.230]Epoch 248: 100%|██████████| 313/313 [06:01<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055776, 0.055534, 0.056519
Train average loss UNet            (all)              : 0.167829

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000669, 4.889716, 8.540912
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001300, 4.781351, 7.313307
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001087, 4.819176, 7.168045
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001063, 4.954201, 7.822127
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000690, 5.145531, 7.509984
Train average loss all      (Triplet)                 : 0.000991

== Recognize ==
Train average loss Recognize     : 1.228486
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.168820

Epoch 248:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]          Epoch 249:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 249:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 249:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 249:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 249:  32%|███▏      | 100/313 [01:28<03:08,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 249:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 249:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=0.877, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 249:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=0.877, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 249:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]  Epoch 249:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 249:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0147, Train/loss_recog_step=0.976, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 249:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0147, Train/loss_recog_step=0.976, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 249:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230] Epoch 249: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 249: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=1.400, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.808, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.481, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.61it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.11it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.94it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.44it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066545, 0.065575, 0.064184
Valid average loss UNet            (all)              : 0.196303

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.141330, 4.683215, 7.018349
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.683026, 5.307144, 5.134802
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.774118, 5.214411, 5.334055
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.438922, 5.249889, 5.959212
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.361448, 5.424820, 5.950161
Valid average loss all      (Triplet)                 : 0.556168

== Recognize ==
Valid average loss Recognize     : 1.110157
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.752471

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.153837203979492 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.650346279144287 sec. =
Valid knn accuracy bass      : 16.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.3734610080719 sec. =
Valid knn accuracy piano     : 33.513513513513516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.611748695373535 sec. =
Valid knn accuracy guitar    : 46.103896103896105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.735422849655151 sec. =
Valid knn accuracy residuals : 67.61006289308176%

Valid knn accuracy average   : 48.28817576064821%

                                                                        [AEpoch 249: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 249: 100%|██████████| 313/313 [06:00<00:00,  0.87it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055647, 0.055469, 0.056416
Train average loss UNet            (all)              : 0.167532

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000344, 4.696693, 8.241791
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001948, 4.564066, 6.965867
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000971, 4.662699, 6.937562
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001588, 4.757022, 7.495184
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000681, 4.957670, 7.234090
Train average loss all      (Triplet)                 : 0.001132

== Recognize ==
Train average loss Recognize     : 1.230960
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.168664

Epoch 249:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]          Epoch 250:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0063, Train/loss_recog_step=0.977, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.0063, Train/loss_recog_step=0.977, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000614, Train/loss_recog_step=1.440, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000614, Train/loss_recog_step=1.440, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.483, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.46it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.49it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.17it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067930, 0.066166, 0.065897
Valid average loss UNet            (all)              : 0.199994

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.126209, 4.551550, 7.389008
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.636876, 5.176632, 5.196372
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.774439, 5.020077, 4.970916
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.548158, 5.166428, 5.913290
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.394271, 4.989153, 5.416334
Valid average loss all      (Triplet)                 : 0.574842

== Recognize ==
Valid average loss Recognize     : 1.109743
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.774836

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.30578351020813 sec. =
Valid knn accuracy drums     : 76.91176470588236%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.356795072555542 sec. =
Valid knn accuracy bass      : 18.168604651162788%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.48639464378357 sec. =
Valid knn accuracy piano     : 33.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.81373405456543 sec. =
Valid knn accuracy guitar    : 43.993506493506494%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.578887224197388 sec. =
Valid knn accuracy residuals : 64.77987421383648%

Valid knn accuracy average   : 47.55453379666142%

                                                                        [AEpoch 250: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.230]Epoch 250: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055491, 0.055327, 0.056278
Train average loss UNet            (all)              : 0.167096

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000388, 4.379226, 7.579453
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002145, 4.262839, 6.525364
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001150, 4.347088, 6.469732
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000728, 4.433266, 6.961132
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000747, 4.638611, 6.745221
Train average loss all      (Triplet)                 : 0.001064

== Recognize ==
Train average loss Recognize     : 1.234785
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.168160

Epoch 250:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]          Epoch 251:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.882, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.882, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=1.440, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00353, Train/loss_recog_step=1.440, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=0.950, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.775, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.476, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.78it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.83it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.63it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.76it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066420, 0.065958, 0.065022
Valid average loss UNet            (all)              : 0.197400

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.141826, 4.668549, 7.264125
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.594431, 5.257177, 5.280519
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.680264, 5.101821, 5.265278
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.557037, 5.427248, 5.973290
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.566741, 5.368507, 5.517241
Valid average loss all      (Triplet)                 : 0.558547

== Recognize ==
Valid average loss Recognize     : 1.111748
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.755947

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.353159666061401 sec. =
Valid knn accuracy drums     : 77.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.427057981491089 sec. =
Valid knn accuracy bass      : 19.186046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.63148021697998 sec. =
Valid knn accuracy piano     : 30.945945945945947%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.804808855056763 sec. =
Valid knn accuracy guitar    : 46.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.37428593635559 sec. =
Valid knn accuracy residuals : 65.25157232704403%

Valid knn accuracy average   : 47.95066253675551%

                                                                        [AEpoch 251: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=0.950, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.230]Epoch 251: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=0.950, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055401, 0.055211, 0.056200
Train average loss UNet            (all)              : 0.166812

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000414, 4.410382, 7.770446
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001574, 4.291502, 6.549256
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000950, 4.338537, 6.495914
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000265, 4.419700, 7.000371
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001227, 4.647215, 6.772619
Train average loss all      (Triplet)                 : 0.000907

== Recognize ==
Train average loss Recognize     : 1.236515
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.167719

Epoch 251:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=0.950, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]          Epoch 252:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=0.950, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]Epoch 252:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=0.950, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]Epoch 252:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]  Epoch 252:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]Epoch 252:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]Epoch 252:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]Epoch 252:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00642, Train/loss_recog_step=0.880, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]Epoch 252:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00642, Train/loss_recog_step=0.880, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]Epoch 252:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]  Epoch 252:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]Epoch 252:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]Epoch 252:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]Epoch 252:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]Epoch 252: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]Epoch 252: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.946, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.987, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.69it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.28it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.42it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074303, 0.074299, 0.074456
Valid average loss UNet            (all)              : 0.223057

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.200694, 5.117678, 7.752908
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.856366, 5.967666, 5.745481
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.864753, 5.776240, 5.728369
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.558677, 5.974178, 6.689407
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.426461, 5.624898, 6.425123
Valid average loss all      (Triplet)                 : 0.680256

== Recognize ==
Valid average loss Recognize     : 1.108443
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.903313

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.736256122589111 sec. =
Valid knn accuracy drums     : 76.91176470588236%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.07683801651001 sec. =
Valid knn accuracy bass      : 20.058139534883722%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.432066202163696 sec. =
Valid knn accuracy piano     : 34.32432432432432%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.81843376159668 sec. =
Valid knn accuracy guitar    : 45.77922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.124739408493042 sec. =
Valid knn accuracy residuals : 65.25157232704403%

Valid knn accuracy average   : 48.46500433427104%

                                                                        [AEpoch 252: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.946, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.000907, Train/loss_recog_epoch=1.240]Epoch 252: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.946, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055399, 0.055213, 0.056147
Train average loss UNet            (all)              : 0.166759

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000405, 4.707229, 8.121424
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002013, 4.593758, 6.969972
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001087, 4.644789, 6.867346
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000393, 4.738627, 7.449302
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001216, 4.954698, 7.203037
Train average loss all      (Triplet)                 : 0.001079

== Recognize ==
Train average loss Recognize     : 1.234764
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.167838

Epoch 252:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.946, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]          Epoch 253:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.946, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.0144, Train/loss_recog_step=0.946, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230] Epoch 253:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=1.440, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=1.440, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.530, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.270, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.903, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.680, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.485, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.95it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.82it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.62it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.41it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067656, 0.066220, 0.064567
Valid average loss UNet            (all)              : 0.198443

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.116335, 4.609777, 7.230202
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.681229, 5.187256, 5.143093
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.778595, 5.249204, 5.259340
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.470233, 5.271348, 6.152903
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.335567, 4.954912, 5.596602
Valid average loss all      (Triplet)                 : 0.564095

== Recognize ==
Valid average loss Recognize     : 1.106647
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.762538

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.120619058609009 sec. =
Valid knn accuracy drums     : 79.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.348989963531494 sec. =
Valid knn accuracy bass      : 17.296511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.160513639450073 sec. =
Valid knn accuracy piano     : 31.351351351351354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.613170862197876 sec. =
Valid knn accuracy guitar    : 48.538961038961034%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.94935917854309 sec. =
Valid knn accuracy residuals : 63.20754716981132%

Valid knn accuracy average   : 47.96122717878261%

                                                                        [AEpoch 253: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00108, Train/loss_recog_epoch=1.230]Epoch 253: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055855, 0.055628, 0.056611
Train average loss UNet            (all)              : 0.168094

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000870, 4.639338, 7.933089
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001700, 4.537424, 6.942624
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002141, 4.606917, 6.830283
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003067, 4.682518, 7.440481
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001103, 4.881194, 7.134750
Train average loss all      (Triplet)                 : 0.001706

== Recognize ==
Train average loss Recognize     : 1.233625
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.169800

Epoch 253:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]          Epoch 254:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254:  80%|███████▉  | 250/313 [03:38<00:55,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.090, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.564, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.480, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.96it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.60it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.76it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.82it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068051, 0.066180, 0.064866
Valid average loss UNet            (all)              : 0.199096

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.076310, 5.088985, 7.794463
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.741285, 6.054126, 6.020373
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.885616, 5.973646, 5.820282
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.500874, 5.931613, 6.799538
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.434022, 6.080538, 6.450702
Valid average loss all      (Triplet)                 : 0.607156

== Recognize ==
Valid average loss Recognize     : 1.108458
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.806253

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.453295946121216 sec. =
Valid knn accuracy drums     : 78.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.698012590408325 sec. =
Valid knn accuracy bass      : 15.55232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.5430269241333 sec. =
Valid knn accuracy piano     : 30.945945945945947%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.068267107009888 sec. =
Valid knn accuracy guitar    : 45.94155844155844%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.50143575668335 sec. =
Valid knn accuracy residuals : 55.9748427672956%

Valid knn accuracy average   : 45.44764042959201%

                                                                        [AEpoch 254: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.170, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.230]Epoch 254: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055659, 0.055472, 0.056438
Train average loss UNet            (all)              : 0.167569

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000145, 4.883256, 8.264390
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001742, 4.754758, 7.256696
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001241, 4.876791, 7.277610
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000764, 4.964263, 7.884871
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000990, 5.181033, 7.567661
Train average loss all      (Triplet)                 : 0.000991

== Recognize ==
Train average loss Recognize     : 1.231192
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.168560

Epoch 254:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]          Epoch 255:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.607, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.454, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.80it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.83it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.95it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.13it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067738, 0.066336, 0.065499
Valid average loss UNet            (all)              : 0.199573

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143211, 4.884186, 7.819276
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.678610, 5.450235, 5.347468
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.863210, 5.532574, 5.351964
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.543355, 5.657314, 6.293911
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.420799, 5.721023, 6.174578
Valid average loss all      (Triplet)                 : 0.611859

== Recognize ==
Valid average loss Recognize     : 1.103181
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.811433

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.299971103668213 sec. =
Valid knn accuracy drums     : 81.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.229144811630249 sec. =
Valid knn accuracy bass      : 15.11627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.476440906524658 sec. =
Valid knn accuracy piano     : 30.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.291243076324463 sec. =
Valid knn accuracy guitar    : 50.97402597402597%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.287033319473267 sec. =
Valid knn accuracy residuals : 61.16352201257862%

Valid knn accuracy average   : 47.83073361477202%

                                                                        [AEpoch 255: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.000991, Train/loss_recog_epoch=1.230]Epoch 255: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055782, 0.055518, 0.056526
Train average loss UNet            (all)              : 0.167827

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000538, 4.851359, 8.319457
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002165, 4.767875, 7.322437
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002171, 4.842847, 7.166352
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001938, 4.959931, 7.848181
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001461, 5.128819, 7.463905
Train average loss all      (Triplet)                 : 0.001653

== Recognize ==
Train average loss Recognize     : 1.231831
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.169480

Epoch 255:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]          Epoch 256:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000171, Train/loss_recog_step=0.967, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000171, Train/loss_recog_step=0.967, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256:  96%|█████████▌| 300/313 [04:19<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00625, Train/loss_recog_step=1.430, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230] Epoch 256: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00625, Train/loss_recog_step=1.430, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=1.480, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.250, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.811, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.478, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.72it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.55it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.19it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.42it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067707, 0.065855, 0.064909
Valid average loss UNet            (all)              : 0.198471

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.095260, 4.775167, 7.438738
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.675113, 5.577598, 5.524288
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.928394, 5.501034, 5.381032
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.279510, 5.477861, 6.611243
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.449494, 5.739428, 6.035622
Valid average loss all      (Triplet)                 : 0.550365

== Recognize ==
Valid average loss Recognize     : 1.099689
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.748836

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.634614706039429 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.811259984970093 sec. =
Valid knn accuracy bass      : 18.6046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.752575159072876 sec. =
Valid knn accuracy piano     : 29.864864864864867%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.613706588745117 sec. =
Valid knn accuracy guitar    : 44.48051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.749371528625488 sec. =
Valid knn accuracy residuals : 60.062893081761004%

Valid knn accuracy average   : 46.308468070928384%

                                                                        [AEpoch 256: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.168, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.230]Epoch 256: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055465, 0.055251, 0.056188
Train average loss UNet            (all)              : 0.166904

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000124, 4.628329, 7.999952
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001157, 4.528311, 6.997804
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001326, 4.563350, 6.768549
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001384, 4.704098, 7.493846
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001170, 4.859100, 7.135975
Train average loss all      (Triplet)                 : 0.001034

== Recognize ==
Train average loss Recognize     : 1.225888
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.167938

Epoch 256:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]          Epoch 257:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=0.873, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=0.873, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]  Epoch 257:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.550, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.32it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.86it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.03it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.55it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067781, 0.066576, 0.065500
Valid average loss UNet            (all)              : 0.199857

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.144425, 4.985488, 7.811359
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.738856, 5.831243, 5.771080
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.843856, 5.748286, 5.823196
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.425931, 5.906839, 6.818854
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.371472, 5.846606, 6.695889
Valid average loss all      (Triplet)                 : 0.585402

== Recognize ==
Valid average loss Recognize     : 1.099790
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.785260

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.415124893188477 sec. =
Valid knn accuracy drums     : 79.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.05451774597168 sec. =
Valid knn accuracy bass      : 17.296511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.859995365142822 sec. =
Valid knn accuracy piano     : 31.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.873117685317993 sec. =
Valid knn accuracy guitar    : 53.73376623376623%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.650399208068848 sec. =
Valid knn accuracy residuals : 61.63522012578616%

Valid knn accuracy average   : 48.80098513008328%

                                                                        [AEpoch 257: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00103, Train/loss_recog_epoch=1.230]Epoch 257: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055455, 0.055287, 0.056169
Train average loss UNet            (all)              : 0.166911

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000278, 5.004632, 8.503993
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001441, 4.918441, 7.549546
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001488, 5.002295, 7.411257
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001598, 5.100434, 8.112062
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000506, 5.307837, 7.797491
Train average loss all      (Triplet)                 : 0.001053

== Recognize ==
Train average loss Recognize     : 1.225286
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.167965

Epoch 257:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]          Epoch 258:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]Epoch 258:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]Epoch 258:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=1.060, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]Epoch 258:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=1.060, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]Epoch 258:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000407, Train/loss_recog_step=1.270, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]Epoch 258:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000407, Train/loss_recog_step=1.270, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]Epoch 258:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.00603, Train/loss_recog_step=0.874, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230] Epoch 258:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.00603, Train/loss_recog_step=0.874, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]Epoch 258:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]  Epoch 258:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]Epoch 258:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.967, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]Epoch 258:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.967, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]Epoch 258:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]Epoch 258: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]Epoch 258: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.488, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.20it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.20it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.57it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.19it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.30it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066653, 0.065790, 0.065206
Valid average loss UNet            (all)              : 0.197650

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.176297, 4.840603, 7.550301
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.644788, 5.545364, 5.616084
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.838901, 5.391676, 5.279046
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.422581, 5.498991, 6.592837
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.424172, 5.577707, 6.297111
Valid average loss all      (Triplet)                 : 0.560019

== Recognize ==
Valid average loss Recognize     : 1.100380
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.757669

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.989012002944946 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.598050355911255 sec. =
Valid knn accuracy bass      : 19.476744186046513%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.706641435623169 sec. =
Valid knn accuracy piano     : 33.108108108108105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.68586277961731 sec. =
Valid knn accuracy guitar    : 50.324675324675326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.805755853652954 sec. =
Valid knn accuracy residuals : 59.905660377358494%

Valid knn accuracy average   : 48.62186112864945%

                                                                        [AEpoch 258: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00105, Train/loss_recog_epoch=1.230]Epoch 258: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055440, 0.055218, 0.056258
Train average loss UNet            (all)              : 0.166917

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000345, 4.798669, 8.197936
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001942, 4.717383, 7.312422
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001395, 4.781585, 7.121181
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001610, 4.908710, 7.822824
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001104, 5.080563, 7.465824
Train average loss all      (Triplet)                 : 0.001336

== Recognize ==
Train average loss Recognize     : 1.225863
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.168253

Epoch 258:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]          Epoch 259:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00119, Train/loss_recog_step=1.060, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00119, Train/loss_recog_step=1.060, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]  Epoch 259:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259:  48%|████▊     | 150/313 [02:12<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259:  64%|██████▍   | 200/313 [02:55<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.486, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.40it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.60it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.78it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.26it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067258, 0.066375, 0.065138
Valid average loss UNet            (all)              : 0.198771

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.156088, 5.052452, 8.038560
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.631269, 5.758459, 5.803393
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.951275, 5.779872, 5.587509
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.560746, 5.868966, 6.818995
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.426092, 5.616666, 6.643974
Valid average loss all      (Triplet)                 : 0.598974

== Recognize ==
Valid average loss Recognize     : 1.105350
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.797745

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.350255250930786 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.942538022994995 sec. =
Valid knn accuracy bass      : 18.459302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.55042576789856 sec. =
Valid knn accuracy piano     : 30.270270270270274%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.63198733329773 sec. =
Valid knn accuracy guitar    : 44.31818181818182%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.925829887390137 sec. =
Valid knn accuracy residuals : 58.01886792452831%

Valid knn accuracy average   : 45.88979505594765%

                                                                        [AEpoch 259: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.230]Epoch 259: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055285, 0.055102, 0.056047
Train average loss UNet            (all)              : 0.166434

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000315, 4.677632, 8.074455
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001147, 4.582546, 7.087079
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000991, 4.623905, 6.893678
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000798, 4.745118, 7.594604
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000776, 4.877586, 7.181345
Train average loss all      (Triplet)                 : 0.000814

== Recognize ==
Train average loss Recognize     : 1.229096
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.167248

Epoch 259:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]          Epoch 260:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000156, Train/loss_recog_step=1.070, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000156, Train/loss_recog_step=1.070, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]   Epoch 260:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.880, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.889, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.798, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.459, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.70it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.96it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.48it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.52it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066140, 0.065596, 0.065292
Valid average loss UNet            (all)              : 0.197028

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.168456, 5.215747, 8.391032
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.844578, 6.101532, 5.937900
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.010177, 6.060174, 5.751150
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.471677, 5.973024, 7.249063
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.456478, 5.943533, 7.081052
Valid average loss all      (Triplet)                 : 0.679005

== Recognize ==
Valid average loss Recognize     : 1.109357
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.876033

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.391334295272827 sec. =
Valid knn accuracy drums     : 77.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.800811767578125 sec. =
Valid knn accuracy bass      : 17.151162790697676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.330483198165894 sec. =
Valid knn accuracy piano     : 32.2972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.477814674377441 sec. =
Valid knn accuracy guitar    : 43.83116883116883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.747614860534668 sec. =
Valid knn accuracy residuals : 61.63522012578616%

Valid knn accuracy average   : 46.39473451487234%

                                                                        [AEpoch 260: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000814, Train/loss_recog_epoch=1.230]Epoch 260: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055307, 0.055133, 0.056026
Train average loss UNet            (all)              : 0.166465

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000316, 4.867016, 8.417362
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000715, 4.716732, 7.238261
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001491, 4.809165, 7.127241
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002129, 4.899431, 7.763951
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000411, 5.060665, 7.404202
Train average loss all      (Triplet)                 : 0.000964

== Recognize ==
Train average loss Recognize     : 1.234375
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.167429

Epoch 260:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]          Epoch 261:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.0147, Train/loss_recog_step=1.280, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.0147, Train/loss_recog_step=1.280, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230] Epoch 261:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261:  96%|█████████▌| 300/313 [04:20<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.340, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.110, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.876, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.679, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.464, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.84it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.98it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.10it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068023, 0.067248, 0.066117
Valid average loss UNet            (all)              : 0.201388

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.179193, 5.124652, 8.241382
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.684176, 5.823459, 5.873547
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.036042, 5.759385, 5.470259
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.409770, 5.777699, 7.089166
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.466339, 5.643208, 6.574593
Valid average loss all      (Triplet)                 : 0.630180

== Recognize ==
Valid average loss Recognize     : 1.106131
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.831569

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.092376708984375 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.15620231628418 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.427992582321167 sec. =
Valid knn accuracy piano     : 32.567567567567565%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.564306497573853 sec. =
Valid knn accuracy guitar    : 43.34415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.127086639404297 sec. =
Valid knn accuracy residuals : 58.01886792452831%

Valid knn accuracy average   : 45.983792685855%

                                                                        [AEpoch 261: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000964, Train/loss_recog_epoch=1.230]Epoch 261: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055414, 0.055175, 0.056151
Train average loss UNet            (all)              : 0.166740

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000658, 5.027071, 8.702127
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002356, 4.910060, 7.494803
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001583, 4.955457, 7.341050
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001375, 5.106503, 8.184034
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001634, 5.270517, 7.707436
Train average loss all      (Triplet)                 : 0.001553

== Recognize ==
Train average loss Recognize     : 1.231829
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.168293

Epoch 261:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]          Epoch 262:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262: 100%|██████████| 313/313 [04:29<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.330, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.100, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.460, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.64it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.78it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.89it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066063, 0.065158, 0.064070
Valid average loss UNet            (all)              : 0.195290

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.177164, 4.513332, 7.250939
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.596336, 5.220066, 5.306466
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.891019, 5.011759, 4.777016
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.364866, 5.080051, 6.130790
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.379638, 5.151852, 6.086163
Valid average loss all      (Triplet)                 : 0.543461

== Recognize ==
Valid average loss Recognize     : 1.106477
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.738750

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.43049693107605 sec. =
Valid knn accuracy drums     : 78.08823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.712321281433105 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.660123109817505 sec. =
Valid knn accuracy piano     : 31.351351351351354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.373737812042236 sec. =
Valid knn accuracy guitar    : 44.967532467532465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.645768880844116 sec. =
Valid knn accuracy residuals : 62.264150943396224%

Valid knn accuracy average   : 46.47378889500047%

                                                                        [AEpoch 262: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00155, Train/loss_recog_epoch=1.230]Epoch 262: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055561, 0.055347, 0.056284
Train average loss UNet            (all)              : 0.167192

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000841, 4.646503, 8.127501
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002825, 4.485151, 6.839158
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001246, 4.506535, 6.661723
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000955, 4.617505, 7.337365
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001921, 4.813063, 6.986082
Train average loss all      (Triplet)                 : 0.001567

== Recognize ==
Train average loss Recognize     : 1.230404
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.168758

Epoch 262:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]          Epoch 263:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.944, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263:  32%|███▏      | 100/313 [01:28<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263:  64%|██████▍   | 200/313 [02:53<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263:  80%|███████▉  | 250/313 [03:37<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263: 100%|██████████| 313/313 [04:30<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.224, Valid/loss_triplet_all_step=0.902, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.195, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.465, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.73it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.69it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.55it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.14it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.20it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066667, 0.066467, 0.065428
Valid average loss UNet            (all)              : 0.198562

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.165179, 4.697874, 7.316682
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.721768, 5.540499, 5.564242
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.889868, 5.281132, 5.184916
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.391286, 5.413851, 6.280533
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.455850, 5.448590, 6.181838
Valid average loss all      (Triplet)                 : 0.608794

== Recognize ==
Valid average loss Recognize     : 1.110698
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.807356

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.495457887649536 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.887734174728394 sec. =
Valid knn accuracy bass      : 16.424418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.999979972839355 sec. =
Valid knn accuracy piano     : 34.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.364920616149902 sec. =
Valid knn accuracy guitar    : 50.97402597402597%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.336263179779053 sec. =
Valid knn accuracy residuals : 58.9622641509434%

Valid knn accuracy average   : 47.89455828010534%

                                                                        [AEpoch 263: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.169, Train/loss_unet_all_epoch=0.167, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.230]Epoch 263: 100%|██████████| 313/313 [06:04<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055073, 0.054830, 0.055779
Train average loss UNet            (all)              : 0.165682

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000286, 4.433038, 7.756823
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001451, 4.247066, 6.557580
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000796, 4.297945, 6.447468
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000506, 4.434555, 7.067582
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000630, 4.677906, 6.908074
Train average loss all      (Triplet)                 : 0.000739

== Recognize ==
Train average loss Recognize     : 1.234091
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.166421

Epoch 263:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]          Epoch 264:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.883, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.883, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000587, Train/loss_recog_step=1.450, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000587, Train/loss_recog_step=1.450, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.609, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.479, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.78it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.91it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066131, 0.065941, 0.064797
Valid average loss UNet            (all)              : 0.196869

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.175955, 5.015839, 8.110233
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.682468, 5.595332, 5.577341
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.962998, 5.499543, 5.285029
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.549329, 5.634625, 6.523452
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.422776, 5.587723, 6.316299
Valid average loss all      (Triplet)                 : 0.644082

== Recognize ==
Valid average loss Recognize     : 1.111495
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.840951

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.06898546218872 sec. =
Valid knn accuracy drums     : 78.97058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.065048933029175 sec. =
Valid knn accuracy bass      : 15.55232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.682785034179688 sec. =
Valid knn accuracy piano     : 32.16216216216216%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.526771068572998 sec. =
Valid knn accuracy guitar    : 46.26623376623377%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.204094648361206 sec. =
Valid knn accuracy residuals : 58.17610062893082%

Valid knn accuracy average   : 46.225482074803246%

                                                                        [AEpoch 264: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000739, Train/loss_recog_epoch=1.230]Epoch 264: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055119, 0.054871, 0.055830
Train average loss UNet            (all)              : 0.165820

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000528, 4.542093, 7.995669
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000980, 4.420824, 6.839455
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000910, 4.489080, 6.728859
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001089, 4.632809, 7.413887
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000738, 4.793242, 7.038895
Train average loss all      (Triplet)                 : 0.000885

== Recognize ==
Train average loss Recognize     : 1.237128
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.166705

Epoch 264:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]          Epoch 265:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265:  48%|████▊     | 150/313 [02:11<02:23,  1.14it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.883, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.883, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265:  64%|██████▍   | 200/313 [02:52<01:37,  1.16it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.00515, Train/loss_recog_step=1.210, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.00515, Train/loss_recog_step=1.210, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265:  80%|███████▉  | 250/313 [03:36<00:54,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]  Epoch 265:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265:  96%|█████████▌| 300/313 [04:19<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.841, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.644, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.462, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.90it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.78it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.14it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066493, 0.066129, 0.065358
Valid average loss UNet            (all)              : 0.197979

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.172241, 5.023770, 8.033172
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.583013, 5.887276, 5.943503
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.960550, 5.547042, 5.293689
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.567747, 5.681277, 6.445017
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.353287, 5.726641, 6.674321
Valid average loss all      (Triplet)                 : 0.598570

== Recognize ==
Valid average loss Recognize     : 1.115934
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.796549

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.275075912475586 sec. =
Valid knn accuracy drums     : 75.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.484825372695923 sec. =
Valid knn accuracy bass      : 17.732558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.57219672203064 sec. =
Valid knn accuracy piano     : 33.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.631531953811646 sec. =
Valid knn accuracy guitar    : 48.37662337662338%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.963746786117554 sec. =
Valid knn accuracy residuals : 59.74842767295597%

Valid knn accuracy average   : 47.13177620984192%

                                                                        [AEpoch 265: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.000885, Train/loss_recog_epoch=1.240]Epoch 265: 100%|██████████| 313/313 [06:02<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.054899, 0.054636, 0.055612
Train average loss UNet            (all)              : 0.165147

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000006, 4.715032, 8.325698
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000667, 4.560789, 7.021852
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000706, 4.638483, 6.929803
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001305, 4.766798, 7.578032
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000526, 4.970938, 7.270727
Train average loss all      (Triplet)                 : 0.000604

== Recognize ==
Train average loss Recognize     : 1.238250
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.165751

Epoch 265:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]          Epoch 266:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]Epoch 266:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.158, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]Epoch 266:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=1.080, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]Epoch 266:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.158, Train/loss_triplet_all_step=0.00824, Train/loss_recog_step=1.080, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]Epoch 266:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]  Epoch 266:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]Epoch 266:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]Epoch 266:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]Epoch 266:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00121, Train/loss_recog_step=1.210, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]Epoch 266:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.00121, Train/loss_recog_step=1.210, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]Epoch 266:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=0.979, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]Epoch 266:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=0.979, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]Epoch 266:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]  Epoch 266: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]Epoch 266: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.0372, Train/loss_recog_step=0.952, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.471, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.45it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.74it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.84it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067471, 0.066055, 0.065397
Valid average loss UNet            (all)              : 0.198923

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.169049, 5.188845, 8.644652
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.780187, 6.059741, 5.973895
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.948130, 5.635014, 5.643133
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.555048, 5.904619, 6.721746
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.375470, 6.079828, 6.854845
Valid average loss all      (Triplet)                 : 0.668221

== Recognize ==
Valid average loss Recognize     : 1.117785
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.867144

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.383141040802002 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.823557138442993 sec. =
Valid knn accuracy bass      : 18.023255813953487%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.212474584579468 sec. =
Valid knn accuracy piano     : 28.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.881171464920044 sec. =
Valid knn accuracy guitar    : 46.42857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.924896717071533 sec. =
Valid knn accuracy residuals : 64.46540880503144%

Valid knn accuracy average   : 47.27311334623624%

                                                                        [AEpoch 266: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.0372, Train/loss_recog_step=0.952, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.000604, Train/loss_recog_epoch=1.240]Epoch 266: 100%|██████████| 313/313 [06:05<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.0372, Train/loss_recog_step=0.952, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055030, 0.054820, 0.055731
Train average loss UNet            (all)              : 0.165582

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000567, 4.968381, 8.769109
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001977, 4.897104, 7.551995
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001621, 4.878273, 7.276878
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000925, 5.028399, 7.995964
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000663, 5.258180, 7.726548
Train average loss all      (Triplet)                 : 0.001209

== Recognize ==
Train average loss Recognize     : 1.240935
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.166791

Epoch 266:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.0372, Train/loss_recog_step=0.952, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]          Epoch 267:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.0372, Train/loss_recog_step=0.952, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]Epoch 267:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.0372, Train/loss_recog_step=0.952, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]Epoch 267:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240] Epoch 267:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]Epoch 267:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]Epoch 267:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]Epoch 267:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]Epoch 267:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.164, Train/loss_unet_all_step=0.164, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]Epoch 267:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=1.220, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]Epoch 267:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=1.220, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]Epoch 267:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240] Epoch 267:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]Epoch 267:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]Epoch 267: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]Epoch 267: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.520, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.290, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.867, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.668, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.473, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.17it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.28it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.43it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.46it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.33it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066493, 0.065408, 0.063828
Valid average loss UNet            (all)              : 0.195730

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.142387, 4.773033, 7.734806
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.630435, 5.498901, 5.585770
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.933766, 5.203843, 5.225838
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.610850, 5.530568, 6.472513
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.420730, 5.458371, 5.898469
Valid average loss all      (Triplet)                 : 0.628842

== Recognize ==
Valid average loss Recognize     : 1.115819
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.824572

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.117244243621826 sec. =
Valid knn accuracy drums     : 80.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.623809576034546 sec. =
Valid knn accuracy bass      : 19.186046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.301890134811401 sec. =
Valid knn accuracy piano     : 34.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.409005403518677 sec. =
Valid knn accuracy guitar    : 49.51298701298701%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.02876353263855 sec. =
Valid knn accuracy residuals : 60.37735849056604%

Valid knn accuracy average   : 48.87887140780567%

                                                                        [AEpoch 267: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.240]Epoch 267: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055271, 0.055103, 0.056063
Train average loss UNet            (all)              : 0.166437

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000186, 4.518920, 7.967337
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002472, 4.451844, 6.811141
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001780, 4.449020, 6.579109
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001504, 4.582645, 7.216834
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001645, 4.757321, 6.895348
Train average loss all      (Triplet)                 : 0.001506

== Recognize ==
Train average loss Recognize     : 1.241359
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.167943

Epoch 267:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]          Epoch 268:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]Epoch 268:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.948, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]Epoch 268:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.00962, Train/loss_recog_step=1.080, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]Epoch 268:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.00962, Train/loss_recog_step=1.080, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]Epoch 268:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=1.280, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240] Epoch 268:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=1.280, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]Epoch 268:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000293, Train/loss_recog_step=0.885, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]Epoch 268:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.165, Train/loss_unet_all_step=0.165, Train/loss_triplet_all_step=0.000293, Train/loss_recog_step=0.885, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]Epoch 268:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]   Epoch 268:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]Epoch 268:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]Epoch 268:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]Epoch 268:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]Epoch 268: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]Epoch 268: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=1.390, Valid/loss_unet_all_step=0.225, Valid/loss_triplet_all_step=1.160, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.825, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.489, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.32it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.66it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.84it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.65it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.065958, 0.065820, 0.064417
Valid average loss UNet            (all)              : 0.196195

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.103735, 4.989410, 7.620088
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.672271, 5.756487, 5.939705
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.055525, 5.837318, 5.715084
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.659173, 5.987301, 6.905330
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.506762, 5.882983, 6.425640
Valid average loss all      (Triplet)                 : 0.693073

== Recognize ==
Valid average loss Recognize     : 1.116510
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.889268

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.020033359527588 sec. =
Valid knn accuracy drums     : 76.3235294117647%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.45505690574646 sec. =
Valid knn accuracy bass      : 22.819767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.496564149856567 sec. =
Valid knn accuracy piano     : 33.24324324324324%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.399442672729492 sec. =
Valid knn accuracy guitar    : 49.67532467532468%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.606846332550049 sec. =
Valid knn accuracy residuals : 63.67924528301887%

Valid knn accuracy average   : 49.14822201104239%

                                                                        [AEpoch 268: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.168, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.240]Epoch 268: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055060, 0.054852, 0.055776
Train average loss UNet            (all)              : 0.165688

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000110, 4.636337, 8.074666
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001488, 4.568575, 7.061870
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000994, 4.575703, 6.863070
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000754, 4.731771, 7.581555
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000537, 4.911764, 7.205464
Train average loss all      (Triplet)                 : 0.000810

== Recognize ==
Train average loss Recognize     : 1.240413
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.166498

Epoch 268:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]          Epoch 269:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.161, Train/loss_unet_all_step=0.161, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.00281, Train/loss_recog_step=1.080, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.00281, Train/loss_recog_step=1.080, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]  Epoch 269:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.981, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.981, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00365, Train/loss_recog_step=1.450, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00365, Train/loss_recog_step=1.450, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=1.600, Valid/loss_unet_all_step=0.226, Valid/loss_triplet_all_step=1.370, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.889, Valid/loss_unet_all_epoch=0.196, Valid/loss_triplet_all_epoch=0.693, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.491, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.46it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.62it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.70it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.01it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070183, 0.068489, 0.068226
Valid average loss UNet            (all)              : 0.206898

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113963, 5.187174, 8.568179
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.608927, 5.574857, 5.764855
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.002404, 5.737670, 5.590497
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.511407, 5.713265, 6.872099
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.429122, 5.910651, 6.456082
Valid average loss all      (Triplet)                 : 0.614060

== Recognize ==
Valid average loss Recognize     : 1.117234
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.820958

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.770986795425415 sec. =
Valid knn accuracy drums     : 78.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.625001668930054 sec. =
Valid knn accuracy bass      : 21.656976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.553802967071533 sec. =
Valid knn accuracy piano     : 30.54054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.36736011505127 sec. =
Valid knn accuracy guitar    : 48.05194805194805%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.340695142745972 sec. =
Valid knn accuracy residuals : 62.893081761006286%

Valid knn accuracy average   : 48.363803537183244%

                                                                        [AEpoch 269: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00081, Train/loss_recog_epoch=1.240]Epoch 269: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.054915, 0.054739, 0.055619
Train average loss UNet            (all)              : 0.165274

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000538, 4.811528, 8.581396
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001231, 4.619479, 7.082048
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001404, 4.715680, 7.026046
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000240, 4.865339, 7.809173
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000846, 5.079914, 7.461870
Train average loss all      (Triplet)                 : 0.000830

== Recognize ==
Train average loss Recognize     : 1.241413
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.166103

Epoch 269:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]          Epoch 270:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.162, Train/loss_unet_all_step=0.162, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.887, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.887, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.420, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.821, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.614, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.484, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.17it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.95it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.92it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.14it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.64it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.065400, 0.066123, 0.065299
Valid average loss UNet            (all)              : 0.196823

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.177540, 5.134422, 8.170299
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.666048, 6.080660, 6.153588
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.164664, 6.148079, 5.838513
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.648016, 6.210496, 6.981307
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.503203, 6.036767, 6.627185
Valid average loss all      (Triplet)                 : 0.720132

== Recognize ==
Valid average loss Recognize     : 1.116729
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.916955

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.642327547073364 sec. =
Valid knn accuracy drums     : 81.91176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.496919393539429 sec. =
Valid knn accuracy bass      : 19.767441860465116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.449868202209473 sec. =
Valid knn accuracy piano     : 33.648648648648646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.393176078796387 sec. =
Valid knn accuracy guitar    : 50.16233766233766%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.740574359893799 sec. =
Valid knn accuracy residuals : 63.52201257861635%

Valid knn accuracy average   : 49.802441091190026%

                                                                        [AEpoch 270: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.630, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.400, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.917, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.498, Train/loss_all_epoch=0.166, Train/loss_unet_all_epoch=0.165, Train/loss_triplet_all_epoch=0.00083, Train/loss_recog_epoch=1.240]Epoch 270: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.630, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.400, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.917, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.498, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.055192, 0.054986, 0.055921
Train average loss UNet            (all)              : 0.166099

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000623, 4.879633, 8.605282
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001239, 4.736584, 7.227469
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001338, 4.809685, 7.146676
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001905, 4.956745, 7.880755
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001571, 5.139657, 7.487980
Train average loss all      (Triplet)                 : 0.001322

== Recognize ==
Train average loss Recognize     : 1.242276
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.167422

Epoch 270:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.630, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.400, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.917, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.498, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.240]          Epoch 271:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.630, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.400, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.917, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.498, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.240]Epoch 271:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.159, Train/loss_unet_all_step=0.159, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.630, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.400, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.917, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.498, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.240]Epoch 271:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=1.630, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.400, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.917, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.498, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.240]Epoch 271:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.160, Train/loss_unet_all_step=0.160, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=1.630, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.400, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.917, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.498, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.240]Epoch 271:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00487, Train/loss_recog_step=1.290, Valid/loss_all_step=1.630, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.400, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.917, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.498, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.240]Epoch 271:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.00487, Train/loss_recog_step=1.290, Valid/loss_all_step=1.630, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.400, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.917, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.498, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.240]Epoch 271:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.163, Train/loss_unet_all_step=0.163, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=1.630, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.400, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.917, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.720, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.498, Train/loss_all_epoch=0.167, Train/loss_unet_all_epoch=0.166, Train/loss_triplet_all_epoch=0.00132, Train/loss_recog_epoch=1.240]  