
=== Using cuda(utils.func). ===

[2023-11-15 20:00:46,846][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-15 20:00:46,852][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: false                                                            
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.NNetForTriplet                                          
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 1                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         ckpt_model_path: null                                                 
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.NNetForTriplet                                        
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: false                                                            
│         n_mels: 259                                                           
│       ckpt_model_path: null                                                   
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: false                                                            
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.NNetForTriplet                                          
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 1                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: false                                                  
│         ckpt_model_path: null                                                 
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: -1                                                        
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 200                                                         
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       num_sanity_val_steps: 0                                                 
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       load_using_librosa: false                                               
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_psd_train: 3                                                    
│       seconds_psd_valid: 10                                                   
│       seconds_psd_test: 10                                                    
│       offset_psd_train: 1.5                                                   
│       offset_psd_valid: 5.0                                                   
│       offset_psd_test: 10.0                                                   
│       seconds_triplet_train: 3                                                
│       seconds_triplet_valid: 3                                                
│       offset_triplet_train: 1.5                                               
│       offset_triplet_valid: 1.5                                               
│       seconds_c32_train: 3                                                    
│       seconds_c32_valid: 10                                                   
│       seconds_c32_test: 10                                                    
│       offset_c32_train: 1.5                                                   
│       offset_c32_valid: 5.0                                                   
│       offset_c32_test: 10.0                                                   
│       sr: 44100                                                               
│       mel: false                                                              
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.NNetForTriplet                                            
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 1                                                            
│       recog_rate: 0                                                           
│       test_psd_mine: false                                                    
│       ckpt_model_path: null                                                   
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-15 20:00:46,946][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-15 20:00:46,972][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet_old). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640_addencoder). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de1_to1d640). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-15 20:00:50,253][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmp0235usg2
[2023-11-15 20:00:50,254][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmp0235usg2/_remote_module_non_scriptable.py
NNetForTriplet(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (encoder2): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(5, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 5, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=10880, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-15 20:00:50,352][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-15 20:00:50,352][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-15 20:00:50,358][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-15 20:00:50,360][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-15 20:00:50,361][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-15 20:00:50,361][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-15 20:00:50,422][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-15 20:00:50,787][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-15 20:00:51,119][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.749675989151001 sec. *
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [01:04<05:39,  0.78it/s]Epoch 0:  16%|█▌        | 50/313 [01:04<05:39,  0.78it/s, v_num=0, Train/loss_all_step=0.573, Train/loss_unet_all_step=0.373, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=0.780]Epoch 0:  32%|███▏      | 100/313 [01:47<03:49,  0.93it/s, v_num=0, Train/loss_all_step=0.573, Train/loss_unet_all_step=0.373, Train/loss_triplet_all_step=0.200, Train/loss_recog_step=0.780]Epoch 0:  32%|███▏      | 100/313 [01:47<03:49,  0.93it/s, v_num=0, Train/loss_all_step=0.528, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.830]Epoch 0:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.528, Train/loss_unet_all_step=0.325, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.830]Epoch 0:  48%|████▊     | 150/313 [02:31<02:44,  0.99it/s, v_num=0, Train/loss_all_step=0.496, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.197, Train/loss_recog_step=0.642]Epoch 0:  64%|██████▍   | 200/313 [03:14<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.496, Train/loss_unet_all_step=0.299, Train/loss_triplet_all_step=0.197, Train/loss_recog_step=0.642]Epoch 0:  64%|██████▍   | 200/313 [03:14<01:49,  1.03it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.785]Epoch 0:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.272, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.785]Epoch 0:  80%|███████▉  | 250/313 [03:57<00:59,  1.05it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=0.676]Epoch 0:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.271, Train/loss_triplet_all_step=0.167, Train/loss_recog_step=0.676]Epoch 0:  96%|█████████▌| 300/313 [04:40<00:12,  1.07it/s, v_num=0, Train/loss_all_step=0.434, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.188, Train/loss_recog_step=0.914]Epoch 0: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.434, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.188, Train/loss_recog_step=0.914]Epoch 0: 100%|██████████| 313/313 [04:50<00:00,  1.08it/s, v_num=0, Train/loss_all_step=0.444, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.676]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.95it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:05<00:00,  1.88it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.34it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:03<00:00,  3.92it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.59it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.12it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.089555, 0.088080, 0.088290
Valid average loss UNet            (all)              : 0.265925

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.089073, 0.251991, 0.565644
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.219714, 0.113039, 0.093325
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.226689, 0.159692, 0.135619
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.190757, 0.103907, 0.113151
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.128724, 0.160490, 0.247390
Valid average loss all      (Triplet)                 : 0.179488

== Recognize ==
Valid average loss Recognize     : 0.767866
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.445414

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 12.019767761230469 sec. =
Valid knn accuracy drums     : 65.73529411764706%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 11.912338972091675 sec. =
Valid knn accuracy bass      : 8.720930232558139%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 13.002924680709839 sec. =
Valid knn accuracy piano     : 7.567567567567568%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 10.525803089141846 sec. =
Valid knn accuracy guitar    : 7.467532467532467%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 10.806392192840576 sec. =
Valid knn accuracy residuals : 27.830188679245282%

Valid knn accuracy average   : 23.464302612910103%

                                                                        [AEpoch 0: 100%|██████████| 313/313 [06:44<00:00,  0.77it/s, v_num=0, Train/loss_all_step=0.444, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.676, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235]Epoch 0: 100%|██████████| 313/313 [06:44<00:00,  0.77it/s, v_num=0, Train/loss_all_step=0.444, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.676, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.102085, 0.102223, 0.102472
Train average loss UNet            (all)              : 0.306779

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.200861, 0.506974, 0.623802
Train average loss bass     (Triplet, dist_p, dist_n) : 0.282868, 0.488647, 0.483019
Train average loss piano    (Triplet, dist_p, dist_n) : 0.282001, 0.501721, 0.483405
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.280103, 0.515098, 0.494909
Train average loss residuals(Triplet, dist_p, dist_n) : 0.239952, 0.485196, 0.509178
Train average loss all      (Triplet)                 : 0.256862

== Recognize ==
Train average loss Recognize     : 0.817466
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.563640

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.444, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.676, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.444, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.676, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.444, Train/loss_unet_all_step=0.263, Train/loss_triplet_all_step=0.181, Train/loss_recog_step=0.676, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.424, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.188, Train/loss_recog_step=0.759, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.424, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.188, Train/loss_recog_step=0.759, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.257, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.863, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.443, Train/loss_unet_all_step=0.257, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.863, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.432, Train/loss_unet_all_step=0.254, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=0.684, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.432, Train/loss_unet_all_step=0.254, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=0.684, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.415, Train/loss_unet_all_step=0.237, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=0.791, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.415, Train/loss_unet_all_step=0.237, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=0.791, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.409, Train/loss_unet_all_step=0.248, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.655, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.409, Train/loss_unet_all_step=0.248, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.655, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.404, Train/loss_unet_all_step=0.232, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.949, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.404, Train/loss_unet_all_step=0.232, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.949, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.664, Valid/loss_all_step=0.467, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.178, Valid/loss_recog_step=0.898, Valid/loss_all_epoch=0.445, Valid/loss_unet_all_epoch=0.266, Valid/loss_triplet_all_epoch=0.179, Valid/loss_recog_epoch=0.768, Valid/knn_avr=0.235, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.26it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.89it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.59it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.24it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.084448, 0.083527, 0.083338
Valid average loss UNet            (all)              : 0.251312

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088312, 0.214721, 0.463613
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.202100, 0.194510, 0.239458
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.259650, 0.215049, 0.156629
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.207476, 0.159056, 0.152618
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.149817, 0.219501, 0.294312
Valid average loss all      (Triplet)                 : 0.187436

== Recognize ==
Valid average loss Recognize     : 0.777280
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.438748

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.762019395828247 sec. =
Valid knn accuracy drums     : 67.05882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.444263458251953 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.108761072158813 sec. =
Valid knn accuracy piano     : 7.4324324324324325%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.396010398864746 sec. =
Valid knn accuracy guitar    : 10.55194805194805%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.098646879196167 sec. =
Valid knn accuracy residuals : 32.70440251572327%

Valid knn accuracy average   : 26.36928874776357%

                                                                        [AEpoch 1: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.664, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.564, Train/loss_unet_all_epoch=0.307, Train/loss_triplet_all_epoch=0.257, Train/loss_recog_epoch=0.817]Epoch 1: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.664, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.081932, 0.081758, 0.082813
Train average loss UNet            (all)              : 0.246503

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.092561, 0.198485, 0.420044
Train average loss bass     (Triplet, dist_p, dist_n) : 0.202610, 0.135080, 0.139280
Train average loss piano    (Triplet, dist_p, dist_n) : 0.206360, 0.145549, 0.142028
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.206734, 0.132795, 0.127688
Train average loss residuals(Triplet, dist_p, dist_n) : 0.193974, 0.177218, 0.188900
Train average loss all      (Triplet)                 : 0.181225

== Recognize ==
Train average loss Recognize     : 0.816366
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.427728

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.664, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.664, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.451, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.664, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.404, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=0.724, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.404, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=0.724, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.415, Train/loss_unet_all_step=0.247, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=0.853, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.415, Train/loss_unet_all_step=0.247, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=0.853, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.429, Train/loss_unet_all_step=0.245, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=0.642, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.429, Train/loss_unet_all_step=0.245, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=0.642, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.230, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=0.781, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.230, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=0.781, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.239, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=0.680, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.239, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=0.680, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.414, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=0.962, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.414, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=0.962, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.239, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=0.687, Valid/loss_all_step=0.474, Valid/loss_unet_all_step=0.281, Valid/loss_triplet_all_step=0.194, Valid/loss_recog_step=0.932, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.251, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.264, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.35it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.33it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.53it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.07it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.082564, 0.081953, 0.082154
Valid average loss UNet            (all)              : 0.246671

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083670, 0.166122, 0.440205
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.198620, 0.084145, 0.085525
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.220495, 0.171968, 0.152707
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.218765, 0.137336, 0.118571
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.118386, 0.179241, 0.278388
Valid average loss all      (Triplet)                 : 0.177715

== Recognize ==
Valid average loss Recognize     : 0.756054
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.424386

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.558760643005371 sec. =
Valid knn accuracy drums     : 64.11764705882354%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.255090475082397 sec. =
Valid knn accuracy bass      : 13.953488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.785590171813965 sec. =
Valid knn accuracy piano     : 8.64864864864865%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.584795713424683 sec. =
Valid knn accuracy guitar    : 7.954545454545454%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.758321285247803 sec. =
Valid knn accuracy residuals : 25.628930817610062%

Valid knn accuracy average   : 24.060652070344144%

                                                                        [AEpoch 2: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.239, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=0.687, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.428, Train/loss_unet_all_epoch=0.247, Train/loss_triplet_all_epoch=0.181, Train/loss_recog_epoch=0.816]Epoch 2: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.239, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=0.687, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.078933, 0.078732, 0.079896
Train average loss UNet            (all)              : 0.237561

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.076985, 0.188415, 0.451136
Train average loss bass     (Triplet, dist_p, dist_n) : 0.203408, 0.129422, 0.131102
Train average loss piano    (Triplet, dist_p, dist_n) : 0.206440, 0.156717, 0.154324
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.201289, 0.148307, 0.150907
Train average loss residuals(Triplet, dist_p, dist_n) : 0.185645, 0.196646, 0.219837
Train average loss all      (Triplet)                 : 0.175588

== Recognize ==
Train average loss Recognize     : 0.819562
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.413149

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.239, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=0.687, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.239, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=0.687, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.239, Train/loss_triplet_all_step=0.207, Train/loss_recog_step=0.687, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=0.738, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=0.738, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.241, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=0.849, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.241, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=0.849, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.241, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.635, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.241, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.635, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.366, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.782, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.366, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.782, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=0.644, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.125, Train/loss_recog_step=0.644, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=0.917, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=0.917, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.661, Valid/loss_all_step=0.480, Valid/loss_unet_all_step=0.277, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.885, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.178, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.241, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.71it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.32it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.98it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.54it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.08it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.081402, 0.080930, 0.081136
Valid average loss UNet            (all)              : 0.243469

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.109544, 0.201845, 0.479762
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.211242, 0.101998, 0.091031
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.190702, 0.156160, 0.167907
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.183035, 0.166702, 0.201380
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.164286, 0.229473, 0.276841
Valid average loss all      (Triplet)                 : 0.175717

== Recognize ==
Valid average loss Recognize     : 0.775622
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.419186

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.459860801696777 sec. =
Valid knn accuracy drums     : 75.1470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.189343690872192 sec. =
Valid knn accuracy bass      : 8.13953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.165382623672485 sec. =
Valid knn accuracy piano     : 15.405405405405407%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.652075290679932 sec. =
Valid knn accuracy guitar    : 18.019480519480517%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.180307865142822 sec. =
Valid knn accuracy residuals : 25.31446540880503%

Valid knn accuracy average   : 28.40518900818826%

                                                                        [AEpoch 3: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.661, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.413, Train/loss_unet_all_epoch=0.238, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.820]Epoch 3: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.661, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.077632, 0.077419, 0.078637
Train average loss UNet            (all)              : 0.233687

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.069622, 0.187777, 0.481180
Train average loss bass     (Triplet, dist_p, dist_n) : 0.194731, 0.142478, 0.156390
Train average loss piano    (Triplet, dist_p, dist_n) : 0.199763, 0.145642, 0.148349
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.194906, 0.155551, 0.164634
Train average loss residuals(Triplet, dist_p, dist_n) : 0.180579, 0.208346, 0.238712
Train average loss all      (Triplet)                 : 0.168941

== Recognize ==
Train average loss Recognize     : 0.814864
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.402628

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.661, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.661, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.438, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.661, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.381, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=0.717, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.381, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.169, Train/loss_recog_step=0.717, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.404, Train/loss_unet_all_step=0.240, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=0.849, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.404, Train/loss_unet_all_step=0.240, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=0.849, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.381, Train/loss_unet_all_step=0.239, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=0.636, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.381, Train/loss_unet_all_step=0.239, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=0.636, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.797, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.797, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.232, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.649, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.232, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.649, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.959, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.959, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.423, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=0.657, Valid/loss_all_step=0.452, Valid/loss_unet_all_step=0.275, Valid/loss_triplet_all_step=0.177, Valid/loss_recog_step=0.933, Valid/loss_all_epoch=0.419, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.284, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.13it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.83it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.41it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.64it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.39it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.080516, 0.080205, 0.081237
Valid average loss UNet            (all)              : 0.241957

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.120566, 0.239898, 0.629810
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.210175, 0.097053, 0.087017
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.207904, 0.176652, 0.168747
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.197649, 0.217431, 0.246537
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.166533, 0.228759, 0.266908
Valid average loss all      (Triplet)                 : 0.185030

== Recognize ==
Valid average loss Recognize     : 0.810517
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.426987

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.463099718093872 sec. =
Valid knn accuracy drums     : 70.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.200026750564575 sec. =
Valid knn accuracy bass      : 9.44767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.186462640762329 sec. =
Valid knn accuracy piano     : 20.675675675675677%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.899654388427734 sec. =
Valid knn accuracy guitar    : 22.24025974025974%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.12224817276001 sec. =
Valid knn accuracy residuals : 22.0125786163522%

Valid knn accuracy average   : 29.02229651370786%

                                                                        [AEpoch 4: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.423, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=0.657, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.403, Train/loss_unet_all_epoch=0.234, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.815]Epoch 4: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.423, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=0.657, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.076747, 0.076597, 0.077740
Train average loss UNet            (all)              : 0.231085

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.066306, 0.209413, 0.533954
Train average loss bass     (Triplet, dist_p, dist_n) : 0.196510, 0.136420, 0.145568
Train average loss piano    (Triplet, dist_p, dist_n) : 0.195255, 0.182556, 0.192548
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.188722, 0.181784, 0.200470
Train average loss residuals(Triplet, dist_p, dist_n) : 0.174447, 0.228646, 0.267717
Train average loss all      (Triplet)                 : 0.165432

== Recognize ==
Train average loss Recognize     : 0.820678
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.396516

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.423, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=0.657, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.423, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=0.657, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.423, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.189, Train/loss_recog_step=0.657, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.731, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.731, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.384, Train/loss_unet_all_step=0.237, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.859, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.384, Train/loss_unet_all_step=0.237, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.859, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.635, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.234, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.635, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.795, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.356, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.795, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.358, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.661, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.358, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.661, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.930, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.930, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.644, Valid/loss_all_step=0.489, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.216, Valid/loss_recog_step=1.010, Valid/loss_all_epoch=0.427, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.811, Valid/knn_avr=0.290, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.38it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.14it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.85it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.92it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.94it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.083354, 0.083291, 0.087456
Valid average loss UNet            (all)              : 0.254101

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101317, 0.270766, 0.772335
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.250040, 0.227297, 0.192613
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.225209, 0.275551, 0.260676
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.159356, 0.271297, 0.378798
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.113395, 0.287866, 0.463099
Valid average loss all      (Triplet)                 : 0.182370

== Recognize ==
Valid average loss Recognize     : 0.755728
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.436471

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.454205513000488 sec. =
Valid knn accuracy drums     : 75.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.152507543563843 sec. =
Valid knn accuracy bass      : 9.593023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.710907220840454 sec. =
Valid knn accuracy piano     : 21.756756756756758%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.650141477584839 sec. =
Valid knn accuracy guitar    : 14.44805194805195%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.087869644165039 sec. =
Valid knn accuracy residuals : 32.075471698113205%

Valid knn accuracy average   : 30.751131319982463%

                                                                        [AEpoch 5: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.644, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.397, Train/loss_unet_all_epoch=0.231, Train/loss_triplet_all_epoch=0.165, Train/loss_recog_epoch=0.821]Epoch 5: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.644, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.075784, 0.075642, 0.076763
Train average loss UNet            (all)              : 0.228189

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.063424, 0.216029, 0.560147
Train average loss bass     (Triplet, dist_p, dist_n) : 0.190071, 0.143939, 0.162037
Train average loss piano    (Triplet, dist_p, dist_n) : 0.190840, 0.193318, 0.210087
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.178438, 0.199340, 0.234222
Train average loss residuals(Triplet, dist_p, dist_n) : 0.166239, 0.250449, 0.302200
Train average loss all      (Triplet)                 : 0.158996

== Recognize ==
Train average loss Recognize     : 0.822574
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.387184

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.644, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.644, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.644, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.370, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=0.733, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.370, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=0.733, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.371, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.883, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.371, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.883, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.230, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=0.663, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.230, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=0.663, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.799, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.799, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.227, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=0.641, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.227, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=0.641, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.360, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.932, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.360, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.932, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=0.648, Valid/loss_all_step=0.505, Valid/loss_unet_all_step=0.294, Valid/loss_triplet_all_step=0.211, Valid/loss_recog_step=0.928, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.254, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.308, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.17it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.82it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.90it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.66it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.081881, 0.080612, 0.083578
Valid average loss UNet            (all)              : 0.246071

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.089596, 0.209576, 0.622165
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.226695, 0.197199, 0.174021
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.216723, 0.238404, 0.226310
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.151108, 0.242288, 0.358510
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.111862, 0.260760, 0.368554
Valid average loss all      (Triplet)                 : 0.167051

== Recognize ==
Valid average loss Recognize     : 0.756455
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.413122

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.819818019866943 sec. =
Valid knn accuracy drums     : 75.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.433587312698364 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.81101131439209 sec. =
Valid knn accuracy piano     : 20.27027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.27351689338684 sec. =
Valid knn accuracy guitar    : 24.18831168831169%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.054874181747437 sec. =
Valid knn accuracy residuals : 34.74842767295597%

Valid knn accuracy average   : 33.86568373205314%

                                                                        [AEpoch 6: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=0.648, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.387, Train/loss_unet_all_epoch=0.228, Train/loss_triplet_all_epoch=0.159, Train/loss_recog_epoch=0.823]Epoch 6: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=0.648, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.074742, 0.074551, 0.075656
Train average loss UNet            (all)              : 0.224949

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.060456, 0.216742, 0.556772
Train average loss bass     (Triplet, dist_p, dist_n) : 0.188035, 0.166344, 0.190072
Train average loss piano    (Triplet, dist_p, dist_n) : 0.189352, 0.202701, 0.220291
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.174354, 0.207928, 0.250474
Train average loss residuals(Triplet, dist_p, dist_n) : 0.161550, 0.264835, 0.323418
Train average loss all      (Triplet)                 : 0.156145

== Recognize ==
Train average loss Recognize     : 0.831378
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.381094

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=0.648, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=0.648, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.164, Train/loss_recog_step=0.648, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.744, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.744, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.384, Train/loss_unet_all_step=0.230, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=0.864, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.384, Train/loss_unet_all_step=0.230, Train/loss_triplet_all_step=0.153, Train/loss_recog_step=0.864, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.228, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=0.660, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.228, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=0.660, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=0.813, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=0.813, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.332, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=0.691, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.332, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=0.691, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.989, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.989, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.377, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.662, Valid/loss_all_step=0.448, Valid/loss_unet_all_step=0.287, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=0.918, Valid/loss_all_epoch=0.413, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.167, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.339, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.06it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.95it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.85it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.35it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.95it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.079941, 0.079121, 0.082385
Valid average loss UNet            (all)              : 0.241447

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.086811, 0.252364, 0.606614
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.222212, 0.244124, 0.231668
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.213655, 0.284633, 0.278454
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.159701, 0.299357, 0.442988
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.123224, 0.403101, 0.527263
Valid average loss all      (Triplet)                 : 0.172063

== Recognize ==
Valid average loss Recognize     : 0.776368
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.413510

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.269866466522217 sec. =
Valid knn accuracy drums     : 72.35294117647058%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.187124013900757 sec. =
Valid knn accuracy bass      : 4.3604651162790695%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.997382640838623 sec. =
Valid knn accuracy piano     : 22.2972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.85881233215332 sec. =
Valid knn accuracy guitar    : 18.506493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.001249551773071 sec. =
Valid knn accuracy residuals : 39.15094339622642%

Valid knn accuracy average   : 31.33362809855338%

                                                                        [AEpoch 7: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.377, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.662, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.225, Train/loss_triplet_all_epoch=0.156, Train/loss_recog_epoch=0.831]Epoch 7: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.377, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.662, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.073793, 0.073562, 0.074714
Train average loss UNet            (all)              : 0.222068

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.061064, 0.240906, 0.595272
Train average loss bass     (Triplet, dist_p, dist_n) : 0.182477, 0.179438, 0.211992
Train average loss piano    (Triplet, dist_p, dist_n) : 0.185998, 0.220906, 0.244357
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.172220, 0.221971, 0.269885
Train average loss residuals(Triplet, dist_p, dist_n) : 0.155979, 0.288909, 0.360359
Train average loss all      (Triplet)                 : 0.152732

== Recognize ==
Train average loss Recognize     : 0.841948
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.374800

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.377, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.662, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.377, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.662, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.377, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.154, Train/loss_recog_step=0.662, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.367, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=0.738, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.367, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=0.738, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=0.852, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=0.852, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.384, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.668, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.384, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.161, Train/loss_recog_step=0.668, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.339, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=0.811, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.339, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=0.811, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.679, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.679, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.369, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=0.960, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.369, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=0.960, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=0.656, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.278, Valid/loss_triplet_all_step=0.175, Valid/loss_recog_step=0.925, Valid/loss_all_epoch=0.414, Valid/loss_unet_all_epoch=0.241, Valid/loss_triplet_all_epoch=0.172, Valid/loss_recog_epoch=0.776, Valid/knn_avr=0.313, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.13it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.55it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.39it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.98it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.080051, 0.079590, 0.083459
Valid average loss UNet            (all)              : 0.243100

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090564, 0.236634, 0.575765
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.239552, 0.283504, 0.275753
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.177556, 0.231781, 0.259723
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.149880, 0.273043, 0.401702
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.118437, 0.365325, 0.484183
Valid average loss all      (Triplet)                 : 0.167922

== Recognize ==
Valid average loss Recognize     : 0.754516
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.411021

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.668658971786499 sec. =
Valid knn accuracy drums     : 74.70588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.042955160140991 sec. =
Valid knn accuracy bass      : 11.627906976744185%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.113460063934326 sec. =
Valid knn accuracy piano     : 12.432432432432433%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.47974705696106 sec. =
Valid knn accuracy guitar    : 26.948051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.021692276000977 sec. =
Valid knn accuracy residuals : 46.540880503144656%

Valid knn accuracy average   : 34.451030842662874%

                                                                        [AEpoch 8: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=0.656, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.375, Train/loss_unet_all_epoch=0.222, Train/loss_triplet_all_epoch=0.153, Train/loss_recog_epoch=0.842]Epoch 8: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=0.656, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.072802, 0.072607, 0.073807
Train average loss UNet            (all)              : 0.219217

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.057361, 0.243464, 0.606955
Train average loss bass     (Triplet, dist_p, dist_n) : 0.182997, 0.183500, 0.212920
Train average loss piano    (Triplet, dist_p, dist_n) : 0.184492, 0.221736, 0.247241
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.166688, 0.229331, 0.286655
Train average loss residuals(Triplet, dist_p, dist_n) : 0.148073, 0.310897, 0.394946
Train average loss all      (Triplet)                 : 0.149458

== Recognize ==
Train average loss Recognize     : 0.832472
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.368675

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=0.656, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=0.656, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=0.656, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=0.749, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=0.749, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.365, Train/loss_unet_all_step=0.228, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.856, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.365, Train/loss_unet_all_step=0.228, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.856, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.359, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.653, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.359, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.653, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.818, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.321, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.818, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.690, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.690, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.978, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.140, Train/loss_recog_step=0.978, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.649, Valid/loss_all_step=0.453, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.185, Valid/loss_recog_step=0.893, Valid/loss_all_epoch=0.411, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.168, Valid/loss_recog_epoch=0.755, Valid/knn_avr=0.345, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.69it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.71it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.21it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.89it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.080786, 0.078799, 0.083208
Valid average loss UNet            (all)              : 0.242794

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.091711, 0.241834, 0.680478
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.203534, 0.197824, 0.201940
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.164278, 0.203539, 0.243447
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.151628, 0.266594, 0.386595
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.110721, 0.369590, 0.528891
Valid average loss all      (Triplet)                 : 0.150265

== Recognize ==
Valid average loss Recognize     : 0.775295
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.393059

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.247411489486694 sec. =
Valid knn accuracy drums     : 73.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.140552997589111 sec. =
Valid knn accuracy bass      : 11.482558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.033081769943237 sec. =
Valid knn accuracy piano     : 13.783783783783784%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.749664545059204 sec. =
Valid knn accuracy guitar    : 25.162337662337663%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.733396768569946 sec. =
Valid knn accuracy residuals : 45.44025157232704%

Valid knn accuracy average   : 33.82084505512609%

                                                                        [AEpoch 9: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.649, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.369, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.149, Train/loss_recog_epoch=0.832]Epoch 9: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.649, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.072252, 0.071983, 0.073191
Train average loss UNet            (all)              : 0.217425

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.055653, 0.252875, 0.629568
Train average loss bass     (Triplet, dist_p, dist_n) : 0.181472, 0.191721, 0.225620
Train average loss piano    (Triplet, dist_p, dist_n) : 0.180537, 0.226219, 0.257157
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.161995, 0.231515, 0.296292
Train average loss residuals(Triplet, dist_p, dist_n) : 0.141692, 0.323030, 0.419520
Train average loss all      (Triplet)                 : 0.145635

== Recognize ==
Train average loss Recognize     : 0.840744
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.363060

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.649, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.649, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.354, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.649, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.346, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.774, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.346, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.774, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.876, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.137, Train/loss_recog_step=0.876, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.690, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.375, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.156, Train/loss_recog_step=0.690, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.326, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=0.800, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.326, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=0.800, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.707, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.707, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.992, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.992, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.647, Valid/loss_all_step=0.410, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.127, Valid/loss_recog_step=0.921, Valid/loss_all_epoch=0.393, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.775, Valid/knn_avr=0.338, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.93it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.06it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.36it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.63it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.69it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.077184, 0.075746, 0.077545
Valid average loss UNet            (all)              : 0.230474

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077191, 0.233756, 0.659144
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.189058, 0.192403, 0.233229
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.192367, 0.236407, 0.244457
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.148420, 0.253291, 0.398905
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.157792, 0.343790, 0.413521
Valid average loss all      (Triplet)                 : 0.153700

== Recognize ==
Valid average loss Recognize     : 0.776710
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.384174

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.60996389389038 sec. =
Valid knn accuracy drums     : 75.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.152687788009644 sec. =
Valid knn accuracy bass      : 11.918604651162791%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.589499473571777 sec. =
Valid knn accuracy piano     : 13.243243243243244%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.849617719650269 sec. =
Valid knn accuracy guitar    : 29.05844155844156%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.904737710952759 sec. =
Valid knn accuracy residuals : 40.25157232704403%

Valid knn accuracy average   : 34.04143117950773%

                                                                        [AEpoch 10: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.647, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.363, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.146, Train/loss_recog_epoch=0.841]Epoch 10: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.647, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.071645, 0.071433, 0.072643
Train average loss UNet            (all)              : 0.215722

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.053754, 0.270448, 0.664161
Train average loss bass     (Triplet, dist_p, dist_n) : 0.178139, 0.206363, 0.246632
Train average loss piano    (Triplet, dist_p, dist_n) : 0.180093, 0.237285, 0.270586
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.159051, 0.245414, 0.319046
Train average loss residuals(Triplet, dist_p, dist_n) : 0.138525, 0.341067, 0.447105
Train average loss all      (Triplet)                 : 0.143081

== Recognize ==
Train average loss Recognize     : 0.844602
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.358804

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.647, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.647, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.647, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.340, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=0.744, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.340, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.142, Train/loss_recog_step=0.744, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=0.868, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=0.868, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.359, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=0.651, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.359, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=0.651, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.318, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=0.831, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.318, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=0.831, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.322, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.705, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.322, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.705, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.341, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.000, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.341, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.124, Train/loss_recog_step=1.000, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.640, Valid/loss_all_step=0.403, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.131, Valid/loss_recog_step=0.922, Valid/loss_all_epoch=0.384, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.777, Valid/knn_avr=0.340, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.15it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.53it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.53it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.22it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.080429, 0.078852, 0.081173
Valid average loss UNet            (all)              : 0.240454

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087997, 0.251999, 0.695157
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.217077, 0.238079, 0.228991
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.193202, 0.269333, 0.278323
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.128451, 0.272589, 0.432278
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.137940, 0.338156, 0.428550
Valid average loss all      (Triplet)                 : 0.159920

== Recognize ==
Valid average loss Recognize     : 0.794289
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.400374

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.439071893692017 sec. =
Valid knn accuracy drums     : 79.11764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.264767169952393 sec. =
Valid knn accuracy bass      : 15.11627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.922258377075195 sec. =
Valid knn accuracy piano     : 15.27027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.91132116317749 sec. =
Valid knn accuracy guitar    : 28.246753246753247%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.239308834075928 sec. =
Valid knn accuracy residuals : 43.39622641509434%

Valid knn accuracy average   : 36.22943521214176%

                                                                        [AEpoch 11: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.640, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.359, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.143, Train/loss_recog_epoch=0.845]Epoch 11: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.640, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.071279, 0.071078, 0.072276
Train average loss UNet            (all)              : 0.214632

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.048970, 0.273194, 0.675006
Train average loss bass     (Triplet, dist_p, dist_n) : 0.175145, 0.214917, 0.260358
Train average loss piano    (Triplet, dist_p, dist_n) : 0.175574, 0.246359, 0.287621
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.155234, 0.249946, 0.330225
Train average loss residuals(Triplet, dist_p, dist_n) : 0.133900, 0.343987, 0.459158
Train average loss all      (Triplet)                 : 0.138813

== Recognize ==
Train average loss Recognize     : 0.846455
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.353445

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.640, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.640, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=0.640, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.344, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=0.803, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.344, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.149, Train/loss_recog_step=0.803, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.351, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=0.893, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.351, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=0.893, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.355, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=0.679, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.355, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=0.679, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.311, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.848, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.311, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.848, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.307, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0931, Train/loss_recog_step=0.706, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.307, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0931, Train/loss_recog_step=0.706, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.337, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.000, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846] Epoch 12: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.337, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.000, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.659, Valid/loss_all_step=0.444, Valid/loss_unet_all_step=0.288, Valid/loss_triplet_all_step=0.156, Valid/loss_recog_step=0.962, Valid/loss_all_epoch=0.400, Valid/loss_unet_all_epoch=0.240, Valid/loss_triplet_all_epoch=0.160, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.362, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.93it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.43it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.03it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.07it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.079823, 0.078254, 0.081083
Valid average loss UNet            (all)              : 0.239161

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.085712, 0.291807, 0.700652
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.226166, 0.287837, 0.345958
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.172424, 0.308852, 0.362905
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.171919, 0.367434, 0.506278
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.156574, 0.458276, 0.540488
Valid average loss all      (Triplet)                 : 0.172507

== Recognize ==
Valid average loss Recognize     : 0.790869
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.411668

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.201041221618652 sec. =
Valid knn accuracy drums     : 72.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.09906268119812 sec. =
Valid knn accuracy bass      : 10.755813953488373%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.9573392868042 sec. =
Valid knn accuracy piano     : 17.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.762054204940796 sec. =
Valid knn accuracy guitar    : 27.435064935064936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.673393726348877 sec. =
Valid knn accuracy residuals : 46.38364779874214%

Valid knn accuracy average   : 34.84018355685495%

                                                                        [AEpoch 12: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.659, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.353, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.139, Train/loss_recog_epoch=0.846]Epoch 12: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.659, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.070948, 0.070771, 0.071823
Train average loss UNet            (all)              : 0.213542

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.045628, 0.294295, 0.713752
Train average loss bass     (Triplet, dist_p, dist_n) : 0.175756, 0.229905, 0.277159
Train average loss piano    (Triplet, dist_p, dist_n) : 0.175317, 0.262888, 0.305688
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.149829, 0.272975, 0.364713
Train average loss residuals(Triplet, dist_p, dist_n) : 0.131122, 0.364064, 0.487909
Train average loss all      (Triplet)                 : 0.136644

== Recognize ==
Train average loss Recognize     : 0.858905
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.350187

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.659, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.659, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=0.659, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.335, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.761, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.335, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.138, Train/loss_recog_step=0.761, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.896, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.896, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.360, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.668, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.360, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.668, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.852, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.852, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.304, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0906, Train/loss_recog_step=0.728, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.304, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0906, Train/loss_recog_step=0.728, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.349, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.010, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859] Epoch 13: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.349, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=1.010, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.659, Valid/loss_all_step=0.472, Valid/loss_unet_all_step=0.282, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.949, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.239, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.791, Valid/knn_avr=0.348, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.57it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.09it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.22it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.30it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.076904, 0.075894, 0.077607
Valid average loss UNet            (all)              : 0.230405

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099796, 0.307565, 0.778088
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.194085, 0.209747, 0.222874
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.170505, 0.288425, 0.324090
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.142959, 0.334707, 0.476876
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.118482, 0.375109, 0.522340
Valid average loss all      (Triplet)                 : 0.150484

== Recognize ==
Valid average loss Recognize     : 0.793755
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.380889

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.782051801681519 sec. =
Valid knn accuracy drums     : 75.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.32890272140503 sec. =
Valid knn accuracy bass      : 9.30232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.871131658554077 sec. =
Valid knn accuracy piano     : 14.324324324324325%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.5555579662323 sec. =
Valid knn accuracy guitar    : 38.14935064935065%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.412423133850098 sec. =
Valid knn accuracy residuals : 41.509433962264154%

Valid knn accuracy average   : 35.71591043287866%

                                                                        [AEpoch 13: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.659, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.350, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.137, Train/loss_recog_epoch=0.859]Epoch 13: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.659, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.070663, 0.070453, 0.071633
Train average loss UNet            (all)              : 0.212749

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.043039, 0.308858, 0.754773
Train average loss bass     (Triplet, dist_p, dist_n) : 0.175110, 0.236841, 0.284948
Train average loss piano    (Triplet, dist_p, dist_n) : 0.170982, 0.275783, 0.324742
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.147750, 0.288758, 0.388687
Train average loss residuals(Triplet, dist_p, dist_n) : 0.127651, 0.374298, 0.507633
Train average loss all      (Triplet)                 : 0.134158

== Recognize ==
Train average loss Recognize     : 0.868964
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.346907

Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.659, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]          Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.659, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.112, Train/loss_recog_step=0.659, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=0.801, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.133, Train/loss_recog_step=0.801, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.887, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.887, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.657, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.132, Train/loss_recog_step=0.657, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0933, Train/loss_recog_step=0.861, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0933, Train/loss_recog_step=0.861, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.308, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0959, Train/loss_recog_step=0.724, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.308, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0959, Train/loss_recog_step=0.724, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.351, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.030, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869] Epoch 14: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.351, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.136, Train/loss_recog_step=1.030, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.675, Valid/loss_all_step=0.394, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.130, Valid/loss_recog_step=0.960, Valid/loss_all_epoch=0.381, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.150, Valid/loss_recog_epoch=0.794, Valid/knn_avr=0.357, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.09it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.06it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.97it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.39it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074306, 0.073606, 0.073483
Valid average loss UNet            (all)              : 0.221394

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.089863, 0.281366, 0.684780
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.172234, 0.216848, 0.263819
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.199263, 0.247941, 0.249969
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.150040, 0.288296, 0.404562
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.158784, 0.352574, 0.415665
Valid average loss all      (Triplet)                 : 0.153925

== Recognize ==
Valid average loss Recognize     : 0.815052
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.375319

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.771572351455688 sec. =
Valid knn accuracy drums     : 71.91176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.178781747817993 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.999875783920288 sec. =
Valid knn accuracy piano     : 14.054054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.660184621810913 sec. =
Valid knn accuracy guitar    : 28.8961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.015587091445923 sec. =
Valid knn accuracy residuals : 42.76729559748428%

Valid knn accuracy average   : 34.57816923210026%

                                                                        [AEpoch 14: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.675, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.347, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.134, Train/loss_recog_epoch=0.869]Epoch 14: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.675, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.070382, 0.070124, 0.071310
Train average loss UNet            (all)              : 0.211816

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.040881, 0.321902, 0.780076
Train average loss bass     (Triplet, dist_p, dist_n) : 0.173072, 0.249432, 0.301196
Train average loss piano    (Triplet, dist_p, dist_n) : 0.164730, 0.302486, 0.363507
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.142650, 0.309390, 0.422664
Train average loss residuals(Triplet, dist_p, dist_n) : 0.125688, 0.395642, 0.534813
Train average loss all      (Triplet)                 : 0.130487

== Recognize ==
Train average loss Recognize     : 0.880476
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.342303

Epoch 14:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.675, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]          Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.675, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.675, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.333, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=0.825, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.333, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.135, Train/loss_recog_step=0.825, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=0.892, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.119, Train/loss_recog_step=0.892, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.343, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.653, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.343, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.653, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0936, Train/loss_recog_step=0.844, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0936, Train/loss_recog_step=0.844, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.282, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0712, Train/loss_recog_step=0.724, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.282, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0712, Train/loss_recog_step=0.724, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.030, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880] Epoch 15: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.128, Train/loss_recog_step=1.030, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.338, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.649, Valid/loss_all_step=0.375, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.135, Valid/loss_recog_step=0.997, Valid/loss_all_epoch=0.375, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.154, Valid/loss_recog_epoch=0.815, Valid/knn_avr=0.346, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.22it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.75it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.29it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.12it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074767, 0.073378, 0.074870
Valid average loss UNet            (all)              : 0.223016

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.095379, 0.358075, 0.763382
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.234204, 0.260505, 0.229639
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.169170, 0.323956, 0.367259
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.134061, 0.358870, 0.570367
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.131227, 0.359392, 0.452480
Valid average loss all      (Triplet)                 : 0.163080

== Recognize ==
Valid average loss Recognize     : 0.834465
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.386096

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.537201404571533 sec. =
Valid knn accuracy drums     : 70.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.113007545471191 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.924336194992065 sec. =
Valid knn accuracy piano     : 22.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.683993339538574 sec. =
Valid knn accuracy guitar    : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.13973593711853 sec. =
Valid knn accuracy residuals : 52.20125786163522%

Valid knn accuracy average   : 39.97257493536176%

                                                                        [AEpoch 15: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.338, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.649, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.342, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.130, Train/loss_recog_epoch=0.880]Epoch 15: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.338, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.649, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.070301, 0.070162, 0.071314
Train average loss UNet            (all)              : 0.211777

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.037782, 0.346780, 0.824737
Train average loss bass     (Triplet, dist_p, dist_n) : 0.173544, 0.260284, 0.312234
Train average loss piano    (Triplet, dist_p, dist_n) : 0.162628, 0.324796, 0.389356
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.136676, 0.327455, 0.452185
Train average loss residuals(Triplet, dist_p, dist_n) : 0.121783, 0.418842, 0.566029
Train average loss all      (Triplet)                 : 0.127712

== Recognize ==
Train average loss Recognize     : 0.875125
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.339489

Epoch 15:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.338, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.649, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]          Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.338, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.649, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.338, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.649, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.791, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.122, Train/loss_recog_step=0.791, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.902, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.902, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.654, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.342, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.654, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.282, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0808, Train/loss_recog_step=0.852, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.282, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0808, Train/loss_recog_step=0.852, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.275, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0655, Train/loss_recog_step=0.693, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.275, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0655, Train/loss_recog_step=0.693, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.346, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.050, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875] Epoch 16: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.346, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.131, Train/loss_recog_step=1.050, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.678, Valid/loss_all_step=0.405, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.161, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.163, Valid/loss_recog_epoch=0.834, Valid/knn_avr=0.400, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.79it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.02it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.16it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.34it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.17it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.075331, 0.074242, 0.076767
Valid average loss UNet            (all)              : 0.226340

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.089593, 0.353048, 0.763943
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.173532, 0.275301, 0.334710
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.182488, 0.337414, 0.360676
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.150248, 0.350861, 0.508736
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.129638, 0.433448, 0.537474
Valid average loss all      (Triplet)                 : 0.147642

== Recognize ==
Valid average loss Recognize     : 0.826577
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.373982

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.73259449005127 sec. =
Valid knn accuracy drums     : 70.29411764705881%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.225359439849854 sec. =
Valid knn accuracy bass      : 20.203488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.067732810974121 sec. =
Valid knn accuracy piano     : 21.35135135135135%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.694583892822266 sec. =
Valid knn accuracy guitar    : 36.688311688311686%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.377964496612549 sec. =
Valid knn accuracy residuals : 50.157232704402524%

Valid knn accuracy average   : 39.73890035264348%

                                                                        [AEpoch 16: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.678, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.339, Train/loss_unet_all_epoch=0.212, Train/loss_triplet_all_epoch=0.128, Train/loss_recog_epoch=0.875]Epoch 16: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.678, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069984, 0.069824, 0.071010
Train average loss UNet            (all)              : 0.210818

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.036466, 0.363007, 0.851521
Train average loss bass     (Triplet, dist_p, dist_n) : 0.170714, 0.275555, 0.329630
Train average loss piano    (Triplet, dist_p, dist_n) : 0.156449, 0.346568, 0.419934
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.132813, 0.346937, 0.485044
Train average loss residuals(Triplet, dist_p, dist_n) : 0.118973, 0.437265, 0.590911
Train average loss all      (Triplet)                 : 0.124223

== Recognize ==
Train average loss Recognize     : 0.875267
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.335041

Epoch 16:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.678, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]          Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.678, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.678, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.800, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.800, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.355, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.917, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.355, Train/loss_unet_all_step=0.225, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.917, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.331, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.670, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.331, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.670, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0961, Train/loss_recog_step=0.873, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.297, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0961, Train/loss_recog_step=0.873, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.275, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0634, Train/loss_recog_step=0.729, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.275, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0634, Train/loss_recog_step=0.729, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.337, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=1.080, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875] Epoch 17: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.337, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.123, Train/loss_recog_step=1.080, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.325, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.712, Valid/loss_all_step=0.377, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=0.118, Valid/loss_recog_step=1.020, Valid/loss_all_epoch=0.374, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.148, Valid/loss_recog_epoch=0.827, Valid/knn_avr=0.397, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.20it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.96it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.44it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.35it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073943, 0.072175, 0.075076
Valid average loss UNet            (all)              : 0.221193

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.080989, 0.369315, 0.768444
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.203855, 0.338029, 0.373228
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.199815, 0.376956, 0.392675
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.137936, 0.408310, 0.664284
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.212142, 0.516137, 0.534020
Valid average loss all      (Triplet)                 : 0.169570

== Recognize ==
Valid average loss Recognize     : 0.845801
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.390763

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.449512958526611 sec. =
Valid knn accuracy drums     : 70.1470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.252147436141968 sec. =
Valid knn accuracy bass      : 10.174418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.058820486068726 sec. =
Valid knn accuracy piano     : 23.783783783783786%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.631121158599854 sec. =
Valid knn accuracy guitar    : 45.616883116883116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.741538286209106 sec. =
Valid knn accuracy residuals : 51.257861635220124%

Valid knn accuracy average   : 40.19600119281351%

                                                                        [AEpoch 17: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.325, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.712, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.335, Train/loss_unet_all_epoch=0.211, Train/loss_triplet_all_epoch=0.124, Train/loss_recog_epoch=0.875]Epoch 17: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.325, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.712, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069847, 0.069637, 0.070779
Train average loss UNet            (all)              : 0.210263

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.034497, 0.382849, 0.900715
Train average loss bass     (Triplet, dist_p, dist_n) : 0.168017, 0.298586, 0.360528
Train average loss piano    (Triplet, dist_p, dist_n) : 0.148958, 0.369667, 0.457010
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.128751, 0.370717, 0.522886
Train average loss residuals(Triplet, dist_p, dist_n) : 0.115956, 0.458898, 0.620503
Train average loss all      (Triplet)                 : 0.120349

== Recognize ==
Train average loss Recognize     : 0.895723
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.330611

Epoch 17:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.325, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.712, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]          Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.325, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.712, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.325, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.712, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=0.794, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.353, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.159, Train/loss_recog_step=0.794, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.337, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.929, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.337, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=0.929, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.360, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.663, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.360, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.663, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.876, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.310, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.876, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.282, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0721, Train/loss_recog_step=0.729, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.282, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0721, Train/loss_recog_step=0.729, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.339, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.060, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896] Epoch 18: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.339, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.127, Train/loss_recog_step=1.060, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.704, Valid/loss_all_step=0.454, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=1.030, Valid/loss_all_epoch=0.391, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.170, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.402, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.95it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.66it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.30it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.58it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.42it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073100, 0.071818, 0.072875
Valid average loss UNet            (all)              : 0.217793

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087627, 0.409277, 0.869267
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.190655, 0.356551, 0.405278
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.215974, 0.429661, 0.424522
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.167794, 0.428908, 0.654792
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.169026, 0.485645, 0.554707
Valid average loss all      (Triplet)                 : 0.172693

== Recognize ==
Valid average loss Recognize     : 0.846299
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.390486

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.633875846862793 sec. =
Valid knn accuracy drums     : 74.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.971900939941406 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.861473560333252 sec. =
Valid knn accuracy piano     : 26.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.402402639389038 sec. =
Valid knn accuracy guitar    : 43.18181818181818%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.050706624984741 sec. =
Valid knn accuracy residuals : 51.41509433962265%

Valid knn accuracy average   : 41.95399817330876%

                                                                        [AEpoch 18: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.704, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.331, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.120, Train/loss_recog_epoch=0.896]Epoch 18: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.704, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069730, 0.069551, 0.070684
Train average loss UNet            (all)              : 0.209965

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.033620, 0.410667, 0.944315
Train average loss bass     (Triplet, dist_p, dist_n) : 0.166895, 0.320825, 0.383762
Train average loss piano    (Triplet, dist_p, dist_n) : 0.148279, 0.406002, 0.498298
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.122773, 0.390105, 0.551872
Train average loss residuals(Triplet, dist_p, dist_n) : 0.113717, 0.482255, 0.653281
Train average loss all      (Triplet)                 : 0.118104

== Recognize ==
Train average loss Recognize     : 0.902606
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.328069

Epoch 18:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.704, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]          Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.704, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.117, Train/loss_recog_step=0.704, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=0.829, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.294, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.101, Train/loss_recog_step=0.829, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.332, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=0.946, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.332, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=0.946, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.343, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.672, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.343, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.129, Train/loss_recog_step=0.672, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.285, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0837, Train/loss_recog_step=0.882, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.285, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0837, Train/loss_recog_step=0.882, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.278, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0684, Train/loss_recog_step=0.732, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.278, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0684, Train/loss_recog_step=0.732, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.352, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.070, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903] Epoch 19: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.352, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=1.070, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.695, Valid/loss_all_step=0.449, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.207, Valid/loss_recog_step=1.040, Valid/loss_all_epoch=0.390, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.173, Valid/loss_recog_epoch=0.846, Valid/knn_avr=0.420, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.96it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.06it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.73it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.64it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.075429, 0.074590, 0.078438
Valid average loss UNet            (all)              : 0.228457

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.081137, 0.431869, 0.855038
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.196179, 0.316690, 0.328095
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.168322, 0.423447, 0.484700
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.176481, 0.447825, 0.687090
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.138132, 0.491406, 0.582797
Valid average loss all      (Triplet)                 : 0.157667

== Recognize ==
Valid average loss Recognize     : 0.849060
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.386124

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.568198442459106 sec. =
Valid knn accuracy drums     : 81.61764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.27574610710144 sec. =
Valid knn accuracy bass      : 13.226744186046513%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.106502056121826 sec. =
Valid knn accuracy piano     : 20.405405405405403%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.478852987289429 sec. =
Valid knn accuracy guitar    : 40.74675324675325%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.03782606124878 sec. =
Valid knn accuracy residuals : 47.48427672955975%

Valid knn accuracy average   : 40.69616532531769%

                                                                        [AEpoch 19: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.695, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.328, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.118, Train/loss_recog_epoch=0.903]Epoch 19: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.695, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069609, 0.069323, 0.070559
Train average loss UNet            (all)              : 0.209491

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.029661, 0.427489, 0.966486
Train average loss bass     (Triplet, dist_p, dist_n) : 0.163909, 0.341754, 0.411654
Train average loss piano    (Triplet, dist_p, dist_n) : 0.140555, 0.431964, 0.539058
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.118465, 0.418221, 0.594224
Train average loss residuals(Triplet, dist_p, dist_n) : 0.110250, 0.492008, 0.666874
Train average loss all      (Triplet)                 : 0.113567

== Recognize ==
Train average loss Recognize     : 0.910137
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.323058

Epoch 19:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.695, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]          Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.695, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20:  16%|█▌        | 50/313 [00:46<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.695, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20:  16%|█▌        | 50/313 [00:46<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=0.819, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=0.819, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.957, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.957, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=0.674, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=0.674, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.278, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0777, Train/loss_recog_step=0.877, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.278, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0777, Train/loss_recog_step=0.877, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.277, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0684, Train/loss_recog_step=0.748, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.277, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0684, Train/loss_recog_step=0.748, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=1.110, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910] Epoch 20: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.328, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.118, Train/loss_recog_step=1.110, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.719, Valid/loss_all_step=0.408, Valid/loss_unet_all_step=0.266, Valid/loss_triplet_all_step=0.142, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.386, Valid/loss_unet_all_epoch=0.228, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.849, Valid/knn_avr=0.407, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.86it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.16it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.66it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.90it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.62it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.078814, 0.078630, 0.080890
Valid average loss UNet            (all)              : 0.238334

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088036, 0.552642, 1.027759
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.212202, 0.440556, 0.436537
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.207928, 0.598954, 0.624749
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.167651, 0.571665, 0.847951
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.165022, 0.660772, 0.752202
Valid average loss all      (Triplet)                 : 0.176332

== Recognize ==
Valid average loss Recognize     : 0.866626
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.414666

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.265565872192383 sec. =
Valid knn accuracy drums     : 82.20588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.234452724456787 sec. =
Valid knn accuracy bass      : 10.901162790697674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.979304313659668 sec. =
Valid knn accuracy piano     : 18.243243243243242%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.045746803283691 sec. =
Valid knn accuracy guitar    : 47.88961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.82355260848999 sec. =
Valid knn accuracy residuals : 54.088050314465406%

Valid knn accuracy average   : 42.66558981819158%

                                                                        [AEpoch 20: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.719, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.323, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.114, Train/loss_recog_epoch=0.910]Epoch 20: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.719, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069615, 0.069377, 0.070547
Train average loss UNet            (all)              : 0.209540

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.028868, 0.468422, 1.042961
Train average loss bass     (Triplet, dist_p, dist_n) : 0.160282, 0.366699, 0.442651
Train average loss piano    (Triplet, dist_p, dist_n) : 0.138611, 0.458490, 0.570986
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.112619, 0.446889, 0.640531
Train average loss residuals(Triplet, dist_p, dist_n) : 0.106934, 0.523124, 0.709362
Train average loss all      (Triplet)                 : 0.110630

== Recognize ==
Train average loss Recognize     : 0.918148
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.320170

Epoch 20:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.719, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]          Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.719, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.324, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.719, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.307, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.840, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.307, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.840, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.964, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.320, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.104, Train/loss_recog_step=0.964, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=0.674, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.347, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.134, Train/loss_recog_step=0.674, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.276, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0776, Train/loss_recog_step=0.884, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.276, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0776, Train/loss_recog_step=0.884, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.273, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0653, Train/loss_recog_step=0.751, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.273, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0653, Train/loss_recog_step=0.751, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=1.090, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918] Epoch 21: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.330, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.116, Train/loss_recog_step=1.090, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=0.718, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.167, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.415, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.176, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.427, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.10it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.11it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.57it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.33it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.082660, 0.083210, 0.085716
Valid average loss UNet            (all)              : 0.251586

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073359, 0.545488, 0.970766
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.194440, 0.490532, 0.536219
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.184405, 0.573936, 0.634987
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.158420, 0.518220, 0.734205
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.144293, 0.610003, 0.728619
Valid average loss all      (Triplet)                 : 0.157689

== Recognize ==
Valid average loss Recognize     : 0.852067
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.409275

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.485812664031982 sec. =
Valid knn accuracy drums     : 81.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.884712219238281 sec. =
Valid knn accuracy bass      : 20.203488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.17738676071167 sec. =
Valid knn accuracy piano     : 25.270270270270267%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.941365718841553 sec. =
Valid knn accuracy guitar    : 41.883116883116884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.044800996780396 sec. =
Valid knn accuracy residuals : 56.132075471698116%

Valid knn accuracy average   : 44.9624960817886%

                                                                        [AEpoch 21: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=0.718, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.320, Train/loss_unet_all_epoch=0.210, Train/loss_triplet_all_epoch=0.111, Train/loss_recog_epoch=0.918]Epoch 21: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=0.718, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069360, 0.069195, 0.070322
Train average loss UNet            (all)              : 0.208877

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.025489, 0.503413, 1.097754
Train average loss bass     (Triplet, dist_p, dist_n) : 0.157146, 0.396984, 0.479559
Train average loss piano    (Triplet, dist_p, dist_n) : 0.131188, 0.501461, 0.630397
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.107209, 0.484345, 0.701245
Train average loss residuals(Triplet, dist_p, dist_n) : 0.104146, 0.562458, 0.761772
Train average loss all      (Triplet)                 : 0.106184

== Recognize ==
Train average loss Recognize     : 0.921277
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.315061

Epoch 21:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=0.718, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]          Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=0.718, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]Epoch 22:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.317, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.103, Train/loss_recog_step=0.718, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]Epoch 22:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.819, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]Epoch 22:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.299, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.106, Train/loss_recog_step=0.819, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]Epoch 22:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.316, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.0981, Train/loss_recog_step=0.970, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]Epoch 22:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.316, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.0981, Train/loss_recog_step=0.970, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]Epoch 22:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.339, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.695, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921] Epoch 22:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.339, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.126, Train/loss_recog_step=0.695, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]Epoch 22:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.268, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0678, Train/loss_recog_step=0.899, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]Epoch 22:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.268, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0678, Train/loss_recog_step=0.899, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]Epoch 22:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.281, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0722, Train/loss_recog_step=0.765, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]Epoch 22:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.281, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0722, Train/loss_recog_step=0.765, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]Epoch 22:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.322, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.080, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921] Epoch 22: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.322, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.080, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]Epoch 22: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.296, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0875, Train/loss_recog_step=0.714, Valid/loss_all_step=0.443, Valid/loss_unet_all_step=0.289, Valid/loss_triplet_all_step=0.153, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.409, Valid/loss_unet_all_epoch=0.252, Valid/loss_triplet_all_epoch=0.158, Valid/loss_recog_epoch=0.852, Valid/knn_avr=0.450, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.14it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.89it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.48it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.30it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072604, 0.071650, 0.073282
Valid average loss UNet            (all)              : 0.217536

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.071464, 0.564772, 1.000142
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.211908, 0.504662, 0.531102
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.242368, 0.556813, 0.556317
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.194047, 0.572295, 0.820745
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.164631, 0.596911, 0.705456
Valid average loss all      (Triplet)                 : 0.190786

== Recognize ==
Valid average loss Recognize     : 0.851246
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.408322

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.70313572883606 sec. =
Valid knn accuracy drums     : 76.3235294117647%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.060342788696289 sec. =
Valid knn accuracy bass      : 14.244186046511627%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.074864625930786 sec. =
Valid knn accuracy piano     : 23.513513513513516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.68209195137024 sec. =
Valid knn accuracy guitar    : 51.13636363636363%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.926425457000732 sec. =
Valid knn accuracy residuals : 53.77358490566038%

Valid knn accuracy average   : 43.79823550276277%

                                                                        [AEpoch 22: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.296, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0875, Train/loss_recog_step=0.714, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.315, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.106, Train/loss_recog_epoch=0.921]Epoch 22: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.296, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0875, Train/loss_recog_step=0.714, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069311, 0.069124, 0.070312
Train average loss UNet            (all)              : 0.208747

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.024737, 0.562161, 1.199569
Train average loss bass     (Triplet, dist_p, dist_n) : 0.152916, 0.437769, 0.533072
Train average loss piano    (Triplet, dist_p, dist_n) : 0.128923, 0.546216, 0.685175
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.097679, 0.524871, 0.764408
Train average loss residuals(Triplet, dist_p, dist_n) : 0.099259, 0.601863, 0.814970
Train average loss all      (Triplet)                 : 0.101949

== Recognize ==
Train average loss Recognize     : 0.930592
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.310695

Epoch 22:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.296, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0875, Train/loss_recog_step=0.714, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]          Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.296, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0875, Train/loss_recog_step=0.714, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]Epoch 23:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.296, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0875, Train/loss_recog_step=0.714, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]Epoch 23:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.298, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.842, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931] Epoch 23:  32%|███▏      | 100/313 [01:32<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.298, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.105, Train/loss_recog_step=0.842, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]Epoch 23:  32%|███▏      | 100/313 [01:32<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.309, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0934, Train/loss_recog_step=0.978, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]Epoch 23:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.309, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0934, Train/loss_recog_step=0.978, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]Epoch 23:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.355, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=0.692, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931] Epoch 23:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.355, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.141, Train/loss_recog_step=0.692, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]Epoch 23:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.285, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0857, Train/loss_recog_step=0.905, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]Epoch 23:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.285, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0857, Train/loss_recog_step=0.905, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]Epoch 23:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0513, Train/loss_recog_step=0.762, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]Epoch 23:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0513, Train/loss_recog_step=0.762, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]Epoch 23:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.090, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931] Epoch 23: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.121, Train/loss_recog_step=1.090, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]Epoch 23: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.723, Valid/loss_all_step=0.510, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.266, Valid/loss_recog_step=1.050, Valid/loss_all_epoch=0.408, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.851, Valid/knn_avr=0.438, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.77it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.99it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.12it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074564, 0.073687, 0.075649
Valid average loss UNet            (all)              : 0.223899

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.090102, 0.688149, 1.158998
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.221077, 0.575099, 0.593479
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.276176, 0.709449, 0.690286
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.232009, 0.718291, 0.985005
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.174378, 0.693728, 0.869618
Valid average loss all      (Triplet)                 : 0.210870

== Recognize ==
Valid average loss Recognize     : 0.868700
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.434769

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.635047674179077 sec. =
Valid knn accuracy drums     : 75.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.25930905342102 sec. =
Valid knn accuracy bass      : 17.732558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.009581804275513 sec. =
Valid knn accuracy piano     : 21.35135135135135%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.873204708099365 sec. =
Valid knn accuracy guitar    : 52.1103896103896%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.944150447845459 sec. =
Valid knn accuracy residuals : 52.04402515723271%

Valid knn accuracy average   : 43.64766485170171%

                                                                        [AEpoch 23: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.723, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.311, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.102, Train/loss_recog_epoch=0.931]Epoch 23: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.723, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069130, 0.069027, 0.070218
Train average loss UNet            (all)              : 0.208376

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.021427, 0.603640, 1.273675
Train average loss bass     (Triplet, dist_p, dist_n) : 0.149386, 0.474254, 0.578015
Train average loss piano    (Triplet, dist_p, dist_n) : 0.118981, 0.587408, 0.750070
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.093408, 0.578695, 0.848257
Train average loss residuals(Triplet, dist_p, dist_n) : 0.094255, 0.647600, 0.880484
Train average loss all      (Triplet)                 : 0.096558

== Recognize ==
Train average loss Recognize     : 0.935480
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.304934

Epoch 23:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.723, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]          Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.723, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]Epoch 24:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.102, Train/loss_recog_step=0.723, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]Epoch 24:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.273, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0775, Train/loss_recog_step=0.859, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]Epoch 24:  32%|███▏      | 100/313 [01:32<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.273, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0775, Train/loss_recog_step=0.859, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]Epoch 24:  32%|███▏      | 100/313 [01:32<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.295, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.0777, Train/loss_recog_step=0.964, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]Epoch 24:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.295, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.0777, Train/loss_recog_step=0.964, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]Epoch 24:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.690, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935] Epoch 24:  64%|██████▍   | 200/313 [03:02<01:43,  1.10it/s, v_num=0, Train/loss_all_step=0.327, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.109, Train/loss_recog_step=0.690, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]Epoch 24:  64%|██████▍   | 200/313 [03:02<01:43,  1.10it/s, v_num=0, Train/loss_all_step=0.271, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0717, Train/loss_recog_step=0.906, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]Epoch 24:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.271, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0717, Train/loss_recog_step=0.906, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]Epoch 24:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0569, Train/loss_recog_step=0.792, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]Epoch 24:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.267, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0569, Train/loss_recog_step=0.792, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]Epoch 24:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.340, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.100, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935] Epoch 24: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.340, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=1.100, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]Epoch 24: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.288, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=0.723, Valid/loss_all_step=0.515, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.270, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.211, Valid/loss_recog_epoch=0.869, Valid/knn_avr=0.436, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.52it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.86it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.78it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.26it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.70it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073093, 0.072761, 0.073459
Valid average loss UNet            (all)              : 0.219313

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.087101, 0.680209, 1.088961
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.212527, 0.558463, 0.586064
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.190702, 0.602915, 0.678157
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.224037, 0.684477, 0.920142
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.166652, 0.702858, 0.903259
Valid average loss all      (Triplet)                 : 0.187147

== Recognize ==
Valid average loss Recognize     : 0.867064
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.406460

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.536197662353516 sec. =
Valid knn accuracy drums     : 78.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.137925386428833 sec. =
Valid knn accuracy bass      : 15.55232558139535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.706120252609253 sec. =
Valid knn accuracy piano     : 21.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.921147346496582 sec. =
Valid knn accuracy guitar    : 51.78571428571429%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.250910997390747 sec. =
Valid knn accuracy residuals : 54.088050314465406%

Valid knn accuracy average   : 44.22957415714171%

                                                                        [AEpoch 24: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.288, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=0.723, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.305, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0966, Train/loss_recog_epoch=0.935]Epoch 24: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.288, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=0.723, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069377, 0.069200, 0.070337
Train average loss UNet            (all)              : 0.208913

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.020882, 0.656842, 1.352419
Train average loss bass     (Triplet, dist_p, dist_n) : 0.143417, 0.498632, 0.610852
Train average loss piano    (Triplet, dist_p, dist_n) : 0.111704, 0.632164, 0.812850
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.084391, 0.623502, 0.918643
Train average loss residuals(Triplet, dist_p, dist_n) : 0.089646, 0.686768, 0.932869
Train average loss all      (Triplet)                 : 0.091134

== Recognize ==
Train average loss Recognize     : 0.939758
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.300048

Epoch 24:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.288, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=0.723, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]          Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.288, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=0.723, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.288, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=0.723, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0415, Train/loss_recog_step=0.838, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0415, Train/loss_recog_step=0.838, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0847, Train/loss_recog_step=0.974, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0847, Train/loss_recog_step=0.974, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.326, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.694, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940] Epoch 25:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.326, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.113, Train/loss_recog_step=0.694, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.259, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0579, Train/loss_recog_step=0.929, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.259, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0579, Train/loss_recog_step=0.929, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0423, Train/loss_recog_step=0.790, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0423, Train/loss_recog_step=0.790, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.283, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0728, Train/loss_recog_step=1.130, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.283, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0728, Train/loss_recog_step=1.130, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.270, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0609, Train/loss_recog_step=0.735, Valid/loss_all_step=0.469, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=1.060, Valid/loss_all_epoch=0.406, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.867, Valid/knn_avr=0.442, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.08it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.09it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.50it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.32it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073391, 0.073565, 0.073481
Valid average loss UNet            (all)              : 0.220437

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099970, 0.809166, 1.315657
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.226748, 0.644449, 0.662978
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.222976, 0.745227, 0.763882
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.211527, 0.767761, 1.096007
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.168500, 0.807558, 1.039874
Valid average loss all      (Triplet)                 : 0.195872

== Recognize ==
Valid average loss Recognize     : 0.889790
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.416309

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.578799962997437 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.424383878707886 sec. =
Valid knn accuracy bass      : 14.970930232558139%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.159233331680298 sec. =
Valid knn accuracy piano     : 21.35135135135135%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.554493427276611 sec. =
Valid knn accuracy guitar    : 46.590909090909086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.073014736175537 sec. =
Valid knn accuracy residuals : 54.87421383647799%

Valid knn accuracy average   : 43.233951490494604%

                                                                        [AEpoch 25: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.270, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0609, Train/loss_recog_step=0.735, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.300, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0911, Train/loss_recog_epoch=0.940]Epoch 25: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.270, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0609, Train/loss_recog_step=0.735, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069315, 0.069119, 0.070287
Train average loss UNet            (all)              : 0.208721

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.018123, 0.710647, 1.431280
Train average loss bass     (Triplet, dist_p, dist_n) : 0.137323, 0.542053, 0.669885
Train average loss piano    (Triplet, dist_p, dist_n) : 0.104544, 0.675000, 0.874209
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.076830, 0.675493, 1.001753
Train average loss residuals(Triplet, dist_p, dist_n) : 0.085010, 0.733386, 0.990136
Train average loss all      (Triplet)                 : 0.085775

== Recognize ==
Train average loss Recognize     : 0.945999
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.294496

Epoch 25:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.270, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0609, Train/loss_recog_step=0.735, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]          Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.270, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0609, Train/loss_recog_step=0.735, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.270, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0609, Train/loss_recog_step=0.735, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0603, Train/loss_recog_step=0.851, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.254, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0603, Train/loss_recog_step=0.851, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.302, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0868, Train/loss_recog_step=0.986, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.302, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0868, Train/loss_recog_step=0.986, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.323, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.708, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946] Epoch 26:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.323, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.110, Train/loss_recog_step=0.708, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.255, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0552, Train/loss_recog_step=0.925, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.255, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0552, Train/loss_recog_step=0.925, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.245, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0346, Train/loss_recog_step=0.799, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.245, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0346, Train/loss_recog_step=0.799, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.304, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0929, Train/loss_recog_step=1.140, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.304, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0929, Train/loss_recog_step=1.140, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.746, Valid/loss_all_step=0.462, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.217, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.416, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.196, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.432, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.10it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.03it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.15it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.50it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.15it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074710, 0.073861, 0.072844
Valid average loss UNet            (all)              : 0.221415

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.100598, 0.721684, 1.125866
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.234889, 0.605350, 0.626801
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.233344, 0.678941, 0.686961
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.196196, 0.718729, 0.912526
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.143419, 0.690938, 0.924165
Valid average loss all      (Triplet)                 : 0.191052

== Recognize ==
Valid average loss Recognize     : 0.896904
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.412467

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.811857461929321 sec. =
Valid knn accuracy drums     : 77.64705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.47746992111206 sec. =
Valid knn accuracy bass      : 16.71511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.98647952079773 sec. =
Valid knn accuracy piano     : 22.702702702702705%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.955721139907837 sec. =
Valid knn accuracy guitar    : 42.37012987012987%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.027639389038086 sec. =
Valid knn accuracy residuals : 55.34591194968554%

Valid knn accuracy average   : 42.95618392502345%

                                                                        [AEpoch 26: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.746, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.294, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0858, Train/loss_recog_epoch=0.946]Epoch 26: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.746, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069331, 0.069177, 0.070290
Train average loss UNet            (all)              : 0.208798

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.016716, 0.790723, 1.575581
Train average loss bass     (Triplet, dist_p, dist_n) : 0.135069, 0.595043, 0.732548
Train average loss piano    (Triplet, dist_p, dist_n) : 0.097322, 0.739649, 0.963930
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.068410, 0.741128, 1.105862
Train average loss residuals(Triplet, dist_p, dist_n) : 0.078784, 0.798518, 1.084415
Train average loss all      (Triplet)                 : 0.080741

== Recognize ==
Train average loss Recognize     : 0.957785
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.289540

Epoch 26:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.746, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]          Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.746, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]Epoch 27:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0394, Train/loss_recog_step=0.746, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]Epoch 27:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0434, Train/loss_recog_step=0.860, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]Epoch 27:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0434, Train/loss_recog_step=0.860, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]Epoch 27:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.279, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0637, Train/loss_recog_step=0.980, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]Epoch 27:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.279, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0637, Train/loss_recog_step=0.980, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]Epoch 27:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.323, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.708, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958] Epoch 27:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.323, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.108, Train/loss_recog_step=0.708, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]Epoch 27:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0728, Train/loss_recog_step=0.928, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]Epoch 27:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0728, Train/loss_recog_step=0.928, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]Epoch 27:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0488, Train/loss_recog_step=0.791, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]Epoch 27:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0488, Train/loss_recog_step=0.791, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]Epoch 27:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.322, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.120, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958] Epoch 27: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.322, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.111, Train/loss_recog_step=1.120, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]Epoch 27: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.262, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0523, Train/loss_recog_step=0.728, Valid/loss_all_step=0.441, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.412, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.897, Valid/knn_avr=0.430, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.00it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.13it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.73it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.69it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.080954, 0.083161, 0.082227
Valid average loss UNet            (all)              : 0.246341

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.130125, 0.906582, 1.366765
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.223118, 0.628617, 0.653231
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.230363, 0.739300, 0.746676
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.217473, 0.826904, 1.025782
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.134489, 0.820121, 1.100567
Valid average loss all      (Triplet)                 : 0.200868

== Recognize ==
Valid average loss Recognize     : 0.885372
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.447210

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.623413324356079 sec. =
Valid knn accuracy drums     : 76.3235294117647%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.140687227249146 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.049471378326416 sec. =
Valid knn accuracy piano     : 22.162162162162165%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.85684847831726 sec. =
Valid knn accuracy guitar    : 42.04545454545455%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.159281015396118 sec. =
Valid knn accuracy residuals : 50.943396226415096%

Valid knn accuracy average   : 40.969327073810454%

                                                                        [AEpoch 27: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.262, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0523, Train/loss_recog_step=0.728, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.290, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0807, Train/loss_recog_epoch=0.958]Epoch 27: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.262, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0523, Train/loss_recog_step=0.728, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069388, 0.069231, 0.070403
Train average loss UNet            (all)              : 0.209022

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.013605, 0.886339, 1.729904
Train average loss bass     (Triplet, dist_p, dist_n) : 0.125845, 0.662796, 0.822701
Train average loss piano    (Triplet, dist_p, dist_n) : 0.089486, 0.825334, 1.087414
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.065102, 0.841302, 1.249462
Train average loss residuals(Triplet, dist_p, dist_n) : 0.069591, 0.894584, 1.223491
Train average loss all      (Triplet)                 : 0.074125

== Recognize ==
Train average loss Recognize     : 0.954820
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.283146

Epoch 27:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.262, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0523, Train/loss_recog_step=0.728, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]          Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.262, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0523, Train/loss_recog_step=0.728, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.262, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0523, Train/loss_recog_step=0.728, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0385, Train/loss_recog_step=0.855, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0385, Train/loss_recog_step=0.855, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0435, Train/loss_recog_step=0.991, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0435, Train/loss_recog_step=0.991, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0999, Train/loss_recog_step=0.699, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.313, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0999, Train/loss_recog_step=0.699, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0512, Train/loss_recog_step=0.936, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0512, Train/loss_recog_step=0.936, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.252, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.045, Train/loss_recog_step=0.783, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955] Epoch 28:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.252, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.045, Train/loss_recog_step=0.783, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.302, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0911, Train/loss_recog_step=1.150, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.302, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0911, Train/loss_recog_step=1.150, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0295, Train/loss_recog_step=0.744, Valid/loss_all_step=0.504, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.252, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.447, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.201, Valid/loss_recog_epoch=0.885, Valid/knn_avr=0.410, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.69it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.08it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.93it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.076030, 0.075986, 0.074045
Valid average loss UNet            (all)              : 0.226060

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.103244, 0.970552, 1.548070
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.204088, 0.676961, 0.732420
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.248736, 0.785125, 0.778211
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.200741, 0.885402, 1.167518
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.180596, 0.878055, 1.117347
Valid average loss all      (Triplet)                 : 0.197640

== Recognize ==
Valid average loss Recognize     : 0.901272
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.423700

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.734402656555176 sec. =
Valid knn accuracy drums     : 79.11764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.127313613891602 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.848042488098145 sec. =
Valid knn accuracy piano     : 27.432432432432428%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.917037725448608 sec. =
Valid knn accuracy guitar    : 41.23376623376623%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.068875789642334 sec. =
Valid knn accuracy residuals : 48.742138364779876%

Valid knn accuracy average   : 41.97961542261158%

                                                                        [AEpoch 28: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0295, Train/loss_recog_step=0.744, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.283, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0741, Train/loss_recog_epoch=0.955]Epoch 28: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0295, Train/loss_recog_step=0.744, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069276, 0.069080, 0.070206
Train average loss UNet            (all)              : 0.208562

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.012905, 0.963956, 1.850783
Train average loss bass     (Triplet, dist_p, dist_n) : 0.116647, 0.704750, 0.887323
Train average loss piano    (Triplet, dist_p, dist_n) : 0.081734, 0.876570, 1.170911
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.055719, 0.890482, 1.331700
Train average loss residuals(Triplet, dist_p, dist_n) : 0.067468, 0.954093, 1.301810
Train average loss all      (Triplet)                 : 0.068243

== Recognize ==
Train average loss Recognize     : 0.958691
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.276804

Epoch 28:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0295, Train/loss_recog_step=0.744, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]          Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0295, Train/loss_recog_step=0.744, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]Epoch 29:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0295, Train/loss_recog_step=0.744, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]Epoch 29:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.056, Train/loss_recog_step=0.877, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959] Epoch 29:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.056, Train/loss_recog_step=0.877, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]Epoch 29:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.259, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0451, Train/loss_recog_step=0.992, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]Epoch 29:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.259, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0451, Train/loss_recog_step=0.992, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]Epoch 29:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.716, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959] Epoch 29:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.329, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.114, Train/loss_recog_step=0.716, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]Epoch 29:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.264, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0653, Train/loss_recog_step=0.936, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]Epoch 29:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.264, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0653, Train/loss_recog_step=0.936, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]Epoch 29:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.789, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]Epoch 29:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.789, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]Epoch 29:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.287, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=1.140, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]Epoch 29: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.287, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0758, Train/loss_recog_step=1.140, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]Epoch 29: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0479, Train/loss_recog_step=0.727, Valid/loss_all_step=0.476, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.233, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.424, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.901, Valid/knn_avr=0.420, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.43it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.29it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.75it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.15it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074048, 0.072986, 0.072393
Valid average loss UNet            (all)              : 0.219426

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.128213, 1.165973, 1.745760
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.244626, 0.886241, 0.891320
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.292906, 1.008184, 1.011863
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.222589, 1.060090, 1.518668
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.189572, 1.126871, 1.503738
Valid average loss all      (Triplet)                 : 0.228697

== Recognize ==
Valid average loss Recognize     : 0.898258
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.448123

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.687775611877441 sec. =
Valid knn accuracy drums     : 79.26470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.240966320037842 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.30437707901001 sec. =
Valid knn accuracy piano     : 25.405405405405407%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.717817544937134 sec. =
Valid knn accuracy guitar    : 47.07792207792208%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.1679048538208 sec. =
Valid knn accuracy residuals : 55.0314465408805%

Valid knn accuracy average   : 44.17566342317265%

                                                                        [AEpoch 29: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0479, Train/loss_recog_step=0.727, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.277, Train/loss_unet_all_epoch=0.209, Train/loss_triplet_all_epoch=0.0682, Train/loss_recog_epoch=0.959]Epoch 29: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0479, Train/loss_recog_step=0.727, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069197, 0.069068, 0.070226
Train average loss UNet            (all)              : 0.208490

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.010759, 1.041425, 2.005184
Train average loss bass     (Triplet, dist_p, dist_n) : 0.108797, 0.775545, 0.987126
Train average loss piano    (Triplet, dist_p, dist_n) : 0.072240, 0.947076, 1.282519
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.050614, 0.980112, 1.480890
Train average loss residuals(Triplet, dist_p, dist_n) : 0.058458, 1.033055, 1.430793
Train average loss all      (Triplet)                 : 0.061440

== Recognize ==
Train average loss Recognize     : 0.963258
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.269930

Epoch 29:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0479, Train/loss_recog_step=0.727, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]          Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0479, Train/loss_recog_step=0.727, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0479, Train/loss_recog_step=0.727, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0332, Train/loss_recog_step=0.850, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0332, Train/loss_recog_step=0.850, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0584, Train/loss_recog_step=0.987, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.0584, Train/loss_recog_step=0.987, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.285, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0751, Train/loss_recog_step=0.713, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.285, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0751, Train/loss_recog_step=0.713, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0317, Train/loss_recog_step=0.937, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0317, Train/loss_recog_step=0.937, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.253, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0423, Train/loss_recog_step=0.786, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.253, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0423, Train/loss_recog_step=0.786, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.257, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.045, Train/loss_recog_step=1.140, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963] Epoch 30: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.257, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.045, Train/loss_recog_step=1.140, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.00904, Train/loss_recog_step=0.736, Valid/loss_all_step=0.557, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.307, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.448, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.229, Valid/loss_recog_epoch=0.898, Valid/knn_avr=0.442, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.42it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.79it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.71it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.01it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.076430, 0.075569, 0.074446
Valid average loss UNet            (all)              : 0.226445

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.097038, 1.132703, 1.830587
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.256270, 0.874931, 0.875752
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.257428, 1.080722, 1.126322
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.210943, 1.099859, 1.550532
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.199783, 1.180183, 1.342545
Valid average loss all      (Triplet)                 : 0.216921

== Recognize ==
Valid average loss Recognize     : 0.890158
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.443366

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.70185399055481 sec. =
Valid knn accuracy drums     : 80.88235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.143921613693237 sec. =
Valid knn accuracy bass      : 12.354651162790697%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.530581951141357 sec. =
Valid knn accuracy piano     : 27.432432432432428%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.880141496658325 sec. =
Valid knn accuracy guitar    : 41.396103896103895%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.058145999908447 sec. =
Valid knn accuracy residuals : 52.20125786163522%

Valid knn accuracy average   : 42.85335965882774%

                                                                        [AEpoch 30: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.00904, Train/loss_recog_step=0.736, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.270, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0614, Train/loss_recog_epoch=0.963]Epoch 30: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.00904, Train/loss_recog_step=0.736, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069180, 0.069044, 0.070190
Train average loss UNet            (all)              : 0.208414

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.013030, 1.119325, 2.140768
Train average loss bass     (Triplet, dist_p, dist_n) : 0.099179, 0.837086, 1.075980
Train average loss piano    (Triplet, dist_p, dist_n) : 0.066598, 1.016306, 1.391678
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.043000, 1.056263, 1.616538
Train average loss residuals(Triplet, dist_p, dist_n) : 0.052961, 1.115619, 1.543090
Train average loss all      (Triplet)                 : 0.056063

== Recognize ==
Train average loss Recognize     : 0.964125
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.264477

Epoch 30:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.00904, Train/loss_recog_step=0.736, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]          Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.00904, Train/loss_recog_step=0.736, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.00904, Train/loss_recog_step=0.736, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31:  16%|█▌        | 50/313 [00:49<04:19,  1.01it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=0.870, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964] Epoch 31:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=0.870, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.270, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0545, Train/loss_recog_step=1.010, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.270, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0545, Train/loss_recog_step=1.010, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0634, Train/loss_recog_step=0.713, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.274, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0634, Train/loss_recog_step=0.713, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.229, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.937, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.229, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.937, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.229, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.809, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.229, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.809, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0479, Train/loss_recog_step=1.160, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.258, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0479, Train/loss_recog_step=1.160, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.260, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0485, Train/loss_recog_step=0.752, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.265, Valid/loss_triplet_all_step=0.257, Valid/loss_recog_step=1.090, Valid/loss_all_epoch=0.443, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.217, Valid/loss_recog_epoch=0.890, Valid/knn_avr=0.429, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.48it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.14it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.05it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.04it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.84it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074034, 0.073190, 0.072805
Valid average loss UNet            (all)              : 0.220029

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.107389, 1.380089, 2.152592
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.277522, 1.099600, 1.123039
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.384540, 1.302251, 1.229409
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.381411, 1.404360, 1.790896
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.195888, 1.437980, 1.627287
Valid average loss all      (Triplet)                 : 0.292393

== Recognize ==
Valid average loss Recognize     : 0.911560
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.512422

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.844104766845703 sec. =
Valid knn accuracy drums     : 78.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.077390670776367 sec. =
Valid knn accuracy bass      : 12.645348837209303%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.487673997879028 sec. =
Valid knn accuracy piano     : 26.351351351351347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.960060834884644 sec. =
Valid knn accuracy guitar    : 39.12337662337662%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.185925245285034 sec. =
Valid knn accuracy residuals : 50.314465408805034%

Valid knn accuracy average   : 41.33396726767787%

                                                                        [AEpoch 31: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.260, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0485, Train/loss_recog_step=0.752, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.264, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0561, Train/loss_recog_epoch=0.964]Epoch 31: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.260, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0485, Train/loss_recog_step=0.752, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069042, 0.068905, 0.070107
Train average loss UNet            (all)              : 0.208054

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.012840, 1.218169, 2.292932
Train average loss bass     (Triplet, dist_p, dist_n) : 0.089914, 0.896829, 1.162666
Train average loss piano    (Triplet, dist_p, dist_n) : 0.056202, 1.090307, 1.508901
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.037644, 1.136948, 1.722997
Train average loss residuals(Triplet, dist_p, dist_n) : 0.049720, 1.202352, 1.650325
Train average loss all      (Triplet)                 : 0.050018

== Recognize ==
Train average loss Recognize     : 0.970921
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.258072

Epoch 31:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.260, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0485, Train/loss_recog_step=0.752, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]          Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.260, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0485, Train/loss_recog_step=0.752, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.260, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0485, Train/loss_recog_step=0.752, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.880, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0216, Train/loss_recog_step=0.880, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.256, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0407, Train/loss_recog_step=1.010, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.256, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0407, Train/loss_recog_step=1.010, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.256, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=0.721, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.256, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0452, Train/loss_recog_step=0.721, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0361, Train/loss_recog_step=0.946, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0361, Train/loss_recog_step=0.946, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=0.803, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=0.803, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0541, Train/loss_recog_step=1.150, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971] Epoch 32: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0541, Train/loss_recog_step=1.150, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.761, Valid/loss_all_step=0.728, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.479, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.512, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.292, Valid/loss_recog_epoch=0.912, Valid/knn_avr=0.413, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.31it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.21it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.03it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.59it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.077406, 0.076645, 0.076585
Valid average loss UNet            (all)              : 0.230636

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.123706, 1.461839, 2.159749
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.252556, 1.140435, 1.202262
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.368712, 1.356024, 1.325906
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.296996, 1.369422, 1.808167
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.203535, 1.462156, 1.771144
Valid average loss all      (Triplet)                 : 0.266642

== Recognize ==
Valid average loss Recognize     : 0.907731
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.497278

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.823608636856079 sec. =
Valid knn accuracy drums     : 76.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.329786539077759 sec. =
Valid knn accuracy bass      : 8.720930232558139%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.141162633895874 sec. =
Valid knn accuracy piano     : 24.324324324324326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.668970108032227 sec. =
Valid knn accuracy guitar    : 42.04545454545455%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.128093242645264 sec. =
Valid knn accuracy residuals : 48.89937106918239%

Valid knn accuracy average   : 40.09213368136271%

                                                                        [AEpoch 32: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.761, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.258, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.050, Train/loss_recog_epoch=0.971]Epoch 32: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.761, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069138, 0.068982, 0.070208
Train average loss UNet            (all)              : 0.208329

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008535, 1.302203, 2.463348
Train average loss bass     (Triplet, dist_p, dist_n) : 0.078812, 0.972997, 1.277820
Train average loss piano    (Triplet, dist_p, dist_n) : 0.052966, 1.173023, 1.619340
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.037974, 1.228548, 1.866157
Train average loss residuals(Triplet, dist_p, dist_n) : 0.044327, 1.289486, 1.787540
Train average loss all      (Triplet)                 : 0.045537

== Recognize ==
Train average loss Recognize     : 0.977307
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.253866

Epoch 32:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.761, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]          Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.761, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.244, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.761, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.887, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.887, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.245, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.0283, Train/loss_recog_step=1.020, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.245, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.0283, Train/loss_recog_step=1.020, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0401, Train/loss_recog_step=0.727, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.250, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0401, Train/loss_recog_step=0.727, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33:  64%|██████▍   | 200/313 [02:54<01:38,  1.14it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.966, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0277, Train/loss_recog_step=0.966, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=0.807, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=0.807, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.255, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0442, Train/loss_recog_step=1.170, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.255, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0442, Train/loss_recog_step=1.170, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=0.766, Valid/loss_all_step=0.658, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.391, Valid/loss_recog_step=1.110, Valid/loss_all_epoch=0.497, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.267, Valid/loss_recog_epoch=0.908, Valid/knn_avr=0.401, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.34it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.86it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.81it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074646, 0.074268, 0.074092
Valid average loss UNet            (all)              : 0.223005

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133703, 1.595677, 2.422912
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.292497, 1.252753, 1.257319
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.341092, 1.458221, 1.480722
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.377960, 1.645609, 2.041584
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.226342, 1.716407, 2.163560
Valid average loss all      (Triplet)                 : 0.294348

== Recognize ==
Valid average loss Recognize     : 0.917823
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.517353

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.741466999053955 sec. =
Valid knn accuracy drums     : 80.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.354782581329346 sec. =
Valid knn accuracy bass      : 9.738372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.140631198883057 sec. =
Valid knn accuracy piano     : 25.675675675675674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.8334481716156 sec. =
Valid knn accuracy guitar    : 40.74675324675325%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.110418796539307 sec. =
Valid knn accuracy residuals : 57.704402515723274%

Valid knn accuracy average   : 42.920099529764514%

                                                                        [AEpoch 33: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=0.766, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.254, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0455, Train/loss_recog_epoch=0.977]Epoch 33: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=0.766, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069126, 0.068928, 0.070094
Train average loss UNet            (all)              : 0.208148

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008581, 1.410334, 2.621563
Train average loss bass     (Triplet, dist_p, dist_n) : 0.068497, 1.071919, 1.438321
Train average loss piano    (Triplet, dist_p, dist_n) : 0.047932, 1.271136, 1.771961
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.031356, 1.347874, 2.077987
Train average loss residuals(Triplet, dist_p, dist_n) : 0.040233, 1.400156, 1.939974
Train average loss all      (Triplet)                 : 0.039876

== Recognize ==
Train average loss Recognize     : 0.990942
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.248024

Epoch 33:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=0.766, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]          Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=0.766, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.234, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.026, Train/loss_recog_step=0.766, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0231, Train/loss_recog_step=0.887, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0231, Train/loss_recog_step=0.887, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.268, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.0512, Train/loss_recog_step=1.030, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.268, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.0512, Train/loss_recog_step=1.030, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.285, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0735, Train/loss_recog_step=0.722, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.285, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0735, Train/loss_recog_step=0.722, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0281, Train/loss_recog_step=0.959, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0281, Train/loss_recog_step=0.959, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.229, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.804, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.229, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0191, Train/loss_recog_step=0.804, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0221, Train/loss_recog_step=1.180, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0221, Train/loss_recog_step=1.180, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0384, Train/loss_recog_step=0.767, Valid/loss_all_step=0.613, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.355, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.517, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.294, Valid/loss_recog_epoch=0.918, Valid/knn_avr=0.429, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.89it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.87it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.17it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.075055, 0.074564, 0.074791
Valid average loss UNet            (all)              : 0.224409

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.177408, 1.896145, 2.688806
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.415338, 1.520017, 1.421529
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.468066, 1.779037, 1.681206
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.256228, 1.694430, 2.469693
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.260694, 2.040965, 2.356151
Valid average loss all      (Triplet)                 : 0.338921

== Recognize ==
Valid average loss Recognize     : 0.919452
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.563330

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.544504642486572 sec. =
Valid knn accuracy drums     : 78.97058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.12698745727539 sec. =
Valid knn accuracy bass      : 12.063953488372094%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.06363844871521 sec. =
Valid knn accuracy piano     : 26.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.908259630203247 sec. =
Valid knn accuracy guitar    : 40.25974025974026%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.213851928710938 sec. =
Valid knn accuracy residuals : 54.87421383647799%

Valid knn accuracy average   : 42.449915380193104%

                                                                        [AEpoch 34: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0384, Train/loss_recog_step=0.767, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.248, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.0399, Train/loss_recog_epoch=0.991]Epoch 34: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0384, Train/loss_recog_step=0.767, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.069034, 0.068791, 0.069959
Train average loss UNet            (all)              : 0.207784

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.008854, 1.499244, 2.794808
Train average loss bass     (Triplet, dist_p, dist_n) : 0.059234, 1.135603, 1.548164
Train average loss piano    (Triplet, dist_p, dist_n) : 0.043312, 1.340911, 1.876974
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.031028, 1.432407, 2.194579
Train average loss residuals(Triplet, dist_p, dist_n) : 0.034211, 1.467858, 2.050378
Train average loss all      (Triplet)                 : 0.035980

== Recognize ==
Train average loss Recognize     : 0.991065
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.243764

Epoch 34:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0384, Train/loss_recog_step=0.767, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]          Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0384, Train/loss_recog_step=0.767, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.249, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0384, Train/loss_recog_step=0.767, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0376, Train/loss_recog_step=0.899, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0376, Train/loss_recog_step=0.899, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.245, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0288, Train/loss_recog_step=1.020, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.245, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.0288, Train/loss_recog_step=1.020, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0198, Train/loss_recog_step=0.734, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0198, Train/loss_recog_step=0.734, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0185, Train/loss_recog_step=0.978, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0185, Train/loss_recog_step=0.978, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0202, Train/loss_recog_step=0.806, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0202, Train/loss_recog_step=0.806, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=1.150, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0223, Train/loss_recog_step=1.150, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=0.759, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.424, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.563, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.339, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.424, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.95it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.62it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.35it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.45it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.076153, 0.075947, 0.076729
Valid average loss UNet            (all)              : 0.228829

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.110555, 1.606449, 2.449759
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.248884, 1.294080, 1.408611
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.352531, 1.450308, 1.418589
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.291268, 1.625869, 2.005372
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.212302, 1.770283, 2.152406
Valid average loss all      (Triplet)                 : 0.260508

== Recognize ==
Valid average loss Recognize     : 0.904314
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.489336

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.893741130828857 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.085539102554321 sec. =
Valid knn accuracy bass      : 13.662790697674417%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.594011783599854 sec. =
Valid knn accuracy piano     : 28.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.048215389251709 sec. =
Valid knn accuracy guitar    : 32.62987012987013%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.35402226448059 sec. =
Valid knn accuracy residuals : 52.51572327044025%

Valid knn accuracy average   : 41.25134295632192%

                                                                        [AEpoch 35: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=0.759, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.244, Train/loss_unet_all_epoch=0.208, Train/loss_triplet_all_epoch=0.036, Train/loss_recog_epoch=0.991]Epoch 35: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=0.759, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068830, 0.068714, 0.069862
Train average loss UNet            (all)              : 0.207407

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007468, 1.615241, 3.026624
Train average loss bass     (Triplet, dist_p, dist_n) : 0.051341, 1.245790, 1.707937
Train average loss piano    (Triplet, dist_p, dist_n) : 0.034851, 1.449600, 2.046331
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.024375, 1.538558, 2.380441
Train average loss residuals(Triplet, dist_p, dist_n) : 0.030735, 1.605588, 2.249778
Train average loss all      (Triplet)                 : 0.030471

== Recognize ==
Train average loss Recognize     : 0.991609
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.237878

Epoch 35:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=0.759, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]          Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=0.759, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]Epoch 36:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00182, Train/loss_recog_step=0.759, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]Epoch 36:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.895, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992] Epoch 36:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.895, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]Epoch 36:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.047, Train/loss_recog_step=1.020, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992] Epoch 36:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.261, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.047, Train/loss_recog_step=1.020, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]Epoch 36:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.268, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0568, Train/loss_recog_step=0.733, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]Epoch 36:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.268, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0568, Train/loss_recog_step=0.733, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]Epoch 36:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=0.975, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992] Epoch 36:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.014, Train/loss_recog_step=0.975, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]Epoch 36:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.816, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]Epoch 36:  96%|█████████▌| 300/313 [04:29<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.816, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]Epoch 36:  96%|█████████▌| 300/313 [04:29<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0413, Train/loss_recog_step=1.170, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]Epoch 36: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.251, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0413, Train/loss_recog_step=1.170, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]Epoch 36: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.760, Valid/loss_all_step=0.609, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.367, Valid/loss_recog_step=1.100, Valid/loss_all_epoch=0.489, Valid/loss_unet_all_epoch=0.229, Valid/loss_triplet_all_epoch=0.261, Valid/loss_recog_epoch=0.904, Valid/knn_avr=0.413, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.09it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.51it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.36it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073356, 0.073204, 0.073886
Valid average loss UNet            (all)              : 0.220445

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.137071, 1.702113, 2.452452
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.288755, 1.337829, 1.388723
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.366386, 1.555563, 1.515920
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.429961, 1.751071, 2.005943
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.202696, 1.841438, 2.207710
Valid average loss all      (Triplet)                 : 0.308051

== Recognize ==
Valid average loss Recognize     : 0.919255
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.528496

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.773132801055908 sec. =
Valid knn accuracy drums     : 82.35294117647058%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.110498428344727 sec. =
Valid knn accuracy bass      : 14.244186046511627%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.180153608322144 sec. =
Valid knn accuracy piano     : 25.675675675675674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.793352842330933 sec. =
Valid knn accuracy guitar    : 39.12337662337662%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.041029453277588 sec. =
Valid knn accuracy residuals : 54.088050314465406%

Valid knn accuracy average   : 43.096845967299984%

                                                                        [AEpoch 36: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.760, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.238, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0305, Train/loss_recog_epoch=0.992]Epoch 36: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.760, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068882, 0.068612, 0.069832
Train average loss UNet            (all)              : 0.207326

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.009417, 1.653862, 3.107004
Train average loss bass     (Triplet, dist_p, dist_n) : 0.046342, 1.268795, 1.763125
Train average loss piano    (Triplet, dist_p, dist_n) : 0.037603, 1.484707, 2.101682
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.024067, 1.570094, 2.450966
Train average loss residuals(Triplet, dist_p, dist_n) : 0.029782, 1.638913, 2.300099
Train average loss all      (Triplet)                 : 0.029954

== Recognize ==
Train average loss Recognize     : 0.996672
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.237280

Epoch 36:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.760, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]          Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.760, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.760, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0368, Train/loss_recog_step=0.891, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0368, Train/loss_recog_step=0.891, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=1.020, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=1.020, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.271, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0616, Train/loss_recog_step=0.716, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.271, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0616, Train/loss_recog_step=0.716, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.960, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0181, Train/loss_recog_step=0.960, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00463, Train/loss_recog_step=0.810, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00463, Train/loss_recog_step=0.810, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=1.170, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]  Epoch 37: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=1.170, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00728, Train/loss_recog_step=0.758, Valid/loss_all_step=0.710, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.464, Valid/loss_recog_step=1.120, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.308, Valid/loss_recog_epoch=0.919, Valid/knn_avr=0.431, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.38it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.68it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.04it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.12it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073760, 0.074078, 0.073863
Valid average loss UNet            (all)              : 0.221701

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.121367, 1.714746, 2.584443
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.264800, 1.351629, 1.446423
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.446359, 1.562130, 1.478619
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.423126, 1.765269, 1.954301
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.200309, 1.815830, 2.164586
Valid average loss all      (Triplet)                 : 0.306162

== Recognize ==
Valid average loss Recognize     : 0.923967
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.527862

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.636552095413208 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.180136442184448 sec. =
Valid knn accuracy bass      : 14.825581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.213558673858643 sec. =
Valid knn accuracy piano     : 29.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.068092346191406 sec. =
Valid knn accuracy guitar    : 35.22727272727273%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.831726312637329 sec. =
Valid knn accuracy residuals : 54.24528301886793%

Valid knn accuracy average   : 42.45740167313096%

                                                                        [AEpoch 37: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00728, Train/loss_recog_step=0.758, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.237, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.030, Train/loss_recog_epoch=0.997]Epoch 37: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00728, Train/loss_recog_step=0.758, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068804, 0.068589, 0.069764
Train average loss UNet            (all)              : 0.207158

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.007623, 1.690224, 3.127702
Train average loss bass     (Triplet, dist_p, dist_n) : 0.041376, 1.299371, 1.816427
Train average loss piano    (Triplet, dist_p, dist_n) : 0.029277, 1.517660, 2.164599
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.022220, 1.611052, 2.496430
Train average loss residuals(Triplet, dist_p, dist_n) : 0.028030, 1.684369, 2.381818
Train average loss all      (Triplet)                 : 0.026381

== Recognize ==
Train average loss Recognize     : 0.992741
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.233539

Epoch 37:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00728, Train/loss_recog_step=0.758, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]          Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00728, Train/loss_recog_step=0.758, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]Epoch 38:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00728, Train/loss_recog_step=0.758, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]Epoch 38:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=0.895, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993] Epoch 38:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0241, Train/loss_recog_step=0.895, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]Epoch 38:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0254, Train/loss_recog_step=1.030, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]Epoch 38:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.239, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0254, Train/loss_recog_step=1.030, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]Epoch 38:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.245, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0345, Train/loss_recog_step=0.726, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]Epoch 38:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.245, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0345, Train/loss_recog_step=0.726, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]Epoch 38:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00717, Train/loss_recog_step=0.972, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]Epoch 38:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00717, Train/loss_recog_step=0.972, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]Epoch 38:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=0.817, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]  Epoch 38:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.020, Train/loss_recog_step=0.817, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]Epoch 38:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=1.170, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]Epoch 38: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.230, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0187, Train/loss_recog_step=1.170, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]Epoch 38: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.761, Valid/loss_all_step=0.638, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.402, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.528, Valid/loss_unet_all_epoch=0.222, Valid/loss_triplet_all_epoch=0.306, Valid/loss_recog_epoch=0.924, Valid/knn_avr=0.425, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.58it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.80it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.53it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072395, 0.072197, 0.071814
Valid average loss UNet            (all)              : 0.216406

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.172791, 1.879526, 2.750077
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.313963, 1.606542, 1.646411
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.312127, 1.635475, 1.749943
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.371010, 2.009236, 2.337160
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.229172, 2.122845, 2.497939
Valid average loss all      (Triplet)                 : 0.297666

== Recognize ==
Valid average loss Recognize     : 0.922858
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.514072

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.635796546936035 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.654106855392456 sec. =
Valid knn accuracy bass      : 17.151162790697676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.46388864517212 sec. =
Valid knn accuracy piano     : 22.027027027027028%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.131299257278442 sec. =
Valid knn accuracy guitar    : 36.52597402597403%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.869947910308838 sec. =
Valid knn accuracy residuals : 55.34591194968554%

Valid knn accuracy average   : 42.268838688088614%

                                                                        [AEpoch 38: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.761, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.234, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0264, Train/loss_recog_epoch=0.993]Epoch 38: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.761, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068689, 0.068454, 0.069694
Train average loss UNet            (all)              : 0.206838

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005504, 1.781747, 3.288526
Train average loss bass     (Triplet, dist_p, dist_n) : 0.036369, 1.383486, 1.958778
Train average loss piano    (Triplet, dist_p, dist_n) : 0.026663, 1.601118, 2.290875
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.018903, 1.695593, 2.640932
Train average loss residuals(Triplet, dist_p, dist_n) : 0.022492, 1.762498, 2.501260
Train average loss all      (Triplet)                 : 0.022316

== Recognize ==
Train average loss Recognize     : 0.994189
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.229154

Epoch 38:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.761, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]          Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.761, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=0.761, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=0.918, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0196, Train/loss_recog_step=0.918, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=1.040, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.233, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0186, Train/loss_recog_step=1.040, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.245, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0367, Train/loss_recog_step=0.738, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.245, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0367, Train/loss_recog_step=0.738, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00788, Train/loss_recog_step=0.992, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00788, Train/loss_recog_step=0.992, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.826, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994] Epoch 39:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=0.826, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0141, Train/loss_recog_step=1.200, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0141, Train/loss_recog_step=1.200, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00966, Train/loss_recog_step=0.777, Valid/loss_all_step=0.585, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.335, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.514, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.298, Valid/loss_recog_epoch=0.923, Valid/knn_avr=0.423, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.63it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.80it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.16it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072021, 0.071653, 0.073093
Valid average loss UNet            (all)              : 0.216767

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.139774, 1.966099, 2.999558
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.460724, 1.858895, 1.806055
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.427664, 1.842332, 1.829431
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.523604, 2.199970, 2.452394
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.251328, 2.186654, 2.505028
Valid average loss all      (Triplet)                 : 0.402998

== Recognize ==
Valid average loss Recognize     : 0.941640
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.619765

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.520166873931885 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.259657382965088 sec. =
Valid knn accuracy bass      : 11.19186046511628%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.3352632522583 sec. =
Valid knn accuracy piano     : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.047404289245605 sec. =
Valid knn accuracy guitar    : 37.01298701298701%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.087202787399292 sec. =
Valid knn accuracy residuals : 56.60377358490566%

Valid knn accuracy average   : 41.873488918484135%

                                                                        [AEpoch 39: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00966, Train/loss_recog_step=0.777, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.229, Train/loss_unet_all_epoch=0.207, Train/loss_triplet_all_epoch=0.0223, Train/loss_recog_epoch=0.994]Epoch 39: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00966, Train/loss_recog_step=0.777, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068420, 0.068223, 0.069462
Train average loss UNet            (all)              : 0.206104

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004821, 1.826738, 3.367863
Train average loss bass     (Triplet, dist_p, dist_n) : 0.032266, 1.439537, 2.058876
Train average loss piano    (Triplet, dist_p, dist_n) : 0.025592, 1.655384, 2.377363
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.019036, 1.747240, 2.732870
Train average loss residuals(Triplet, dist_p, dist_n) : 0.022450, 1.835312, 2.623839
Train average loss all      (Triplet)                 : 0.021264

== Recognize ==
Train average loss Recognize     : 1.010458
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.227368

Epoch 39:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00966, Train/loss_recog_step=0.777, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]          Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00966, Train/loss_recog_step=0.777, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]Epoch 40:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00966, Train/loss_recog_step=0.777, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]Epoch 40:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=0.912, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010] Epoch 40:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0169, Train/loss_recog_step=0.912, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]Epoch 40:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=1.050, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]Epoch 40:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.0199, Train/loss_recog_step=1.050, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]Epoch 40:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.248, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0396, Train/loss_recog_step=0.742, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]Epoch 40:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.248, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0396, Train/loss_recog_step=0.742, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]Epoch 40:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.990, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]Epoch 40:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0304, Train/loss_recog_step=0.990, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]Epoch 40:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.838, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]Epoch 40:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.838, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]Epoch 40:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=1.220, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010] Epoch 40: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=1.220, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]Epoch 40: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0935, Train/loss_recog_step=0.794, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.403, Valid/loss_recog_epoch=0.942, Valid/knn_avr=0.419, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.37it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.58it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.16it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.08it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.076047, 0.075033, 0.074579
Valid average loss UNet            (all)              : 0.225659

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101952, 2.178075, 3.525762
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.373050, 1.863976, 1.877542
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.436433, 2.029829, 2.046601
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.335361, 2.239838, 2.688625
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.263396, 2.267527, 2.754457
Valid average loss all      (Triplet)                 : 0.322829

== Recognize ==
Valid average loss Recognize     : 0.953496
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.548488

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.565481662750244 sec. =
Valid knn accuracy drums     : 80.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.258923530578613 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.14504098892212 sec. =
Valid knn accuracy piano     : 23.64864864864865%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.211058855056763 sec. =
Valid knn accuracy guitar    : 36.201298701298704%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.955360651016235 sec. =
Valid knn accuracy residuals : 55.503144654088054%

Valid knn accuracy average   : 42.385939878235256%

                                                                        [AEpoch 40: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0935, Train/loss_recog_step=0.794, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.227, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0213, Train/loss_recog_epoch=1.010]Epoch 40: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0935, Train/loss_recog_step=0.794, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068414, 0.068226, 0.069383
Train average loss UNet            (all)              : 0.206023

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005604, 1.937354, 3.565269
Train average loss bass     (Triplet, dist_p, dist_n) : 0.028457, 1.552315, 2.240330
Train average loss piano    (Triplet, dist_p, dist_n) : 0.025085, 1.769916, 2.552168
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.018604, 1.884826, 2.926909
Train average loss residuals(Triplet, dist_p, dist_n) : 0.019573, 1.944470, 2.774150
Train average loss all      (Triplet)                 : 0.019869

== Recognize ==
Train average loss Recognize     : 1.018515
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.225891

Epoch 40:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0935, Train/loss_recog_step=0.794, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]          Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0935, Train/loss_recog_step=0.794, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]Epoch 41:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.301, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0935, Train/loss_recog_step=0.794, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]Epoch 41:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.922, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]Epoch 41:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0167, Train/loss_recog_step=0.922, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]Epoch 41:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.050, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020] Epoch 41:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=1.050, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]Epoch 41:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.746, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]Epoch 41:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.746, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]Epoch 41:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00821, Train/loss_recog_step=0.994, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]Epoch 41:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00821, Train/loss_recog_step=0.994, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]Epoch 41:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.017, Train/loss_recog_step=0.831, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]  Epoch 41:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.017, Train/loss_recog_step=0.831, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]Epoch 41:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0237, Train/loss_recog_step=1.190, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]Epoch 41: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0237, Train/loss_recog_step=1.190, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]Epoch 41: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=0.774, Valid/loss_all_step=0.690, Valid/loss_unet_all_step=0.270, Valid/loss_triplet_all_step=0.420, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.548, Valid/loss_unet_all_epoch=0.226, Valid/loss_triplet_all_epoch=0.323, Valid/loss_recog_epoch=0.953, Valid/knn_avr=0.424, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.13it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.18it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.49it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.02it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.93it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072039, 0.071763, 0.072274
Valid average loss UNet            (all)              : 0.216075

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.158919, 2.162750, 3.341904
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.461572, 1.929035, 1.887725
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.448672, 2.034570, 1.942150
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.502702, 2.278053, 2.635290
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.311977, 2.277978, 2.632704
Valid average loss all      (Triplet)                 : 0.420508

== Recognize ==
Valid average loss Recognize     : 0.927595
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.636583

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.361863613128662 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.105047464370728 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.05693244934082 sec. =
Valid knn accuracy piano     : 26.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.02653694152832 sec. =
Valid knn accuracy guitar    : 39.61038961038961%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.742728233337402 sec. =
Valid knn accuracy residuals : 57.704402515723274%

Valid knn accuracy average   : 43.13782070200004%

                                                                        [AEpoch 41: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=0.774, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.226, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0199, Train/loss_recog_epoch=1.020]Epoch 41: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=0.774, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068217, 0.068071, 0.069284
Train average loss UNet            (all)              : 0.205572

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005780, 1.966273, 3.657118
Train average loss bass     (Triplet, dist_p, dist_n) : 0.026257, 1.563028, 2.266685
Train average loss piano    (Triplet, dist_p, dist_n) : 0.021365, 1.791680, 2.614855
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.018138, 1.877483, 2.954567
Train average loss residuals(Triplet, dist_p, dist_n) : 0.017340, 1.942191, 2.790773
Train average loss all      (Triplet)                 : 0.017954

== Recognize ==
Train average loss Recognize     : 1.021874
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.223526

Epoch 41:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=0.774, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]          Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=0.774, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]Epoch 42:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=0.774, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]Epoch 42:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00636, Train/loss_recog_step=0.919, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]Epoch 42:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00636, Train/loss_recog_step=0.919, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]Epoch 42:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0291, Train/loss_recog_step=1.040, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020] Epoch 42:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.242, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0291, Train/loss_recog_step=1.040, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]Epoch 42:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0269, Train/loss_recog_step=0.740, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]Epoch 42:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0269, Train/loss_recog_step=0.740, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]Epoch 42:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.989, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020] Epoch 42:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=0.989, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]Epoch 42:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000247, Train/loss_recog_step=0.820, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]Epoch 42:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000247, Train/loss_recog_step=0.820, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]Epoch 42:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=1.220, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020] Epoch 42: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=1.220, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]Epoch 42: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.953, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.709, Valid/loss_recog_step=1.130, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.421, Valid/loss_recog_epoch=0.928, Valid/knn_avr=0.431, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.92it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.98it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.91it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.83it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.21it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072694, 0.072217, 0.072333
Valid average loss UNet            (all)              : 0.217245

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.178063, 2.052689, 3.091278
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.437180, 1.776784, 1.714358
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.423885, 1.877297, 1.806801
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.329595, 2.149806, 2.583030
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.244939, 2.107752, 2.628709
Valid average loss all      (Triplet)                 : 0.349574

== Recognize ==
Valid average loss Recognize     : 0.948907
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.566818

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.59820008277893 sec. =
Valid knn accuracy drums     : 77.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.87836217880249 sec. =
Valid knn accuracy bass      : 11.918604651162791%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.342108964920044 sec. =
Valid knn accuracy piano     : 29.864864864864867%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.847557067871094 sec. =
Valid knn accuracy guitar    : 35.87662337662338%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.130726099014282 sec. =
Valid knn accuracy residuals : 55.9748427672956%

Valid knn accuracy average   : 42.22698713198933%

                                                                        [AEpoch 42: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.224, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.018, Train/loss_recog_epoch=1.020]Epoch 42: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068269, 0.068104, 0.069320
Train average loss UNet            (all)              : 0.205693

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005987, 2.037613, 3.777802
Train average loss bass     (Triplet, dist_p, dist_n) : 0.027493, 1.645858, 2.381235
Train average loss piano    (Triplet, dist_p, dist_n) : 0.019009, 1.863787, 2.701426
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.016152, 1.956430, 3.071911
Train average loss residuals(Triplet, dist_p, dist_n) : 0.015779, 2.030734, 2.914959
Train average loss all      (Triplet)                 : 0.017373

== Recognize ==
Train average loss Recognize     : 1.008952
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.223066

Epoch 42:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]          Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]Epoch 43:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]Epoch 43:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00379, Train/loss_recog_step=0.924, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]Epoch 43:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00379, Train/loss_recog_step=0.924, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]Epoch 43:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.00715, Train/loss_recog_step=1.050, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]Epoch 43:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.00715, Train/loss_recog_step=1.050, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]Epoch 43:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=0.746, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010] Epoch 43:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.228, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0217, Train/loss_recog_step=0.746, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]Epoch 43:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.993, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]Epoch 43:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0118, Train/loss_recog_step=0.993, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]Epoch 43:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.820, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]Epoch 43:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00358, Train/loss_recog_step=0.820, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]Epoch 43:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=1.210, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010] Epoch 43: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.231, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0239, Train/loss_recog_step=1.210, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]Epoch 43: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0201, Train/loss_recog_step=0.781, Valid/loss_all_step=0.682, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.432, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.567, Valid/loss_unet_all_epoch=0.217, Valid/loss_triplet_all_epoch=0.350, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.422, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.80it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.51it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.53it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.30it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.39it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072647, 0.072869, 0.073478
Valid average loss UNet            (all)              : 0.218994

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.156559, 2.087280, 3.336734
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.460423, 1.905364, 1.910112
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.415636, 1.930450, 1.880776
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.414403, 2.198268, 2.570049
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.180598, 2.131443, 2.849153
Valid average loss all      (Triplet)                 : 0.361574

== Recognize ==
Valid average loss Recognize     : 0.947012
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.580567

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.000216722488403 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.254268169403076 sec. =
Valid knn accuracy bass      : 10.755813953488373%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.857575178146362 sec. =
Valid knn accuracy piano     : 25.270270270270267%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.987994194030762 sec. =
Valid knn accuracy guitar    : 42.2077922077922%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.203587532043457 sec. =
Valid knn accuracy residuals : 56.132075471698116%

Valid knn accuracy average   : 42.57907273359097%

                                                                        [AEpoch 43: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0201, Train/loss_recog_step=0.781, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.223, Train/loss_unet_all_epoch=0.206, Train/loss_triplet_all_epoch=0.0174, Train/loss_recog_epoch=1.010]Epoch 43: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0201, Train/loss_recog_step=0.781, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068131, 0.068048, 0.069213
Train average loss UNet            (all)              : 0.205392

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005019, 2.113170, 3.884452
Train average loss bass     (Triplet, dist_p, dist_n) : 0.021670, 1.695240, 2.491536
Train average loss piano    (Triplet, dist_p, dist_n) : 0.019542, 1.918332, 2.786203
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012959, 2.024320, 3.238311
Train average loss residuals(Triplet, dist_p, dist_n) : 0.016828, 2.084954, 2.977656
Train average loss all      (Triplet)                 : 0.015409

== Recognize ==
Train average loss Recognize     : 1.014469
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.220802

Epoch 43:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0201, Train/loss_recog_step=0.781, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]          Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0201, Train/loss_recog_step=0.781, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0201, Train/loss_recog_step=0.781, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.915, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.915, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=1.070, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.240, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.0259, Train/loss_recog_step=1.070, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.744, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=0.744, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.992, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010] Epoch 44:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.992, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.828, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0256, Train/loss_recog_step=0.828, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.00822, Train/loss_recog_step=1.210, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.00822, Train/loss_recog_step=1.210, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.362, Valid/loss_recog_epoch=0.947, Valid/knn_avr=0.426, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.92it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.46it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.35it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.55it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.74it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.27it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.077576, 0.076372, 0.075846
Valid average loss UNet            (all)              : 0.229793

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.144600, 2.148304, 3.394867
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.388341, 1.981659, 1.932942
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.310928, 1.979482, 2.151405
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.253772, 2.220832, 2.692101
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.325884, 2.471420, 2.818944
Valid average loss all      (Triplet)                 : 0.290019

== Recognize ==
Valid average loss Recognize     : 0.945066
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.519812

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.833006143569946 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.1113862991333 sec. =
Valid knn accuracy bass      : 13.517441860465116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.15239667892456 sec. =
Valid knn accuracy piano     : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.834983348846436 sec. =
Valid knn accuracy guitar    : 28.733766233766232%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.221716403961182 sec. =
Valid knn accuracy residuals : 56.132075471698116%

Valid knn accuracy average   : 40.73548024259767%

                                                                        [AEpoch 44: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.221, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0154, Train/loss_recog_epoch=1.010]Epoch 44: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.068090, 0.067911, 0.069110
Train average loss UNet            (all)              : 0.205111

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005730, 2.099216, 3.927451
Train average loss bass     (Triplet, dist_p, dist_n) : 0.021787, 1.683180, 2.484356
Train average loss piano    (Triplet, dist_p, dist_n) : 0.019584, 1.920252, 2.803350
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.013017, 2.005370, 3.201858
Train average loss residuals(Triplet, dist_p, dist_n) : 0.014224, 2.056615, 2.973818
Train average loss all      (Triplet)                 : 0.015142

== Recognize ==
Train average loss Recognize     : 1.024049
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.220253

Epoch 44:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]          Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]Epoch 45:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]Epoch 45:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=0.927, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]Epoch 45:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=0.927, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]Epoch 45:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00452, Train/loss_recog_step=1.060, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]Epoch 45:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00452, Train/loss_recog_step=1.060, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]Epoch 45:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=0.750, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020] Epoch 45:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=0.750, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]Epoch 45:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=0.997, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]Epoch 45:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=0.997, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]Epoch 45:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00788, Train/loss_recog_step=0.831, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]Epoch 45:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00788, Train/loss_recog_step=0.831, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]Epoch 45:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0281, Train/loss_recog_step=1.210, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020] Epoch 45: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0281, Train/loss_recog_step=1.210, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]Epoch 45: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.00855, Train/loss_recog_step=0.780, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.199, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.520, Valid/loss_unet_all_epoch=0.230, Valid/loss_triplet_all_epoch=0.290, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.407, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.06it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.21it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.61it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.50it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074867, 0.074549, 0.074524
Valid average loss UNet            (all)              : 0.223940

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.164124, 2.291424, 3.703053
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.587200, 2.049918, 1.883668
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.342652, 2.114738, 2.235944
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.404921, 2.374752, 2.948369
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.270090, 2.592996, 3.162325
Valid average loss all      (Triplet)                 : 0.396449

== Recognize ==
Valid average loss Recognize     : 0.949774
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.620389

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.666643381118774 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.319897174835205 sec. =
Valid knn accuracy bass      : 12.936046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.34136152267456 sec. =
Valid knn accuracy piano     : 26.351351351351347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.70822024345398 sec. =
Valid knn accuracy guitar    : 39.285714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.920242547988892 sec. =
Valid knn accuracy residuals : 57.07547169811321%

Valid knn accuracy average   : 43.18854029877311%

                                                                        [AEpoch 45: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.00855, Train/loss_recog_step=0.780, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.220, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0151, Train/loss_recog_epoch=1.020]Epoch 45: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.00855, Train/loss_recog_step=0.780, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067964, 0.067778, 0.068975
Train average loss UNet            (all)              : 0.204718

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005188, 2.146217, 4.032626
Train average loss bass     (Triplet, dist_p, dist_n) : 0.021095, 1.744765, 2.553950
Train average loss piano    (Triplet, dist_p, dist_n) : 0.016752, 1.962029, 2.880689
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.013974, 2.041370, 3.267008
Train average loss residuals(Triplet, dist_p, dist_n) : 0.014020, 2.129972, 3.084415
Train average loss all      (Triplet)                 : 0.014337

== Recognize ==
Train average loss Recognize     : 1.024444
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.219055

Epoch 45:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.00855, Train/loss_recog_step=0.780, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]          Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.00855, Train/loss_recog_step=0.780, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]Epoch 46:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.00855, Train/loss_recog_step=0.780, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]Epoch 46:  16%|█▌        | 50/313 [00:46<04:02,  1.08it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=0.929, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020] Epoch 46:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=0.929, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]Epoch 46:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.00676, Train/loss_recog_step=1.050, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]Epoch 46:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.212, Train/loss_triplet_all_step=0.00676, Train/loss_recog_step=1.050, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]Epoch 46:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00639, Train/loss_recog_step=0.736, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]Epoch 46:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00639, Train/loss_recog_step=0.736, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]Epoch 46:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0205, Train/loss_recog_step=0.995, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020] Epoch 46:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0205, Train/loss_recog_step=0.995, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]Epoch 46:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.837, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]Epoch 46:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00384, Train/loss_recog_step=0.837, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]Epoch 46:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=1.210, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020] Epoch 46: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=1.210, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]Epoch 46: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.775, Valid/loss_all_step=0.846, Valid/loss_unet_all_step=0.269, Valid/loss_triplet_all_step=0.577, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.620, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.432, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.85it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.22it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.17it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.49it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073275, 0.072725, 0.075022
Valid average loss UNet            (all)              : 0.221021

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.188175, 2.190650, 3.459584
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.395469, 1.956194, 1.972673
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.422303, 2.151269, 2.280216
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.312869, 2.429431, 3.016737
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.282105, 2.535420, 2.701459
Valid average loss all      (Triplet)                 : 0.333421

== Recognize ==
Valid average loss Recognize     : 0.951193
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.554442

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.80096173286438 sec. =
Valid knn accuracy drums     : 80.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.21477746963501 sec. =
Valid knn accuracy bass      : 12.354651162790697%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.12095022201538 sec. =
Valid knn accuracy piano     : 26.216216216216214%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.118384838104248 sec. =
Valid knn accuracy guitar    : 36.85064935064935%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.911580324172974 sec. =
Valid knn accuracy residuals : 56.60377358490566%

Valid knn accuracy average   : 42.493293357030026%

                                                                        [AEpoch 46: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.775, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0143, Train/loss_recog_epoch=1.020]Epoch 46: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.775, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067924, 0.067752, 0.068952
Train average loss UNet            (all)              : 0.204629

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004466, 2.082514, 3.912322
Train average loss bass     (Triplet, dist_p, dist_n) : 0.019706, 1.716923, 2.544109
Train average loss piano    (Triplet, dist_p, dist_n) : 0.019435, 1.936144, 2.835649
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.016461, 2.021030, 3.210730
Train average loss residuals(Triplet, dist_p, dist_n) : 0.012542, 2.096442, 3.061761
Train average loss all      (Triplet)                 : 0.014401

== Recognize ==
Train average loss Recognize     : 1.017348
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.219030

Epoch 46:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.775, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]          Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.775, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.775, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.933, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.933, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.000524, Train/loss_recog_step=1.070, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.000524, Train/loss_recog_step=1.070, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.743, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]  Epoch 47:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0161, Train/loss_recog_step=0.743, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.020, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.020, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.846, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=0.846, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=1.230, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=1.230, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.787, Valid/loss_all_step=0.632, Valid/loss_unet_all_step=0.256, Valid/loss_triplet_all_step=0.376, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.554, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.333, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.425, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.06it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.28it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.32it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072197, 0.071911, 0.072264
Valid average loss UNet            (all)              : 0.216372

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.179686, 2.171885, 3.311494
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.406105, 1.906464, 1.919961
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.374643, 2.075433, 2.174508
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.423918, 2.567067, 2.850675
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.246906, 2.396249, 2.922123
Valid average loss all      (Triplet)                 : 0.348412

== Recognize ==
Valid average loss Recognize     : 0.953934
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.564784

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.621533393859863 sec. =
Valid knn accuracy drums     : 81.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.932829856872559 sec. =
Valid knn accuracy bass      : 11.337209302325581%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.106116771697998 sec. =
Valid knn accuracy piano     : 32.16216216216216%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.866899490356445 sec. =
Valid knn accuracy guitar    : 38.63636363636363%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.952254056930542 sec. =
Valid knn accuracy residuals : 55.9748427672956%

Valid knn accuracy average   : 43.91623322068822%

                                                                        [AEpoch 47: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.787, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.219, Train/loss_unet_all_epoch=0.205, Train/loss_triplet_all_epoch=0.0144, Train/loss_recog_epoch=1.020]Epoch 47: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.787, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067781, 0.067616, 0.068812
Train average loss UNet            (all)              : 0.204209

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003283, 2.057734, 3.865585
Train average loss bass     (Triplet, dist_p, dist_n) : 0.018471, 1.679692, 2.503703
Train average loss piano    (Triplet, dist_p, dist_n) : 0.016094, 1.881832, 2.780498
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012633, 1.977009, 3.175323
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011842, 2.050003, 2.994520
Train average loss all      (Triplet)                 : 0.012775

== Recognize ==
Train average loss Recognize     : 1.029775
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.216985

Epoch 47:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.787, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]          Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.787, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]Epoch 48:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.787, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]Epoch 48:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0231, Train/loss_recog_step=0.932, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030] Epoch 48:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0231, Train/loss_recog_step=0.932, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]Epoch 48:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=1.070, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]Epoch 48:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=1.070, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]Epoch 48:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=0.757, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]Epoch 48:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.225, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=0.757, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]Epoch 48:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=1.020, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]Epoch 48:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0126, Train/loss_recog_step=1.020, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]Epoch 48:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.836, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030] Epoch 48:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.836, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]Epoch 48:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000871, Train/loss_recog_step=1.220, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]Epoch 48: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000871, Train/loss_recog_step=1.220, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]Epoch 48: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.795, Valid/loss_all_step=0.686, Valid/loss_unet_all_step=0.251, Valid/loss_triplet_all_step=0.435, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.565, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.348, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.439, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.97it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.01it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.43it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.42it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071766, 0.071463, 0.071600
Valid average loss UNet            (all)              : 0.214829

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.167359, 2.263957, 3.435195
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.417814, 2.089629, 2.140255
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.426322, 2.090500, 2.175792
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.461087, 2.520401, 2.931706
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.308906, 2.576084, 3.158759
Valid average loss all      (Triplet)                 : 0.381467

== Recognize ==
Valid average loss Recognize     : 0.953658
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.596296

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.937465190887451 sec. =
Valid knn accuracy drums     : 77.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.030062913894653 sec. =
Valid knn accuracy bass      : 18.6046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.06552243232727 sec. =
Valid knn accuracy piano     : 25.270270270270267%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.142571926116943 sec. =
Valid knn accuracy guitar    : 36.201298701298704%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.16563630104065 sec. =
Valid knn accuracy residuals : 51.886792452830186%

Valid knn accuracy average   : 41.980837811555624%

                                                                        [AEpoch 48: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.795, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.030]Epoch 48: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.795, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067707, 0.067562, 0.068713
Train average loss UNet            (all)              : 0.203982

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.005149, 2.250929, 4.274356
Train average loss bass     (Triplet, dist_p, dist_n) : 0.018992, 1.850419, 2.743996
Train average loss piano    (Triplet, dist_p, dist_n) : 0.013468, 2.058203, 3.044229
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.013022, 2.168453, 3.451195
Train average loss residuals(Triplet, dist_p, dist_n) : 0.011965, 2.239423, 3.260998
Train average loss all      (Triplet)                 : 0.012798

== Recognize ==
Train average loss Recognize     : 1.037377
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.216779

Epoch 48:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.795, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]          Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.795, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.224, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.795, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00861, Train/loss_recog_step=0.925, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00861, Train/loss_recog_step=0.925, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0236, Train/loss_recog_step=1.070, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040] Epoch 49:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.236, Train/loss_unet_all_step=0.213, Train/loss_triplet_all_step=0.0236, Train/loss_recog_step=1.070, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.752, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.752, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=1.000, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0142, Train/loss_recog_step=1.000, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=0.834, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0175, Train/loss_recog_step=0.834, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00607, Train/loss_recog_step=1.210, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00607, Train/loss_recog_step=1.210, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.789, Valid/loss_all_step=0.740, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.495, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.596, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.381, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.420, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.96it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.31it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.12it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.42it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.96it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.56it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070845, 0.070783, 0.071531
Valid average loss UNet            (all)              : 0.213160

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.175145, 2.202754, 3.584104
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.487386, 2.071965, 2.074365
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.471976, 2.053216, 2.074094
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.445559, 2.496197, 2.671077
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.266509, 2.575596, 2.935318
Valid average loss all      (Triplet)                 : 0.412490

== Recognize ==
Valid average loss Recognize     : 0.949153
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.625649

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.55309772491455 sec. =
Valid knn accuracy drums     : 79.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.305159091949463 sec. =
Valid knn accuracy bass      : 17.87790697674419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.080454349517822 sec. =
Valid knn accuracy piano     : 25.270270270270267%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.898192167282104 sec. =
Valid knn accuracy guitar    : 37.82467532467532%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.963704347610474 sec. =
Valid knn accuracy residuals : 54.24528301886793%

Valid knn accuracy average   : 42.92598005928801%

                                                                        [AEpoch 49: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.789, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.217, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0128, Train/loss_recog_epoch=1.040]Epoch 49: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.789, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067622, 0.067372, 0.068605
Train average loss UNet            (all)              : 0.203599

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003990, 2.162237, 3.996927
Train average loss bass     (Triplet, dist_p, dist_n) : 0.016711, 1.775508, 2.670208
Train average loss piano    (Triplet, dist_p, dist_n) : 0.014413, 1.982122, 2.947511
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.013124, 2.065586, 3.327965
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009628, 2.190224, 3.205106
Train average loss all      (Triplet)                 : 0.011794

== Recognize ==
Train average loss Recognize     : 1.031313
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.215393

Epoch 49:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.789, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]          Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.789, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]Epoch 50:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.789, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]Epoch 50:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00262, Train/loss_recog_step=0.927, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]Epoch 50:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00262, Train/loss_recog_step=0.927, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]Epoch 50:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00421, Train/loss_recog_step=1.070, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]Epoch 50:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00421, Train/loss_recog_step=1.070, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]Epoch 50:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000202, Train/loss_recog_step=0.760, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]Epoch 50:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000202, Train/loss_recog_step=0.760, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]Epoch 50:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00293, Train/loss_recog_step=1.010, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030] Epoch 50:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00293, Train/loss_recog_step=1.010, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]Epoch 50:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.834, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]Epoch 50:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00393, Train/loss_recog_step=0.834, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]Epoch 50:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=1.210, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030] Epoch 50: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0143, Train/loss_recog_step=1.210, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]Epoch 50: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.779, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.648, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.412, Valid/loss_recog_epoch=0.949, Valid/knn_avr=0.429, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.16it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.14it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.42it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.072662, 0.071479, 0.071938
Valid average loss UNet            (all)              : 0.216079

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.192776, 2.286459, 3.673323
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.498048, 2.139117, 2.112877
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.441703, 2.125783, 2.163632
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.489471, 2.489011, 2.735850
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.294847, 2.374150, 2.774992
Valid average loss all      (Triplet)                 : 0.428757

== Recognize ==
Valid average loss Recognize     : 0.945440
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.644836

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.664402484893799 sec. =
Valid knn accuracy drums     : 80.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.767796516418457 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.265345335006714 sec. =
Valid knn accuracy piano     : 23.10810810810811%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.01464319229126 sec. =
Valid knn accuracy guitar    : 35.87662337662338%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.89178466796875 sec. =
Valid knn accuracy residuals : 50.157232704402524%

Valid knn accuracy average   : 41.02777724275156%

                                                                        [AEpoch 50: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.779, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.215, Train/loss_unet_all_epoch=0.204, Train/loss_triplet_all_epoch=0.0118, Train/loss_recog_epoch=1.030]Epoch 50: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.779, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067428, 0.067290, 0.068491
Train average loss UNet            (all)              : 0.203209

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004215, 2.173608, 4.076495
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014220, 1.826137, 2.753776
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012926, 2.010509, 2.974872
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010024, 2.101496, 3.382546
Train average loss residuals(Triplet, dist_p, dist_n) : 0.012853, 2.218261, 3.229909
Train average loss all      (Triplet)                 : 0.010931

== Recognize ==
Train average loss Recognize     : 1.034580
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.214140

Epoch 50:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.779, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]          Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.779, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]Epoch 51:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.779, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]Epoch 51:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00827, Train/loss_recog_step=0.931, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]Epoch 51:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00827, Train/loss_recog_step=0.931, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]Epoch 51:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00787, Train/loss_recog_step=1.070, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]Epoch 51:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00787, Train/loss_recog_step=1.070, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]Epoch 51:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.753, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]  Epoch 51:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.010, Train/loss_recog_step=0.753, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]Epoch 51:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00705, Train/loss_recog_step=1.010, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]Epoch 51:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00705, Train/loss_recog_step=1.010, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]Epoch 51:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.840, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030] Epoch 51:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=0.840, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]Epoch 51:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00391, Train/loss_recog_step=1.210, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]Epoch 51: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00391, Train/loss_recog_step=1.210, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]Epoch 51: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.789, Valid/loss_all_step=0.933, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.685, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.645, Valid/loss_unet_all_epoch=0.216, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.945, Valid/knn_avr=0.410, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.16it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.96it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.20it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.22it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.00it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071559, 0.070794, 0.071143
Valid average loss UNet            (all)              : 0.213496

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.152490, 2.488983, 4.018656
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.363601, 2.299467, 2.514901
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.447526, 2.297849, 2.407177
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.547945, 2.737233, 2.971781
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.282115, 2.751464, 3.266598
Valid average loss all      (Triplet)                 : 0.384844

== Recognize ==
Valid average loss Recognize     : 0.950890
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.598341

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.373775482177734 sec. =
Valid knn accuracy drums     : 79.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.295828819274902 sec. =
Valid knn accuracy bass      : 12.354651162790697%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.611238241195679 sec. =
Valid knn accuracy piano     : 20.81081081081081%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.18152904510498 sec. =
Valid knn accuracy guitar    : 35.22727272727273%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.81540322303772 sec. =
Valid knn accuracy residuals : 52.67295597484277%

Valid knn accuracy average   : 40.09549107631988%

                                                                        [AEpoch 51: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.789, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0109, Train/loss_recog_epoch=1.030]Epoch 51: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.789, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067427, 0.067278, 0.068528
Train average loss UNet            (all)              : 0.203233

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004526, 2.267636, 4.206476
Train average loss bass     (Triplet, dist_p, dist_n) : 0.015033, 1.907972, 2.887704
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012685, 2.101152, 3.127842
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011331, 2.194765, 3.515141
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008909, 2.273889, 3.333025
Train average loss all      (Triplet)                 : 0.010829

== Recognize ==
Train average loss Recognize     : 1.036215
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.214062

Epoch 51:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.789, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]          Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.789, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0158, Train/loss_recog_step=0.789, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=0.933, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=0.933, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=1.080, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=1.080, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00163, Train/loss_recog_step=0.753, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00163, Train/loss_recog_step=0.753, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00864, Train/loss_recog_step=1.020, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00864, Train/loss_recog_step=1.020, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00237, Train/loss_recog_step=0.843, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00237, Train/loss_recog_step=0.843, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=1.210, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040] Epoch 52: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=1.210, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=0.800, Valid/loss_all_step=0.813, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.571, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.598, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.385, Valid/loss_recog_epoch=0.951, Valid/knn_avr=0.401, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.97it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.74it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.51it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.92it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.14it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071614, 0.070900, 0.071313
Valid average loss UNet            (all)              : 0.213827

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.160470, 2.538000, 3.897815
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.473453, 2.276371, 2.270884
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.423556, 2.322918, 2.459606
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.495283, 2.840970, 3.217279
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.273741, 2.846051, 3.167175
Valid average loss all      (Triplet)                 : 0.412592

== Recognize ==
Valid average loss Recognize     : 0.959623
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.626418

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.644320487976074 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.975704669952393 sec. =
Valid knn accuracy bass      : 21.36627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.266326189041138 sec. =
Valid knn accuracy piano     : 28.783783783783782%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.997881174087524 sec. =
Valid knn accuracy guitar    : 38.14935064935065%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.921765089035034 sec. =
Valid knn accuracy residuals : 56.76100628930818%

Valid knn accuracy average   : 44.57090748785378%

                                                                        [AEpoch 52: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=0.800, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0108, Train/loss_recog_epoch=1.040]Epoch 52: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=0.800, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067392, 0.067214, 0.068364
Train average loss UNet            (all)              : 0.202969

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004503, 2.252747, 4.227486
Train average loss bass     (Triplet, dist_p, dist_n) : 0.017511, 1.882424, 2.858903
Train average loss piano    (Triplet, dist_p, dist_n) : 0.014274, 2.075046, 3.086705
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010539, 2.186047, 3.489055
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010167, 2.266200, 3.320794
Train average loss all      (Triplet)                 : 0.011530

== Recognize ==
Train average loss Recognize     : 1.039834
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.214500

Epoch 52:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=0.800, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]          Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=0.800, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]Epoch 53:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0021, Train/loss_recog_step=0.800, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]Epoch 53:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00569, Train/loss_recog_step=0.926, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]Epoch 53:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00569, Train/loss_recog_step=0.926, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]Epoch 53:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.080, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040] Epoch 53:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.0109, Train/loss_recog_step=1.080, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]Epoch 53:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=0.750, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]Epoch 53:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00168, Train/loss_recog_step=0.750, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]Epoch 53:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=1.000, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040] Epoch 53:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=1.000, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]Epoch 53:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.829, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]Epoch 53:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0157, Train/loss_recog_step=0.829, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]Epoch 53:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00488, Train/loss_recog_step=1.220, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]Epoch 53: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00488, Train/loss_recog_step=1.220, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]Epoch 53: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.785, Valid/loss_all_step=0.891, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.626, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.413, Valid/loss_recog_epoch=0.960, Valid/knn_avr=0.446, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.13it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.57it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.81it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071420, 0.071378, 0.072455
Valid average loss UNet            (all)              : 0.215252

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.149819, 2.424453, 3.712737
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.395521, 2.162486, 2.327831
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.442158, 2.310821, 2.325572
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.605821, 2.729755, 3.041657
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.248752, 2.596453, 3.115557
Valid average loss all      (Triplet)                 : 0.400208

== Recognize ==
Valid average loss Recognize     : 0.953697
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.615460

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.134911060333252 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.132429361343384 sec. =
Valid knn accuracy bass      : 12.063953488372094%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.192948579788208 sec. =
Valid knn accuracy piano     : 28.243243243243242%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.040657043457031 sec. =
Valid knn accuracy guitar    : 33.27922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.078390121459961 sec. =
Valid knn accuracy residuals : 52.358490566037744%

Valid knn accuracy average   : 40.659569850668895%

                                                                        [AEpoch 53: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.785, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0115, Train/loss_recog_epoch=1.040]Epoch 53: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.785, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067351, 0.067144, 0.068366
Train average loss UNet            (all)              : 0.202860

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.004188, 2.412183, 4.550848
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014752, 1.995604, 3.009787
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012470, 2.199913, 3.273424
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.010980, 2.321652, 3.701057
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010809, 2.394118, 3.519313
Train average loss all      (Triplet)                 : 0.010642

== Recognize ==
Train average loss Recognize     : 1.035428
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.213502

Epoch 53:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.785, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]          Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.785, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]Epoch 54:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00448, Train/loss_recog_step=0.785, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]Epoch 54:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.927, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]Epoch 54:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.927, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]Epoch 54:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]  Epoch 54:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]Epoch 54:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=0.754, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]Epoch 54:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0149, Train/loss_recog_step=0.754, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]Epoch 54:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00788, Train/loss_recog_step=1.020, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]Epoch 54:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00788, Train/loss_recog_step=1.020, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]Epoch 54:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00797, Train/loss_recog_step=0.830, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]Epoch 54:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00797, Train/loss_recog_step=0.830, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]Epoch 54:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=1.220, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040] Epoch 54: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.235, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0293, Train/loss_recog_step=1.220, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]Epoch 54: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.850, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.615, Valid/loss_unet_all_epoch=0.215, Valid/loss_triplet_all_epoch=0.400, Valid/loss_recog_epoch=0.954, Valid/knn_avr=0.407, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.11it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.55it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.14it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074257, 0.073889, 0.073223
Valid average loss UNet            (all)              : 0.221369

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.158985, 2.338118, 3.548434
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.490107, 2.273064, 2.295108
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.399730, 2.221750, 2.413419
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.441166, 2.631835, 3.075608
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.292819, 2.411023, 2.993943
Valid average loss all      (Triplet)                 : 0.389771

== Recognize ==
Valid average loss Recognize     : 0.950467
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.611140

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.584707260131836 sec. =
Valid knn accuracy drums     : 81.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.541355609893799 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.180082321166992 sec. =
Valid knn accuracy piano     : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.669140100479126 sec. =
Valid knn accuracy guitar    : 33.92857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.136640310287476 sec. =
Valid knn accuracy residuals : 56.44654088050315%

Valid knn accuracy average   : 42.333230396151436%

                                                                        [AEpoch 54: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.214, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0106, Train/loss_recog_epoch=1.040]Epoch 54: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067301, 0.067101, 0.068370
Train average loss UNet            (all)              : 0.202772

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003169, 2.290082, 4.285093
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012748, 1.931451, 2.967448
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012955, 2.136196, 3.178675
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.012042, 2.207144, 3.569502
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009232, 2.302348, 3.383787
Train average loss all      (Triplet)                 : 0.010060

== Recognize ==
Train average loss Recognize     : 1.038886
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.212832

Epoch 54:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]          Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]Epoch 55:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.796, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]Epoch 55:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00561, Train/loss_recog_step=0.922, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]Epoch 55:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00561, Train/loss_recog_step=0.922, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]Epoch 55:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.080, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040] Epoch 55:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.226, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.080, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]Epoch 55:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.755, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]Epoch 55:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.755, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]Epoch 55:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040] Epoch 55:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]Epoch 55:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0088, Train/loss_recog_step=0.821, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]Epoch 55:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0088, Train/loss_recog_step=0.821, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]Epoch 55:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=1.210, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]Epoch 55: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=1.210, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]Epoch 55: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.796, Valid/loss_all_step=0.794, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.529, Valid/loss_recog_step=1.160, Valid/loss_all_epoch=0.611, Valid/loss_unet_all_epoch=0.221, Valid/loss_triplet_all_epoch=0.390, Valid/loss_recog_epoch=0.950, Valid/knn_avr=0.423, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.50it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.08it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.87it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.95it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073924, 0.073622, 0.072836
Valid average loss UNet            (all)              : 0.220382

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.189232, 2.513021, 4.014099
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.445953, 2.296492, 2.338539
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.452508, 2.378031, 2.361558
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.465120, 2.594372, 2.904974
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.317544, 2.818139, 3.268064
Valid average loss all      (Triplet)                 : 0.401004

== Recognize ==
Valid average loss Recognize     : 0.940643
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.621386

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.500728368759155 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.326377868652344 sec. =
Valid knn accuracy bass      : 16.71511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.367270469665527 sec. =
Valid knn accuracy piano     : 22.027027027027028%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.036499738693237 sec. =
Valid knn accuracy guitar    : 42.532467532467535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.980942487716675 sec. =
Valid knn accuracy residuals : 59.905660377358494%

Valid knn accuracy average   : 44.29487777259632%

                                                                        [AEpoch 55: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.796, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.213, Train/loss_unet_all_epoch=0.203, Train/loss_triplet_all_epoch=0.0101, Train/loss_recog_epoch=1.040]Epoch 55: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.796, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067181, 0.067052, 0.068221
Train average loss UNet            (all)              : 0.202454

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002897, 2.267033, 4.301448
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012952, 1.915693, 2.923936
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011881, 2.111467, 3.164267
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.011721, 2.215897, 3.569724
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009406, 2.297160, 3.365246
Train average loss all      (Triplet)                 : 0.009856

== Recognize ==
Train average loss Recognize     : 1.035907
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.212310

Epoch 55:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.796, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]          Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.796, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]Epoch 56:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.796, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]Epoch 56:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=0.918, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040] Epoch 56:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0061, Train/loss_recog_step=0.918, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]Epoch 56:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=1.070, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]Epoch 56:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=1.070, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]Epoch 56:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000646, Train/loss_recog_step=0.749, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]Epoch 56:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000646, Train/loss_recog_step=0.749, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]Epoch 56:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000186, Train/loss_recog_step=1.000, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]Epoch 56:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000186, Train/loss_recog_step=1.000, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]Epoch 56:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00342, Train/loss_recog_step=0.830, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040] Epoch 56:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.00342, Train/loss_recog_step=0.830, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]Epoch 56:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=1.210, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040] Epoch 56: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0184, Train/loss_recog_step=1.210, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]Epoch 56: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.776, Valid/loss_all_step=0.777, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.514, Valid/loss_recog_step=1.140, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.401, Valid/loss_recog_epoch=0.941, Valid/knn_avr=0.443, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.92it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.26it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.62it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.19it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.21it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070889, 0.070775, 0.070596
Valid average loss UNet            (all)              : 0.212260

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.181866, 2.655759, 4.348686
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.556803, 2.592376, 2.512266
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.485547, 2.587127, 2.661190
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.473655, 2.966294, 3.636831
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.332528, 3.067509, 3.743186
Valid average loss all      (Triplet)                 : 0.449565

== Recognize ==
Valid average loss Recognize     : 0.940373
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.661824

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.681225299835205 sec. =
Valid knn accuracy drums     : 78.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.012368440628052 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.147127389907837 sec. =
Valid knn accuracy piano     : 26.891891891891888%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.940483093261719 sec. =
Valid knn accuracy guitar    : 41.07142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.046422243118286 sec. =
Valid knn accuracy residuals : 55.660377358490564%

Valid knn accuracy average   : 43.36701042619531%

                                                                        [AEpoch 56: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.776, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00986, Train/loss_recog_epoch=1.040]Epoch 56: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.776, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]  

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067097, 0.066895, 0.068070
Train average loss UNet            (all)              : 0.202062

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003534, 2.364603, 4.477060
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011204, 2.031697, 3.102836
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011106, 2.200024, 3.296360
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009469, 2.310523, 3.711099
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009523, 2.401785, 3.540916
Train average loss all      (Triplet)                 : 0.009003

== Recognize ==
Train average loss Recognize     : 1.028333
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.211065

Epoch 56:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.776, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]          Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.776, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]Epoch 57:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.776, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]Epoch 57:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0179, Train/loss_recog_step=0.925, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]Epoch 57:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0179, Train/loss_recog_step=0.925, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]Epoch 57:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00875, Train/loss_recog_step=1.080, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]Epoch 57:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00875, Train/loss_recog_step=1.080, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]Epoch 57:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.763, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030] Epoch 57:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.763, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]Epoch 57:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000518, Train/loss_recog_step=1.020, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]Epoch 57:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000518, Train/loss_recog_step=1.020, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]Epoch 57:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]   Epoch 57:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]Epoch 57:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=1.230, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]Epoch 57: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=1.230, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]Epoch 57: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=4.47e-5, Train/loss_recog_step=0.801, Valid/loss_all_step=0.911, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.150, Valid/loss_all_epoch=0.662, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.450, Valid/loss_recog_epoch=0.940, Valid/knn_avr=0.434, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.48it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.21it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.57it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.78it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073128, 0.073180, 0.073381
Valid average loss UNet            (all)              : 0.219688

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.184191, 2.460266, 3.834598
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.497301, 2.438371, 2.371939
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.465246, 2.361024, 2.405641
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.467632, 2.635929, 3.300848
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.251716, 2.731716, 3.334157
Valid average loss all      (Triplet)                 : 0.406878

== Recognize ==
Valid average loss Recognize     : 0.956343
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.626566

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.671702146530151 sec. =
Valid knn accuracy drums     : 79.70588235294119%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.990048170089722 sec. =
Valid knn accuracy bass      : 13.953488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.18295407295227 sec. =
Valid knn accuracy piano     : 25.54054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.853317022323608 sec. =
Valid knn accuracy guitar    : 32.142857142857146%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.215753078460693 sec. =
Valid knn accuracy residuals : 52.20125786163522%

Valid knn accuracy average   : 40.70880525401342%

                                                                        [AEpoch 57: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=4.47e-5, Train/loss_recog_step=0.801, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.009, Train/loss_recog_epoch=1.030]Epoch 57: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=4.47e-5, Train/loss_recog_step=0.801, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067043, 0.066866, 0.068109
Train average loss UNet            (all)              : 0.202017

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002771, 2.350274, 4.340356
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013920, 2.011970, 3.081916
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011324, 2.191769, 3.276792
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009246, 2.266726, 3.671324
Train average loss residuals(Triplet, dist_p, dist_n) : 0.010057, 2.395395, 3.503599
Train average loss all      (Triplet)                 : 0.009600

== Recognize ==
Train average loss Recognize     : 1.040001
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.211617

Epoch 57:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=4.47e-5, Train/loss_recog_step=0.801, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]          Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=4.47e-5, Train/loss_recog_step=0.801, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]Epoch 58:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=4.47e-5, Train/loss_recog_step=0.801, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]Epoch 58:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00634, Train/loss_recog_step=0.928, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]Epoch 58:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00634, Train/loss_recog_step=0.928, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]Epoch 58:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00235, Train/loss_recog_step=1.100, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]Epoch 58:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00235, Train/loss_recog_step=1.100, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]Epoch 58:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.767, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040] Epoch 58:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.223, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0193, Train/loss_recog_step=0.767, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]Epoch 58:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=1.010, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]Epoch 58:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00319, Train/loss_recog_step=1.010, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]Epoch 58:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]  Epoch 58:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]Epoch 58:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0201, Train/loss_recog_step=1.230, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]Epoch 58: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.227, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0201, Train/loss_recog_step=1.230, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]Epoch 58: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.819, Valid/loss_unet_all_step=0.257, Valid/loss_triplet_all_step=0.562, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.627, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.407, Valid/loss_recog_epoch=0.956, Valid/knn_avr=0.407, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.31it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.98it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.29it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.33it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070460, 0.070144, 0.069739
Valid average loss UNet            (all)              : 0.210343

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.194742, 2.367791, 3.833508
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.356597, 2.211582, 2.365436
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.529804, 2.248810, 2.253816
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.277683, 2.372902, 2.975317
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.259978, 2.409609, 2.927740
Valid average loss all      (Triplet)                 : 0.335826

== Recognize ==
Valid average loss Recognize     : 0.958648
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.546169

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.697364091873169 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.10964035987854 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.002761602401733 sec. =
Valid knn accuracy piano     : 26.756756756756754%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.781789779663086 sec. =
Valid knn accuracy guitar    : 34.57792207792208%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.16522216796875 sec. =
Valid knn accuracy residuals : 53.77358490566038%

Valid knn accuracy average   : 42.22001116120054%

                                                                        [AEpoch 58: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.212, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0096, Train/loss_recog_epoch=1.040]Epoch 58: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.067046, 0.066824, 0.068074
Train average loss UNet            (all)              : 0.201944

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003929, 2.293836, 4.309309
Train average loss bass     (Triplet, dist_p, dist_n) : 0.014907, 1.995418, 3.069402
Train average loss piano    (Triplet, dist_p, dist_n) : 0.012383, 2.158059, 3.239905
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007078, 2.222574, 3.605599
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008021, 2.351129, 3.481500
Train average loss all      (Triplet)                 : 0.009089

== Recognize ==
Train average loss Recognize     : 1.047857
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.211033

Epoch 58:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]          Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.802, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=0.912, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=0.912, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=1.070, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=1.070, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.754, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00562, Train/loss_recog_step=0.754, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.010, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050] Epoch 59:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.010, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.834, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=0.834, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00677, Train/loss_recog_step=1.230, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00677, Train/loss_recog_step=1.230, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.577, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.343, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.546, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.336, Valid/loss_recog_epoch=0.959, Valid/knn_avr=0.422, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.74it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.51it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.26it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071208, 0.069791, 0.070222
Valid average loss UNet            (all)              : 0.211221

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.172437, 2.480533, 3.900342
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.481129, 2.426389, 2.351188
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.440960, 2.342597, 2.399197
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.531718, 2.722847, 3.025938
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.263536, 2.699830, 3.363206
Valid average loss all      (Triplet)                 : 0.417405

== Recognize ==
Valid average loss Recognize     : 0.971979
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.628626

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.797500610351562 sec. =
Valid knn accuracy drums     : 81.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.387333869934082 sec. =
Valid knn accuracy bass      : 21.511627906976745%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.269962549209595 sec. =
Valid knn accuracy piano     : 30.405405405405407%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.69710111618042 sec. =
Valid knn accuracy guitar    : 39.44805194805195%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.948659420013428 sec. =
Valid knn accuracy residuals : 55.0314465408805%

Valid knn accuracy average   : 45.63224753673351%

                                                                        [AEpoch 59: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.211, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.00909, Train/loss_recog_epoch=1.050]Epoch 59: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066886, 0.066692, 0.067924
Train average loss UNet            (all)              : 0.201502

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002717, 2.309048, 4.261467
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012045, 2.004495, 3.085814
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010509, 2.169798, 3.269234
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007318, 2.242410, 3.656106
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007377, 2.345485, 3.501964
Train average loss all      (Triplet)                 : 0.008205

== Recognize ==
Train average loss Recognize     : 1.039516
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.209707

Epoch 59:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]          Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]Epoch 60:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]Epoch 60:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.950, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]Epoch 60:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.950, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]Epoch 60:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.000867, Train/loss_recog_step=1.110, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]Epoch 60:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.209, Train/loss_triplet_all_step=0.000867, Train/loss_recog_step=1.110, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]Epoch 60:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00982, Train/loss_recog_step=0.776, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040] Epoch 60:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00982, Train/loss_recog_step=0.776, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]Epoch 60:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=1.030, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040] Epoch 60:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=1.030, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]Epoch 60:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00361, Train/loss_recog_step=0.843, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]Epoch 60:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00361, Train/loss_recog_step=0.843, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]Epoch 60:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]  Epoch 60: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]Epoch 60: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.801, Valid/loss_all_step=0.864, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.627, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.629, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.417, Valid/loss_recog_epoch=0.972, Valid/knn_avr=0.456, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.92it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.06it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.47it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.78it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.84it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073047, 0.072360, 0.072476
Valid average loss UNet            (all)              : 0.217883

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.164128, 2.577253, 3.908683
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.479878, 2.447557, 2.414234
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.418804, 2.518383, 2.666934
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.336318, 2.790044, 3.479315
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.265680, 2.940686, 3.573340
Valid average loss all      (Triplet)                 : 0.363081

== Recognize ==
Valid average loss Recognize     : 0.965058
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.580964

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.574631690979004 sec. =
Valid knn accuracy drums     : 80.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.634076356887817 sec. =
Valid knn accuracy bass      : 13.08139534883721%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.75846004486084 sec. =
Valid knn accuracy piano     : 22.83783783783784%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.80091643333435 sec. =
Valid knn accuracy guitar    : 32.467532467532465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.275116682052612 sec. =
Valid knn accuracy residuals : 51.41509433962265%

Valid knn accuracy average   : 40.078019057589565%

                                                                        [AEpoch 60: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.801, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.202, Train/loss_triplet_all_epoch=0.0082, Train/loss_recog_epoch=1.040]Epoch 60: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.801, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066829, 0.066593, 0.067844
Train average loss UNet            (all)              : 0.201266

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003922, 2.317360, 4.300346
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010976, 1.988634, 3.079775
Train average loss piano    (Triplet, dist_p, dist_n) : 0.010729, 2.172313, 3.253284
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008092, 2.252523, 3.624903
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007534, 2.379444, 3.540059
Train average loss all      (Triplet)                 : 0.008483

== Recognize ==
Train average loss Recognize     : 1.059129
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.209750

Epoch 60:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.801, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]          Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.801, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.801, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=0.946, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=0.946, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]  Epoch 61:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=0.766, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00243, Train/loss_recog_step=0.766, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=8.37e-5, Train/loss_recog_step=1.030, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=8.37e-5, Train/loss_recog_step=1.030, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00504, Train/loss_recog_step=0.852, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00504, Train/loss_recog_step=0.852, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00734, Train/loss_recog_step=1.240, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00734, Train/loss_recog_step=1.240, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=0.805, Valid/loss_all_step=0.723, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.470, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.581, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.363, Valid/loss_recog_epoch=0.965, Valid/knn_avr=0.401, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.24it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.49it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.89it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.75it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070962, 0.070473, 0.069896
Valid average loss UNet            (all)              : 0.211331

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.139322, 2.549002, 3.820164
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.447120, 2.549630, 2.562642
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.406847, 2.484120, 2.575505
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.459051, 2.762084, 3.411949
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.274889, 2.617999, 3.386856
Valid average loss all      (Triplet)                 : 0.372327

== Recognize ==
Valid average loss Recognize     : 0.974753
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.583658

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.678545713424683 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.218032836914062 sec. =
Valid knn accuracy bass      : 13.662790697674417%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.30083417892456 sec. =
Valid knn accuracy piano     : 29.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.680052042007446 sec. =
Valid knn accuracy guitar    : 37.66233766233766%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.270742177963257 sec. =
Valid knn accuracy residuals : 55.503144654088054%

Valid knn accuracy average   : 42.7821887840601%

                                                                        [AEpoch 61: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=0.805, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.210, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00848, Train/loss_recog_epoch=1.060]Epoch 61: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=0.805, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066788, 0.066521, 0.067801
Train average loss UNet            (all)              : 0.201110

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002726, 2.358124, 4.386708
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009315, 2.008636, 3.135789
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009335, 2.188566, 3.307422
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007729, 2.273975, 3.694692
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007463, 2.367841, 3.526771
Train average loss all      (Triplet)                 : 0.007418

== Recognize ==
Train average loss Recognize     : 1.054386
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.208528

Epoch 61:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=0.805, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]          Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=0.805, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]Epoch 62:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=0.805, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]Epoch 62:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00747, Train/loss_recog_step=0.945, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]Epoch 62:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00747, Train/loss_recog_step=0.945, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]Epoch 62:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00223, Train/loss_recog_step=1.090, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]Epoch 62:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00223, Train/loss_recog_step=1.090, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]Epoch 62:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.774, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050] Epoch 62:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.774, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]Epoch 62:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000413, Train/loss_recog_step=1.040, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]Epoch 62:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000413, Train/loss_recog_step=1.040, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]Epoch 62:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000656, Train/loss_recog_step=0.861, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]Epoch 62:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000656, Train/loss_recog_step=0.861, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]Epoch 62:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00771, Train/loss_recog_step=1.240, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050] Epoch 62: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00771, Train/loss_recog_step=1.240, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]Epoch 62: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.676, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.434, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.584, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.372, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.428, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.85it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.52it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.66it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.46it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.30it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071954, 0.071449, 0.070769
Valid average loss UNet            (all)              : 0.214172

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.131104, 2.589174, 3.954645
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.444999, 2.507845, 2.487237
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.479365, 2.435818, 2.433633
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.371454, 2.703241, 3.242287
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.291513, 2.794280, 3.482570
Valid average loss all      (Triplet)                 : 0.355358

== Recognize ==
Valid average loss Recognize     : 0.969810
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.569530

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.466011762619019 sec. =
Valid knn accuracy drums     : 82.6470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.380894899368286 sec. =
Valid knn accuracy bass      : 17.296511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.071060419082642 sec. =
Valid knn accuracy piano     : 29.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.969148397445679 sec. =
Valid knn accuracy guitar    : 28.40909090909091%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.006434679031372 sec. =
Valid knn accuracy residuals : 54.71698113207547%

Valid knn accuracy average   : 42.42473930933136%

                                                                        [AEpoch 62: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00742, Train/loss_recog_epoch=1.050]Epoch 62: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066712, 0.066531, 0.067718
Train average loss UNet            (all)              : 0.200961

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.003659, 2.541477, 4.637050
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009079, 2.186955, 3.409645
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009282, 2.391132, 3.591459
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009064, 2.474468, 4.019427
Train average loss residuals(Triplet, dist_p, dist_n) : 0.009135, 2.607965, 3.865867
Train average loss all      (Triplet)                 : 0.008232

== Recognize ==
Train average loss Recognize     : 1.058787
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.209193

Epoch 62:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]          Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]Epoch 63:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.794, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]Epoch 63:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=0.941, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]Epoch 63:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0218, Train/loss_recog_step=0.941, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]Epoch 63:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060] Epoch 63:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]Epoch 63:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00366, Train/loss_recog_step=0.775, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]Epoch 63:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00366, Train/loss_recog_step=0.775, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]Epoch 63:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=1.030, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]  Epoch 63:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.012, Train/loss_recog_step=1.030, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]Epoch 63:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00724, Train/loss_recog_step=0.851, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]Epoch 63:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00724, Train/loss_recog_step=0.851, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]Epoch 63:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000691, Train/loss_recog_step=1.250, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]Epoch 63: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000691, Train/loss_recog_step=1.250, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]Epoch 63: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.547, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=0.299, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.570, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.355, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.74it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.75it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.00it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.97it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.68it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070712, 0.069672, 0.069667
Valid average loss UNet            (all)              : 0.210051

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.144892, 2.555462, 4.189739
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.455295, 2.489184, 2.487311
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.408086, 2.409664, 2.528883
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.381813, 2.594438, 3.064545
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.258530, 2.675756, 3.560544
Valid average loss all      (Triplet)                 : 0.358380

== Recognize ==
Valid average loss Recognize     : 0.976120
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.568431

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.611195802688599 sec. =
Valid knn accuracy drums     : 80.88235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.196015119552612 sec. =
Valid knn accuracy bass      : 11.918604651162791%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.810070753097534 sec. =
Valid knn accuracy piano     : 28.10810810810811%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.17813515663147 sec. =
Valid knn accuracy guitar    : 37.17532467532468%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.045533418655396 sec. =
Valid knn accuracy residuals : 52.358490566037744%

Valid knn accuracy average   : 42.08857618836196%

                                                                        [AEpoch 63: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00823, Train/loss_recog_epoch=1.060]Epoch 63: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066719, 0.066530, 0.067662
Train average loss UNet            (all)              : 0.200911

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002613, 2.449494, 4.577157
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011507, 2.086794, 3.244032
Train average loss piano    (Triplet, dist_p, dist_n) : 0.011396, 2.280918, 3.438497
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008032, 2.352398, 3.835783
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008149, 2.452221, 3.617755
Train average loss all      (Triplet)                 : 0.008383

== Recognize ==
Train average loss Recognize     : 1.055262
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.209294

Epoch 63:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]          Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.798, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000878, Train/loss_recog_step=0.946, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000878, Train/loss_recog_step=0.946, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0152, Train/loss_recog_step=1.090, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]  Epoch 64:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0152, Train/loss_recog_step=1.090, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=0.767, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0162, Train/loss_recog_step=0.767, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.040, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00127, Train/loss_recog_step=1.040, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00707, Train/loss_recog_step=0.851, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00707, Train/loss_recog_step=0.851, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00576, Train/loss_recog_step=1.250, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00576, Train/loss_recog_step=1.250, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=0.811, Valid/loss_all_step=0.750, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.511, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.568, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.358, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.15it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.03it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.25it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.08it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.93it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071123, 0.070891, 0.070609
Valid average loss UNet            (all)              : 0.212623

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.131059, 2.452784, 3.891680
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.396410, 2.216803, 2.275059
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.493832, 2.266291, 2.251402
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.384550, 2.562515, 3.044240
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.261278, 2.593289, 3.291548
Valid average loss all      (Triplet)                 : 0.358812

== Recognize ==
Valid average loss Recognize     : 0.982805
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.571434

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.569133281707764 sec. =
Valid knn accuracy drums     : 81.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.234851121902466 sec. =
Valid knn accuracy bass      : 13.80813953488372%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.142196893692017 sec. =
Valid knn accuracy piano     : 24.594594594594597%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.699947118759155 sec. =
Valid knn accuracy guitar    : 37.82467532467532%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.139487028121948 sec. =
Valid knn accuracy residuals : 47.16981132075472%

Valid knn accuracy average   : 40.91473827262873%

                                                                        [AEpoch 64: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=0.811, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00838, Train/loss_recog_epoch=1.060]Epoch 64: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=0.811, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066585, 0.066404, 0.067632
Train average loss UNet            (all)              : 0.200621

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002307, 2.545470, 4.745808
Train average loss bass     (Triplet, dist_p, dist_n) : 0.013068, 2.179589, 3.370850
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007617, 2.387740, 3.607418
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007809, 2.433838, 3.948745
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007414, 2.563473, 3.795244
Train average loss all      (Triplet)                 : 0.007573

== Recognize ==
Train average loss Recognize     : 1.059390
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.208195

Epoch 64:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=0.811, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]          Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=0.811, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0164, Train/loss_recog_step=0.811, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0177, Train/loss_recog_step=0.960, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0177, Train/loss_recog_step=0.960, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00545, Train/loss_recog_step=1.110, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.210, Train/loss_triplet_all_step=0.00545, Train/loss_recog_step=1.110, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000903, Train/loss_recog_step=0.782, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000903, Train/loss_recog_step=0.782, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.050, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]  Epoch 65:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.050, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0079, Train/loss_recog_step=0.859, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0079, Train/loss_recog_step=0.859, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000435, Train/loss_recog_step=1.260, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000435, Train/loss_recog_step=1.260, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.693, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.457, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.571, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.359, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.409, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.45it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.30it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.54it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.07it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071825, 0.071608, 0.070935
Valid average loss UNet            (all)              : 0.214368

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.127766, 2.502527, 4.162646
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.538093, 2.585068, 2.519780
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.387065, 2.321957, 2.507197
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.468719, 2.809755, 3.273571
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.243002, 2.728022, 3.384682
Valid average loss all      (Triplet)                 : 0.396070

== Recognize ==
Valid average loss Recognize     : 0.990986
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.610439

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.512527465820312 sec. =
Valid knn accuracy drums     : 79.70588235294119%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.26827883720398 sec. =
Valid knn accuracy bass      : 11.046511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.36860990524292 sec. =
Valid knn accuracy piano     : 28.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.835792064666748 sec. =
Valid knn accuracy guitar    : 39.61038961038961%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.034115314483643 sec. =
Valid knn accuracy residuals : 51.57232704402516%

Valid knn accuracy average   : 42.06269780272825%

                                                                        [AEpoch 65: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.208, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00757, Train/loss_recog_epoch=1.060]Epoch 65: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066559, 0.066416, 0.067552
Train average loss UNet            (all)              : 0.200527

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002120, 2.405405, 4.489707
Train average loss bass     (Triplet, dist_p, dist_n) : 0.011130, 2.076845, 3.223342
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009523, 2.260243, 3.415567
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.008460, 2.360317, 3.814844
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008810, 2.459267, 3.643932
Train average loss all      (Triplet)                 : 0.008031

== Recognize ==
Train average loss Recognize     : 1.071785
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.208558

Epoch 65:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]          Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]Epoch 66:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.812, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]Epoch 66:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.965, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]Epoch 66:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.965, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]Epoch 66:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0401, Train/loss_recog_step=1.110, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]Epoch 66:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.246, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.0401, Train/loss_recog_step=1.110, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]Epoch 66:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00993, Train/loss_recog_step=0.774, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]Epoch 66:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.214, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00993, Train/loss_recog_step=0.774, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]Epoch 66:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=1.040, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070] Epoch 66:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0151, Train/loss_recog_step=1.040, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]Epoch 66:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00595, Train/loss_recog_step=0.860, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]Epoch 66:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00595, Train/loss_recog_step=0.860, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]Epoch 66:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0152, Train/loss_recog_step=1.250, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070] Epoch 66: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.216, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0152, Train/loss_recog_step=1.250, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]Epoch 66: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.799, Valid/loss_all_step=0.835, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.610, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.396, Valid/loss_recog_epoch=0.991, Valid/knn_avr=0.421, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.77it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.57it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.39it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.26it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070096, 0.069551, 0.069829
Valid average loss UNet            (all)              : 0.209477

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.130336, 2.585496, 4.065980
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.399864, 2.443164, 2.511921
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.527525, 2.437273, 2.442090
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.543801, 2.793681, 3.056442
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.284163, 2.755240, 3.202517
Valid average loss all      (Triplet)                 : 0.411456

== Recognize ==
Valid average loss Recognize     : 0.973615
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.620933

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.398974180221558 sec. =
Valid knn accuracy drums     : 82.79411764705881%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.358855962753296 sec. =
Valid knn accuracy bass      : 13.80813953488372%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.981298446655273 sec. =
Valid knn accuracy piano     : 23.783783783783786%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.939507246017456 sec. =
Valid knn accuracy guitar    : 37.82467532467532%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.992952585220337 sec. =
Valid knn accuracy residuals : 53.61635220125787%

Valid knn accuracy average   : 42.365413698331906%

                                                                        [AEpoch 66: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.799, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.201, Train/loss_triplet_all_epoch=0.00803, Train/loss_recog_epoch=1.070]Epoch 66: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.799, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066530, 0.066328, 0.067568
Train average loss UNet            (all)              : 0.200425

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002769, 2.549402, 4.753773
Train average loss bass     (Triplet, dist_p, dist_n) : 0.012013, 2.188889, 3.386113
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009796, 2.378255, 3.578501
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007801, 2.472455, 4.020747
Train average loss residuals(Triplet, dist_p, dist_n) : 0.008622, 2.611671, 3.860693
Train average loss all      (Triplet)                 : 0.008300

== Recognize ==
Train average loss Recognize     : 1.064540
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.208726

Epoch 66:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.799, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]          Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.799, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]Epoch 67:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.799, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]Epoch 67:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.954, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060] Epoch 67:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.954, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]Epoch 67:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00707, Train/loss_recog_step=1.100, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]Epoch 67:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00707, Train/loss_recog_step=1.100, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]Epoch 67:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00531, Train/loss_recog_step=0.781, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]Epoch 67:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00531, Train/loss_recog_step=0.781, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]Epoch 67:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=1.030, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]Epoch 67:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=1.030, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]Epoch 67:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]  Epoch 67:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.856, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]Epoch 67:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000767, Train/loss_recog_step=1.260, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]Epoch 67: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000767, Train/loss_recog_step=1.260, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]Epoch 67: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.890, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.655, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.621, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.424, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.41it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.63it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.12it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.26it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071696, 0.071053, 0.070906
Valid average loss UNet            (all)              : 0.213655

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.152883, 2.989975, 4.525149
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.624107, 2.941654, 2.870258
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.686690, 2.964863, 2.889326
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.376505, 3.104061, 3.884383
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.303836, 3.517410, 3.911757
Valid average loss all      (Triplet)                 : 0.472126

== Recognize ==
Valid average loss Recognize     : 0.982625
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.685781

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.73894190788269 sec. =
Valid knn accuracy drums     : 82.35294117647058%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.960620641708374 sec. =
Valid knn accuracy bass      : 13.953488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.592966794967651 sec. =
Valid knn accuracy piano     : 25.54054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.989955186843872 sec. =
Valid knn accuracy guitar    : 38.63636363636363%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.078807830810547 sec. =
Valid knn accuracy residuals : 55.0314465408805%

Valid knn accuracy average   : 43.10295605326965%

                                                                        [AEpoch 67: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.209, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.0083, Train/loss_recog_epoch=1.060]Epoch 67: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066422, 0.066225, 0.067387
Train average loss UNet            (all)              : 0.200034

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002793, 2.435164, 4.505044
Train average loss bass     (Triplet, dist_p, dist_n) : 0.010096, 2.111631, 3.304011
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009303, 2.268458, 3.483436
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006504, 2.390992, 3.895532
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004437, 2.469969, 3.682434
Train average loss all      (Triplet)                 : 0.006694

== Recognize ==
Train average loss Recognize     : 1.058453
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.206727

Epoch 67:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]          Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]Epoch 68:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]Epoch 68:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00793, Train/loss_recog_step=0.960, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]Epoch 68:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00793, Train/loss_recog_step=0.960, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]Epoch 68:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=1.110, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]Epoch 68:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=0.00368, Train/loss_recog_step=1.110, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]Epoch 68:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000989, Train/loss_recog_step=0.788, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]Epoch 68:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000989, Train/loss_recog_step=0.788, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]Epoch 68:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00865, Train/loss_recog_step=1.050, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060] Epoch 68:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00865, Train/loss_recog_step=1.050, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]Epoch 68:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]  Epoch 68:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]Epoch 68:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0141, Train/loss_recog_step=1.260, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]Epoch 68: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.0141, Train/loss_recog_step=1.260, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]Epoch 68: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=0.816, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.710, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.686, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.472, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.431, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.01it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.88it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.09it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.08it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.54it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071373, 0.071006, 0.071007
Valid average loss UNet            (all)              : 0.213387

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.110495, 2.551042, 4.113219
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.571783, 2.588971, 2.472599
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.468908, 2.496074, 2.427186
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.493226, 2.691921, 3.104024
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.291691, 2.904538, 3.388016
Valid average loss all      (Triplet)                 : 0.440222

== Recognize ==
Valid average loss Recognize     : 0.986303
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.653609

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.696114778518677 sec. =
Valid knn accuracy drums     : 81.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.341716527938843 sec. =
Valid knn accuracy bass      : 17.296511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.19543194770813 sec. =
Valid knn accuracy piano     : 27.432432432432428%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.67343544960022 sec. =
Valid knn accuracy guitar    : 35.714285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.120543241500854 sec. =
Valid knn accuracy residuals : 58.490566037735846%

Valid knn accuracy average   : 44.08087680953102%

                                                                        [AEpoch 68: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=0.816, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00669, Train/loss_recog_epoch=1.060]Epoch 68: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=0.816, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066404, 0.066185, 0.067356
Train average loss UNet            (all)              : 0.199945

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002605, 2.499367, 4.580055
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008831, 2.193310, 3.456540
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008989, 2.367073, 3.592895
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007469, 2.459332, 3.988903
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006624, 2.542167, 3.787313
Train average loss all      (Triplet)                 : 0.007036

== Recognize ==
Train average loss Recognize     : 1.074040
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.206981

Epoch 68:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=0.816, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]          Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=0.816, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]Epoch 69:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=0.816, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]Epoch 69:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070] Epoch 69:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]Epoch 69:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=3.84e-5, Train/loss_recog_step=1.110, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]Epoch 69:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.207, Train/loss_triplet_all_step=3.84e-5, Train/loss_recog_step=1.110, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]Epoch 69:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=0.776, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]Epoch 69:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00453, Train/loss_recog_step=0.776, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]Epoch 69:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]  Epoch 69:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]Epoch 69:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00677, Train/loss_recog_step=0.850, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]Epoch 69:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00677, Train/loss_recog_step=0.850, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]Epoch 69:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00546, Train/loss_recog_step=1.250, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]Epoch 69: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00546, Train/loss_recog_step=1.250, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]Epoch 69: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.815, Valid/loss_all_step=0.967, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.726, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.986, Valid/knn_avr=0.441, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.19it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.56it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.62it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.14it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.85it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071585, 0.070711, 0.070228
Valid average loss UNet            (all)              : 0.212523

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.181950, 3.107223, 4.598431
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.626848, 3.099559, 2.994174
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.549303, 2.795053, 2.783039
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.542372, 3.259310, 3.671613
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.282933, 3.412466, 3.950701
Valid average loss all      (Triplet)                 : 0.483021

== Recognize ==
Valid average loss Recognize     : 0.975763
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.695545

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.454701900482178 sec. =
Valid knn accuracy drums     : 79.11764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.51930570602417 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.120597839355469 sec. =
Valid knn accuracy piano     : 22.702702702702705%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.853651762008667 sec. =
Valid knn accuracy guitar    : 31.818181818181817%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.343346118927002 sec. =
Valid knn accuracy residuals : 55.0314465408805%

Valid knn accuracy average   : 40.78632120551306%

                                                                        [AEpoch 69: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.815, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00704, Train/loss_recog_epoch=1.070]Epoch 69: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.815, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066334, 0.066174, 0.067391
Train average loss UNet            (all)              : 0.199899

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002437, 2.552270, 4.707832
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008881, 2.237689, 3.483996
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009347, 2.397259, 3.672812
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.009837, 2.503008, 4.077128
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007349, 2.613600, 3.869463
Train average loss all      (Triplet)                 : 0.007451

== Recognize ==
Train average loss Recognize     : 1.066582
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.207350

Epoch 69:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.815, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]          Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.815, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]Epoch 70:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00816, Train/loss_recog_step=0.815, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]Epoch 70:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00503, Train/loss_recog_step=0.954, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]Epoch 70:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00503, Train/loss_recog_step=0.954, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]Epoch 70:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=1.110, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]Epoch 70:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=1.110, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]Epoch 70:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.778, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]  Epoch 70:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.778, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]Epoch 70:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000307, Train/loss_recog_step=1.040, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]Epoch 70:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000307, Train/loss_recog_step=1.040, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]Epoch 70:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.862, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]  Epoch 70:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=0.862, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]Epoch 70:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=1.260, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]Epoch 70: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00565, Train/loss_recog_step=1.260, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]Epoch 70: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.815, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.696, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=0.976, Valid/knn_avr=0.408, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.13it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.51it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.66it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.86it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070870, 0.070538, 0.069896
Valid average loss UNet            (all)              : 0.211304

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.113093, 3.000075, 4.881241
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.731234, 3.004012, 2.836758
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.639918, 2.951079, 2.883540
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.560554, 3.222779, 3.645861
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.341364, 3.252554, 3.893338
Valid average loss all      (Triplet)                 : 0.546978

== Recognize ==
Valid average loss Recognize     : 0.979610
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.758282

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.647575378417969 sec. =
Valid knn accuracy drums     : 81.61764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.338776350021362 sec. =
Valid knn accuracy bass      : 12.354651162790697%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.116389274597168 sec. =
Valid knn accuracy piano     : 24.054054054054056%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.669183492660522 sec. =
Valid knn accuracy guitar    : 39.77272727272727%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.971455335617065 sec. =
Valid knn accuracy residuals : 56.132075471698116%

Valid knn accuracy average   : 42.78623100401873%

                                                                        [AEpoch 70: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.815, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00745, Train/loss_recog_epoch=1.070]Epoch 70: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.815, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066342, 0.066083, 0.067288
Train average loss UNet            (all)              : 0.199713

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002695, 2.671822, 4.949028
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008379, 2.333642, 3.646392
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008439, 2.478858, 3.782080
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007560, 2.583651, 4.196091
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007468, 2.732486, 4.068261
Train average loss all      (Triplet)                 : 0.006874

== Recognize ==
Train average loss Recognize     : 1.072274
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.206587

Epoch 70:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.815, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]          Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.815, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0188, Train/loss_recog_step=0.815, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.949, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.949, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000554, Train/loss_recog_step=1.110, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.000554, Train/loss_recog_step=1.110, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.771, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]   Epoch 71:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.771, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=0.855, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00164, Train/loss_recog_step=0.855, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00541, Train/loss_recog_step=1.250, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00541, Train/loss_recog_step=1.250, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.758, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=0.980, Valid/knn_avr=0.428, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.17it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.37it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.46it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.60it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.43it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071478, 0.070504, 0.069628
Valid average loss UNet            (all)              : 0.211611

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.132619, 2.654165, 3.982130
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.703501, 2.858333, 2.736130
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.554458, 2.731231, 2.758658
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.357963, 2.850793, 3.344409
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.285361, 3.036669, 3.576526
Valid average loss all      (Triplet)                 : 0.465838

== Recognize ==
Valid average loss Recognize     : 0.975070
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.677449

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.46866488456726 sec. =
Valid knn accuracy drums     : 81.61764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.325771808624268 sec. =
Valid knn accuracy bass      : 13.80813953488372%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.1370108127594 sec. =
Valid knn accuracy piano     : 25.675675675675674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.95514988899231 sec. =
Valid knn accuracy guitar    : 33.92857142857143%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.665207862854004 sec. =
Valid knn accuracy residuals : 54.55974842767296%

Valid knn accuracy average   : 41.91795642512546%

                                                                        [AEpoch 71: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.207, Train/loss_unet_all_epoch=0.200, Train/loss_triplet_all_epoch=0.00687, Train/loss_recog_epoch=1.070]Epoch 71: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066206, 0.065977, 0.067233
Train average loss UNet            (all)              : 0.199415

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002679, 2.476719, 4.542982
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009945, 2.210794, 3.473387
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008144, 2.344081, 3.604073
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007091, 2.451702, 3.974066
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005497, 2.546777, 3.815419
Train average loss all      (Triplet)                 : 0.006793

== Recognize ==
Train average loss Recognize     : 1.065305
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.206209

Epoch 71:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]          Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]Epoch 72:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.816, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]Epoch 72:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00281, Train/loss_recog_step=0.948, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]Epoch 72:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00281, Train/loss_recog_step=0.948, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]Epoch 72:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=1.110, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070] Epoch 72:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.222, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.0145, Train/loss_recog_step=1.110, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]Epoch 72:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.776, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]Epoch 72:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0131, Train/loss_recog_step=0.776, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]Epoch 72:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000743, Train/loss_recog_step=1.040, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]Epoch 72:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000743, Train/loss_recog_step=1.040, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]Epoch 72:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.843, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070] Epoch 72:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00572, Train/loss_recog_step=0.843, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]Epoch 72:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]  Epoch 72: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]Epoch 72: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00318, Train/loss_recog_step=0.812, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.755, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.466, Valid/loss_recog_epoch=0.975, Valid/knn_avr=0.419, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.78it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.11it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.66it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.77it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070971, 0.071378, 0.069942
Valid average loss UNet            (all)              : 0.212292

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.170636, 2.723833, 4.152879
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.686167, 2.858101, 2.744144
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.503536, 2.814415, 2.804131
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.552507, 3.079582, 3.622402
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.344352, 3.252117, 3.631876
Valid average loss all      (Triplet)                 : 0.510293

== Recognize ==
Valid average loss Recognize     : 0.966133
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.722585

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.625487327575684 sec. =
Valid knn accuracy drums     : 80.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.044068574905396 sec. =
Valid knn accuracy bass      : 9.44767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.448291540145874 sec. =
Valid knn accuracy piano     : 25.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.006184339523315 sec. =
Valid knn accuracy guitar    : 38.311688311688314%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.084533452987671 sec. =
Valid knn accuracy residuals : 55.503144654088054%

Valid knn accuracy average   : 41.82658732743264%

                                                                        [AEpoch 72: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00318, Train/loss_recog_step=0.812, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.206, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00679, Train/loss_recog_epoch=1.070]Epoch 72: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00318, Train/loss_recog_step=0.812, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066095, 0.065812, 0.067073
Train average loss UNet            (all)              : 0.198981

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001499, 2.520196, 4.579503
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008386, 2.258956, 3.578845
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007534, 2.396362, 3.681710
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005359, 2.501427, 4.068676
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006395, 2.631005, 3.955838
Train average loss all      (Triplet)                 : 0.005883

== Recognize ==
Train average loss Recognize     : 1.066390
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.204863

Epoch 72:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00318, Train/loss_recog_step=0.812, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]          Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00318, Train/loss_recog_step=0.812, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]Epoch 73:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00318, Train/loss_recog_step=0.812, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]Epoch 73:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.0172, Train/loss_recog_step=0.933, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070] Epoch 73:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.0172, Train/loss_recog_step=0.933, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]Epoch 73:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00771, Train/loss_recog_step=1.100, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]Epoch 73:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.00771, Train/loss_recog_step=1.100, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]Epoch 73:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.774, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]Epoch 73:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=0.774, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]Epoch 73:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=1.050, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070] Epoch 73:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=1.050, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]Epoch 73:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00485, Train/loss_recog_step=0.858, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]Epoch 73:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00485, Train/loss_recog_step=0.858, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]Epoch 73:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000281, Train/loss_recog_step=1.250, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]Epoch 73: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000281, Train/loss_recog_step=1.250, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]Epoch 73: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000785, Train/loss_recog_step=0.820, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.867, Valid/loss_recog_step=1.170, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=0.966, Valid/knn_avr=0.418, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.15it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.72it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.34it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.78it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071440, 0.070691, 0.069382
Valid average loss UNet            (all)              : 0.211513

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.209388, 2.852907, 4.470511
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.460387, 2.890881, 3.030630
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.562505, 2.930089, 2.896677
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.438833, 2.962780, 3.591625
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.319101, 3.287485, 3.622581
Valid average loss all      (Triplet)                 : 0.411182

== Recognize ==
Valid average loss Recognize     : 0.969477
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.622695

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.564440965652466 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.311776876449585 sec. =
Valid knn accuracy bass      : 12.936046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.25960922241211 sec. =
Valid knn accuracy piano     : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.795651197433472 sec. =
Valid knn accuracy guitar    : 37.01298701298701%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.046919584274292 sec. =
Valid knn accuracy residuals : 52.20125786163522%

Valid knn accuracy average   : 41.10652886548532%

                                                                        [AEpoch 73: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000785, Train/loss_recog_step=0.820, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00588, Train/loss_recog_epoch=1.070]Epoch 73: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000785, Train/loss_recog_step=0.820, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.066030, 0.065830, 0.067020
Train average loss UNet            (all)              : 0.198879

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002030, 2.537653, 4.732697
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008391, 2.230396, 3.491095
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006260, 2.372157, 3.636680
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006692, 2.477068, 4.025740
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005675, 2.578679, 3.851028
Train average loss all      (Triplet)                 : 0.005847

== Recognize ==
Train average loss Recognize     : 1.068392
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.204726

Epoch 73:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000785, Train/loss_recog_step=0.820, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]          Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000785, Train/loss_recog_step=0.820, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]Epoch 74:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000785, Train/loss_recog_step=0.820, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]Epoch 74:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=0.938, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]  Epoch 74:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0207, Train/loss_recog_step=0.938, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]Epoch 74:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00548, Train/loss_recog_step=1.090, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]Epoch 74:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00548, Train/loss_recog_step=1.090, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]Epoch 74:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.767, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070] Epoch 74:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=0.767, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]Epoch 74:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=1.040, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]Epoch 74:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=1.040, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]Epoch 74:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0064, Train/loss_recog_step=0.856, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]Epoch 74:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.0064, Train/loss_recog_step=0.856, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]Epoch 74:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00215, Train/loss_recog_step=1.250, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]Epoch 74: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00215, Train/loss_recog_step=1.250, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]Epoch 74: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.814, Valid/loss_all_step=0.679, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.433, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.623, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.411, Valid/loss_recog_epoch=0.969, Valid/knn_avr=0.411, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.77it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.11it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.39it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.29it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.43it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.92it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070470, 0.069993, 0.069604
Valid average loss UNet            (all)              : 0.210067

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.157045, 2.478570, 3.972640
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.527897, 2.496866, 2.481458
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.512105, 2.484671, 2.416453
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.453485, 2.808934, 3.288917
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.281534, 2.861905, 3.396275
Valid average loss all      (Triplet)                 : 0.427383

== Recognize ==
Valid average loss Recognize     : 0.974397
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.637450

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.692262649536133 sec. =
Valid knn accuracy drums     : 80.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.623545169830322 sec. =
Valid knn accuracy bass      : 12.354651162790697%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.305455684661865 sec. =
Valid knn accuracy piano     : 30.405405405405407%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.872127056121826 sec. =
Valid knn accuracy guitar    : 39.77272727272727%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.999947547912598 sec. =
Valid knn accuracy residuals : 61.63522012578616%

Valid knn accuracy average   : 44.86301255804779%

                                                                        [AEpoch 74: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.814, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00585, Train/loss_recog_epoch=1.070]Epoch 74: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.814, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065991, 0.065816, 0.066949
Train average loss UNet            (all)              : 0.198756

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002390, 2.541939, 4.757741
Train average loss bass     (Triplet, dist_p, dist_n) : 0.009951, 2.256208, 3.564162
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005968, 2.409262, 3.717335
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007491, 2.490787, 4.013247
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006102, 2.617619, 3.925558
Train average loss all      (Triplet)                 : 0.006411

== Recognize ==
Train average loss Recognize     : 1.061164
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.205167

Epoch 74:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.814, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]          Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.814, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]Epoch 75:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.814, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]Epoch 75:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000875, Train/loss_recog_step=0.949, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]Epoch 75:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000875, Train/loss_recog_step=0.949, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]Epoch 75:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=1.110, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]  Epoch 75:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0171, Train/loss_recog_step=1.110, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]Epoch 75:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.779, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060] Epoch 75:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.779, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]Epoch 75:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]Epoch 75:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]Epoch 75:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]Epoch 75:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]Epoch 75:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00504, Train/loss_recog_step=1.270, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]Epoch 75: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00504, Train/loss_recog_step=1.270, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]Epoch 75: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000775, Train/loss_recog_step=0.818, Valid/loss_all_step=0.876, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.637, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.427, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.449, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.20it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.74it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.61it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.82it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.48it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070033, 0.069739, 0.069504
Valid average loss UNet            (all)              : 0.209275

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.200126, 2.436302, 3.938479
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.463883, 2.411097, 2.459379
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.424515, 2.396312, 2.532433
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.449936, 2.641837, 3.213929
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.188670, 2.693087, 3.462330
Valid average loss all      (Triplet)                 : 0.382058

== Recognize ==
Valid average loss Recognize     : 0.989496
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.591334

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.70219898223877 sec. =
Valid knn accuracy drums     : 80.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.006962299346924 sec. =
Valid knn accuracy bass      : 11.627906976744185%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.428625106811523 sec. =
Valid knn accuracy piano     : 29.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.835146188735962 sec. =
Valid knn accuracy guitar    : 37.17532467532468%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.08828592300415 sec. =
Valid knn accuracy residuals : 54.24528301886793%

Valid knn accuracy average   : 42.56757256852758%

                                                                        [AEpoch 75: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000775, Train/loss_recog_step=0.818, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.199, Train/loss_triplet_all_epoch=0.00641, Train/loss_recog_epoch=1.060]Epoch 75: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000775, Train/loss_recog_step=0.818, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065882, 0.065635, 0.066854
Train average loss UNet            (all)              : 0.198371

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001391, 2.473989, 4.627045
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007447, 2.200933, 3.484042
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007049, 2.368440, 3.648938
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.006365, 2.477284, 4.041978
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005643, 2.584986, 3.920339
Train average loss all      (Triplet)                 : 0.005707

== Recognize ==
Train average loss Recognize     : 1.071436
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.204078

Epoch 75:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000775, Train/loss_recog_step=0.818, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]          Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000775, Train/loss_recog_step=0.818, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]Epoch 76:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000775, Train/loss_recog_step=0.818, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]Epoch 76:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.963, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]  Epoch 76:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0123, Train/loss_recog_step=0.963, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]Epoch 76:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0084, Train/loss_recog_step=1.110, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]Epoch 76:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.0084, Train/loss_recog_step=1.110, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]Epoch 76:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070] Epoch 76:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.781, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]Epoch 76:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=1.050, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]Epoch 76:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0017, Train/loss_recog_step=1.050, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]Epoch 76:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000494, Train/loss_recog_step=0.860, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]Epoch 76:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000494, Train/loss_recog_step=0.860, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]Epoch 76:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=1.240, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070] Epoch 76: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=1.240, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]Epoch 76: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.771, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.532, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.591, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.382, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.426, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.83it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.69it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.31it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069959, 0.069565, 0.068728
Valid average loss UNet            (all)              : 0.208252

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.230533, 2.759914, 4.257530
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.467080, 2.685019, 2.790947
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.512454, 2.734972, 2.849830
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.488224, 3.092745, 3.562377
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.281827, 2.921982, 3.918292
Valid average loss all      (Triplet)                 : 0.424129

== Recognize ==
Valid average loss Recognize     : 0.970278
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.632381

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.487709999084473 sec. =
Valid knn accuracy drums     : 83.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.163259506225586 sec. =
Valid knn accuracy bass      : 13.08139534883721%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.203651905059814 sec. =
Valid knn accuracy piano     : 29.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.07448410987854 sec. =
Valid knn accuracy guitar    : 45.77922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.820543050765991 sec. =
Valid knn accuracy residuals : 57.07547169811321%

Valid knn accuracy average   : 45.868457628827244%

                                                                        [AEpoch 76: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00571, Train/loss_recog_epoch=1.070]Epoch 76: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065740, 0.065588, 0.066764
Train average loss UNet            (all)              : 0.198093

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001766, 2.441456, 4.587581
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007571, 2.191336, 3.431813
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007443, 2.341664, 3.608051
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004925, 2.408062, 3.932285
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005355, 2.577673, 3.899817
Train average loss all      (Triplet)                 : 0.005539

== Recognize ==
Train average loss Recognize     : 1.072213
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.203631

Epoch 76:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]          Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]Epoch 77:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.808, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]Epoch 77:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00118, Train/loss_recog_step=0.942, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]Epoch 77:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00118, Train/loss_recog_step=0.942, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]Epoch 77:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]  Epoch 77:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]Epoch 77:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.769, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]Epoch 77:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0206, Train/loss_recog_step=0.769, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]Epoch 77:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=1.040, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]Epoch 77:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=1.040, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]Epoch 77:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00151, Train/loss_recog_step=0.852, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]Epoch 77:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00151, Train/loss_recog_step=0.852, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]Epoch 77:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=1.250, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070] Epoch 77: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.215, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0168, Train/loss_recog_step=1.250, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]Epoch 77: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000165, Train/loss_recog_step=0.813, Valid/loss_all_step=0.762, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.523, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.632, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.424, Valid/loss_recog_epoch=0.970, Valid/knn_avr=0.459, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.57it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.41it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.33it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.99it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071039, 0.070656, 0.069881
Valid average loss UNet            (all)              : 0.211577

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.189095, 2.617437, 4.103958
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.485309, 2.755348, 2.866542
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.687274, 2.748387, 2.687362
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.372247, 2.842148, 3.547088
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.236906, 2.873828, 3.883736
Valid average loss all      (Triplet)                 : 0.429670

== Recognize ==
Valid average loss Recognize     : 0.971215
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.641247

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.39383840560913 sec. =
Valid knn accuracy drums     : 80.88235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.37405514717102 sec. =
Valid knn accuracy bass      : 12.354651162790697%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.120063781738281 sec. =
Valid knn accuracy piano     : 27.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.955286264419556 sec. =
Valid knn accuracy guitar    : 45.2922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.152837038040161 sec. =
Valid knn accuracy residuals : 55.188679245283026%

Valid knn accuracy average   : 44.25709174180511%

                                                                        [AEpoch 77: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000165, Train/loss_recog_step=0.813, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00554, Train/loss_recog_epoch=1.070]Epoch 77: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000165, Train/loss_recog_step=0.813, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065829, 0.065529, 0.066702
Train average loss UNet            (all)              : 0.198060

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001988, 2.533512, 4.734493
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007766, 2.316875, 3.642075
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007581, 2.463891, 3.776774
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007073, 2.542694, 4.128340
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005438, 2.681426, 4.058743
Train average loss all      (Triplet)                 : 0.006055

== Recognize ==
Train average loss Recognize     : 1.062147
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.204115

Epoch 77:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000165, Train/loss_recog_step=0.813, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]          Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000165, Train/loss_recog_step=0.813, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]Epoch 78:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000165, Train/loss_recog_step=0.813, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]Epoch 78:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]   Epoch 78:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]Epoch 78:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.110, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]Epoch 78:  48%|████▊     | 150/313 [02:17<02:28,  1.09it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=1.110, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]Epoch 78:  48%|████▊     | 150/313 [02:17<02:28,  1.09it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00683, Train/loss_recog_step=0.781, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]Epoch 78:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00683, Train/loss_recog_step=0.781, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]Epoch 78:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000687, Train/loss_recog_step=1.060, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]Epoch 78:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000687, Train/loss_recog_step=1.060, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]Epoch 78:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00124, Train/loss_recog_step=0.859, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060] Epoch 78:  96%|█████████▌| 300/313 [04:31<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00124, Train/loss_recog_step=0.859, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]Epoch 78:  96%|█████████▌| 300/313 [04:31<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=1.270, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]Epoch 78: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=1.270, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]Epoch 78: 100%|██████████| 313/313 [04:41<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.825, Valid/loss_all_step=0.837, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.607, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.641, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.430, Valid/loss_recog_epoch=0.971, Valid/knn_avr=0.443, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.80it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.91it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.47it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071025, 0.071289, 0.069652
Valid average loss UNet            (all)              : 0.211966

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.191629, 2.783120, 4.277078
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.572083, 2.883464, 2.869272
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.694817, 3.048967, 3.007615
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.369433, 3.089290, 3.795882
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.298623, 3.350363, 3.813349
Valid average loss all      (Triplet)                 : 0.459200

== Recognize ==
Valid average loss Recognize     : 0.983283
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.671166

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.817338228225708 sec. =
Valid knn accuracy drums     : 81.61764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.19658637046814 sec. =
Valid knn accuracy bass      : 15.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.240654706954956 sec. =
Valid knn accuracy piano     : 27.972972972972972%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.694661378860474 sec. =
Valid knn accuracy guitar    : 45.616883116883116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.196784734725952 sec. =
Valid knn accuracy residuals : 49.056603773584904%

Valid knn accuracy average   : 44.02142603561569%

                                                                        [AEpoch 78: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.825, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00605, Train/loss_recog_epoch=1.060]Epoch 78: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.825, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065753, 0.065522, 0.066732
Train average loss UNet            (all)              : 0.198006

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001429, 2.558119, 4.807962
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008105, 2.307573, 3.658508
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007796, 2.477992, 3.778711
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007226, 2.530235, 4.116742
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005958, 2.688187, 4.035393
Train average loss all      (Triplet)                 : 0.006109

== Recognize ==
Train average loss Recognize     : 1.072403
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.204115

Epoch 78:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.825, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]          Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.825, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]Epoch 79:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=0.825, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]Epoch 79:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.950, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]Epoch 79:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=0.950, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]Epoch 79:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070] Epoch 79:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]Epoch 79:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.775, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]Epoch 79:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.218, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0194, Train/loss_recog_step=0.775, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]Epoch 79:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=1.040, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]Epoch 79:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0183, Train/loss_recog_step=1.040, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]Epoch 79:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00988, Train/loss_recog_step=0.846, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]Epoch 79:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00988, Train/loss_recog_step=0.846, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]Epoch 79:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]  Epoch 79: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]Epoch 79: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=0.827, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.578, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.212, Valid/loss_triplet_all_epoch=0.459, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.440, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.11it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.12it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.33it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.48it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.14it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069865, 0.069651, 0.068901
Valid average loss UNet            (all)              : 0.208418

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.233944, 2.577425, 4.196249
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.545400, 2.609332, 2.630952
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.524732, 2.590944, 2.612905
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.495431, 2.864231, 3.309175
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.255407, 2.865856, 3.573543
Valid average loss all      (Triplet)                 : 0.462804

== Recognize ==
Valid average loss Recognize     : 0.983344
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.671223

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.852582931518555 sec. =
Valid knn accuracy drums     : 83.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.274660348892212 sec. =
Valid knn accuracy bass      : 22.819767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.271845817565918 sec. =
Valid knn accuracy piano     : 27.027027027027028%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.654613256454468 sec. =
Valid knn accuracy guitar    : 45.2922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.285248279571533 sec. =
Valid knn accuracy residuals : 52.987421383647806%

Valid knn accuracy average   : 46.38999061130156%

                                                                        [AEpoch 79: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.204, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00611, Train/loss_recog_epoch=1.070]Epoch 79: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065787, 0.065520, 0.066720
Train average loss UNet            (all)              : 0.198027

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002545, 2.595871, 4.813204
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007836, 2.323103, 3.653212
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008723, 2.494506, 3.803444
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.007112, 2.578176, 4.203717
Train average loss residuals(Triplet, dist_p, dist_n) : 0.007337, 2.709758, 4.044844
Train average loss all      (Triplet)                 : 0.006861

== Recognize ==
Train average loss Recognize     : 1.073992
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.204888

Epoch 79:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]          Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.820, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00877, Train/loss_recog_step=0.951, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00877, Train/loss_recog_step=0.951, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00611, Train/loss_recog_step=1.120, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.211, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.00611, Train/loss_recog_step=1.120, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=0.786, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00222, Train/loss_recog_step=0.786, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00279, Train/loss_recog_step=1.050, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00279, Train/loss_recog_step=1.050, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0086, Train/loss_recog_step=0.862, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070] Epoch 80:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0086, Train/loss_recog_step=0.862, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00446, Train/loss_recog_step=1.270, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00446, Train/loss_recog_step=1.270, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00352, Train/loss_recog_step=0.823, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.772, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.463, Valid/loss_recog_epoch=0.983, Valid/knn_avr=0.464, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.98it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.90it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.85it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.63it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.10it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070721, 0.069985, 0.069611
Valid average loss UNet            (all)              : 0.210317

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.228456, 2.676043, 4.196327
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.493186, 2.672519, 2.752943
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.502992, 2.582645, 2.659158
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.431345, 2.743003, 3.486297
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.317670, 2.926790, 3.652926
Valid average loss all      (Triplet)                 : 0.420359

== Recognize ==
Valid average loss Recognize     : 0.987032
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.630676

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.563128471374512 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.295269250869751 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.187352657318115 sec. =
Valid knn accuracy piano     : 29.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.746567487716675 sec. =
Valid knn accuracy guitar    : 42.6948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.091038942337036 sec. =
Valid knn accuracy residuals : 49.84276729559748%

Valid knn accuracy average   : 43.4192607176243%

                                                                        [AEpoch 80: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00352, Train/loss_recog_step=0.823, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.205, Train/loss_unet_all_epoch=0.198, Train/loss_triplet_all_epoch=0.00686, Train/loss_recog_epoch=1.070]Epoch 80: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00352, Train/loss_recog_step=0.823, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065552, 0.065285, 0.066591
Train average loss UNet            (all)              : 0.197429

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001600, 2.494603, 4.696066
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007491, 2.230951, 3.508218
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005946, 2.375328, 3.653618
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005931, 2.442555, 3.977619
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004798, 2.594817, 3.917208
Train average loss all      (Triplet)                 : 0.005192

== Recognize ==
Train average loss Recognize     : 1.078290
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.202621

Epoch 80:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00352, Train/loss_recog_step=0.823, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]          Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00352, Train/loss_recog_step=0.823, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00352, Train/loss_recog_step=0.823, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00025, Train/loss_recog_step=0.962, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00025, Train/loss_recog_step=0.962, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=1.120, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=1.120, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=0.780, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=0.780, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00341, Train/loss_recog_step=1.050, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00341, Train/loss_recog_step=1.050, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000384, Train/loss_recog_step=0.858, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000384, Train/loss_recog_step=0.858, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00447, Train/loss_recog_step=1.260, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080] Epoch 81: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00447, Train/loss_recog_step=1.260, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00225, Train/loss_recog_step=0.822, Valid/loss_all_step=0.688, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.452, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.631, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.420, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.78it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.64it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.07it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.34it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.37it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069634, 0.069776, 0.069041
Valid average loss UNet            (all)              : 0.208451

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.201098, 2.740337, 4.398534
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.480210, 2.789305, 2.878318
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.567741, 2.682673, 2.661855
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.511709, 2.986364, 3.690418
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.334646, 3.206764, 3.921702
Valid average loss all      (Triplet)                 : 0.445840

== Recognize ==
Valid average loss Recognize     : 0.986748
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.654290

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.505667686462402 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.252938032150269 sec. =
Valid knn accuracy bass      : 12.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.156483173370361 sec. =
Valid knn accuracy piano     : 27.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.916188955307007 sec. =
Valid knn accuracy guitar    : 38.311688311688314%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.023347854614258 sec. =
Valid knn accuracy residuals : 52.67295597484277%

Valid knn accuracy average   : 42.2692659002315%

                                                                        [AEpoch 81: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00225, Train/loss_recog_step=0.822, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00519, Train/loss_recog_epoch=1.080]Epoch 81: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00225, Train/loss_recog_step=0.822, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065557, 0.065327, 0.066545
Train average loss UNet            (all)              : 0.197429

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001274, 2.628839, 4.889072
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008208, 2.379837, 3.751939
Train average loss piano    (Triplet, dist_p, dist_n) : 0.009050, 2.504491, 3.856754
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005832, 2.574477, 4.187609
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005590, 2.735274, 4.106533
Train average loss all      (Triplet)                 : 0.005954

== Recognize ==
Train average loss Recognize     : 1.078235
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.203383

Epoch 81:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00225, Train/loss_recog_step=0.822, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]          Epoch 82:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00225, Train/loss_recog_step=0.822, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]Epoch 82:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00225, Train/loss_recog_step=0.822, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]Epoch 82:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.955, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080] Epoch 82:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.0111, Train/loss_recog_step=0.955, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]Epoch 82:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080] Epoch 82:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]Epoch 82:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.778, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]Epoch 82:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.778, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]Epoch 82:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00229, Train/loss_recog_step=1.040, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]Epoch 82:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00229, Train/loss_recog_step=1.040, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]Epoch 82:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00535, Train/loss_recog_step=0.860, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]Epoch 82:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00535, Train/loss_recog_step=0.860, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]Epoch 82:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=1.270, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080] Epoch 82: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0101, Train/loss_recog_step=1.270, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]Epoch 82: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.803, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.568, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.76it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.01it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.33it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.41it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070023, 0.069729, 0.068355
Valid average loss UNet            (all)              : 0.208107

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.145972, 2.735987, 4.524960
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.599602, 2.795602, 2.815977
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.553056, 2.752101, 2.739533
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.391650, 2.955189, 3.733750
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.277945, 3.069354, 3.651212
Valid average loss all      (Triplet)                 : 0.446296

== Recognize ==
Valid average loss Recognize     : 0.983614
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.654403

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.611564636230469 sec. =
Valid knn accuracy drums     : 81.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.215469121932983 sec. =
Valid knn accuracy bass      : 16.13372093023256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.374417543411255 sec. =
Valid knn accuracy piano     : 27.837837837837835%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.620731830596924 sec. =
Valid knn accuracy guitar    : 38.63636363636363%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.149919509887695 sec. =
Valid knn accuracy residuals : 53.459119496855344%

Valid knn accuracy average   : 43.44870249790493%

                                                                        [AEpoch 82: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00595, Train/loss_recog_epoch=1.080]Epoch 82: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065456, 0.065287, 0.066442
Train average loss UNet            (all)              : 0.197185

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002326, 2.540450, 4.805357
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007693, 2.259804, 3.572963
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007099, 2.426876, 3.755105
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005044, 2.500278, 4.102524
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005643, 2.627080, 3.952014
Train average loss all      (Triplet)                 : 0.005676

== Recognize ==
Train average loss Recognize     : 1.073798
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.202861

Epoch 82:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]          Epoch 83:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.824, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.956, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.956, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000663, Train/loss_recog_step=0.784, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.000663, Train/loss_recog_step=0.784, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=1.060, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]   Epoch 83:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=1.060, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=0.872, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0119, Train/loss_recog_step=0.872, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000231, Train/loss_recog_step=1.280, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000231, Train/loss_recog_step=1.280, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.835, Valid/loss_all_step=0.930, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.693, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.654, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.446, Valid/loss_recog_epoch=0.984, Valid/knn_avr=0.434, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.78it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.88it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.86it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.50it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069838, 0.069964, 0.068557
Valid average loss UNet            (all)              : 0.208359

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.165941, 2.635768, 4.411921
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.554710, 2.847988, 2.968276
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.571398, 2.612549, 2.629872
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.397189, 2.755735, 3.364336
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.269625, 2.900653, 3.399406
Valid average loss all      (Triplet)                 : 0.429284

== Recognize ==
Valid average loss Recognize     : 0.993404
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.637644

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.830883741378784 sec. =
Valid knn accuracy drums     : 81.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.92270040512085 sec. =
Valid knn accuracy bass      : 17.87790697674419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.006518125534058 sec. =
Valid knn accuracy piano     : 29.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.719710111618042 sec. =
Valid knn accuracy guitar    : 40.0974025974026%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.137129783630371 sec. =
Valid knn accuracy residuals : 52.67295597484277%

Valid knn accuracy average   : 44.146346273549895%

                                                                        [AEpoch 83: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.835, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00568, Train/loss_recog_epoch=1.070]Epoch 83: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.835, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065423, 0.065163, 0.066463
Train average loss UNet            (all)              : 0.197050

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001788, 2.672070, 5.070121
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007211, 2.401455, 3.821070
Train average loss piano    (Triplet, dist_p, dist_n) : 0.008284, 2.528980, 3.891187
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004463, 2.609596, 4.276769
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005762, 2.783316, 4.168712
Train average loss all      (Triplet)                 : 0.005458

== Recognize ==
Train average loss Recognize     : 1.082874
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.202508

Epoch 83:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.835, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]          Epoch 84:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.835, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]Epoch 84:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.835, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]Epoch 84:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=0.976, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]Epoch 84:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=0.976, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]Epoch 84:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]  Epoch 84:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]Epoch 84:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000221, Train/loss_recog_step=0.794, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]Epoch 84:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000221, Train/loss_recog_step=0.794, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]Epoch 84:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]   Epoch 84:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]Epoch 84:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=0.884, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]Epoch 84:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.0137, Train/loss_recog_step=0.884, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]Epoch 84:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00875, Train/loss_recog_step=1.270, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]Epoch 84: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00875, Train/loss_recog_step=1.270, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]Epoch 84: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.775, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.535, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.638, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.429, Valid/loss_recog_epoch=0.993, Valid/knn_avr=0.441, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.88it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.97it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.43it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.99it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.34it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070030, 0.069890, 0.068298
Valid average loss UNet            (all)              : 0.208218

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.161855, 3.026635, 4.908360
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.510323, 3.113034, 3.278073
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.506827, 2.901017, 2.968231
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.407744, 3.106647, 3.921135
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.350325, 3.372827, 4.023957
Valid average loss all      (Triplet)                 : 0.416413

== Recognize ==
Valid average loss Recognize     : 0.987163
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.624631

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.690294027328491 sec. =
Valid knn accuracy drums     : 80.88235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.644032001495361 sec. =
Valid knn accuracy bass      : 12.936046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.286789894104004 sec. =
Valid knn accuracy piano     : 28.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.876134634017944 sec. =
Valid knn accuracy guitar    : 37.17532467532468%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.25446605682373 sec. =
Valid knn accuracy residuals : 55.9748427672956%

Valid knn accuracy average   : 43.069389054760606%

                                                                        [AEpoch 84: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00546, Train/loss_recog_epoch=1.080]Epoch 84: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065444, 0.065129, 0.066352
Train average loss UNet            (all)              : 0.196925

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001916, 2.789880, 5.203480
Train average loss bass     (Triplet, dist_p, dist_n) : 0.008544, 2.491788, 3.944518
Train average loss piano    (Triplet, dist_p, dist_n) : 0.007497, 2.635386, 4.047976
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004534, 2.728576, 4.416337
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006499, 2.878066, 4.319000
Train average loss all      (Triplet)                 : 0.005899

== Recognize ==
Train average loss Recognize     : 1.091878
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.202823

Epoch 84:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]          Epoch 85:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00189, Train/loss_recog_step=0.954, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00189, Train/loss_recog_step=0.954, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00886, Train/loss_recog_step=1.120, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.210, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.00886, Train/loss_recog_step=1.120, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=0.783, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=0.783, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=1.060, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00144, Train/loss_recog_step=1.060, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00592, Train/loss_recog_step=0.872, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00592, Train/loss_recog_step=0.872, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000221, Train/loss_recog_step=1.270, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000221, Train/loss_recog_step=1.270, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.742, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.506, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.625, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.416, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.431, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.87it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.01it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.51it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.67it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069515, 0.069701, 0.068245
Valid average loss UNet            (all)              : 0.207460

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.142229, 2.645896, 4.212743
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.490687, 2.639920, 2.722308
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.599670, 2.657548, 2.615531
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.452953, 2.801703, 3.375381
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.292594, 3.104561, 3.521633
Valid average loss all      (Triplet)                 : 0.427823

== Recognize ==
Valid average loss Recognize     : 0.988047
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.635284

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.542200088500977 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.278856992721558 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.064669132232666 sec. =
Valid knn accuracy piano     : 25.54054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.826668739318848 sec. =
Valid knn accuracy guitar    : 39.285714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.218928575515747 sec. =
Valid knn accuracy residuals : 53.61635220125787%

Valid knn accuracy average   : 42.32874028375151%

                                                                        [AEpoch 85: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.203, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.0059, Train/loss_recog_epoch=1.090]Epoch 85: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065277, 0.065007, 0.066250
Train average loss UNet            (all)              : 0.196534

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001540, 2.796845, 5.215679
Train average loss bass     (Triplet, dist_p, dist_n) : 0.007852, 2.485532, 3.968637
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005281, 2.637676, 4.088442
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004234, 2.726252, 4.457358
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005042, 2.828431, 4.271986
Train average loss all      (Triplet)                 : 0.004939

== Recognize ==
Train average loss Recognize     : 1.083012
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.201473

Epoch 85:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]          Epoch 86:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]Epoch 86:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]Epoch 86:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0088, Train/loss_recog_step=0.962, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]Epoch 86:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0088, Train/loss_recog_step=0.962, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]Epoch 86:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080] Epoch 86:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]Epoch 86:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.785, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]Epoch 86:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0116, Train/loss_recog_step=0.785, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]Epoch 86:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080] Epoch 86:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]Epoch 86:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]Epoch 86:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]Epoch 86:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=1.270, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]Epoch 86: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.0016, Train/loss_recog_step=1.270, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]Epoch 86: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.823, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.593, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.635, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.428, Valid/loss_recog_epoch=0.988, Valid/knn_avr=0.423, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.99it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.23it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.58it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.73it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.52it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070422, 0.070890, 0.068627
Valid average loss UNet            (all)              : 0.209939

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.173400, 2.922324, 4.359960
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.615208, 3.085562, 3.024748
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.647218, 3.086028, 2.964183
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.508970, 3.230318, 3.932581
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.292224, 3.393709, 4.285695
Valid average loss all      (Triplet)                 : 0.490591

== Recognize ==
Valid average loss Recognize     : 0.987119
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.700530

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.678056955337524 sec. =
Valid knn accuracy drums     : 77.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.33311128616333 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.147928237915039 sec. =
Valid knn accuracy piano     : 29.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.826741218566895 sec. =
Valid knn accuracy guitar    : 36.688311688311686%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.194907188415527 sec. =
Valid knn accuracy residuals : 56.44654088050315%

Valid knn accuracy average   : 43.33281589402695%

                                                                        [AEpoch 86: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00494, Train/loss_recog_epoch=1.080]Epoch 86: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065311, 0.065037, 0.066225
Train average loss UNet            (all)              : 0.196573

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001481, 2.776230, 5.224784
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006417, 2.484345, 3.948237
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004630, 2.611481, 4.053217
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005446, 2.694388, 4.459795
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005194, 2.847480, 4.301967
Train average loss all      (Triplet)                 : 0.004686

== Recognize ==
Train average loss Recognize     : 1.080822
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.201259

Epoch 86:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]          Epoch 87:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00635, Train/loss_recog_step=0.959, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00635, Train/loss_recog_step=0.959, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000672, Train/loss_recog_step=1.120, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000672, Train/loss_recog_step=1.120, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=0.785, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080] Epoch 87:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=0.785, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]  Epoch 87:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00885, Train/loss_recog_step=0.866, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00885, Train/loss_recog_step=0.866, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=1.260, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=1.260, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000117, Train/loss_recog_step=0.824, Valid/loss_all_step=0.936, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.491, Valid/loss_recog_epoch=0.987, Valid/knn_avr=0.433, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.01it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.55it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.71it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.86it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.41it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.48it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069559, 0.069347, 0.068486
Valid average loss UNet            (all)              : 0.207392

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.147439, 2.771431, 4.396948
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.501836, 2.944566, 3.108886
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.585147, 2.863587, 2.761953
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.549032, 3.044177, 3.631102
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.192572, 3.064402, 3.751554
Valid average loss all      (Triplet)                 : 0.439703

== Recognize ==
Valid average loss Recognize     : 0.981415
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.647095

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.721785068511963 sec. =
Valid knn accuracy drums     : 79.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.47575855255127 sec. =
Valid knn accuracy bass      : 16.424418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.21649980545044 sec. =
Valid knn accuracy piano     : 28.513513513513512%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.943782806396484 sec. =
Valid knn accuracy guitar    : 32.3051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.141940832138062 sec. =
Valid knn accuracy residuals : 55.34591194968554%

Valid knn accuracy average   : 42.400160715785475%

                                                                        [AEpoch 87: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000117, Train/loss_recog_step=0.824, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.197, Train/loss_triplet_all_epoch=0.00469, Train/loss_recog_epoch=1.080]Epoch 87: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000117, Train/loss_recog_step=0.824, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065185, 0.064912, 0.066172
Train average loss UNet            (all)              : 0.196269

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001721, 2.642436, 4.861473
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006223, 2.378321, 3.842531
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006338, 2.531489, 3.924893
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004161, 2.593979, 4.291748
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003748, 2.726393, 4.129318
Train average loss all      (Triplet)                 : 0.004518

== Recognize ==
Train average loss Recognize     : 1.078343
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.200787

Epoch 87:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000117, Train/loss_recog_step=0.824, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]          Epoch 88:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000117, Train/loss_recog_step=0.824, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 88:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000117, Train/loss_recog_step=0.824, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 88:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=0.959, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080] Epoch 88:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=0.959, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 88:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00187, Train/loss_recog_step=1.110, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 88:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00187, Train/loss_recog_step=1.110, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 88:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.784, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080] Epoch 88:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0041, Train/loss_recog_step=0.784, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 88:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00287, Train/loss_recog_step=1.060, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 88:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00287, Train/loss_recog_step=1.060, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 88:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=0.871, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]  Epoch 88:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=0.871, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 88:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 88: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 88: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.970, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.735, Valid/loss_recog_step=1.190, Valid/loss_all_epoch=0.647, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.440, Valid/loss_recog_epoch=0.981, Valid/knn_avr=0.424, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.92it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.71it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.05it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.49it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.32it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069226, 0.069156, 0.068459
Valid average loss UNet            (all)              : 0.206841

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.152849, 2.866318, 4.685307
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.517739, 2.828813, 2.881146
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.613164, 2.815227, 2.732353
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.528097, 3.120167, 3.743814
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.252024, 3.061450, 3.812377
Valid average loss all      (Triplet)                 : 0.451084

== Recognize ==
Valid average loss Recognize     : 0.988759
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.657925

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.324004411697388 sec. =
Valid knn accuracy drums     : 80.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.339033603668213 sec. =
Valid knn accuracy bass      : 11.627906976744185%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.150946617126465 sec. =
Valid knn accuracy piano     : 24.324324324324326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.026092290878296 sec. =
Valid knn accuracy guitar    : 41.07142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.727051973342896 sec. =
Valid knn accuracy residuals : 55.188679245283026%

Valid knn accuracy average   : 42.4718795882619%

                                                                        [AEpoch 88: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.080]Epoch 88: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065109, 0.064814, 0.066130
Train average loss UNet            (all)              : 0.196052

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002226, 2.651390, 4.921524
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006659, 2.344455, 3.806561
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006096, 2.510151, 3.919556
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005240, 2.602760, 4.301720
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002454, 2.731483, 4.154084
Train average loss all      (Triplet)                 : 0.004564

== Recognize ==
Train average loss Recognize     : 1.081159
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.200616

Epoch 88:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]          Epoch 89:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=0.959, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89:  32%|███▏      | 100/313 [01:33<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=0.959, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89:  32%|███▏      | 100/313 [01:33<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00442, Train/loss_recog_step=1.120, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00442, Train/loss_recog_step=1.120, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.789, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]  Epoch 89:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.789, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.868, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.868, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=1.270, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00308, Train/loss_recog_step=1.270, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.720, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.658, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=0.989, Valid/knn_avr=0.425, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.39it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.75it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.31it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.36it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.76it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069392, 0.069838, 0.068655
Valid average loss UNet            (all)              : 0.207885

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.174799, 2.755173, 4.371320
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.621121, 2.941759, 2.926499
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.632206, 2.931031, 2.828007
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.585954, 3.174616, 3.756264
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.244193, 3.170333, 3.914838
Valid average loss all      (Triplet)                 : 0.497913

== Recognize ==
Valid average loss Recognize     : 0.989789
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.705798

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.237635374069214 sec. =
Valid knn accuracy drums     : 81.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.235923528671265 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.170717239379883 sec. =
Valid knn accuracy piano     : 26.756756756756754%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.893226146697998 sec. =
Valid knn accuracy guitar    : 40.42207792207792%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.783336639404297 sec. =
Valid knn accuracy residuals : 54.24528301886793%

Valid knn accuracy average   : 43.572101241318904%

                                                                        [AEpoch 89: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00456, Train/loss_recog_epoch=1.080]Epoch 89: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064997, 0.064751, 0.065991
Train average loss UNet            (all)              : 0.195739

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002097, 2.658101, 4.939157
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003808, 2.352042, 3.811625
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005232, 2.526314, 3.941650
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004380, 2.614106, 4.311437
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003407, 2.743981, 4.150664
Train average loss all      (Triplet)                 : 0.003755

== Recognize ==
Train average loss Recognize     : 1.082025
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.199494

Epoch 89:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]          Epoch 90:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.825, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.961, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0305, Train/loss_recog_step=1.110, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.232, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.0305, Train/loss_recog_step=1.110, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.778, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=0.778, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000316, Train/loss_recog_step=1.050, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000316, Train/loss_recog_step=1.050, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]   Epoch 90:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.863, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.826, Valid/loss_all_step=0.994, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.760, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.37it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.64it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.39it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.37it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074076, 0.074294, 0.070906
Valid average loss UNet            (all)              : 0.219275

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.185243, 2.791003, 4.356107
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.466002, 2.852929, 2.904660
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.506748, 2.738019, 2.843947
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.464735, 3.020475, 3.677505
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.262900, 3.041564, 3.647479
Valid average loss all      (Triplet)                 : 0.393553

== Recognize ==
Valid average loss Recognize     : 0.974284
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.612828

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.525911569595337 sec. =
Valid knn accuracy drums     : 80.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.295655727386475 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.213263273239136 sec. =
Valid knn accuracy piano     : 28.783783783783782%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.844261407852173 sec. =
Valid knn accuracy guitar    : 38.14935064935065%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.006603240966797 sec. =
Valid knn accuracy residuals : 50.943396226415096%

Valid knn accuracy average   : 42.59958793765546%

                                                                        [AEpoch 90: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.826, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00375, Train/loss_recog_epoch=1.080]Epoch 90: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.826, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.065019, 0.064785, 0.066051
Train average loss UNet            (all)              : 0.195855

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001536, 2.710206, 5.062471
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006805, 2.426663, 3.889327
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006031, 2.584500, 4.047064
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004119, 2.677328, 4.397510
Train average loss residuals(Triplet, dist_p, dist_n) : 0.006032, 2.813083, 4.220169
Train average loss all      (Triplet)                 : 0.005046

== Recognize ==
Train average loss Recognize     : 1.076914
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.200902

Epoch 90:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.826, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]          Epoch 91:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.826, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.826, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00879, Train/loss_recog_step=0.943, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00879, Train/loss_recog_step=0.943, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00451, Train/loss_recog_step=1.120, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00451, Train/loss_recog_step=1.120, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=0.784, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=0.784, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00034, Train/loss_recog_step=1.050, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00034, Train/loss_recog_step=1.050, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]  Epoch 91:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00889, Train/loss_recog_step=1.280, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00889, Train/loss_recog_step=1.280, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.720, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.453, Valid/loss_recog_step=1.180, Valid/loss_all_epoch=0.613, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.394, Valid/loss_recog_epoch=0.974, Valid/knn_avr=0.426, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.02it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.88it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.88it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.15it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.03it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069413, 0.069453, 0.068578
Valid average loss UNet            (all)              : 0.207444

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.195423, 3.231431, 5.083901
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.563484, 3.390606, 3.390001
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.595135, 3.325950, 3.362954
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.613779, 3.604232, 4.344244
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.319916, 3.618889, 4.336901
Valid average loss all      (Triplet)                 : 0.490075

== Recognize ==
Valid average loss Recognize     : 0.993708
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.697519

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.717987775802612 sec. =
Valid knn accuracy drums     : 83.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.243351697921753 sec. =
Valid knn accuracy bass      : 11.627906976744185%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.271255731582642 sec. =
Valid knn accuracy piano     : 22.972972972972975%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.91961932182312 sec. =
Valid knn accuracy guitar    : 36.201298701298704%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.363890886306763 sec. =
Valid knn accuracy residuals : 52.51572327044025%

Valid knn accuracy average   : 41.31063920782063%

                                                                        [AEpoch 91: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.201, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00505, Train/loss_recog_epoch=1.080]Epoch 91: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064972, 0.064669, 0.065929
Train average loss UNet            (all)              : 0.195570

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001228, 2.720976, 5.053648
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004985, 2.471368, 3.982162
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005462, 2.626808, 4.085791
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004632, 2.693418, 4.422233
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004292, 2.826226, 4.269800
Train average loss all      (Triplet)                 : 0.004164

== Recognize ==
Train average loss Recognize     : 1.081644
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.199734

Epoch 91:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]          Epoch 92:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.830, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92:  16%|█▌        | 50/313 [00:48<04:14,  1.04it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00103, Train/loss_recog_step=0.963, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00103, Train/loss_recog_step=0.963, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=1.120, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=1.120, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000519, Train/loss_recog_step=0.784, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000519, Train/loss_recog_step=0.784, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=1.050, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080] Epoch 92:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00331, Train/loss_recog_step=1.050, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00457, Train/loss_recog_step=0.875, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00457, Train/loss_recog_step=0.875, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00458, Train/loss_recog_step=1.290, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00458, Train/loss_recog_step=1.290, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00022, Train/loss_recog_step=0.830, Valid/loss_all_step=0.915, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.678, Valid/loss_recog_step=1.210, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=0.994, Valid/knn_avr=0.413, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.88it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.00it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.20it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.16it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070036, 0.070664, 0.068742
Valid average loss UNet            (all)              : 0.209442

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133724, 2.958089, 4.615372
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.519639, 3.048724, 3.060039
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.640085, 3.105202, 3.098145
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.597200, 3.451566, 4.047389
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.264802, 3.325006, 3.778663
Valid average loss all      (Triplet)                 : 0.467792

== Recognize ==
Valid average loss Recognize     : 1.000536
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.677234

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.552542448043823 sec. =
Valid knn accuracy drums     : 85.88235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.264957427978516 sec. =
Valid knn accuracy bass      : 12.209302325581394%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.106614589691162 sec. =
Valid knn accuracy piano     : 32.2972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.042548179626465 sec. =
Valid knn accuracy guitar    : 34.090909090909086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.151689052581787 sec. =
Valid knn accuracy residuals : 55.0314465408805%

Valid knn accuracy average   : 43.90226163916894%

                                                                        [AEpoch 92: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00022, Train/loss_recog_step=0.830, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.196, Train/loss_triplet_all_epoch=0.00416, Train/loss_recog_epoch=1.080]Epoch 92: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00022, Train/loss_recog_step=0.830, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064894, 0.064580, 0.065850
Train average loss UNet            (all)              : 0.195325

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001442, 2.709077, 4.997935
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005276, 2.470575, 3.985520
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006367, 2.639804, 4.118748
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002809, 2.695636, 4.472542
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005376, 2.822884, 4.263645
Train average loss all      (Triplet)                 : 0.004228

== Recognize ==
Train average loss Recognize     : 1.085580
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.199552

Epoch 92:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00022, Train/loss_recog_step=0.830, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]          Epoch 93:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00022, Train/loss_recog_step=0.830, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]Epoch 93:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00022, Train/loss_recog_step=0.830, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]Epoch 93:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]  Epoch 93:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]Epoch 93:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=1.130, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]Epoch 93:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00466, Train/loss_recog_step=1.130, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]Epoch 93:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00366, Train/loss_recog_step=0.792, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]Epoch 93:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00366, Train/loss_recog_step=0.792, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]Epoch 93:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]  Epoch 93:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]Epoch 93:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00248, Train/loss_recog_step=0.888, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]Epoch 93:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00248, Train/loss_recog_step=0.888, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]Epoch 93:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00304, Train/loss_recog_step=1.290, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]Epoch 93: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00304, Train/loss_recog_step=1.290, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]Epoch 93: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.837, Valid/loss_all_step=0.907, Valid/loss_unet_all_step=0.249, Valid/loss_triplet_all_step=0.658, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.677, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.468, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.439, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.99it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.36it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.32it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.69it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.42it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069514, 0.069426, 0.068661
Valid average loss UNet            (all)              : 0.207601

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.155469, 2.858760, 4.561234
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.477765, 3.011055, 3.161597
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.638627, 2.932987, 2.828553
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.607674, 3.273250, 3.677574
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.243530, 3.155923, 3.865292
Valid average loss all      (Triplet)                 : 0.465183

== Recognize ==
Valid average loss Recognize     : 1.003263
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.672784

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.23926854133606 sec. =
Valid knn accuracy drums     : 83.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.308047533035278 sec. =
Valid knn accuracy bass      : 15.11627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.023271322250366 sec. =
Valid knn accuracy piano     : 27.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.062975883483887 sec. =
Valid knn accuracy guitar    : 37.33766233766234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.899794578552246 sec. =
Valid knn accuracy residuals : 58.333333333333336%

Valid knn accuracy average   : 44.34505431222257%

                                                                        [AEpoch 93: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.837, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00423, Train/loss_recog_epoch=1.090]Epoch 93: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.837, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064884, 0.064663, 0.065859
Train average loss UNet            (all)              : 0.195405

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001551, 2.773685, 5.064840
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006127, 2.504250, 4.021686
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006647, 2.641661, 4.078224
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003593, 2.736346, 4.499532
Train average loss residuals(Triplet, dist_p, dist_n) : 0.005433, 2.875297, 4.318386
Train average loss all      (Triplet)                 : 0.004756

== Recognize ==
Train average loss Recognize     : 1.095627
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.200161

Epoch 93:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.837, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]          Epoch 94:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.837, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.837, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000653, Train/loss_recog_step=0.971, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000653, Train/loss_recog_step=0.971, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]   Epoch 94:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.797, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.797, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00118, Train/loss_recog_step=0.886, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00118, Train/loss_recog_step=0.886, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00545, Train/loss_recog_step=1.290, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00545, Train/loss_recog_step=1.290, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=0.968, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.739, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.673, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.465, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.443, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.39it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.18it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.31it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069754, 0.069515, 0.068125
Valid average loss UNet            (all)              : 0.207394

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.176223, 3.125825, 5.097923
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.719500, 3.475973, 3.372909
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.560186, 3.353316, 3.415934
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.565125, 3.600122, 4.497378
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.294623, 3.613760, 4.453944
Valid average loss all      (Triplet)                 : 0.517489

== Recognize ==
Valid average loss Recognize     : 0.998292
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.724883

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.6942880153656 sec. =
Valid knn accuracy drums     : 81.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.088169574737549 sec. =
Valid knn accuracy bass      : 12.645348837209303%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.664847135543823 sec. =
Valid knn accuracy piano     : 28.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.983824253082275 sec. =
Valid knn accuracy guitar    : 39.77272727272727%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.119964838027954 sec. =
Valid knn accuracy residuals : 54.71698113207547%

Valid knn accuracy average   : 43.416677585127374%

                                                                        [AEpoch 94: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00476, Train/loss_recog_epoch=1.100]Epoch 94: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064885, 0.064551, 0.065800
Train average loss UNet            (all)              : 0.195235

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002104, 2.875200, 5.338359
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005368, 2.577076, 4.120400
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006326, 2.726533, 4.188491
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005372, 2.842973, 4.616321
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003241, 2.948547, 4.485853
Train average loss all      (Triplet)                 : 0.004487

== Recognize ==
Train average loss Recognize     : 1.099396
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.199722

Epoch 94:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]          Epoch 95:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]Epoch 95:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.839, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]Epoch 95:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00121, Train/loss_recog_step=0.960, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]Epoch 95:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00121, Train/loss_recog_step=0.960, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]Epoch 95:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.130, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100] Epoch 95:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.217, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.0134, Train/loss_recog_step=1.130, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]Epoch 95:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00109, Train/loss_recog_step=0.788, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]Epoch 95:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00109, Train/loss_recog_step=0.788, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]Epoch 95:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00569, Train/loss_recog_step=1.070, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]Epoch 95:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00569, Train/loss_recog_step=1.070, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]Epoch 95:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.869, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100] Epoch 95:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.869, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]Epoch 95:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00407, Train/loss_recog_step=1.280, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]Epoch 95: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00407, Train/loss_recog_step=1.280, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]Epoch 95: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000797, Train/loss_recog_step=0.833, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.763, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.517, Valid/loss_recog_epoch=0.998, Valid/knn_avr=0.434, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.22it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.96it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.35it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.40it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070236, 0.069814, 0.068460
Valid average loss UNet            (all)              : 0.208510

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.134435, 3.096830, 5.177869
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.538161, 3.214366, 3.204966
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.771525, 3.326988, 3.233532
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.528610, 3.416382, 4.266011
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.301460, 3.423827, 4.180799
Valid average loss all      (Triplet)                 : 0.492433

== Recognize ==
Valid average loss Recognize     : 0.990369
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.700943

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.711157083511353 sec. =
Valid knn accuracy drums     : 82.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.43346643447876 sec. =
Valid knn accuracy bass      : 11.773255813953488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.3241605758667 sec. =
Valid knn accuracy piano     : 27.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.67223834991455 sec. =
Valid knn accuracy guitar    : 41.07142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.106380939483643 sec. =
Valid knn accuracy residuals : 54.24528301886793%

Valid knn accuracy average   : 43.343271700245865%

                                                                        [AEpoch 95: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000797, Train/loss_recog_step=0.833, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.200, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00449, Train/loss_recog_epoch=1.100]Epoch 95: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000797, Train/loss_recog_step=0.833, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064721, 0.064437, 0.065718
Train average loss UNet            (all)              : 0.194876

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001903, 2.893802, 5.378920
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005275, 2.626377, 4.233080
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006317, 2.765825, 4.285210
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004961, 2.913779, 4.753119
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004121, 2.994052, 4.529109
Train average loss all      (Triplet)                 : 0.004422

== Recognize ==
Train average loss Recognize     : 1.091580
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.199298

Epoch 95:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000797, Train/loss_recog_step=0.833, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]          Epoch 96:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000797, Train/loss_recog_step=0.833, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]Epoch 96:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000797, Train/loss_recog_step=0.833, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]Epoch 96:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00881, Train/loss_recog_step=0.960, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090] Epoch 96:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00881, Train/loss_recog_step=0.960, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]Epoch 96:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00196, Train/loss_recog_step=1.140, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]Epoch 96:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00196, Train/loss_recog_step=1.140, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]Epoch 96:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00533, Train/loss_recog_step=0.798, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]Epoch 96:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00533, Train/loss_recog_step=0.798, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]Epoch 96:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00121, Train/loss_recog_step=1.080, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]Epoch 96:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00121, Train/loss_recog_step=1.080, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]Epoch 96:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000653, Train/loss_recog_step=0.892, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]Epoch 96:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000653, Train/loss_recog_step=0.892, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]Epoch 96:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00378, Train/loss_recog_step=1.310, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090] Epoch 96: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00378, Train/loss_recog_step=1.310, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]Epoch 96: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.852, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.786, Valid/loss_recog_step=1.200, Valid/loss_all_epoch=0.701, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=0.990, Valid/knn_avr=0.433, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.61it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.96it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.81it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.46it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068951, 0.069787, 0.067687
Valid average loss UNet            (all)              : 0.206425

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.178046, 2.679128, 4.527476
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.531150, 2.899267, 2.940303
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.616347, 2.844251, 2.764856
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.488508, 3.065294, 3.971996
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.231369, 2.900958, 3.628007
Valid average loss all      (Triplet)                 : 0.450738

== Recognize ==
Valid average loss Recognize     : 1.013718
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.657163

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.257951498031616 sec. =
Valid knn accuracy drums     : 81.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.475636005401611 sec. =
Valid knn accuracy bass      : 13.80813953488372%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.213539361953735 sec. =
Valid knn accuracy piano     : 31.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.044745445251465 sec. =
Valid knn accuracy guitar    : 39.935064935064936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.053097248077393 sec. =
Valid knn accuracy residuals : 55.81761006289309%

Valid knn accuracy average   : 44.393085005137515%

                                                                        [AEpoch 96: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.852, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00442, Train/loss_recog_epoch=1.090]Epoch 96: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.852, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064651, 0.064396, 0.065645
Train average loss UNet            (all)              : 0.194692

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001511, 2.548181, 4.789401
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006438, 2.323572, 3.759639
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003978, 2.440065, 3.795699
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005273, 2.557172, 4.171536
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004918, 2.678136, 4.073525
Train average loss all      (Triplet)                 : 0.004525

== Recognize ==
Train average loss Recognize     : 1.106582
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.199217

Epoch 96:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.852, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]          Epoch 97:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.852, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]Epoch 97:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.852, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]Epoch 97:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.984, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]Epoch 97:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00297, Train/loss_recog_step=0.984, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]Epoch 97:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]  Epoch 97:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]Epoch 97:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=2.34e-5, Train/loss_recog_step=0.797, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]Epoch 97:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=2.34e-5, Train/loss_recog_step=0.797, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]Epoch 97:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=1.080, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]Epoch 97:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=1.080, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]Epoch 97:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]  Epoch 97:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]Epoch 97:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=1.300, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]Epoch 97: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.219, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.0213, Train/loss_recog_step=1.300, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]Epoch 97: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=0.932, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.698, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.657, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.451, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.444, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.95it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.39it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.43it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.88it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074075, 0.074098, 0.070946
Valid average loss UNet            (all)              : 0.219120

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.223951, 2.917967, 4.542986
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.540468, 3.047993, 3.085461
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.630419, 2.995466, 2.976460
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.464174, 3.207593, 3.988854
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.409747, 3.565553, 3.734633
Valid average loss all      (Triplet)                 : 0.484880

== Recognize ==
Valid average loss Recognize     : 1.006251
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.704000

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.677643775939941 sec. =
Valid knn accuracy drums     : 83.08823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.167337894439697 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.931386947631836 sec. =
Valid knn accuracy piano     : 32.2972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.158318519592285 sec. =
Valid knn accuracy guitar    : 39.285714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.996270179748535 sec. =
Valid knn accuracy residuals : 51.41509433962265%

Valid knn accuracy average   : 44.29866359218758%

                                                                        [AEpoch 97: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00453, Train/loss_recog_epoch=1.110]Epoch 97: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064581, 0.064354, 0.065565
Train average loss UNet            (all)              : 0.194501

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001836, 2.733612, 5.169353
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005402, 2.486899, 3.996638
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005933, 2.590502, 4.028449
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004163, 2.708951, 4.420558
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003560, 2.839358, 4.302955
Train average loss all      (Triplet)                 : 0.004282

== Recognize ==
Train average loss Recognize     : 1.106718
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.198782

Epoch 97:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]          Epoch 98:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]Epoch 98:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.840, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]Epoch 98:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.979, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]Epoch 98:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.979, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]Epoch 98:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]  Epoch 98:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]Epoch 98:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00745, Train/loss_recog_step=0.802, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]Epoch 98:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00745, Train/loss_recog_step=0.802, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]Epoch 98:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=1.090, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]Epoch 98:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00113, Train/loss_recog_step=1.090, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]Epoch 98:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]  Epoch 98:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.885, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]Epoch 98:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00698, Train/loss_recog_step=1.300, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]Epoch 98: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00698, Train/loss_recog_step=1.300, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]Epoch 98: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.267, Valid/loss_triplet_all_step=0.740, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.704, Valid/loss_unet_all_epoch=0.219, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.443, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.65it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.08it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.94it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.61it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.13it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070701, 0.069752, 0.069038
Valid average loss UNet            (all)              : 0.209492

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.228268, 3.109820, 4.949865
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.636873, 3.223337, 3.195796
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.665238, 3.211590, 3.241254
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.615608, 3.712644, 4.141683
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.333580, 3.647931, 4.216274
Valid average loss all      (Triplet)                 : 0.555894

== Recognize ==
Valid average loss Recognize     : 1.006771
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.765385

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.534392595291138 sec. =
Valid knn accuracy drums     : 82.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.317562341690063 sec. =
Valid knn accuracy bass      : 12.354651162790697%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.391225814819336 sec. =
Valid knn accuracy piano     : 27.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.049490451812744 sec. =
Valid knn accuracy guitar    : 32.7922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.126903295516968 sec. =
Valid knn accuracy residuals : 54.088050314465406%

Valid knn accuracy average   : 41.77226007328865%

                                                                        [AEpoch 98: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.110]Epoch 98: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064620, 0.064309, 0.065591
Train average loss UNet            (all)              : 0.194520

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002622, 2.695747, 5.072820
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006447, 2.447018, 3.939365
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004346, 2.557962, 4.015499
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.005328, 2.683442, 4.378126
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003402, 2.795221, 4.228489
Train average loss all      (Triplet)                 : 0.004508

== Recognize ==
Train average loss Recognize     : 1.107654
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.199028

Epoch 98:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]          Epoch 99:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]Epoch 99:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]Epoch 99:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00218, Train/loss_recog_step=0.971, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]Epoch 99:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00218, Train/loss_recog_step=0.971, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]Epoch 99:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00369, Train/loss_recog_step=1.140, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]Epoch 99:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00369, Train/loss_recog_step=1.140, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]Epoch 99:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.791, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]  Epoch 99:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.791, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]Epoch 99:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=1.080, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]Epoch 99:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=1.080, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]Epoch 99:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=0.883, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]Epoch 99:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=0.883, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]Epoch 99:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=1.300, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110] Epoch 99: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.207, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=1.300, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]Epoch 99: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.418, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.12it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.96it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.65it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.40it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.83it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068875, 0.068954, 0.067368
Valid average loss UNet            (all)              : 0.205197

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.172675, 2.817106, 4.745681
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.559446, 2.956194, 2.976391
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.641109, 2.919790, 2.776603
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.552227, 3.239098, 3.676380
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.217673, 3.151124, 4.036069
Valid average loss all      (Triplet)                 : 0.472939

== Recognize ==
Valid average loss Recognize     : 1.003719
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.678136

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.336637496948242 sec. =
Valid knn accuracy drums     : 81.61764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.296366453170776 sec. =
Valid knn accuracy bass      : 14.970930232558139%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.237967491149902 sec. =
Valid knn accuracy piano     : 27.297297297297295%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.919164419174194 sec. =
Valid knn accuracy guitar    : 40.42207792207792%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.838337659835815 sec. =
Valid knn accuracy residuals : 53.77358490566038%

Valid knn accuracy average   : 43.61630748328345%

                                                                        [AEpoch 99: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00451, Train/loss_recog_epoch=1.110]Epoch 99: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064615, 0.064360, 0.065641
Train average loss UNet            (all)              : 0.194616

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002285, 2.735676, 5.159965
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004904, 2.489384, 4.030897
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006901, 2.620114, 4.086270
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004579, 2.722014, 4.465858
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004744, 2.828923, 4.264456
Train average loss all      (Triplet)                 : 0.004522

== Recognize ==
Train average loss Recognize     : 1.101466
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.199139

Epoch 99:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]          Epoch 100:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.845, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00241, Train/loss_recog_step=1.150, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00241, Train/loss_recog_step=1.150, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.801, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]  Epoch 100:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.801, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=1.310, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0104, Train/loss_recog_step=1.310, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0232, Train/loss_recog_step=0.850, Valid/loss_all_step=0.942, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.711, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.678, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.473, Valid/loss_recog_epoch=1.000, Valid/knn_avr=0.436, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.81it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.92it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.47it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.54it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.96it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.075610, 0.074837, 0.072797
Valid average loss UNet            (all)              : 0.223244

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.252602, 3.278163, 4.997495
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.615119, 3.438054, 3.306544
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.480335, 3.186865, 3.312634
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.378939, 3.394933, 4.198151
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.320035, 3.786860, 4.219111
Valid average loss all      (Triplet)                 : 0.437442

== Recognize ==
Valid average loss Recognize     : 1.014695
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.660685

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.63236379623413 sec. =
Valid knn accuracy drums     : 81.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.280038118362427 sec. =
Valid knn accuracy bass      : 16.71511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.196041822433472 sec. =
Valid knn accuracy piano     : 26.216216216216214%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.029132843017578 sec. =
Valid knn accuracy guitar    : 35.064935064935064%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.004882097244263 sec. =
Valid knn accuracy residuals : 53.930817610062896%

Valid knn accuracy average   : 42.62071115170385%

                                                                        [AEpoch 100: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0232, Train/loss_recog_step=0.850, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.199, Train/loss_unet_all_epoch=0.195, Train/loss_triplet_all_epoch=0.00452, Train/loss_recog_epoch=1.100]Epoch 100: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0232, Train/loss_recog_step=0.850, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064410, 0.064138, 0.065402
Train average loss UNet            (all)              : 0.193951

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001774, 2.835280, 5.340633
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005365, 2.615329, 4.256581
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004263, 2.737556, 4.253006
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004283, 2.858045, 4.723445
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004517, 2.973719, 4.506756
Train average loss all      (Triplet)                 : 0.004032

== Recognize ==
Train average loss Recognize     : 1.108643
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.197983

Epoch 100:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0232, Train/loss_recog_step=0.850, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]          Epoch 101:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0232, Train/loss_recog_step=0.850, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]Epoch 101:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0232, Train/loss_recog_step=0.850, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]Epoch 101:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.983, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]Epoch 101:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00372, Train/loss_recog_step=0.983, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]Epoch 101:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]  Epoch 101:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]Epoch 101:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00406, Train/loss_recog_step=0.801, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]Epoch 101:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00406, Train/loss_recog_step=0.801, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]Epoch 101:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]  Epoch 101:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]Epoch 101:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00118, Train/loss_recog_step=0.888, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]Epoch 101:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00118, Train/loss_recog_step=0.888, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]Epoch 101:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00029, Train/loss_recog_step=1.310, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]Epoch 101: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00029, Train/loss_recog_step=1.310, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]Epoch 101: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.747, Valid/loss_unet_all_step=0.272, Valid/loss_triplet_all_step=0.476, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.661, Valid/loss_unet_all_epoch=0.223, Valid/loss_triplet_all_epoch=0.437, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.426, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.20it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.84it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.34it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.14it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.10it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069677, 0.068965, 0.067136
Valid average loss UNet            (all)              : 0.205777

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.145646, 2.763181, 4.674385
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.593714, 2.913929, 2.788149
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.610386, 2.884247, 2.835421
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.473711, 3.132728, 3.627673
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.256381, 3.154592, 3.659848
Valid average loss all      (Triplet)                 : 0.462170

== Recognize ==
Valid average loss Recognize     : 1.016038
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.667947

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.783053874969482 sec. =
Valid knn accuracy drums     : 80.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.08731484413147 sec. =
Valid knn accuracy bass      : 11.19186046511628%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.783806562423706 sec. =
Valid knn accuracy piano     : 29.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.888102531433105 sec. =
Valid knn accuracy guitar    : 37.33766233766234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.242717266082764 sec. =
Valid knn accuracy residuals : 55.503144654088054%

Valid knn accuracy average   : 42.84548420679464%

                                                                        [AEpoch 101: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00403, Train/loss_recog_epoch=1.110]Epoch 101: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064431, 0.064158, 0.065413
Train average loss UNet            (all)              : 0.194003

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002365, 2.640939, 4.839173
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005737, 2.406378, 3.914062
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005704, 2.514599, 3.900196
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003367, 2.622987, 4.334479
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004691, 2.726708, 4.139249
Train average loss all      (Triplet)                 : 0.004441

== Recognize ==
Train average loss Recognize     : 1.112821
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.198443

Epoch 101:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]          Epoch 102:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00472, Train/loss_recog_step=1.160, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00472, Train/loss_recog_step=1.160, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.806, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]  Epoch 102:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.806, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102:  80%|███████▉  | 250/313 [03:40<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=1.310, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0051, Train/loss_recog_step=1.310, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.661, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.668, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.462, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.428, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.24it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.79it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.17it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.43it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.47it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070498, 0.071000, 0.068160
Valid average loss UNet            (all)              : 0.209658

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.240873, 3.317180, 5.021456
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.563131, 3.333305, 3.297360
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.502110, 3.108235, 3.230278
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.676023, 3.685601, 4.131237
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.287836, 3.459048, 4.497844
Valid average loss all      (Triplet)                 : 0.482262

== Recognize ==
Valid average loss Recognize     : 1.016001
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.691920

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.480398416519165 sec. =
Valid knn accuracy drums     : 83.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.309303045272827 sec. =
Valid knn accuracy bass      : 17.587209302325583%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.044209718704224 sec. =
Valid knn accuracy piano     : 27.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.737767934799194 sec. =
Valid knn accuracy guitar    : 36.038961038961034%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.30259394645691 sec. =
Valid knn accuracy residuals : 55.0314465408805%

Valid knn accuracy average   : 44.00735803462103%

                                                                        [AEpoch 102: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00444, Train/loss_recog_epoch=1.110]Epoch 102: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064224, 0.063916, 0.065278
Train average loss UNet            (all)              : 0.193418

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001141, 2.650117, 4.870065
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003931, 2.431687, 3.946705
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003647, 2.542407, 3.983399
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004674, 2.663387, 4.387614
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002986, 2.779709, 4.246433
Train average loss all      (Triplet)                 : 0.003312

== Recognize ==
Train average loss Recognize     : 1.116621
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.196729

Epoch 102:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]          Epoch 103:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.851, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.983, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.983, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.797, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.797, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.884, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00389, Train/loss_recog_step=0.884, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]  Epoch 103: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.842, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.592, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.692, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.482, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.440, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.03it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.55it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.60it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.01it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.80it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.073762, 0.073525, 0.070876
Valid average loss UNet            (all)              : 0.218163

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.227412, 3.408596, 5.132364
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.699639, 3.517759, 3.433800
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.494909, 3.293623, 3.503756
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.504390, 3.891152, 4.664781
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.359441, 3.780550, 4.555179
Valid average loss all      (Triplet)                 : 0.502966

== Recognize ==
Valid average loss Recognize     : 1.013004
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.721129

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.668300867080688 sec. =
Valid knn accuracy drums     : 82.94117647058825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.35462737083435 sec. =
Valid knn accuracy bass      : 17.87790697674419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.35996413230896 sec. =
Valid knn accuracy piano     : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.892566204071045 sec. =
Valid knn accuracy guitar    : 36.85064935064935%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.042298316955566 sec. =
Valid knn accuracy residuals : 55.660377358490564%

Valid knn accuracy average   : 43.666022031294474%

                                                                        [AEpoch 103: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00331, Train/loss_recog_epoch=1.120]Epoch 103: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064347, 0.064027, 0.065223
Train average loss UNet            (all)              : 0.193597

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002289, 2.920845, 5.416224
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004989, 2.670277, 4.346516
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004892, 2.769934, 4.338302
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003499, 2.917688, 4.779825
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003627, 3.035605, 4.627866
Train average loss all      (Triplet)                 : 0.003929

== Recognize ==
Train average loss Recognize     : 1.106990
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.197526

Epoch 103:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]          Epoch 104:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]Epoch 104:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]Epoch 104:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00507, Train/loss_recog_step=0.978, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]Epoch 104:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00507, Train/loss_recog_step=0.978, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]Epoch 104:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=1.150, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]Epoch 104:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=1.150, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]Epoch 104:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0177, Train/loss_recog_step=0.801, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110] Epoch 104:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.209, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0177, Train/loss_recog_step=0.801, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]Epoch 104:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110] Epoch 104:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]Epoch 104:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]Epoch 104:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.888, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]Epoch 104:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00305, Train/loss_recog_step=1.310, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]Epoch 104: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00305, Train/loss_recog_step=1.310, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]Epoch 104: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=0.849, Valid/loss_all_step=0.950, Valid/loss_unet_all_step=0.264, Valid/loss_triplet_all_step=0.686, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.721, Valid/loss_unet_all_epoch=0.218, Valid/loss_triplet_all_epoch=0.503, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.437, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.96it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.50it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.98it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.71it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.45it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069287, 0.069244, 0.067477
Valid average loss UNet            (all)              : 0.206008

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.176006, 3.050850, 4.650658
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.809118, 3.289572, 3.088285
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.675533, 3.062177, 2.996569
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.557975, 3.444374, 4.184007
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.344258, 3.399921, 4.334339
Valid average loss all      (Triplet)                 : 0.584882

== Recognize ==
Valid average loss Recognize     : 1.014748
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.790889

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.500821828842163 sec. =
Valid knn accuracy drums     : 81.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.205508947372437 sec. =
Valid knn accuracy bass      : 11.627906976744185%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.38615083694458 sec. =
Valid knn accuracy piano     : 28.10810810810811%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.916340827941895 sec. =
Valid knn accuracy guitar    : 38.63636363636363%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.016778230667114 sec. =
Valid knn accuracy residuals : 50.786163522012586%

Valid knn accuracy average   : 42.18464962511629%

                                                                        [AEpoch 104: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=0.849, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00393, Train/loss_recog_epoch=1.110]Epoch 104: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=0.849, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064292, 0.064046, 0.065249
Train average loss UNet            (all)              : 0.193587

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001473, 2.859974, 5.189196
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006393, 2.603269, 4.200085
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005366, 2.719253, 4.240304
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004698, 2.866323, 4.679541
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002816, 2.972128, 4.526719
Train average loss all      (Triplet)                 : 0.004211

== Recognize ==
Train average loss Recognize     : 1.109346
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.197798

Epoch 104:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=0.849, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]          Epoch 105:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=0.849, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]Epoch 105:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00729, Train/loss_recog_step=0.849, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]Epoch 105:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.0045, Train/loss_recog_step=0.986, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110] Epoch 105:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.0045, Train/loss_recog_step=0.986, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]Epoch 105:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00773, Train/loss_recog_step=1.160, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]Epoch 105:  48%|████▊     | 150/313 [02:17<02:28,  1.09it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.00773, Train/loss_recog_step=1.160, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]Epoch 105:  48%|████▊     | 150/313 [02:17<02:28,  1.09it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.807, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]  Epoch 105:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.807, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]Epoch 105:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]Epoch 105:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]Epoch 105:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000792, Train/loss_recog_step=0.891, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]Epoch 105:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000792, Train/loss_recog_step=0.891, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]Epoch 105:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]   Epoch 105: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]Epoch 105: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=0.854, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.85it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.96it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.31it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.52it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.50it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.30it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070879, 0.071086, 0.069352
Valid average loss UNet            (all)              : 0.211317

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.201657, 3.252359, 4.817502
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.636829, 3.170259, 3.196352
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.671092, 3.266964, 3.125574
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.461530, 3.550860, 4.338811
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.352875, 3.489686, 4.378620
Valid average loss all      (Triplet)                 : 0.511329

== Recognize ==
Valid average loss Recognize     : 1.014286
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.722646

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.601215839385986 sec. =
Valid knn accuracy drums     : 80.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.381512641906738 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.213918924331665 sec. =
Valid knn accuracy piano     : 28.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.889997005462646 sec. =
Valid knn accuracy guitar    : 36.201298701298704%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.283956050872803 sec. =
Valid knn accuracy residuals : 51.57232704402516%

Valid knn accuracy average   : 42.334062968416276%

                                                                        [AEpoch 105: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=0.854, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.198, Train/loss_unet_all_epoch=0.194, Train/loss_triplet_all_epoch=0.00421, Train/loss_recog_epoch=1.110]Epoch 105: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=0.854, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064184, 0.063914, 0.065105
Train average loss UNet            (all)              : 0.193203

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001627, 2.677372, 4.947056
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005687, 2.453417, 3.995852
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005097, 2.553297, 4.017245
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003574, 2.688159, 4.451322
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003146, 2.781907, 4.255704
Train average loss all      (Triplet)                 : 0.003798

== Recognize ==
Train average loss Recognize     : 1.114531
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.197001

Epoch 105:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=0.854, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]          Epoch 106:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=0.854, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]Epoch 106:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=0.854, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]Epoch 106:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000578, Train/loss_recog_step=0.986, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]Epoch 106:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000578, Train/loss_recog_step=0.986, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]Epoch 106:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00829, Train/loss_recog_step=1.160, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110] Epoch 106:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00829, Train/loss_recog_step=1.160, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]Epoch 106:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.805, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110] Epoch 106:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0309, Train/loss_recog_step=0.805, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]Epoch 106:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00339, Train/loss_recog_step=1.090, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]Epoch 106:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00339, Train/loss_recog_step=1.090, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]Epoch 106:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]  Epoch 106:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]Epoch 106:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00614, Train/loss_recog_step=1.320, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]Epoch 106: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00614, Train/loss_recog_step=1.320, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]Epoch 106: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=1.020, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.771, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.423, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.82it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.58it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.51it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.67it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.54it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070950, 0.071474, 0.068514
Valid average loss UNet            (all)              : 0.210937

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.167332, 3.197427, 5.102988
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.644881, 3.286152, 3.331271
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.671431, 3.275466, 3.226371
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.504675, 3.516940, 4.315471
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.372009, 3.905413, 4.368751
Valid average loss all      (Triplet)                 : 0.524159

== Recognize ==
Valid average loss Recognize     : 1.018170
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.735096

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.697440147399902 sec. =
Valid knn accuracy drums     : 81.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.374774932861328 sec. =
Valid knn accuracy bass      : 11.482558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.233668565750122 sec. =
Valid knn accuracy piano     : 24.054054054054056%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.861034154891968 sec. =
Valid knn accuracy guitar    : 37.82467532467532%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.29967474937439 sec. =
Valid knn accuracy residuals : 55.660377358490564%

Valid knn accuracy average   : 42.06903885770391%

                                                                        [AEpoch 106: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0038, Train/loss_recog_epoch=1.110]Epoch 106: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063990, 0.063714, 0.064927
Train average loss UNet            (all)              : 0.192632

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001043, 2.722772, 4.998878
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003981, 2.490662, 4.064842
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004603, 2.631457, 4.125881
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003758, 2.750018, 4.532600
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002267, 2.844515, 4.374364
Train average loss all      (Triplet)                 : 0.003097

== Recognize ==
Train average loss Recognize     : 1.117959
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.195729

Epoch 106:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]          Epoch 107:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=1.150, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.212, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=1.150, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00526, Train/loss_recog_step=0.803, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00526, Train/loss_recog_step=0.803, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000169, Train/loss_recog_step=1.090, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000169, Train/loss_recog_step=1.090, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]   Epoch 107:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.895, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000273, Train/loss_recog_step=1.320, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000273, Train/loss_recog_step=1.320, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=0.858, Valid/loss_all_step=1.070, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.06it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.56it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.81it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.37it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.98it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.93it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.077932, 0.077209, 0.075374
Valid average loss UNet            (all)              : 0.230514

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.236591, 3.031593, 4.825104
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.578515, 3.240856, 3.232211
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.629657, 3.064392, 3.082068
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.227613, 3.254360, 4.191443
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.375801, 3.546971, 4.062487
Valid average loss all      (Triplet)                 : 0.434688

== Recognize ==
Valid average loss Recognize     : 1.017172
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.665202

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.625985383987427 sec. =
Valid knn accuracy drums     : 83.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.896509170532227 sec. =
Valid knn accuracy bass      : 16.71511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.20432448387146 sec. =
Valid knn accuracy piano     : 27.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.83498477935791 sec. =
Valid knn accuracy guitar    : 35.38961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.121787548065186 sec. =
Valid knn accuracy residuals : 47.79874213836478%

Valid knn accuracy average   : 42.141266098451915%

                                                                        [AEpoch 107: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=0.858, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.0031, Train/loss_recog_epoch=1.120]Epoch 107: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=0.858, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.064097, 0.063749, 0.065027
Train average loss UNet            (all)              : 0.192873

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001954, 3.000037, 5.622756
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006341, 2.726406, 4.387054
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005022, 2.874068, 4.474360
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004645, 2.982296, 4.872670
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003695, 3.087616, 4.701985
Train average loss all      (Triplet)                 : 0.004377

== Recognize ==
Train average loss Recognize     : 1.118345
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.197250

Epoch 107:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=0.858, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]          Epoch 108:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=0.858, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]Epoch 108:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=0.858, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]Epoch 108:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00134, Train/loss_recog_step=0.986, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]Epoch 108:  32%|███▏      | 100/313 [01:32<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00134, Train/loss_recog_step=0.986, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]Epoch 108:  32%|███▏      | 100/313 [01:32<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=1.150, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120] Epoch 108:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.213, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.0165, Train/loss_recog_step=1.150, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]Epoch 108:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.800, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]Epoch 108:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.800, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]Epoch 108:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120] Epoch 108:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]Epoch 108:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]Epoch 108:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]Epoch 108:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=1.310, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]Epoch 108: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=1.310, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]Epoch 108: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.763, Valid/loss_unet_all_step=0.286, Valid/loss_triplet_all_step=0.477, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.665, Valid/loss_unet_all_epoch=0.231, Valid/loss_triplet_all_epoch=0.435, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.421, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.53it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.71it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.79it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.59it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069297, 0.069182, 0.066871
Valid average loss UNet            (all)              : 0.205350

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.197740, 2.975287, 4.785051
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.630013, 3.258898, 3.281594
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.715441, 3.167746, 3.154407
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.328556, 3.361954, 4.191010
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.359258, 3.345999, 4.338171
Valid average loss all      (Triplet)                 : 0.482779

== Recognize ==
Valid average loss Recognize     : 1.011053
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.688128

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.715246200561523 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.465726613998413 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.84892201423645 sec. =
Valid knn accuracy piano     : 29.594594594594593%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.899747610092163 sec. =
Valid knn accuracy guitar    : 37.01298701298701%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.275245904922485 sec. =
Valid knn accuracy residuals : 48.742138364779876%

Valid knn accuracy average   : 42.20947887819323%

                                                                        [AEpoch 108: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00438, Train/loss_recog_epoch=1.120]Epoch 108: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063841, 0.063607, 0.064885
Train average loss UNet            (all)              : 0.192333

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001504, 2.674868, 4.987288
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004940, 2.451300, 4.004103
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003953, 2.586417, 4.053265
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003030, 2.698724, 4.439177
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003537, 2.795810, 4.251486
Train average loss all      (Triplet)                 : 0.003356

== Recognize ==
Train average loss Recognize     : 1.114312
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.195689

Epoch 108:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]          Epoch 109:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]Epoch 109:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]Epoch 109:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00605, Train/loss_recog_step=0.977, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]Epoch 109:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00605, Train/loss_recog_step=0.977, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]Epoch 109:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00855, Train/loss_recog_step=1.140, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]Epoch 109:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00855, Train/loss_recog_step=1.140, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]Epoch 109:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=0.796, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110] Epoch 109:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=0.796, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]Epoch 109:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110] Epoch 109:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]Epoch 109:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=0.890, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]Epoch 109:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00397, Train/loss_recog_step=0.890, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]Epoch 109:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=1.300, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]Epoch 109: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00443, Train/loss_recog_step=1.300, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]Epoch 109: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.688, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.483, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.41it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.75it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.99it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.47it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.10it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068775, 0.068565, 0.067163
Valid average loss UNet            (all)              : 0.204503

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.155113, 2.879137, 4.641197
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.590845, 3.115541, 3.089933
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.661922, 3.076074, 3.019412
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.459944, 3.334832, 4.179486
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.307277, 3.352010, 4.193683
Valid average loss all      (Triplet)                 : 0.489635

== Recognize ==
Valid average loss Recognize     : 1.009090
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.694137

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.712054014205933 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.395495891571045 sec. =
Valid knn accuracy bass      : 9.011627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.2408607006073 sec. =
Valid knn accuracy piano     : 25.945945945945947%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.775750637054443 sec. =
Valid knn accuracy guitar    : 39.935064935064936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.293066501617432 sec. =
Valid knn accuracy residuals : 53.930817610062896%

Valid knn accuracy average   : 41.23527951490423%

                                                                        [AEpoch 109: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00336, Train/loss_recog_epoch=1.110]Epoch 109: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063994, 0.063718, 0.064900
Train average loss UNet            (all)              : 0.192612

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001608, 2.775913, 5.253464
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005516, 2.541508, 4.118310
Train average loss piano    (Triplet, dist_p, dist_n) : 0.006744, 2.667787, 4.189754
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004333, 2.779594, 4.600496
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003001, 2.908017, 4.462399
Train average loss all      (Triplet)                 : 0.004273

== Recognize ==
Train average loss Recognize     : 1.106826
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.196885

Epoch 109:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]          Epoch 110:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]Epoch 110:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.846, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]Epoch 110:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0069, Train/loss_recog_step=0.976, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]Epoch 110:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0069, Train/loss_recog_step=0.976, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]Epoch 110:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00694, Train/loss_recog_step=1.140, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]Epoch 110:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.205, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.00694, Train/loss_recog_step=1.140, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]Epoch 110:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000212, Train/loss_recog_step=0.799, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]Epoch 110:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000212, Train/loss_recog_step=0.799, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]Epoch 110:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0079, Train/loss_recog_step=1.090, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]  Epoch 110:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0079, Train/loss_recog_step=1.090, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]Epoch 110:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00189, Train/loss_recog_step=0.897, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]Epoch 110:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00189, Train/loss_recog_step=0.897, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]Epoch 110:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]  Epoch 110: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]Epoch 110: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=1.080, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.853, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.694, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.412, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.91it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.21it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.80it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.33it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.17it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070669, 0.070682, 0.067577
Valid average loss UNet            (all)              : 0.208928

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.141455, 3.080023, 5.072793
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.636480, 3.395269, 3.404898
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.711435, 3.310436, 3.301134
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.518794, 3.641347, 4.476094
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.252648, 3.564102, 4.606821
Valid average loss all      (Triplet)                 : 0.509076

== Recognize ==
Valid average loss Recognize     : 1.019004
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.718005

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.303890466690063 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.480782747268677 sec. =
Valid knn accuracy bass      : 13.517441860465116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.194823265075684 sec. =
Valid knn accuracy piano     : 29.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.937419652938843 sec. =
Valid knn accuracy guitar    : 39.61038961038961%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.878044605255127 sec. =
Valid knn accuracy residuals : 54.40251572327044%

Valid knn accuracy average   : 43.07443191895223%

                                                                        [AEpoch 110: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.197, Train/loss_unet_all_epoch=0.193, Train/loss_triplet_all_epoch=0.00427, Train/loss_recog_epoch=1.110]Epoch 110: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063886, 0.063587, 0.064811
Train average loss UNet            (all)              : 0.192283

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001778, 2.759458, 5.203549
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004780, 2.543353, 4.158482
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004424, 2.659997, 4.167808
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003493, 2.796688, 4.622525
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003692, 2.915044, 4.486242
Train average loss all      (Triplet)                 : 0.003592

== Recognize ==
Train average loss Recognize     : 1.113079
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.195876

Epoch 110:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]          Epoch 111:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.985, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00134, Train/loss_recog_step=1.150, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.00134, Train/loss_recog_step=1.150, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00471, Train/loss_recog_step=0.803, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00471, Train/loss_recog_step=0.803, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=1.100, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00419, Train/loss_recog_step=1.100, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]  Epoch 111:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=1.320, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=1.320, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.509, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.431, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.15it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.46it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  4.95it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.62it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.88it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070173, 0.069112, 0.067058
Valid average loss UNet            (all)              : 0.206343

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.169878, 3.218611, 5.231352
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.736950, 3.770939, 3.566203
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.681587, 3.478776, 3.475626
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.489558, 3.858748, 4.672869
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.340458, 3.759362, 4.442590
Valid average loss all      (Triplet)                 : 0.531490

== Recognize ==
Valid average loss Recognize     : 1.022185
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.737833

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.271697998046875 sec. =
Valid knn accuracy drums     : 78.97058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.34779953956604 sec. =
Valid knn accuracy bass      : 15.11627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.216491937637329 sec. =
Valid knn accuracy piano     : 27.027027027027028%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.108553647994995 sec. =
Valid knn accuracy guitar    : 42.6948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.97566533088684 sec. =
Valid knn accuracy residuals : 52.51572327044025%

Valid knn accuracy average   : 43.26488455946681%

                                                                        [AEpoch 111: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00359, Train/loss_recog_epoch=1.110]Epoch 111: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063785, 0.063527, 0.064812
Train average loss UNet            (all)              : 0.192124

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000835, 2.897937, 5.394995
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004735, 2.666238, 4.372787
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005081, 2.815598, 4.415250
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003962, 2.936049, 4.847009
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004060, 3.070518, 4.721938
Train average loss all      (Triplet)                 : 0.003787

== Recognize ==
Train average loss Recognize     : 1.118750
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.195911

Epoch 111:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]          Epoch 112:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.854, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=0.996, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0136, Train/loss_recog_step=0.996, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000799, Train/loss_recog_step=1.160, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000799, Train/loss_recog_step=1.160, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.805, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]   Epoch 112:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.805, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0261, Train/loss_recog_step=0.898, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.220, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0261, Train/loss_recog_step=0.898, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=1.320, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0115, Train/loss_recog_step=1.320, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.993, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.754, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.433, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.66it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.48it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.18it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068363, 0.068564, 0.066365
Valid average loss UNet            (all)              : 0.203291

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.193491, 2.809439, 4.590165
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.659545, 3.309594, 3.220887
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.663340, 3.064452, 3.028883
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.368984, 3.267266, 3.954525
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.337587, 3.314192, 4.148027
Valid average loss all      (Triplet)                 : 0.496681

== Recognize ==
Valid average loss Recognize     : 1.026116
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.699972

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.660133600234985 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.250311851501465 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.10226583480835 sec. =
Valid knn accuracy piano     : 26.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.723757028579712 sec. =
Valid knn accuracy guitar    : 40.909090909090914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.14677119255066 sec. =
Valid knn accuracy residuals : 56.60377358490566%

Valid knn accuracy average   : 43.53753056508393%

                                                                        [AEpoch 112: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00379, Train/loss_recog_epoch=1.120]Epoch 112: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063845, 0.063600, 0.064728
Train average loss UNet            (all)              : 0.192174

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001352, 2.898368, 5.434434
Train average loss bass     (Triplet, dist_p, dist_n) : 0.006723, 2.715238, 4.411767
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005680, 2.844471, 4.467642
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002842, 2.917103, 4.839069
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004045, 3.053255, 4.665808
Train average loss all      (Triplet)                 : 0.004276

== Recognize ==
Train average loss Recognize     : 1.121561
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.196449

Epoch 112:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]          Epoch 113:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]Epoch 113:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]Epoch 113:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.999, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]Epoch 113:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.999, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]Epoch 113:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]Epoch 113:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]Epoch 113:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00169, Train/loss_recog_step=0.809, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]Epoch 113:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00169, Train/loss_recog_step=0.809, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]Epoch 113:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]  Epoch 113:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]Epoch 113:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000537, Train/loss_recog_step=0.906, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]Epoch 113:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000537, Train/loss_recog_step=0.906, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]Epoch 113:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00697, Train/loss_recog_step=1.320, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120] Epoch 113: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00697, Train/loss_recog_step=1.320, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]Epoch 113: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.948, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.716, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.435, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.11it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.52it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.43it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.45it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069546, 0.070007, 0.068518
Valid average loss UNet            (all)              : 0.208070

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.242760, 3.023657, 4.774986
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.629729, 3.395509, 3.330059
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.744937, 3.158588, 3.019921
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.491400, 3.505142, 4.369625
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.274581, 3.415426, 4.302886
Valid average loss all      (Triplet)                 : 0.533596

== Recognize ==
Valid average loss Recognize     : 1.023484
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.741667

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.7945716381073 sec. =
Valid knn accuracy drums     : 77.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.337678670883179 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.289644956588745 sec. =
Valid knn accuracy piano     : 25.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.704503774642944 sec. =
Valid knn accuracy guitar    : 43.34415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.11607027053833 sec. =
Valid knn accuracy residuals : 50.314465408805034%

Valid knn accuracy average   : 42.19479778924711%

                                                                        [AEpoch 113: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.196, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00428, Train/loss_recog_epoch=1.120]Epoch 113: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063681, 0.063351, 0.064590
Train average loss UNet            (all)              : 0.191622

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001475, 2.775088, 5.204552
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004066, 2.574745, 4.201685
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003889, 2.684866, 4.240769
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002699, 2.787769, 4.581166
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002824, 2.899895, 4.445854
Train average loss all      (Triplet)                 : 0.003043

== Recognize ==
Train average loss Recognize     : 1.127051
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.194664

Epoch 113:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]          Epoch 114:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]Epoch 114:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]Epoch 114:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.999, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]Epoch 114:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.999, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]Epoch 114:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000986, Train/loss_recog_step=1.170, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]Epoch 114:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000986, Train/loss_recog_step=1.170, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]Epoch 114:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000306, Train/loss_recog_step=0.810, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]Epoch 114:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000306, Train/loss_recog_step=0.810, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]Epoch 114:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=7.78e-5, Train/loss_recog_step=1.100, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130] Epoch 114:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=7.78e-5, Train/loss_recog_step=1.100, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]Epoch 114:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]  Epoch 114:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]Epoch 114:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00298, Train/loss_recog_step=1.320, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]Epoch 114: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00298, Train/loss_recog_step=1.320, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]Epoch 114: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.534, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.422, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.22it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.05it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.63it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.66it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071016, 0.070419, 0.069625
Valid average loss UNet            (all)              : 0.211060

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.166641, 2.764395, 4.595234
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.527631, 2.893736, 2.989061
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.582509, 2.763355, 2.736521
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.655410, 3.341761, 3.708391
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.322140, 3.217718, 4.002690
Valid average loss all      (Triplet)                 : 0.502116

== Recognize ==
Valid average loss Recognize     : 1.024135
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.713176

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.743864059448242 sec. =
Valid knn accuracy drums     : 80.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.309869527816772 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.109131336212158 sec. =
Valid knn accuracy piano     : 24.054054054054056%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.854790210723877 sec. =
Valid knn accuracy guitar    : 37.98701298701299%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.081160306930542 sec. =
Valid knn accuracy residuals : 58.17610062893082%

Valid knn accuracy average   : 42.9798220428915%

                                                                        [AEpoch 114: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.130]Epoch 114: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063689, 0.063332, 0.064555
Train average loss UNet            (all)              : 0.191576

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000983, 2.816678, 5.310291
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004946, 2.628781, 4.311788
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003647, 2.712736, 4.255860
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003697, 2.824209, 4.650208
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003212, 2.972423, 4.582044
Train average loss all      (Triplet)                 : 0.003348

== Recognize ==
Train average loss Recognize     : 1.125950
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.194923

Epoch 114:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]          Epoch 115:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00162, Train/loss_recog_step=0.995, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00162, Train/loss_recog_step=0.995, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115:  32%|███▏      | 100/313 [01:27<03:07,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00162, Train/loss_recog_step=1.170, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00162, Train/loss_recog_step=1.170, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115:  48%|████▊     | 150/313 [02:10<02:21,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]  Epoch 115:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.809, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.892, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.203, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.0117, Train/loss_recog_step=0.892, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00161, Train/loss_recog_step=1.320, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.00161, Train/loss_recog_step=1.320, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.789, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.502, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.430, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.39it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.16it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.16it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.80it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070668, 0.069007, 0.067844
Valid average loss UNet            (all)              : 0.207520

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.196086, 3.212807, 5.300987
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.710356, 3.473945, 3.354898
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.784211, 3.322248, 3.147969
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.543752, 3.894858, 4.590319
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.319377, 3.616707, 4.575646
Valid average loss all      (Triplet)                 : 0.583771

== Recognize ==
Valid average loss Recognize     : 1.022097
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.791290

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.553183317184448 sec. =
Valid knn accuracy drums     : 80.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.443460702896118 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.357492923736572 sec. =
Valid knn accuracy piano     : 24.054054054054056%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.030160665512085 sec. =
Valid knn accuracy guitar    : 38.311688311688314%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.846646785736084 sec. =
Valid knn accuracy residuals : 55.0314465408805%

Valid knn accuracy average   : 42.4158262902165%

                                                                        [AEpoch 115: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.192, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.130]Epoch 115: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063502, 0.063232, 0.064479
Train average loss UNet            (all)              : 0.191212

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001007, 2.818882, 5.357190
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005001, 2.607409, 4.300448
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004996, 2.703582, 4.232736
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004147, 2.834412, 4.652894
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003485, 2.985680, 4.572498
Train average loss all      (Triplet)                 : 0.003715

== Recognize ==
Train average loss Recognize     : 1.126140
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.194927

Epoch 115:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]          Epoch 116:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]Epoch 116:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.862, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]Epoch 116:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00868, Train/loss_recog_step=0.994, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]Epoch 116:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00868, Train/loss_recog_step=0.994, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]Epoch 116:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]  Epoch 116:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]Epoch 116:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]Epoch 116:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.810, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]Epoch 116:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00083, Train/loss_recog_step=1.110, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]Epoch 116:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00083, Train/loss_recog_step=1.110, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]Epoch 116:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=0.899, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]Epoch 116:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00188, Train/loss_recog_step=0.899, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]Epoch 116:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]  Epoch 116: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]Epoch 116: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.240, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.584, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.424, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.93it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.11it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.93it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.19it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.11it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.36it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069636, 0.069559, 0.068149
Valid average loss UNet            (all)              : 0.207344

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.230764, 2.966562, 4.831915
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.606952, 3.205976, 3.223290
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.690198, 2.981415, 2.867955
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.491030, 3.455030, 4.211384
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.283757, 3.395477, 3.981484
Valid average loss all      (Triplet)                 : 0.506771

== Recognize ==
Valid average loss Recognize     : 1.016952
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.714115

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.549489259719849 sec. =
Valid knn accuracy drums     : 79.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.318890571594238 sec. =
Valid knn accuracy bass      : 12.790697674418606%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.133899211883545 sec. =
Valid knn accuracy piano     : 26.351351351351347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.934535503387451 sec. =
Valid knn accuracy guitar    : 38.63636363636363%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.079613447189331 sec. =
Valid knn accuracy residuals : 54.088050314465406%

Valid knn accuracy average   : 42.25564553649627%

                                                                        [AEpoch 116: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00371, Train/loss_recog_epoch=1.130]Epoch 116: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063467, 0.063125, 0.064338
Train average loss UNet            (all)              : 0.190930

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001256, 2.846776, 5.401482
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004086, 2.647449, 4.341832
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003763, 2.742894, 4.295784
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003360, 2.876183, 4.783597
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002936, 2.970258, 4.562407
Train average loss all      (Triplet)                 : 0.003092

== Recognize ==
Train average loss Recognize     : 1.129392
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.194022

Epoch 116:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]          Epoch 117:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 117:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.865, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 117:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=0.989, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 117:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0037, Train/loss_recog_step=0.989, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 117:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130] Epoch 117:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 117:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00503, Train/loss_recog_step=0.806, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 117:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00503, Train/loss_recog_step=0.806, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 117:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]  Epoch 117:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 117:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 117:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 117:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=1.320, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 117: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00201, Train/loss_recog_step=1.320, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 117: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=0.980, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.745, Valid/loss_recog_step=1.230, Valid/loss_all_epoch=0.714, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.507, Valid/loss_recog_epoch=1.020, Valid/knn_avr=0.423, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.84it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.43it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.41it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.39it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068871, 0.068406, 0.066347
Valid average loss UNet            (all)              : 0.203624

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.224359, 2.968705, 4.755983
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.600937, 3.257615, 3.283171
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.756934, 3.170497, 3.102956
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.595998, 3.594917, 4.148000
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.266023, 3.470415, 4.236086
Valid average loss all      (Triplet)                 : 0.542469

== Recognize ==
Valid average loss Recognize     : 1.014459
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.746093

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.731815099716187 sec. =
Valid knn accuracy drums     : 81.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.280350685119629 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.652799129486084 sec. =
Valid knn accuracy piano     : 29.18918918918919%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.954232454299927 sec. =
Valid knn accuracy guitar    : 40.58441558441558%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.187848329544067 sec. =
Valid knn accuracy residuals : 55.9748427672956%

Valid knn accuracy average   : 44.204751067687596%

                                                                        [AEpoch 117: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00309, Train/loss_recog_epoch=1.130]Epoch 117: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063266, 0.062969, 0.064231
Train average loss UNet            (all)              : 0.190466

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001270, 2.714317, 5.255486
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004549, 2.486181, 4.119186
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005143, 2.616922, 4.128504
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001947, 2.738863, 4.544053
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002712, 2.840483, 4.369358
Train average loss all      (Triplet)                 : 0.003152

== Recognize ==
Train average loss Recognize     : 1.126018
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.193618

Epoch 117:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]          Epoch 118:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.859, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.988, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.988, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.170, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.170, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.807, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00211, Train/loss_recog_step=0.807, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]  Epoch 118:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.220, Valid/loss_all_epoch=0.746, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.010, Valid/knn_avr=0.442, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.20it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.61it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.49it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.50it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.40it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069002, 0.068634, 0.067892
Valid average loss UNet            (all)              : 0.205528

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.208560, 3.172776, 5.329590
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.690068, 3.317631, 3.240613
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.736638, 3.221686, 3.163645
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.641642, 3.700210, 4.320127
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.272751, 3.415357, 4.066545
Valid average loss all      (Triplet)                 : 0.566291

== Recognize ==
Valid average loss Recognize     : 1.031639
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.771819

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.61879277229309 sec. =
Valid knn accuracy drums     : 82.94117647058825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.230514526367188 sec. =
Valid knn accuracy bass      : 11.337209302325581%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.984691143035889 sec. =
Valid knn accuracy piano     : 29.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.906678199768066 sec. =
Valid knn accuracy guitar    : 38.961038961038966%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.240460872650146 sec. =
Valid knn accuracy residuals : 52.51572327044025%

Valid knn accuracy average   : 43.09697554682456%

                                                                        [AEpoch 118: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00315, Train/loss_recog_epoch=1.130]Epoch 118: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063320, 0.063017, 0.064230
Train average loss UNet            (all)              : 0.190567

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001626, 2.832932, 5.406729
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003182, 2.572188, 4.231841
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003995, 2.661884, 4.193354
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004403, 2.801603, 4.624354
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002341, 2.929640, 4.472304
Train average loss all      (Triplet)                 : 0.003061

== Recognize ==
Train average loss Recognize     : 1.130027
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.193628

Epoch 118:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]          Epoch 119:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=1.000, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00257, Train/loss_recog_step=1.000, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00962, Train/loss_recog_step=1.170, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00962, Train/loss_recog_step=1.170, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119:  48%|████▊     | 150/313 [02:11<02:22,  1.14it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=0.810, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00117, Train/loss_recog_step=0.810, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119:  64%|██████▍   | 200/313 [02:54<01:38,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]  Epoch 119:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119:  80%|███████▉  | 250/313 [03:36<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119:  96%|█████████▌| 300/313 [04:18<00:11,  1.16it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119: 100%|██████████| 313/313 [04:28<00:00,  1.16it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.888, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.772, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.84it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.31it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069508, 0.068927, 0.067347
Valid average loss UNet            (all)              : 0.205782

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.178209, 3.028889, 5.019978
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.595938, 3.324996, 3.404771
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.720784, 3.149824, 3.091003
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.648171, 3.638292, 4.359622
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.305673, 3.342767, 4.136172
Valid average loss all      (Triplet)                 : 0.542267

== Recognize ==
Valid average loss Recognize     : 1.027943
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.748049

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.577621221542358 sec. =
Valid knn accuracy drums     : 80.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.10758090019226 sec. =
Valid knn accuracy bass      : 13.80813953488372%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.223907947540283 sec. =
Valid knn accuracy piano     : 26.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.727511644363403 sec. =
Valid knn accuracy guitar    : 43.66883116883117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.473496913909912 sec. =
Valid knn accuracy residuals : 55.34591194968554%

Valid knn accuracy average   : 43.918312619710285%

                                                                        [AEpoch 119: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00306, Train/loss_recog_epoch=1.130]Epoch 119: 100%|██████████| 313/313 [06:03<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063380, 0.062992, 0.064274
Train average loss UNet            (all)              : 0.190646

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002055, 3.047711, 5.721083
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005402, 2.814504, 4.573551
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003490, 2.879410, 4.521922
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004707, 3.041823, 5.051997
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004232, 3.166413, 4.861788
Train average loss all      (Triplet)                 : 0.003974

== Recognize ==
Train average loss Recognize     : 1.133433
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.194619

Epoch 119:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]          Epoch 120:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]Epoch 120:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]Epoch 120:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.997, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]Epoch 120:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.997, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]Epoch 120:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00853, Train/loss_recog_step=1.170, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]Epoch 120:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.206, Train/loss_unet_all_step=0.197, Train/loss_triplet_all_step=0.00853, Train/loss_recog_step=1.170, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]Epoch 120:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.0057, Train/loss_recog_step=0.814, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130] Epoch 120:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.0057, Train/loss_recog_step=0.814, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]Epoch 120:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130] Epoch 120:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]Epoch 120:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0312, Train/loss_recog_step=0.909, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]Epoch 120:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.221, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0312, Train/loss_recog_step=0.909, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]Epoch 120:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130] Epoch 120: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]Epoch 120: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.250, Valid/loss_all_epoch=0.748, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.030, Valid/knn_avr=0.439, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.02it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.70it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.01it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.53it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.13it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068486, 0.069053, 0.067338
Valid average loss UNet            (all)              : 0.204877

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.154499, 3.012710, 4.841009
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.555234, 3.194463, 3.272752
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.707899, 3.170611, 2.977161
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.579102, 3.620775, 4.181367
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.228348, 3.335994, 4.363341
Valid average loss all      (Triplet)                 : 0.497902

== Recognize ==
Valid average loss Recognize     : 1.035801
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.702780

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.535398960113525 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.156462669372559 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.131460189819336 sec. =
Valid knn accuracy piano     : 28.64864864864865%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.894588470458984 sec. =
Valid knn accuracy guitar    : 37.98701298701299%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.859647989273071 sec. =
Valid knn accuracy residuals : 54.40251572327044%

Valid knn accuracy average   : 43.08622644305865%

                                                                        [AEpoch 120: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.195, Train/loss_unet_all_epoch=0.191, Train/loss_triplet_all_epoch=0.00397, Train/loss_recog_epoch=1.130]Epoch 120: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063244, 0.062916, 0.064142
Train average loss UNet            (all)              : 0.190303

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001130, 2.791975, 5.304513
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004680, 2.532043, 4.150102
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003155, 2.658526, 4.184836
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004648, 2.782282, 4.627838
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003250, 2.895091, 4.413455
Train average loss all      (Triplet)                 : 0.003346

== Recognize ==
Train average loss Recognize     : 1.136542
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.193649

Epoch 120:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]          Epoch 121:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]Epoch 121:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]Epoch 121:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=9.96e-5, Train/loss_recog_step=1.000, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]Epoch 121:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=9.96e-5, Train/loss_recog_step=1.000, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]Epoch 121:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]  Epoch 121:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.196, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]Epoch 121:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00831, Train/loss_recog_step=0.826, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]Epoch 121:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00831, Train/loss_recog_step=0.826, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]Epoch 121:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]  Epoch 121:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]Epoch 121:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]Epoch 121:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]Epoch 121:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]Epoch 121: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]Epoch 121: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.703, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.498, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.431, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.13it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.45it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.74it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.78it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.25it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070262, 0.069780, 0.067462
Valid average loss UNet            (all)              : 0.207504

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.195320, 3.142186, 5.010691
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.590144, 3.294477, 3.419893
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.784397, 3.318558, 3.231408
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.724237, 3.851357, 4.418445
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.272971, 3.574337, 4.171358
Valid average loss all      (Triplet)                 : 0.569937

== Recognize ==
Valid average loss Recognize     : 1.038353
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.777442

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.54701828956604 sec. =
Valid knn accuracy drums     : 81.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.80946660041809 sec. =
Valid knn accuracy bass      : 13.226744186046513%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.298567771911621 sec. =
Valid knn accuracy piano     : 28.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.831945180892944 sec. =
Valid knn accuracy guitar    : 40.25974025974026%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.136186599731445 sec. =
Valid knn accuracy residuals : 54.088050314465406%

Valid knn accuracy average   : 43.484700274784934%

                                                                        [AEpoch 121: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00335, Train/loss_recog_epoch=1.140]Epoch 121: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063117, 0.062843, 0.064001
Train average loss UNet            (all)              : 0.189962

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000845, 2.857003, 5.383050
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003907, 2.630376, 4.331760
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003904, 2.801363, 4.406406
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002247, 2.895643, 4.869282
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003542, 3.031681, 4.662554
Train average loss all      (Triplet)                 : 0.002899

== Recognize ==
Train average loss Recognize     : 1.145998
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.192861

Epoch 121:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]          Epoch 122:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.874, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00611, Train/loss_recog_step=1.190, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00611, Train/loss_recog_step=1.190, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.828, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]  Epoch 122:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.828, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00758, Train/loss_recog_step=1.120, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00758, Train/loss_recog_step=1.120, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00667, Train/loss_recog_step=0.911, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00667, Train/loss_recog_step=0.911, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00877, Train/loss_recog_step=1.340, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00877, Train/loss_recog_step=1.340, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.280, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.040, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.208, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.435, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.85it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.41it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.54it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.36it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.85it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069215, 0.068426, 0.066480
Valid average loss UNet            (all)              : 0.204121

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.182959, 3.286941, 4.821896
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.548936, 3.460073, 3.556784
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.763616, 3.189108, 3.105908
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.596804, 3.757199, 4.172047
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.267202, 3.699227, 4.261190
Valid average loss all      (Triplet)                 : 0.521361

== Recognize ==
Valid average loss Recognize     : 1.037888
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.725482

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.654499769210815 sec. =
Valid knn accuracy drums     : 78.97058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.10882830619812 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.31870412826538 sec. =
Valid knn accuracy piano     : 29.864864864864867%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.796442031860352 sec. =
Valid knn accuracy guitar    : 42.2077922077922%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.100954055786133 sec. =
Valid knn accuracy residuals : 52.67295597484277%

Valid knn accuracy average   : 43.621147233302985%

                                                                        [AEpoch 122: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.150]Epoch 122: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063059, 0.062748, 0.063881
Train average loss UNet            (all)              : 0.189688

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000756, 2.945412, 5.435802
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003271, 2.756018, 4.569986
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002888, 2.867724, 4.557862
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002481, 2.970437, 4.960209
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002760, 3.116306, 4.797605
Train average loss all      (Triplet)                 : 0.002489

== Recognize ==
Train average loss Recognize     : 1.146740
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.192177

Epoch 122:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]          Epoch 123:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]Epoch 123:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]Epoch 123:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=1.000, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]Epoch 123:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00154, Train/loss_recog_step=1.000, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]Epoch 123:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]  Epoch 123:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]Epoch 123:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00761, Train/loss_recog_step=0.824, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]Epoch 123:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00761, Train/loss_recog_step=0.824, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]Epoch 123:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0073, Train/loss_recog_step=1.120, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150] Epoch 123:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0073, Train/loss_recog_step=1.120, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]Epoch 123:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000213, Train/loss_recog_step=0.912, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]Epoch 123:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000213, Train/loss_recog_step=0.912, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]Epoch 123:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00125, Train/loss_recog_step=1.340, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150] Epoch 123: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.00125, Train/loss_recog_step=1.340, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]Epoch 123: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.725, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.521, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.10it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.79it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.69it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.02it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.07it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068965, 0.068166, 0.067135
Valid average loss UNet            (all)              : 0.204266

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.196189, 3.407242, 5.612541
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.719501, 3.588876, 3.637348
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.845299, 3.476537, 3.288028
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.685071, 4.020211, 4.657085
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.309632, 3.825694, 4.673162
Valid average loss all      (Triplet)                 : 0.612028

== Recognize ==
Valid average loss Recognize     : 1.038315
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.816294

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.581353902816772 sec. =
Valid knn accuracy drums     : 78.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.148199081420898 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.99610948562622 sec. =
Valid knn accuracy piano     : 28.513513513513512%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.804128408432007 sec. =
Valid knn accuracy guitar    : 39.61038961038961%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.018709897994995 sec. =
Valid knn accuracy residuals : 52.358490566037744%

Valid knn accuracy average   : 42.6515402974957%

                                                                        [AEpoch 123: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00249, Train/loss_recog_epoch=1.150]Epoch 123: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063073, 0.062826, 0.064029
Train average loss UNet            (all)              : 0.189927

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001347, 2.960190, 5.433094
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005201, 2.735095, 4.478485
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004870, 2.864549, 4.493488
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002841, 2.970905, 4.916289
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004642, 3.107668, 4.763493
Train average loss all      (Triplet)                 : 0.003823

== Recognize ==
Train average loss Recognize     : 1.146796
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.193751

Epoch 123:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]          Epoch 124:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.881, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00983, Train/loss_recog_step=1.200, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.202, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00983, Train/loss_recog_step=1.200, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=0.827, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00266, Train/loss_recog_step=0.827, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]  Epoch 124:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00111, Train/loss_recog_step=0.912, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00111, Train/loss_recog_step=0.912, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00456, Train/loss_recog_step=1.340, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00456, Train/loss_recog_step=1.340, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00801, Train/loss_recog_step=0.880, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.816, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.612, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.427, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.97it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.05it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.13it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.45it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.52it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068183, 0.068050, 0.067777
Valid average loss UNet            (all)              : 0.204010

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.201882, 3.145062, 4.958304
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.662863, 3.281444, 3.370306
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.768002, 3.222465, 3.142551
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.562413, 3.496688, 4.055651
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.268762, 3.516793, 4.325113
Valid average loss all      (Triplet)                 : 0.546175

== Recognize ==
Valid average loss Recognize     : 1.039425
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.750185

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.593405723571777 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.633816957473755 sec. =
Valid knn accuracy bass      : 11.773255813953488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.165640115737915 sec. =
Valid knn accuracy piano     : 31.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.616448163986206 sec. =
Valid knn accuracy guitar    : 43.34415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.103816270828247 sec. =
Valid knn accuracy residuals : 51.729559748427675%

Valid knn accuracy average   : 43.644434026935386%

                                                                        [AEpoch 124: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00801, Train/loss_recog_step=0.880, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.194, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00382, Train/loss_recog_epoch=1.150]Epoch 124: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00801, Train/loss_recog_step=0.880, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.063017, 0.062672, 0.063952
Train average loss UNet            (all)              : 0.189641

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000625, 2.953603, 5.576124
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004050, 2.710842, 4.476962
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005016, 2.831585, 4.451415
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004025, 2.941694, 4.904043
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004888, 3.052942, 4.670030
Train average loss all      (Triplet)                 : 0.003736

== Recognize ==
Train average loss Recognize     : 1.150313
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.193377

Epoch 124:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00801, Train/loss_recog_step=0.880, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]          Epoch 125:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00801, Train/loss_recog_step=0.880, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]Epoch 125:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00801, Train/loss_recog_step=0.880, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]Epoch 125:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0039, Train/loss_recog_step=1.010, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150] Epoch 125:  32%|███▏      | 100/313 [01:32<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0039, Train/loss_recog_step=1.010, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]Epoch 125:  32%|███▏      | 100/313 [01:32<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150] Epoch 125:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]Epoch 125:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.828, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]Epoch 125:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.828, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]Epoch 125:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=1.130, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]Epoch 125:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0135, Train/loss_recog_step=1.130, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]Epoch 125:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=0.913, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]Epoch 125:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.0014, Train/loss_recog_step=0.913, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]Epoch 125:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=1.340, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]Epoch 125: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00252, Train/loss_recog_step=1.340, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]Epoch 125: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00626, Train/loss_recog_step=0.884, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.911, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.436, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.61it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.88it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.02it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071925, 0.071522, 0.069296
Valid average loss UNet            (all)              : 0.212743

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.187358, 3.161194, 5.044362
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.631393, 3.298978, 3.384247
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.672324, 3.220037, 3.192284
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.505981, 3.558530, 4.194611
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.334900, 3.508922, 4.197156
Valid average loss all      (Triplet)                 : 0.511248

== Recognize ==
Valid average loss Recognize     : 1.038655
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.723991

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.499255180358887 sec. =
Valid knn accuracy drums     : 82.6470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.933021783828735 sec. =
Valid knn accuracy bass      : 14.825581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.510197639465332 sec. =
Valid knn accuracy piano     : 25.945945945945947%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.865994691848755 sec. =
Valid knn accuracy guitar    : 35.714285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.191831827163696 sec. =
Valid knn accuracy residuals : 53.930817610062896%

Valid knn accuracy average   : 42.61273789783456%

                                                                        [AEpoch 125: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00626, Train/loss_recog_step=0.884, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.190, Train/loss_triplet_all_epoch=0.00374, Train/loss_recog_epoch=1.150]Epoch 125: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00626, Train/loss_recog_step=0.884, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062854, 0.062512, 0.063702
Train average loss UNet            (all)              : 0.189068

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001775, 2.764427, 5.182333
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004500, 2.567751, 4.225718
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003779, 2.706372, 4.283877
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003167, 2.811446, 4.698504
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003385, 2.899222, 4.467277
Train average loss all      (Triplet)                 : 0.003291

== Recognize ==
Train average loss Recognize     : 1.152498
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.192358

Epoch 125:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00626, Train/loss_recog_step=0.884, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]          Epoch 126:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00626, Train/loss_recog_step=0.884, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00626, Train/loss_recog_step=0.884, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00326, Train/loss_recog_step=1.010, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00326, Train/loss_recog_step=1.010, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]  Epoch 126:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.828, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.828, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.258, Valid/loss_triplet_all_step=0.793, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.724, Valid/loss_unet_all_epoch=0.213, Valid/loss_triplet_all_epoch=0.511, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.426, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.15it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.20it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.77it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.46it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.94it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071615, 0.071047, 0.068827
Valid average loss UNet            (all)              : 0.211489

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.196312, 3.143494, 4.918789
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.709595, 3.455038, 3.343440
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.819770, 3.429442, 3.255594
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.518934, 3.634026, 4.383810
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.355603, 3.792014, 4.172966
Valid average loss all      (Triplet)                 : 0.573424

== Recognize ==
Valid average loss Recognize     : 1.037307
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.784912

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.683094501495361 sec. =
Valid knn accuracy drums     : 81.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.32037091255188 sec. =
Valid knn accuracy bass      : 17.587209302325583%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.161617517471313 sec. =
Valid knn accuracy piano     : 29.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.840971231460571 sec. =
Valid knn accuracy guitar    : 35.38961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.232447862625122 sec. =
Valid knn accuracy residuals : 54.55974842767296%

Valid knn accuracy average   : 43.717965452220675%

                                                                        [AEpoch 126: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00329, Train/loss_recog_epoch=1.150]Epoch 126: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062712, 0.062360, 0.063553
Train average loss UNet            (all)              : 0.188625

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000619, 2.685141, 5.163113
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004277, 2.515646, 4.180607
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003049, 2.616947, 4.153492
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001718, 2.704028, 4.537611
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002603, 2.782568, 4.297464
Train average loss all      (Triplet)                 : 0.002563

== Recognize ==
Train average loss Recognize     : 1.152866
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.191188

Epoch 126:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]          Epoch 127:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=4.55e-5, Train/loss_recog_step=1.190, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=4.55e-5, Train/loss_recog_step=1.190, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.823, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]  Epoch 127:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.823, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00434, Train/loss_recog_step=1.340, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00434, Train/loss_recog_step=1.340, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.255, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.74it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.87it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.80it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.37it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.69it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068610, 0.068159, 0.066940
Valid average loss UNet            (all)              : 0.203709

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.183082, 2.912138, 4.778749
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.759792, 3.263984, 3.100833
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.726616, 3.013065, 2.923529
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.631541, 3.377933, 3.802611
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.298451, 3.317091, 4.024078
Valid average loss all      (Triplet)                 : 0.591061

== Recognize ==
Valid average loss Recognize     : 1.040310
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.794770

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.323648691177368 sec. =
Valid knn accuracy drums     : 80.88235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.294084072113037 sec. =
Valid knn accuracy bass      : 14.825581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.217216491699219 sec. =
Valid knn accuracy piano     : 32.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.077731847763062 sec. =
Valid knn accuracy guitar    : 38.311688311688314%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.990663290023804 sec. =
Valid knn accuracy residuals : 51.57232704402516%

Valid knn accuracy average   : 43.658930478988296%

                                                                        [AEpoch 127: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.150]Epoch 127: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062631, 0.062278, 0.063508
Train average loss UNet            (all)              : 0.188417

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001007, 2.900996, 5.557417
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002784, 2.712557, 4.508755
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003429, 2.803686, 4.435120
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002022, 2.932119, 4.889619
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001199, 2.990976, 4.630162
Train average loss all      (Triplet)                 : 0.002212

== Recognize ==
Train average loss Recognize     : 1.150825
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.190629

Epoch 127:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]          Epoch 128:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000579, Train/loss_recog_step=1.010, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128:  32%|███▏      | 100/313 [01:32<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000579, Train/loss_recog_step=1.010, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128:  32%|███▏      | 100/313 [01:32<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]   Epoch 128:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00612, Train/loss_recog_step=1.350, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.196, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00612, Train/loss_recog_step=1.350, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.260, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.437, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.88it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.26it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.94it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.58it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.07it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.13it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071121, 0.069247, 0.068549
Valid average loss UNet            (all)              : 0.208917

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.178813, 3.299009, 5.295608
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.693050, 3.551186, 3.440005
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.590761, 3.233909, 3.227366
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.557396, 3.839991, 4.488702
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.361259, 3.597900, 4.402081
Valid average loss all      (Triplet)                 : 0.528354

== Recognize ==
Valid average loss Recognize     : 1.044263
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.737272

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.724563598632812 sec. =
Valid knn accuracy drums     : 78.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.4436514377594 sec. =
Valid knn accuracy bass      : 11.19186046511628%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.982697248458862 sec. =
Valid knn accuracy piano     : 29.324324324324323%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.065289497375488 sec. =
Valid knn accuracy guitar    : 35.38961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.360172986984253 sec. =
Valid knn accuracy residuals : 53.459119496855344%

Valid knn accuracy average   : 41.60827705282833%

                                                                        [AEpoch 128: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.150]Epoch 128: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062631, 0.062303, 0.063605
Train average loss UNet            (all)              : 0.188539

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000726, 2.923291, 5.539782
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005118, 2.706801, 4.439414
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004120, 2.837392, 4.448185
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003730, 2.933410, 4.838391
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002924, 3.015918, 4.647083
Train average loss all      (Triplet)                 : 0.003389

== Recognize ==
Train average loss Recognize     : 1.155695
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.191927

Epoch 128:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]          Epoch 129:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=1.010, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00538, Train/loss_recog_step=1.010, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000683, Train/loss_recog_step=1.200, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.000683, Train/loss_recog_step=1.200, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]   Epoch 129:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.829, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.919, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.919, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129:  96%|█████████▌| 300/313 [04:21<00:11,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000245, Train/loss_recog_step=1.350, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000245, Train/loss_recog_step=1.350, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129: 100%|██████████| 313/313 [04:31<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.528, Valid/loss_recog_epoch=1.040, Valid/knn_avr=0.416, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.49it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.52it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.76it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.18it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068037, 0.067756, 0.066298
Valid average loss UNet            (all)              : 0.202091

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.162696, 3.388750, 5.484937
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.633360, 3.589292, 3.565861
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.752941, 3.375962, 3.172580
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.570037, 3.833449, 4.597889
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.322592, 3.802182, 4.443952
Valid average loss all      (Triplet)                 : 0.536121

== Recognize ==
Valid average loss Recognize     : 1.046486
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.738212

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.736887454986572 sec. =
Valid knn accuracy drums     : 78.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.131946325302124 sec. =
Valid knn accuracy bass      : 13.517441860465116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.226162433624268 sec. =
Valid knn accuracy piano     : 26.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.687630891799927 sec. =
Valid knn accuracy guitar    : 38.311688311688314%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.264700412750244 sec. =
Valid knn accuracy residuals : 50.943396226415096%

Valid knn accuracy average   : 41.41778031945933%

                                                                        [AEpoch 129: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.192, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00339, Train/loss_recog_epoch=1.160]Epoch 129: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062508, 0.062117, 0.063389
Train average loss UNet            (all)              : 0.188013

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001584, 2.992846, 5.672637
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003428, 2.783854, 4.597497
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002550, 2.914710, 4.554334
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002221, 3.033382, 5.028125
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003204, 3.155732, 4.863554
Train average loss all      (Triplet)                 : 0.002616

== Recognize ==
Train average loss Recognize     : 1.156842
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.190629

Epoch 129:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]          Epoch 130:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=1.020, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=1.020, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00835, Train/loss_recog_step=1.210, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.201, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00835, Train/loss_recog_step=1.210, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000545, Train/loss_recog_step=0.837, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000545, Train/loss_recog_step=0.837, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=1.140, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]  Epoch 130:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0058, Train/loss_recog_step=1.140, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00833, Train/loss_recog_step=0.927, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00833, Train/loss_recog_step=0.927, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=1.370, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00311, Train/loss_recog_step=1.370, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00265, Train/loss_recog_step=0.893, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.869, Valid/loss_recog_step=1.270, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.67it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.99it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.37it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.26it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068898, 0.067873, 0.066370
Valid average loss UNet            (all)              : 0.203141

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.181335, 3.192055, 5.244562
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.674760, 3.659358, 3.488194
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.656425, 3.215265, 3.155519
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.604894, 3.711674, 4.211118
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.292974, 3.920664, 4.743244
Valid average loss all      (Triplet)                 : 0.530780

== Recognize ==
Valid average loss Recognize     : 1.057068
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.733921

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.519848346710205 sec. =
Valid knn accuracy drums     : 80.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.447007417678833 sec. =
Valid knn accuracy bass      : 17.151162790697676%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.186821460723877 sec. =
Valid knn accuracy piano     : 23.243243243243246%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.851404428482056 sec. =
Valid knn accuracy guitar    : 35.22727272727273%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.82862377166748 sec. =
Valid knn accuracy residuals : 54.088050314465406%

Valid knn accuracy average   : 42.030181109253455%

                                                                        [AEpoch 130: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00265, Train/loss_recog_step=0.893, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00262, Train/loss_recog_epoch=1.160]Epoch 130: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00265, Train/loss_recog_step=0.893, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062611, 0.062337, 0.063591
Train average loss UNet            (all)              : 0.188539

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002121, 3.212275, 6.037639
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005087, 2.985861, 4.901649
Train average loss piano    (Triplet, dist_p, dist_n) : 0.005242, 3.107974, 4.846133
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003076, 3.234874, 5.372766
Train average loss residuals(Triplet, dist_p, dist_n) : 0.004225, 3.344147, 5.122535
Train average loss all      (Triplet)                 : 0.004065

== Recognize ==
Train average loss Recognize     : 1.167470
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.192604

Epoch 130:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00265, Train/loss_recog_step=0.893, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]          Epoch 131:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00265, Train/loss_recog_step=0.893, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]Epoch 131:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00265, Train/loss_recog_step=0.893, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]Epoch 131:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00557, Train/loss_recog_step=1.030, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]Epoch 131:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00557, Train/loss_recog_step=1.030, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]Epoch 131:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=1.210, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170] Epoch 131:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.204, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=1.210, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]Epoch 131:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.842, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170] Epoch 131:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.842, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]Epoch 131:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00207, Train/loss_recog_step=1.150, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]Epoch 131:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00207, Train/loss_recog_step=1.150, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]Epoch 131:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]  Epoch 131:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]Epoch 131:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]Epoch 131: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]Epoch 131: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.884, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.734, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.420, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.32it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.70it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.62it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.28it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068501, 0.067547, 0.065632
Valid average loss UNet            (all)              : 0.201680

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.200706, 3.316083, 5.314906
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.706493, 3.478387, 3.407154
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.716172, 3.342734, 3.366454
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.610774, 3.843384, 4.347081
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.299557, 3.818628, 4.473313
Valid average loss all      (Triplet)                 : 0.565507

== Recognize ==
Valid average loss Recognize     : 1.058607
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.767187

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.70249891281128 sec. =
Valid knn accuracy drums     : 79.70588235294119%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.009870529174805 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.356244802474976 sec. =
Valid knn accuracy piano     : 28.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.768199920654297 sec. =
Valid knn accuracy guitar    : 33.603896103896105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.173819541931152 sec. =
Valid knn accuracy residuals : 56.60377358490566%

Valid knn accuracy average   : 42.818819773527714%

                                                                        [AEpoch 131: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.193, Train/loss_unet_all_epoch=0.189, Train/loss_triplet_all_epoch=0.00406, Train/loss_recog_epoch=1.170]Epoch 131: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062582, 0.062164, 0.063347
Train average loss UNet            (all)              : 0.188094

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000811, 2.905917, 5.590014
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004049, 2.712884, 4.481487
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004243, 2.785514, 4.393220
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002910, 2.939796, 4.894813
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002965, 3.029705, 4.658463
Train average loss all      (Triplet)                 : 0.002930

== Recognize ==
Train average loss Recognize     : 1.172239
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.191024

Epoch 131:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]          Epoch 132:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.834, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.960, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.767, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.566, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.428, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.16it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.43it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.57it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068373, 0.067268, 0.065818
Valid average loss UNet            (all)              : 0.201459

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.146871, 3.109334, 5.182406
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.742513, 3.468344, 3.392869
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.661187, 3.208296, 3.344132
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.586279, 3.700549, 4.194069
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.317734, 3.637581, 4.233079
Valid average loss all      (Triplet)                 : 0.561674

== Recognize ==
Valid average loss Recognize     : 1.051300
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.763134

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.580788850784302 sec. =
Valid knn accuracy drums     : 82.35294117647058%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.302739381790161 sec. =
Valid knn accuracy bass      : 15.11627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.448786497116089 sec. =
Valid knn accuracy piano     : 26.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.163703441619873 sec. =
Valid knn accuracy guitar    : 38.798701298701296%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.941895008087158 sec. =
Valid knn accuracy residuals : 58.01886792452831%

Valid knn accuracy average   : 44.15465519119083%

                                                                        [AEpoch 132: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00293, Train/loss_recog_epoch=1.170]Epoch 132: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062479, 0.062149, 0.063337
Train average loss UNet            (all)              : 0.187965

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001267, 3.104746, 5.843089
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003210, 2.873364, 4.740036
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003435, 2.997905, 4.747968
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002931, 3.136355, 5.211469
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002593, 3.244825, 4.944723
Train average loss all      (Triplet)                 : 0.002763

== Recognize ==
Train average loss Recognize     : 1.166839
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.190728

Epoch 132:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]          Epoch 133:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]Epoch 133:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]Epoch 133:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000823, Train/loss_recog_step=1.020, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]Epoch 133:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000823, Train/loss_recog_step=1.020, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]Epoch 133:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00373, Train/loss_recog_step=1.210, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170] Epoch 133:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.195, Train/loss_triplet_all_step=0.00373, Train/loss_recog_step=1.210, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]Epoch 133:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]  Epoch 133:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.831, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]Epoch 133:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=1.130, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]Epoch 133:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=1.130, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]Epoch 133:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.919, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170] Epoch 133:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.919, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]Epoch 133:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=1.360, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]Epoch 133: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00224, Train/loss_recog_step=1.360, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]Epoch 133: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.763, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.562, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.442, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.35it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.17it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.79it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068475, 0.067838, 0.066584
Valid average loss UNet            (all)              : 0.202897

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.153245, 3.075623, 5.221926
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.739321, 3.478249, 3.413291
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.744798, 3.303422, 3.146722
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.628664, 3.862376, 4.379437
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.263320, 3.504219, 4.252345
Valid average loss all      (Triplet)                 : 0.575208

== Recognize ==
Valid average loss Recognize     : 1.052088
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.778105

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.271136045455933 sec. =
Valid knn accuracy drums     : 80.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.244094848632812 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.20464038848877 sec. =
Valid knn accuracy piano     : 24.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.407395839691162 sec. =
Valid knn accuracy guitar    : 33.603896103896105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.929661989212036 sec. =
Valid knn accuracy residuals : 53.930817610062896%

Valid knn accuracy average   : 41.36020743018781%

                                                                        [AEpoch 133: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.191, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.170]Epoch 133: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062447, 0.062116, 0.063311
Train average loss UNet            (all)              : 0.187874

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001019, 2.955601, 5.602436
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002876, 2.740998, 4.542387
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002816, 2.878692, 4.560268
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002765, 2.981439, 4.974353
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003620, 3.068571, 4.700275
Train average loss all      (Triplet)                 : 0.002608

== Recognize ==
Train average loss Recognize     : 1.162337
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.190481

Epoch 133:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]          Epoch 134:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=1.020, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=1.020, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=1.200, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.208, Train/loss_unet_all_step=0.194, Train/loss_triplet_all_step=0.0138, Train/loss_recog_step=1.200, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.832, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160] Epoch 134:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.832, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.050, Valid/knn_avr=0.414, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.11it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.44it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.26it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.68it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068878, 0.067635, 0.065314
Valid average loss UNet            (all)              : 0.201828

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.134693, 3.253228, 5.233888
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.828336, 3.746520, 3.670271
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.709681, 3.454366, 3.438211
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.589674, 3.833794, 4.349306
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.337162, 4.066958, 4.607754
Valid average loss all      (Triplet)                 : 0.589046

== Recognize ==
Valid average loss Recognize     : 1.056806
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.790874

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.568342685699463 sec. =
Valid knn accuracy drums     : 78.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.137209415435791 sec. =
Valid knn accuracy bass      : 12.790697674418606%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.177783727645874 sec. =
Valid knn accuracy piano     : 30.270270270270274%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.909000635147095 sec. =
Valid knn accuracy guitar    : 42.37012987012987%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.052714586257935 sec. =
Valid knn accuracy residuals : 53.301886792452834%

Valid knn accuracy average   : 43.39365574498373%

                                                                        [AEpoch 134: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.160]Epoch 134: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062384, 0.062063, 0.063196
Train average loss UNet            (all)              : 0.187644

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000624, 3.082773, 5.834248
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004049, 2.885235, 4.772888
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003154, 3.026952, 4.771427
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003025, 3.149235, 5.171487
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002748, 3.248906, 4.980429
Train average loss all      (Triplet)                 : 0.002749

== Recognize ==
Train average loss Recognize     : 1.162261
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.190393

Epoch 134:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]          Epoch 135:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.891, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00827, Train/loss_recog_step=1.210, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.191, Train/loss_triplet_all_step=0.00827, Train/loss_recog_step=1.210, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00745, Train/loss_recog_step=0.839, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00745, Train/loss_recog_step=0.839, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=1.140, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00489, Train/loss_recog_step=1.140, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]  Epoch 135:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.791, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.589, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.434, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.47it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.33it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068646, 0.067209, 0.066466
Valid average loss UNet            (all)              : 0.202321

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.167911, 3.218023, 5.093103
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.740791, 3.491801, 3.489424
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.758247, 3.377513, 3.301897
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.607146, 3.805625, 4.433075
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.311018, 3.881165, 4.564454
Valid average loss all      (Triplet)                 : 0.584752

== Recognize ==
Valid average loss Recognize     : 1.063540
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.787073

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.639326572418213 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.086600542068481 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.283859729766846 sec. =
Valid knn accuracy piano     : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.794803857803345 sec. =
Valid knn accuracy guitar    : 37.66233766233766%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.128055334091187 sec. =
Valid knn accuracy residuals : 57.861635220125784%

Valid knn accuracy average   : 42.95260579400295%

                                                                        [AEpoch 135: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.188, Train/loss_triplet_all_epoch=0.00275, Train/loss_recog_epoch=1.160]Epoch 135: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062232, 0.061936, 0.063117
Train average loss UNet            (all)              : 0.187285

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001498, 3.091341, 5.918140
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004882, 2.916866, 4.800169
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004343, 2.983562, 4.734614
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002917, 3.173733, 5.242478
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001629, 3.265096, 5.048724
Train average loss all      (Triplet)                 : 0.003051

== Recognize ==
Train average loss Recognize     : 1.166034
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.190336

Epoch 135:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]          Epoch 136:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.835, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.835, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136:  80%|███████▉  | 250/313 [03:38<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.930, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.930, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00011, Train/loss_recog_step=1.370, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00011, Train/loss_recog_step=1.370, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=0.889, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.030, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.787, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.585, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.430, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.54it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.17it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.74it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.18it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069411, 0.067875, 0.067117
Valid average loss UNet            (all)              : 0.204403

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.164217, 3.230503, 4.922964
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.772799, 3.591181, 3.527081
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.553085, 3.285641, 3.512023
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.543496, 3.704757, 4.437432
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.282211, 3.707045, 4.376467
Valid average loss all      (Triplet)                 : 0.518289

== Recognize ==
Valid average loss Recognize     : 1.058581
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.722693

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.581674337387085 sec. =
Valid knn accuracy drums     : 81.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.358548402786255 sec. =
Valid knn accuracy bass      : 11.918604651162791%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.094968795776367 sec. =
Valid knn accuracy piano     : 27.027027027027028%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.607308864593506 sec. =
Valid knn accuracy guitar    : 41.23376623376623%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.086548566818237 sec. =
Valid knn accuracy residuals : 54.24528301886793%

Valid knn accuracy average   : 43.09081853910598%

                                                                        [AEpoch 136: 100%|██████████| 313/313 [06:06<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=0.889, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00305, Train/loss_recog_epoch=1.170]Epoch 136: 100%|██████████| 313/313 [06:06<00:00,  0.86it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=0.889, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062137, 0.061822, 0.062997
Train average loss UNet            (all)              : 0.186957

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001732, 3.011869, 5.672292
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002621, 2.790480, 4.620643
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003249, 2.912793, 4.615400
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002817, 3.068765, 5.066093
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001824, 3.175364, 4.886731
Train average loss all      (Triplet)                 : 0.002444

== Recognize ==
Train average loss Recognize     : 1.163558
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.189401

Epoch 136:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=0.889, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]          Epoch 137:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=0.889, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]Epoch 137:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00532, Train/loss_recog_step=0.889, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]Epoch 137:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]  Epoch 137:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]Epoch 137:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]Epoch 137:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.193, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]Epoch 137:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.837, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]Epoch 137:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=0.837, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]Epoch 137:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]Epoch 137:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]Epoch 137:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00664, Train/loss_recog_step=0.929, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]Epoch 137:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00664, Train/loss_recog_step=0.929, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]Epoch 137:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]  Epoch 137: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]Epoch 137: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.795, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.723, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.431, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.11it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.10it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.37it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068992, 0.067582, 0.066213
Valid average loss UNet            (all)              : 0.202787

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.120904, 3.201221, 4.938014
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.781088, 3.508834, 3.441423
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.568680, 3.198329, 3.381012
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.458955, 3.733873, 4.461750
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.278583, 3.839549, 4.483539
Valid average loss all      (Triplet)                 : 0.497106

== Recognize ==
Valid average loss Recognize     : 1.058037
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.699893

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.658760786056519 sec. =
Valid knn accuracy drums     : 81.91176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.230615377426147 sec. =
Valid knn accuracy bass      : 13.517441860465116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.235117197036743 sec. =
Valid knn accuracy piano     : 30.810810810810814%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.920406341552734 sec. =
Valid knn accuracy guitar    : 38.47402597402597%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.965309143066406 sec. =
Valid knn accuracy residuals : 52.67295597484277%

Valid knn accuracy average   : 43.477399865205406%

                                                                        [AEpoch 137: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00244, Train/loss_recog_epoch=1.160]Epoch 137: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062031, 0.061656, 0.062900
Train average loss UNet            (all)              : 0.186588

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000996, 2.961607, 5.503961
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003317, 2.774591, 4.596761
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002391, 2.894913, 4.584058
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002257, 3.061272, 5.092138
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001681, 3.161140, 4.882720
Train average loss all      (Triplet)                 : 0.002238

== Recognize ==
Train average loss Recognize     : 1.164396
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.188826

Epoch 137:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]          Epoch 138:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]Epoch 138:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]Epoch 138:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000841, Train/loss_recog_step=1.030, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]Epoch 138:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000841, Train/loss_recog_step=1.030, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]Epoch 138:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00256, Train/loss_recog_step=1.210, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160] Epoch 138:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00256, Train/loss_recog_step=1.210, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]Epoch 138:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]  Epoch 138:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]Epoch 138:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=1.140, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]Epoch 138:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00212, Train/loss_recog_step=1.140, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]Epoch 138:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]  Epoch 138:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]Epoch 138:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]Epoch 138: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]Epoch 138: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.890, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.777, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.700, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.435, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.14it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.61it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.86it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.21it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.31it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070433, 0.068586, 0.067674
Valid average loss UNet            (all)              : 0.206693

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.125645, 3.248571, 5.288828
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.869149, 3.748701, 3.592360
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.789911, 3.550945, 3.416822
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.463130, 3.978128, 4.781017
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.312857, 4.170990, 5.022039
Valid average loss all      (Triplet)                 : 0.588328

== Recognize ==
Valid average loss Recognize     : 1.059988
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.795021

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.794816493988037 sec. =
Valid knn accuracy drums     : 77.20588235294117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.96240234375 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.38836121559143 sec. =
Valid knn accuracy piano     : 27.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.070512056350708 sec. =
Valid knn accuracy guitar    : 35.22727272727273%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.09653353691101 sec. =
Valid knn accuracy residuals : 54.55974842767296%

Valid knn accuracy average   : 41.84609798630397%

                                                                        [AEpoch 138: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.890, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00224, Train/loss_recog_epoch=1.160]Epoch 138: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.890, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061894, 0.061533, 0.062730
Train average loss UNet            (all)              : 0.186157

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000520, 2.964876, 5.577280
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003232, 2.787734, 4.600257
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002014, 2.909460, 4.607019
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002721, 3.082904, 5.116878
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001637, 3.195799, 4.948549
Train average loss all      (Triplet)                 : 0.002072

== Recognize ==
Train average loss Recognize     : 1.166224
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.188229

Epoch 138:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.890, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]          Epoch 139:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.890, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]Epoch 139:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.890, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]Epoch 139:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]Epoch 139:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]Epoch 139:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00053, Train/loss_recog_step=1.210, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]Epoch 139:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00053, Train/loss_recog_step=1.210, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]Epoch 139:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.0039, Train/loss_recog_step=0.844, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170] Epoch 139:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.0039, Train/loss_recog_step=0.844, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]Epoch 139:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000315, Train/loss_recog_step=1.150, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]Epoch 139:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000315, Train/loss_recog_step=1.150, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]Epoch 139:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000341, Train/loss_recog_step=0.940, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]Epoch 139:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000341, Train/loss_recog_step=0.940, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]Epoch 139:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]   Epoch 139: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]Epoch 139: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=1.260, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.020, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.588, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.418, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.39it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.57it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.54it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.24it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068325, 0.067782, 0.065312
Valid average loss UNet            (all)              : 0.201419

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.144498, 3.290223, 5.320822
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.739999, 3.520660, 3.404052
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.789957, 3.450066, 3.335367
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.452518, 3.830753, 4.731286
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.266765, 3.891526, 4.815943
Valid average loss all      (Triplet)                 : 0.545952

== Recognize ==
Valid average loss Recognize     : 1.060958
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.747371

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.584156274795532 sec. =
Valid knn accuracy drums     : 79.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.054086208343506 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.232873916625977 sec. =
Valid knn accuracy piano     : 31.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.96805739402771 sec. =
Valid knn accuracy guitar    : 41.883116883116884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.208809852600098 sec. =
Valid knn accuracy residuals : 56.44654088050315%

Valid knn accuracy average   : 44.80865532985271%

                                                                        [AEpoch 139: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.170]Epoch 139: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062011, 0.061681, 0.062889
Train average loss UNet            (all)              : 0.186581

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000550, 3.111726, 5.839785
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004285, 2.934878, 4.811391
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003659, 3.036018, 4.780851
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002930, 3.194240, 5.291039
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003170, 3.299732, 5.053343
Train average loss all      (Triplet)                 : 0.003013

== Recognize ==
Train average loss Recognize     : 1.171751
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.189594

Epoch 139:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]          Epoch 140:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]Epoch 140:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.892, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]Epoch 140:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=1.030, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]Epoch 140:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=1.030, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]Epoch 140:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]  Epoch 140:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]Epoch 140:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=0.839, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]Epoch 140:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00775, Train/loss_recog_step=0.839, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]Epoch 140:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]  Epoch 140:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]Epoch 140:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=0.934, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]Epoch 140:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00131, Train/loss_recog_step=0.934, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]Epoch 140:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00315, Train/loss_recog_step=1.370, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]Epoch 140: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00315, Train/loss_recog_step=1.370, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]Epoch 140: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.944, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.82it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.20it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.11it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.58it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.07it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069114, 0.067547, 0.065065
Valid average loss UNet            (all)              : 0.201725

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.161544, 3.097073, 4.805052
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.818885, 3.535532, 3.308021
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.780325, 3.321098, 3.120919
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.484501, 3.569352, 4.078274
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.249235, 3.654060, 4.345923
Valid average loss all      (Triplet)                 : 0.566869

== Recognize ==
Valid average loss Recognize     : 1.060904
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.768594

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.595674991607666 sec. =
Valid knn accuracy drums     : 80.88235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.329074382781982 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.115764856338501 sec. =
Valid knn accuracy piano     : 31.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.88914966583252 sec. =
Valid knn accuracy guitar    : 42.857142857142854%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.023425579071045 sec. =
Valid knn accuracy residuals : 52.51572327044025%

Valid knn accuracy average   : 44.345167006712316%

                                                                        [AEpoch 140: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00301, Train/loss_recog_epoch=1.170]Epoch 140: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061964, 0.061627, 0.062804
Train average loss UNet            (all)              : 0.186395

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000901, 3.022071, 5.653989
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005366, 2.845476, 4.668217
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003086, 2.925951, 4.676706
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003495, 3.084727, 5.105565
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001954, 3.194069, 4.905018
Train average loss all      (Triplet)                 : 0.003023

== Recognize ==
Train average loss Recognize     : 1.168426
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.189418

Epoch 140:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]          Epoch 141:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=1.030, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0027, Train/loss_recog_step=1.030, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=1.210, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00115, Train/loss_recog_step=1.210, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.842, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]  Epoch 141:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.842, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=1.150, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=1.150, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00662, Train/loss_recog_step=0.942, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00662, Train/loss_recog_step=0.942, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00263, Train/loss_recog_step=1.380, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00263, Train/loss_recog_step=1.380, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.942, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.769, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.567, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.443, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.02it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.00it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.53it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067865, 0.067226, 0.065078
Valid average loss UNet            (all)              : 0.200169

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.185341, 2.934089, 4.728523
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.660830, 3.263216, 3.271623
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.642803, 3.026293, 3.015640
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.609594, 3.472241, 3.809421
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.260856, 3.382620, 4.194792
Valid average loss all      (Triplet)                 : 0.531655

== Recognize ==
Valid average loss Recognize     : 1.068918
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.731824

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.748003721237183 sec. =
Valid knn accuracy drums     : 76.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.58147931098938 sec. =
Valid knn accuracy bass      : 18.8953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.251808643341064 sec. =
Valid knn accuracy piano     : 27.432432432432428%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.812587261199951 sec. =
Valid knn accuracy guitar    : 41.55844155844156%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.172839879989624 sec. =
Valid knn accuracy residuals : 54.87421383647799%

Valid knn accuracy average   : 43.846204979971084%

                                                                        [AEpoch 141: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00302, Train/loss_recog_epoch=1.170]Epoch 141: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.062027, 0.061639, 0.062852
Train average loss UNet            (all)              : 0.186518

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001412, 2.799636, 5.219523
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004807, 2.644063, 4.388933
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003604, 2.734299, 4.361622
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003808, 2.830466, 4.689621
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002951, 2.926476, 4.494731
Train average loss all      (Triplet)                 : 0.003342

== Recognize ==
Train average loss Recognize     : 1.172991
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.189860

Epoch 141:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]          Epoch 142:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]Epoch 142:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]Epoch 142:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=1.040, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]Epoch 142:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.003, Train/loss_recog_step=1.040, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]Epoch 142:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000989, Train/loss_recog_step=1.220, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]Epoch 142:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000989, Train/loss_recog_step=1.220, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]Epoch 142:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]   Epoch 142:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.844, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]Epoch 142:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00539, Train/loss_recog_step=1.150, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]Epoch 142:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00539, Train/loss_recog_step=1.150, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]Epoch 142:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]  Epoch 142:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]Epoch 142:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00112, Train/loss_recog_step=1.380, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]Epoch 142: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00112, Train/loss_recog_step=1.380, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]Epoch 142: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=0.915, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.732, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.23it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.99it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.55it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.21it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068786, 0.068403, 0.066673
Valid average loss UNet            (all)              : 0.203862

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.181804, 2.932501, 4.570380
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.569721, 3.133018, 3.180164
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.720401, 3.130992, 2.880756
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.500899, 3.428770, 3.842577
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.222064, 3.481234, 4.132985
Valid average loss all      (Triplet)                 : 0.480747

== Recognize ==
Valid average loss Recognize     : 1.066282
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.684609

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.519670009613037 sec. =
Valid knn accuracy drums     : 81.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.084535121917725 sec. =
Valid knn accuracy bass      : 15.69767441860465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.221070766448975 sec. =
Valid knn accuracy piano     : 28.513513513513512%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.879390001296997 sec. =
Valid knn accuracy guitar    : 43.506493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.776347398757935 sec. =
Valid knn accuracy residuals : 54.71698113207547%

Valid knn accuracy average   : 44.83987369060801%

                                                                        [AEpoch 142: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.190, Train/loss_unet_all_epoch=0.187, Train/loss_triplet_all_epoch=0.00334, Train/loss_recog_epoch=1.170]Epoch 142: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061949, 0.061619, 0.062750
Train average loss UNet            (all)              : 0.186318

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001155, 2.907151, 5.392037
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003628, 2.771483, 4.604206
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003451, 2.871172, 4.578581
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003004, 2.933981, 4.837112
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002063, 3.086193, 4.772383
Train average loss all      (Triplet)                 : 0.002765

== Recognize ==
Train average loss Recognize     : 1.176251
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.189082

Epoch 142:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]          Epoch 143:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=0.845, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00783, Train/loss_recog_step=0.845, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=1.150, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00413, Train/loss_recog_step=1.150, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]  Epoch 143:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=0.958, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.685, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.481, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.93it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.42it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.46it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.23it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.27it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068117, 0.067556, 0.065446
Valid average loss UNet            (all)              : 0.201120

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.155884, 3.303860, 5.221249
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.633704, 3.628554, 3.608160
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.821016, 3.554286, 3.332991
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.597366, 4.016633, 4.494095
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.242551, 3.811665, 4.749820
Valid average loss all      (Triplet)                 : 0.539405

== Recognize ==
Valid average loss Recognize     : 1.060293
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.740525

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.733749628067017 sec. =
Valid knn accuracy drums     : 79.26470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.975598573684692 sec. =
Valid knn accuracy bass      : 17.587209302325583%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.087113380432129 sec. =
Valid knn accuracy piano     : 27.432432432432428%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.896230220794678 sec. =
Valid knn accuracy guitar    : 42.6948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.152472257614136 sec. =
Valid knn accuracy residuals : 55.503144654088054%

Valid knn accuracy average   : 44.49645949320084%

                                                                        [AEpoch 143: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00276, Train/loss_recog_epoch=1.180]Epoch 143: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061659, 0.061390, 0.062554
Train average loss UNet            (all)              : 0.185603

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000567, 2.847968, 5.362042
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002652, 2.701696, 4.522129
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003684, 2.824381, 4.475557
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002376, 2.908503, 4.843886
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001890, 2.991792, 4.606256
Train average loss all      (Triplet)                 : 0.002254

== Recognize ==
Train average loss Recognize     : 1.174258
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.187857

Epoch 143:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]          Epoch 144:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]Epoch 144:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.899, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]Epoch 144:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=9.19e-5, Train/loss_recog_step=1.030, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]Epoch 144:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=9.19e-5, Train/loss_recog_step=1.030, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]Epoch 144:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.210, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170] Epoch 144:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.210, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]Epoch 144:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170] Epoch 144:  64%|██████▍   | 200/313 [02:56<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.838, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]Epoch 144:  64%|██████▍   | 200/313 [02:56<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000129, Train/loss_recog_step=1.150, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]Epoch 144:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000129, Train/loss_recog_step=1.150, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]Epoch 144:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]   Epoch 144:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.938, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]Epoch 144:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00282, Train/loss_recog_step=1.370, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]Epoch 144: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00282, Train/loss_recog_step=1.370, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]Epoch 144: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00906, Train/loss_recog_step=0.897, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.866, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.21it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.34it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.83it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.42it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.33it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067727, 0.067525, 0.065759
Valid average loss UNet            (all)              : 0.201011

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.202092, 3.422061, 5.399956
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.677332, 3.764148, 3.772027
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.751748, 3.571890, 3.432477
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.554798, 4.052722, 4.497381
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.256421, 3.959983, 5.008153
Valid average loss all      (Triplet)                 : 0.544153

== Recognize ==
Valid average loss Recognize     : 1.060493
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.745164

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.658183336257935 sec. =
Valid knn accuracy drums     : 81.91176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.208795070648193 sec. =
Valid knn accuracy bass      : 12.063953488372094%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.124509811401367 sec. =
Valid knn accuracy piano     : 28.91891891891892%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.76703929901123 sec. =
Valid knn accuracy guitar    : 38.798701298701296%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.143243312835693 sec. =
Valid knn accuracy residuals : 52.67295597484277%

Valid knn accuracy average   : 42.87325887734348%

                                                                        [AEpoch 144: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00906, Train/loss_recog_step=0.897, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00225, Train/loss_recog_epoch=1.170]Epoch 144: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00906, Train/loss_recog_step=0.897, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061633, 0.061332, 0.062507
Train average loss UNet            (all)              : 0.185472

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000833, 3.057021, 5.770428
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002480, 2.901379, 4.848782
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002701, 3.006885, 4.790204
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002017, 3.116046, 5.228025
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001536, 3.229359, 5.000832
Train average loss all      (Triplet)                 : 0.002006

== Recognize ==
Train average loss Recognize     : 1.170614
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.187478

Epoch 144:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00906, Train/loss_recog_step=0.897, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]          Epoch 145:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00906, Train/loss_recog_step=0.897, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]Epoch 145:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00906, Train/loss_recog_step=0.897, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]Epoch 145:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=1.030, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170] Epoch 145:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0208, Train/loss_recog_step=1.030, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]Epoch 145:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00852, Train/loss_recog_step=1.210, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]Epoch 145:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.00852, Train/loss_recog_step=1.210, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]Epoch 145:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000417, Train/loss_recog_step=0.838, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]Epoch 145:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000417, Train/loss_recog_step=0.838, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]Epoch 145:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]   Epoch 145:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]Epoch 145:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=0.932, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]Epoch 145:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.0019, Train/loss_recog_step=0.932, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]Epoch 145:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0091, Train/loss_recog_step=1.370, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]Epoch 145: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0091, Train/loss_recog_step=1.370, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]Epoch 145: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.897, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.952, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.544, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.429, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.13it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.10it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.89it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.15it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.63it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068482, 0.067020, 0.065729
Valid average loss UNet            (all)              : 0.201231

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.145821, 3.438813, 5.704716
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.651948, 3.801512, 3.773156
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.810171, 3.814109, 3.613299
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.491278, 4.013886, 4.500523
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.254973, 4.205449, 5.101137
Valid average loss all      (Triplet)                 : 0.525688

== Recognize ==
Valid average loss Recognize     : 1.056754
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.726919

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.766548871994019 sec. =
Valid knn accuracy drums     : 78.97058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.75677227973938 sec. =
Valid knn accuracy bass      : 16.424418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.382431745529175 sec. =
Valid knn accuracy piano     : 31.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.126105785369873 sec. =
Valid knn accuracy guitar    : 41.07142857142857%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.938968658447266 sec. =
Valid knn accuracy residuals : 55.0314465408805%

Valid knn accuracy average   : 44.515792606667084%

                                                                        [AEpoch 145: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.897, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.170]Epoch 145: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.897, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061689, 0.061364, 0.062596
Train average loss UNet            (all)              : 0.185648

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001196, 3.236999, 6.129293
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004686, 3.065772, 5.066465
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002454, 3.187401, 5.053271
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001728, 3.281603, 5.507175
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002800, 3.439724, 5.294432
Train average loss all      (Triplet)                 : 0.002586

== Recognize ==
Train average loss Recognize     : 1.169309
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.188235

Epoch 145:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.897, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]          Epoch 146:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.897, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]Epoch 146:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.001, Train/loss_recog_step=0.897, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]Epoch 146:  16%|█▌        | 50/313 [00:46<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00514, Train/loss_recog_step=1.020, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]Epoch 146:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00514, Train/loss_recog_step=1.020, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]Epoch 146:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00217, Train/loss_recog_step=1.220, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]Epoch 146:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00217, Train/loss_recog_step=1.220, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]Epoch 146:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00633, Train/loss_recog_step=0.842, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]Epoch 146:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00633, Train/loss_recog_step=0.842, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]Epoch 146:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=1.150, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170] Epoch 146:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.0011, Train/loss_recog_step=1.150, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]Epoch 146:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=0.938, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]Epoch 146:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00267, Train/loss_recog_step=0.938, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]Epoch 146:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.0031, Train/loss_recog_step=1.370, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170] Epoch 146: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.0031, Train/loss_recog_step=1.370, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]Epoch 146: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.864, Valid/loss_recog_step=1.280, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.526, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.445, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.10it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.41it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.31it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.94it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068609, 0.068136, 0.067019
Valid average loss UNet            (all)              : 0.203765

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.117575, 3.467953, 5.642335
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.725112, 3.953579, 3.933049
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.848545, 3.845206, 3.702299
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.477274, 3.923138, 4.574490
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.190767, 4.137772, 4.874104
Valid average loss all      (Triplet)                 : 0.538689

== Recognize ==
Valid average loss Recognize     : 1.062875
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.742453

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.570446491241455 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.191557168960571 sec. =
Valid knn accuracy bass      : 15.261627906976743%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.328470468521118 sec. =
Valid knn accuracy piano     : 29.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.92898678779602 sec. =
Valid knn accuracy guitar    : 37.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.096051216125488 sec. =
Valid knn accuracy residuals : 58.17610062893082%

Valid knn accuracy average   : 43.550025834367524%

                                                                        [AEpoch 146: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00259, Train/loss_recog_epoch=1.170]Epoch 146: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061666, 0.061307, 0.062552
Train average loss UNet            (all)              : 0.185525

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000751, 3.134838, 5.834739
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003542, 2.981068, 4.911202
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003226, 3.112877, 4.888427
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003594, 3.211550, 5.346127
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003095, 3.334586, 5.140843
Train average loss all      (Triplet)                 : 0.002899

== Recognize ==
Train average loss Recognize     : 1.174916
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.188424

Epoch 146:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]          Epoch 147:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]Epoch 147:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]Epoch 147:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000539, Train/loss_recog_step=1.030, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]Epoch 147:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000539, Train/loss_recog_step=1.030, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]Epoch 147:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]   Epoch 147:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]Epoch 147:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000123, Train/loss_recog_step=0.839, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]Epoch 147:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000123, Train/loss_recog_step=0.839, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]Epoch 147:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=1.140, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170] Epoch 147:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=1.140, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]Epoch 147:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]  Epoch 147:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]Epoch 147:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]Epoch 147: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]Epoch 147: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=1.170, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.934, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.742, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.436, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.92it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.67it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.39it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.46it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069392, 0.068138, 0.067010
Valid average loss UNet            (all)              : 0.204540

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.180952, 3.399975, 5.444719
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.677844, 3.964771, 3.943715
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.749178, 3.616273, 3.510075
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.559490, 3.858406, 4.354223
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.259409, 4.034521, 4.787413
Valid average loss all      (Triplet)                 : 0.524285

== Recognize ==
Valid average loss Recognize     : 1.055125
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.728825

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.594332218170166 sec. =
Valid knn accuracy drums     : 76.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.432008981704712 sec. =
Valid knn accuracy bass      : 11.627906976744185%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.045787811279297 sec. =
Valid knn accuracy piano     : 24.594594594594597%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.083421230316162 sec. =
Valid knn accuracy guitar    : 33.44155844155844%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.202783107757568 sec. =
Valid knn accuracy residuals : 54.71698113207547%

Valid knn accuracy average   : 40.08209058193572%

                                                                        [AEpoch 147: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.0029, Train/loss_recog_epoch=1.170]Epoch 147: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061686, 0.061404, 0.062514
Train average loss UNet            (all)              : 0.185604

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000796, 3.174712, 5.953897
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003846, 3.004721, 4.960941
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003739, 3.103271, 4.893945
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002844, 3.197894, 5.330409
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003335, 3.327439, 5.109017
Train average loss all      (Triplet)                 : 0.002916

== Recognize ==
Train average loss Recognize     : 1.170352
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.188520

Epoch 147:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]          Epoch 148:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.893, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000447, Train/loss_recog_step=1.210, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.192, Train/loss_triplet_all_step=0.000447, Train/loss_recog_step=1.210, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000767, Train/loss_recog_step=0.843, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000767, Train/loss_recog_step=0.843, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]   Epoch 148:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.936, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.936, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.762, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.729, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.060, Valid/knn_avr=0.401, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.10it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.40it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.46it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.55it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.41it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068436, 0.067472, 0.065631
Valid average loss UNet            (all)              : 0.201540

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.148438, 2.984574, 4.884171
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.555957, 3.376101, 3.405363
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.692661, 3.190254, 3.127367
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.412415, 3.477002, 4.238016
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.299370, 3.552505, 4.104707
Valid average loss all      (Triplet)                 : 0.446835

== Recognize ==
Valid average loss Recognize     : 1.066786
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.648374

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.58432149887085 sec. =
Valid knn accuracy drums     : 81.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.284287452697754 sec. =
Valid knn accuracy bass      : 11.337209302325581%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.549676179885864 sec. =
Valid knn accuracy piano     : 33.108108108108105%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.735568761825562 sec. =
Valid knn accuracy guitar    : 35.714285714285715%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.83366060256958 sec. =
Valid knn accuracy residuals : 56.60377358490566%

Valid knn accuracy average   : 43.70561651839561%

                                                                        [AEpoch 148: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.186, Train/loss_triplet_all_epoch=0.00292, Train/loss_recog_epoch=1.170]Epoch 148: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061697, 0.061283, 0.062512
Train average loss UNet            (all)              : 0.185492

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000802, 3.074281, 5.769817
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003602, 2.899596, 4.794564
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004722, 3.056130, 4.825721
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004053, 3.162483, 5.243006
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003127, 3.264431, 5.034090
Train average loss all      (Triplet)                 : 0.003273

== Recognize ==
Train average loss Recognize     : 1.173225
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.188765

Epoch 148:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]          Epoch 149:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00595, Train/loss_recog_step=1.230, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00595, Train/loss_recog_step=1.230, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00392, Train/loss_recog_step=0.850, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00392, Train/loss_recog_step=0.850, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=3.98e-7, Train/loss_recog_step=1.160, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=3.98e-7, Train/loss_recog_step=1.160, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.945, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.945, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00624, Train/loss_recog_step=1.390, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00624, Train/loss_recog_step=1.390, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.787, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.552, Valid/loss_recog_step=1.290, Valid/loss_all_epoch=0.648, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.447, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.47it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.94it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.53it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.37it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.11it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068427, 0.067707, 0.066543
Valid average loss UNet            (all)              : 0.202676

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.171356, 3.171390, 5.085945
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.656632, 3.513798, 3.470243
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.657697, 3.169205, 3.188660
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.434815, 3.579511, 4.236855
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.287778, 3.845842, 4.461576
Valid average loss all      (Triplet)                 : 0.488398

== Recognize ==
Valid average loss Recognize     : 1.072216
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.691074

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.844694375991821 sec. =
Valid knn accuracy drums     : 77.64705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.379047870635986 sec. =
Valid knn accuracy bass      : 11.627906976744185%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.549944639205933 sec. =
Valid knn accuracy piano     : 27.432432432432428%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.997559070587158 sec. =
Valid knn accuracy guitar    : 43.66883116883117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.788499355316162 sec. =
Valid knn accuracy residuals : 58.17610062893082%

Valid knn accuracy average   : 43.71046600609361%

                                                                        [AEpoch 149: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.189, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00327, Train/loss_recog_epoch=1.170]Epoch 149: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061359, 0.061048, 0.062221
Train average loss UNet            (all)              : 0.184628

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000812, 2.999083, 5.683294
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001838, 2.789605, 4.685591
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002466, 2.945016, 4.726332
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002405, 3.059158, 5.135155
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002178, 3.217498, 5.014399
Train average loss all      (Triplet)                 : 0.001982

== Recognize ==
Train average loss Recognize     : 1.185563
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.186610

Epoch 149:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]          Epoch 150:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.907, Valid/loss_all_step=0.960, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.723, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.488, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.437, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.95it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.82it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.64it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.14it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068473, 0.067357, 0.066692
Valid average loss UNet            (all)              : 0.202522

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.158189, 3.204752, 5.285670
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.663820, 3.640157, 3.568185
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.768287, 3.282316, 3.119039
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.415536, 3.495879, 4.271087
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.293924, 3.798468, 4.502917
Valid average loss all      (Triplet)                 : 0.496796

== Recognize ==
Valid average loss Recognize     : 1.070344
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.699318

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.740537643432617 sec. =
Valid knn accuracy drums     : 81.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.865646600723267 sec. =
Valid knn accuracy bass      : 17.87790697674419%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.25992727279663 sec. =
Valid knn accuracy piano     : 25.945945945945947%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.924479484558105 sec. =
Valid knn accuracy guitar    : 43.66883116883117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.087499141693115 sec. =
Valid knn accuracy residuals : 55.503144654088054%

Valid knn accuracy average   : 44.805048102063054%

                                                                        [AEpoch 150: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.907, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00198, Train/loss_recog_epoch=1.190]Epoch 150: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.907, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061407, 0.061138, 0.062354
Train average loss UNet            (all)              : 0.184899

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000631, 3.088177, 5.855738
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003915, 2.894222, 4.788609
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004183, 3.019476, 4.798119
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002171, 3.147035, 5.257275
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002981, 3.314389, 5.136067
Train average loss all      (Triplet)                 : 0.002674

== Recognize ==
Train average loss Recognize     : 1.183794
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.187573

Epoch 150:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.907, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]          Epoch 151:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.907, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]Epoch 151:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00735, Train/loss_recog_step=0.907, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]Epoch 151:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00799, Train/loss_recog_step=1.040, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]Epoch 151:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00799, Train/loss_recog_step=1.040, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]Epoch 151:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]  Epoch 151:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]Epoch 151:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.008, Train/loss_recog_step=0.849, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]Epoch 151:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.008, Train/loss_recog_step=0.849, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]Epoch 151:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=1.160, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]Epoch 151:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00438, Train/loss_recog_step=1.160, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]Epoch 151:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]  Epoch 151:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.946, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]Epoch 151:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00186, Train/loss_recog_step=1.380, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]Epoch 151: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00186, Train/loss_recog_step=1.380, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]Epoch 151: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=0.921, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.692, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.699, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.448, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.33it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.50it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.49it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.47it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068075, 0.067013, 0.065424
Valid average loss UNet            (all)              : 0.200512

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.153245, 3.199011, 5.274464
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.747991, 3.710081, 3.587355
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.744059, 3.418836, 3.304837
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.529920, 3.924863, 4.720434
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.293022, 4.161242, 4.616538
Valid average loss all      (Triplet)                 : 0.549436

== Recognize ==
Valid average loss Recognize     : 1.069234
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.749949

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.489691734313965 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.326233148574829 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.97756576538086 sec. =
Valid knn accuracy piano     : 31.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.886301279067993 sec. =
Valid knn accuracy guitar    : 42.04545454545455%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.035799980163574 sec. =
Valid knn accuracy residuals : 60.062893081761004%

Valid knn accuracy average   : 45.95081323823935%

                                                                        [AEpoch 151: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.188, Train/loss_unet_all_epoch=0.185, Train/loss_triplet_all_epoch=0.00267, Train/loss_recog_epoch=1.180]Epoch 151: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061242, 0.060929, 0.062134
Train average loss UNet            (all)              : 0.184305

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000476, 2.862331, 5.388043
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003317, 2.685427, 4.517716
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002299, 2.784640, 4.468095
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001901, 2.951249, 4.945705
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002515, 3.055789, 4.773165
Train average loss all      (Triplet)                 : 0.002165

== Recognize ==
Train average loss Recognize     : 1.184798
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.186470

Epoch 151:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]          Epoch 152:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000121, Train/loss_recog_step=0.846, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000121, Train/loss_recog_step=0.846, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]   Epoch 152:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=0.944, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00251, Train/loss_recog_step=0.944, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00606, Train/loss_recog_step=1.390, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00606, Train/loss_recog_step=1.390, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.899, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.750, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.460, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.56it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.79it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.47it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.17it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068711, 0.068700, 0.066860
Valid average loss UNet            (all)              : 0.204272

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.101705, 3.030699, 4.922553
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.613341, 3.407191, 3.404872
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.751485, 3.274672, 3.161195
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.463178, 3.610677, 4.090157
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.278148, 3.762013, 4.225887
Valid average loss all      (Triplet)                 : 0.492665

== Recognize ==
Valid average loss Recognize     : 1.072344
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.696937

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.699452877044678 sec. =
Valid knn accuracy drums     : 78.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.92370080947876 sec. =
Valid knn accuracy bass      : 12.063953488372094%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.171024799346924 sec. =
Valid knn accuracy piano     : 29.864864864864867%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.148163080215454 sec. =
Valid knn accuracy guitar    : 43.66883116883117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.175500392913818 sec. =
Valid knn accuracy residuals : 59.27672955974843%

Valid knn accuracy average   : 44.73958169871626%

                                                                        [AEpoch 152: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00216, Train/loss_recog_epoch=1.180]Epoch 152: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061175, 0.060825, 0.062065
Train average loss UNet            (all)              : 0.184065

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001391, 3.005318, 5.637513
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003257, 2.800488, 4.663043
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001866, 2.938918, 4.656609
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001839, 3.061169, 5.130831
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001756, 3.180095, 4.932430
Train average loss all      (Triplet)                 : 0.002006

== Recognize ==
Train average loss Recognize     : 1.179736
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.186071

Epoch 152:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]          Epoch 153:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.902, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00357, Train/loss_recog_step=0.846, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00357, Train/loss_recog_step=0.846, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]  Epoch 153:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.945, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.015, Train/loss_recog_step=0.945, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00024, Train/loss_recog_step=1.390, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00024, Train/loss_recog_step=1.390, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.820, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.493, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.447, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.24it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.36it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.10it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.45it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.95it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068422, 0.067742, 0.066281
Valid average loss UNet            (all)              : 0.202444

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.147428, 3.384689, 5.348843
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.828218, 4.054697, 3.867307
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.864233, 3.690097, 3.503609
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.546043, 4.091184, 4.685864
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.291227, 4.070385, 4.785746
Valid average loss all      (Triplet)                 : 0.616543

== Recognize ==
Valid average loss Recognize     : 1.071883
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.818987

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.895935297012329 sec. =
Valid knn accuracy drums     : 81.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.194627285003662 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.173593997955322 sec. =
Valid knn accuracy piano     : 27.027027027027028%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.988461017608643 sec. =
Valid knn accuracy guitar    : 41.55844155844156%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.102309703826904 sec. =
Valid knn accuracy residuals : 55.0314465408805%

Valid knn accuracy average   : 43.83624212239704%

                                                                        [AEpoch 153: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00201, Train/loss_recog_epoch=1.180]Epoch 153: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061197, 0.060862, 0.062001
Train average loss UNet            (all)              : 0.184060

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000543, 3.027278, 5.578106
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003192, 2.837274, 4.714464
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003008, 2.976263, 4.734314
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001895, 3.086678, 5.165927
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001717, 3.209017, 4.969356
Train average loss all      (Triplet)                 : 0.002198

== Recognize ==
Train average loss Recognize     : 1.182427
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.186258

Epoch 153:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]          Epoch 154:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]Epoch 154:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]Epoch 154:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000934, Train/loss_recog_step=1.040, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]Epoch 154:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000934, Train/loss_recog_step=1.040, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]Epoch 154:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00547, Train/loss_recog_step=1.230, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180] Epoch 154:  48%|████▊     | 150/313 [02:17<02:28,  1.09it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.00547, Train/loss_recog_step=1.230, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]Epoch 154:  48%|████▊     | 150/313 [02:17<02:28,  1.09it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]  Epoch 154:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]Epoch 154:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]Epoch 154:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]Epoch 154:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.945, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]Epoch 154:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.013, Train/loss_recog_step=0.945, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]Epoch 154:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]Epoch 154: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]Epoch 154: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=1.460, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.220, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.819, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.617, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.438, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.40it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.13it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.48it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.12it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.58it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069261, 0.068014, 0.065862
Valid average loss UNet            (all)              : 0.203137

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.163318, 3.012885, 4.952241
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.738559, 3.599915, 3.492209
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.668047, 3.240090, 3.307803
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.587063, 3.635588, 4.044723
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.240899, 3.569906, 4.100492
Valid average loss all      (Triplet)                 : 0.535648

== Recognize ==
Valid average loss Recognize     : 1.071255
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.738785

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.605791807174683 sec. =
Valid knn accuracy drums     : 78.97058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.167614459991455 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.206377506256104 sec. =
Valid knn accuracy piano     : 29.324324324324323%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.768917322158813 sec. =
Valid knn accuracy guitar    : 43.34415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.014658689498901 sec. =
Valid knn accuracy residuals : 56.289308176100626%

Valid knn accuracy average   : 44.405442757835445%

                                                                        [AEpoch 154: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.180]Epoch 154: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061266, 0.060898, 0.062121
Train average loss UNet            (all)              : 0.184285

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001224, 2.930207, 5.453085
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003366, 2.774495, 4.655936
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004429, 2.894809, 4.592737
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002311, 3.004992, 4.989523
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002098, 3.097013, 4.794289
Train average loss all      (Triplet)                 : 0.002805

== Recognize ==
Train average loss Recognize     : 1.183435
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.187090

Epoch 154:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]          Epoch 155:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]Epoch 155:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]Epoch 155:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00104, Train/loss_recog_step=1.040, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]Epoch 155:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00104, Train/loss_recog_step=1.040, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]Epoch 155:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=1.230, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180] Epoch 155:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.200, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=1.230, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]Epoch 155:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0059, Train/loss_recog_step=0.848, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]Epoch 155:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0059, Train/loss_recog_step=0.848, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]Epoch 155:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180] Epoch 155:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]Epoch 155:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]Epoch 155:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]Epoch 155:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=1.390, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]Epoch 155: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=1.390, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]Epoch 155: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.444, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.93it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.48it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.34it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.11it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.85it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068548, 0.066759, 0.064864
Valid average loss UNet            (all)              : 0.200171

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.123359, 3.168166, 5.273253
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.643398, 3.676471, 3.664715
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.755600, 3.474289, 3.306235
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.618918, 3.810106, 4.214916
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.268537, 3.851980, 4.402504
Valid average loss all      (Triplet)                 : 0.536972

== Recognize ==
Valid average loss Recognize     : 1.075090
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.737143

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.6446533203125 sec. =
Valid knn accuracy drums     : 81.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.443260431289673 sec. =
Valid knn accuracy bass      : 15.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.346180200576782 sec. =
Valid knn accuracy piano     : 27.837837837837835%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.870993375778198 sec. =
Valid knn accuracy guitar    : 43.18181818181818%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.912245273590088 sec. =
Valid knn accuracy residuals : 53.459119496855344%

Valid knn accuracy average   : 44.299653872112124%

                                                                        [AEpoch 155: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00281, Train/loss_recog_epoch=1.180]Epoch 155: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061110, 0.060705, 0.061891
Train average loss UNet            (all)              : 0.183706

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000602, 2.983711, 5.617016
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003196, 2.851740, 4.851306
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002430, 2.957214, 4.759612
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002023, 3.050477, 5.068682
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001928, 3.170947, 4.933432
Train average loss all      (Triplet)                 : 0.002034

== Recognize ==
Train average loss Recognize     : 1.184050
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.185741

Epoch 155:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]          Epoch 156:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=1.040, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0022, Train/loss_recog_step=1.040, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180] Epoch 156:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.853, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.950, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.950, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00381, Train/loss_recog_step=1.390, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00381, Train/loss_recog_step=1.390, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.886, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.537, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.443, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.22it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.09it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.61it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.44it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068308, 0.066994, 0.065835
Valid average loss UNet            (all)              : 0.201137

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.111441, 3.355727, 5.513895
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.745530, 3.775965, 3.663446
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.854631, 3.773033, 3.648958
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.668623, 4.118371, 4.487457
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.292292, 3.993650, 4.670646
Valid average loss all      (Triplet)                 : 0.601518

== Recognize ==
Valid average loss Recognize     : 1.076353
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.802655

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.588511228561401 sec. =
Valid knn accuracy drums     : 80.58823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.047598361968994 sec. =
Valid knn accuracy bass      : 13.226744186046513%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.620542764663696 sec. =
Valid knn accuracy piano     : 25.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.986435413360596 sec. =
Valid knn accuracy guitar    : 45.77922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.149290800094604 sec. =
Valid knn accuracy residuals : 54.55974842767296%

Valid knn accuracy average   : 43.85781676443861%

                                                                        [AEpoch 156: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00203, Train/loss_recog_epoch=1.180]Epoch 156: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061009, 0.060690, 0.061875
Train average loss UNet            (all)              : 0.183574

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000555, 3.029361, 5.704882
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003267, 2.867228, 4.787331
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002005, 2.981951, 4.781234
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002387, 3.112765, 5.203084
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001715, 3.261076, 5.019298
Train average loss all      (Triplet)                 : 0.002103

== Recognize ==
Train average loss Recognize     : 1.188576
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.185677

Epoch 156:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]          Epoch 157:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157:  32%|███▏      | 100/313 [01:29<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.189, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.849, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157:  64%|██████▍   | 200/313 [02:55<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.160, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.160, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.0053, Train/loss_recog_step=0.946, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.0053, Train/loss_recog_step=0.946, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00501, Train/loss_recog_step=1.390, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00501, Train/loss_recog_step=1.390, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=1.270, Valid/loss_unet_all_step=0.227, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.803, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.602, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.439, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.98it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.36it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.06it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.39it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071111, 0.070121, 0.068940
Valid average loss UNet            (all)              : 0.210172

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.151027, 3.542836, 5.570536
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.718404, 4.075122, 4.039892
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.902924, 4.006355, 3.724968
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.552073, 4.089300, 4.821442
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.356256, 4.380359, 5.202832
Valid average loss all      (Triplet)                 : 0.591945

== Recognize ==
Valid average loss Recognize     : 1.073515
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.802117

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.579902648925781 sec. =
Valid knn accuracy drums     : 76.91176470588236%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.607471942901611 sec. =
Valid knn accuracy bass      : 13.517441860465116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.123995304107666 sec. =
Valid knn accuracy piano     : 22.162162162162165%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.668885946273804 sec. =
Valid knn accuracy guitar    : 38.961038961038966%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.058612823486328 sec. =
Valid knn accuracy residuals : 59.11949685534591%

Valid knn accuracy average   : 42.134380908978905%

                                                                        [AEpoch 157: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.0021, Train/loss_recog_epoch=1.190]Epoch 157: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061195, 0.060851, 0.062004
Train average loss UNet            (all)              : 0.184051

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000746, 3.159617, 5.859507
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004467, 3.009740, 4.983176
Train average loss piano    (Triplet, dist_p, dist_n) : 0.004062, 3.119747, 4.989972
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001782, 3.225141, 5.386425
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003411, 3.376978, 5.208555
Train average loss all      (Triplet)                 : 0.002891

== Recognize ==
Train average loss Recognize     : 1.186435
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.186942

Epoch 157:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]          Epoch 158:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.908, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00362, Train/loss_recog_step=1.050, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00362, Train/loss_recog_step=1.050, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=1.230, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.190, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=1.230, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.849, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00139, Train/loss_recog_step=0.849, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=1.160, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00184, Train/loss_recog_step=1.160, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]  Epoch 158:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00349, Train/loss_recog_step=1.380, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00349, Train/loss_recog_step=1.380, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.252, Valid/loss_triplet_all_step=0.939, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.802, Valid/loss_unet_all_epoch=0.210, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.421, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.17it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.81it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.03it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.72it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.66it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069510, 0.068504, 0.067052
Valid average loss UNet            (all)              : 0.205065

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.141137, 3.200406, 5.027763
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.622002, 3.695089, 3.684442
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.716826, 3.480157, 3.314840
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.527375, 3.795874, 4.323641
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.251744, 3.735684, 4.820210
Valid average loss all      (Triplet)                 : 0.485446

== Recognize ==
Valid average loss Recognize     : 1.072135
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.690511

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.72471308708191 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.616363048553467 sec. =
Valid knn accuracy bass      : 13.517441860465116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.131457090377808 sec. =
Valid knn accuracy piano     : 26.351351351351347%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.941479921340942 sec. =
Valid knn accuracy guitar    : 43.83116883116883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.057885885238647 sec. =
Valid knn accuracy residuals : 55.9748427672956%

Valid knn accuracy average   : 43.640843314997355%

                                                                        [AEpoch 158: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00289, Train/loss_recog_epoch=1.190]Epoch 158: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061138, 0.060795, 0.061954
Train average loss UNet            (all)              : 0.183887

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000911, 3.135671, 5.834492
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004355, 3.009714, 5.028109
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002155, 3.124309, 4.967556
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003334, 3.243054, 5.451083
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001991, 3.365598, 5.188165
Train average loss all      (Triplet)                 : 0.002564

== Recognize ==
Train average loss Recognize     : 1.185709
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.186451

Epoch 158:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]          Epoch 159:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.905, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000628, Train/loss_recog_step=1.040, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000628, Train/loss_recog_step=1.040, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]   Epoch 159:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.847, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.0093, Train/loss_recog_step=1.380, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.0093, Train/loss_recog_step=1.380, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.894, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.647, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.485, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.436, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.16it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.99it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.80it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068133, 0.068091, 0.064924
Valid average loss UNet            (all)              : 0.201149

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.171438, 3.261154, 5.184284
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.652843, 3.610195, 3.570867
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.682192, 3.447540, 3.375416
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.437194, 3.767110, 4.556961
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.300816, 3.699094, 4.875535
Valid average loss all      (Triplet)                 : 0.492055

== Recognize ==
Valid average loss Recognize     : 1.068331
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.693204

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.357387781143188 sec. =
Valid knn accuracy drums     : 79.70588235294119%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.306862354278564 sec. =
Valid knn accuracy bass      : 12.790697674418606%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.109813213348389 sec. =
Valid knn accuracy piano     : 25.945945945945947%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.166226625442505 sec. =
Valid knn accuracy guitar    : 40.909090909090914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.126023769378662 sec. =
Valid knn accuracy residuals : 54.088050314465406%

Valid knn accuracy average   : 42.68793343937241%

                                                                        [AEpoch 159: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.186, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00256, Train/loss_recog_epoch=1.190]Epoch 159: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060769, 0.060466, 0.061692
Train average loss UNet            (all)              : 0.182927

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000517, 3.129610, 5.812016
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002766, 2.964833, 5.005789
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002731, 3.075271, 4.902709
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003108, 3.217518, 5.396171
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001728, 3.312742, 5.085932
Train average loss all      (Triplet)                 : 0.002126

== Recognize ==
Train average loss Recognize     : 1.183244
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.185053

Epoch 159:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]          Epoch 160:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000181, Train/loss_recog_step=1.040, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000181, Train/loss_recog_step=1.040, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]   Epoch 160:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.848, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00785, Train/loss_recog_step=0.911, Valid/loss_all_step=0.945, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.712, Valid/loss_recog_step=1.300, Valid/loss_all_epoch=0.693, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.492, Valid/loss_recog_epoch=1.070, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.16it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.34it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.07it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068270, 0.066986, 0.065934
Valid average loss UNet            (all)              : 0.201189

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.111935, 3.447794, 5.515980
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.599743, 3.681288, 3.758825
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.753043, 3.726868, 3.543716
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.435278, 3.694283, 4.342770
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.264185, 3.937133, 5.081718
Valid average loss all      (Triplet)                 : 0.469536

== Recognize ==
Valid average loss Recognize     : 1.078469
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.670725

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.55418610572815 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.20458698272705 sec. =
Valid knn accuracy bass      : 11.918604651162791%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.068270206451416 sec. =
Valid knn accuracy piano     : 23.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.803308725357056 sec. =
Valid knn accuracy guitar    : 40.42207792207792%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.362834930419922 sec. =
Valid knn accuracy residuals : 61.16352201257862%

Valid knn accuracy average   : 43.28828129872189%

                                                                        [AEpoch 160: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00785, Train/loss_recog_step=0.911, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00213, Train/loss_recog_epoch=1.180]Epoch 160: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00785, Train/loss_recog_step=0.911, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060832, 0.060546, 0.061791
Train average loss UNet            (all)              : 0.183169

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001294, 3.115226, 5.795392
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003993, 2.968946, 4.998637
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002617, 3.086484, 4.943135
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001842, 3.197110, 5.369704
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001512, 3.292756, 5.069330
Train average loss all      (Triplet)                 : 0.002298

== Recognize ==
Train average loss Recognize     : 1.184282
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.185467

Epoch 160:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00785, Train/loss_recog_step=0.911, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]          Epoch 161:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00785, Train/loss_recog_step=0.911, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]Epoch 161:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00785, Train/loss_recog_step=0.911, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]Epoch 161:  16%|█▌        | 50/313 [00:46<04:03,  1.08it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00269, Train/loss_recog_step=1.050, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]Epoch 161:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00269, Train/loss_recog_step=1.050, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]Epoch 161:  32%|███▏      | 100/313 [01:29<03:09,  1.12it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=1.230, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180] Epoch 161:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.198, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=1.230, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]Epoch 161:  48%|████▊     | 150/313 [02:12<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000589, Train/loss_recog_step=0.851, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]Epoch 161:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000589, Train/loss_recog_step=0.851, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]Epoch 161:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00947, Train/loss_recog_step=1.170, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180] Epoch 161:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00947, Train/loss_recog_step=1.170, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]Epoch 161:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]  Epoch 161:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]Epoch 161:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=1.390, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]Epoch 161: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=1.390, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]Epoch 161: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=0.901, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.669, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.671, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.470, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.433, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.27it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.54it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.79it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.57it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067841, 0.067751, 0.065287
Valid average loss UNet            (all)              : 0.200880

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.144559, 3.212186, 5.066590
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.722772, 3.668978, 3.573453
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.705212, 3.376803, 3.309705
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.401022, 3.619368, 4.254615
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.241430, 3.672969, 4.571399
Valid average loss all      (Triplet)                 : 0.490467

== Recognize ==
Valid average loss Recognize     : 1.079281
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.691347

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.612035036087036 sec. =
Valid knn accuracy drums     : 78.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.30277419090271 sec. =
Valid knn accuracy bass      : 15.11627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.056024551391602 sec. =
Valid knn accuracy piano     : 28.243243243243242%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.701986312866211 sec. =
Valid knn accuracy guitar    : 42.532467532467535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.058567762374878 sec. =
Valid knn accuracy residuals : 58.01886792452831%

Valid knn accuracy average   : 44.51746567164836%

                                                                        [AEpoch 161: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.0023, Train/loss_recog_epoch=1.180]Epoch 161: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.061028, 0.060719, 0.061918
Train average loss UNet            (all)              : 0.183665

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001022, 3.191724, 5.917800
Train average loss bass     (Triplet, dist_p, dist_n) : 0.005824, 3.060705, 5.090428
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002602, 3.175942, 5.011855
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002903, 3.296038, 5.451872
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002793, 3.426239, 5.270694
Train average loss all      (Triplet)                 : 0.003172

== Recognize ==
Train average loss Recognize     : 1.191327
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.186838

Epoch 161:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]          Epoch 162:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.050, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00834, Train/loss_recog_step=1.050, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=1.240, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00108, Train/loss_recog_step=1.240, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]  Epoch 162:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.858, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.947, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.0025, Train/loss_recog_step=0.947, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00494, Train/loss_recog_step=1.400, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00494, Train/loss_recog_step=1.400, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=0.915, Valid/loss_all_step=0.988, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.756, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.691, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.490, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.445, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.96it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.99it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.17it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.32it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.86it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066871, 0.067138, 0.065369
Valid average loss UNet            (all)              : 0.199378

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.171943, 3.294708, 5.506948
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.835880, 3.789046, 3.614537
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.648253, 3.435251, 3.433829
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.659714, 4.072241, 4.532251
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.248792, 3.874696, 4.693107
Valid average loss all      (Triplet)                 : 0.597811

== Recognize ==
Valid average loss Recognize     : 1.081184
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.797189

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.595616579055786 sec. =
Valid knn accuracy drums     : 76.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.129510164260864 sec. =
Valid knn accuracy bass      : 16.71511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.997431755065918 sec. =
Valid knn accuracy piano     : 27.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.833696842193604 sec. =
Valid knn accuracy guitar    : 43.18181818181818%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.851110458374023 sec. =
Valid knn accuracy residuals : 55.81761006289309%

Valid knn accuracy average   : 43.95054006532854%

                                                                        [AEpoch 162: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=0.915, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.187, Train/loss_unet_all_epoch=0.184, Train/loss_triplet_all_epoch=0.00317, Train/loss_recog_epoch=1.190]Epoch 162: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=0.915, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060848, 0.060506, 0.061694
Train average loss UNet            (all)              : 0.183047

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001200, 3.158797, 5.939938
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002884, 3.037513, 5.077556
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002420, 3.141262, 5.001463
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002311, 3.258557, 5.438306
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002729, 3.366199, 5.183200
Train average loss all      (Triplet)                 : 0.002212

== Recognize ==
Train average loss Recognize     : 1.196141
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.185259

Epoch 162:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=0.915, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]          Epoch 163:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=0.915, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00242, Train/loss_recog_step=0.915, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=1.050, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=1.050, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00119, Train/loss_recog_step=1.240, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.188, Train/loss_triplet_all_step=0.00119, Train/loss_recog_step=1.240, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00908, Train/loss_recog_step=0.854, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00908, Train/loss_recog_step=0.854, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00918, Train/loss_recog_step=1.170, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00918, Train/loss_recog_step=1.170, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]  Epoch 163:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.797, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.440, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.28it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.66it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.71it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.44it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.39it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068913, 0.067498, 0.065573
Valid average loss UNet            (all)              : 0.201985

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.183271, 3.336863, 5.493668
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.656644, 3.721980, 3.748336
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.742299, 3.541458, 3.551637
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.455079, 3.904847, 4.312408
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.288988, 3.888204, 4.822392
Valid average loss all      (Triplet)                 : 0.510019

== Recognize ==
Valid average loss Recognize     : 1.079034
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.712003

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.515467405319214 sec. =
Valid knn accuracy drums     : 81.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.989707946777344 sec. =
Valid knn accuracy bass      : 16.13372093023256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.49687385559082 sec. =
Valid knn accuracy piano     : 26.216216216216214%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.999061822891235 sec. =
Valid knn accuracy guitar    : 45.12987012987013%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.134432077407837 sec. =
Valid knn accuracy residuals : 59.74842767295597%

Valid knn accuracy average   : 45.71035287220791%

                                                                        [AEpoch 163: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.200]Epoch 163: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060862, 0.060475, 0.061721
Train average loss UNet            (all)              : 0.183058

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000978, 3.236453, 6.176054
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003021, 3.107209, 5.276688
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002903, 3.197255, 5.107753
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002397, 3.332829, 5.603553
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002147, 3.446734, 5.319671
Train average loss all      (Triplet)                 : 0.002316

== Recognize ==
Train average loss Recognize     : 1.192748
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.185375

Epoch 163:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]          Epoch 164:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=1.240, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00499, Train/loss_recog_step=1.240, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=0.853, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00585, Train/loss_recog_step=0.853, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]  Epoch 164:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00488, Train/loss_recog_step=1.390, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00488, Train/loss_recog_step=1.390, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.767, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.712, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.510, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.457, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.87it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.76it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.42it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068127, 0.067367, 0.065650
Valid average loss UNet            (all)              : 0.201144

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.180791, 3.186464, 5.316435
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.672063, 3.536720, 3.504094
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.727598, 3.453639, 3.324785
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.679571, 3.889978, 4.253798
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.238350, 3.846911, 4.682388
Valid average loss all      (Triplet)                 : 0.553122

== Recognize ==
Valid average loss Recognize     : 1.075123
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.754266

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.59481430053711 sec. =
Valid knn accuracy drums     : 78.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.405592203140259 sec. =
Valid knn accuracy bass      : 10.61046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.072687149047852 sec. =
Valid knn accuracy piano     : 25.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.875221967697144 sec. =
Valid knn accuracy guitar    : 44.967532467532465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.053707838058472 sec. =
Valid knn accuracy residuals : 54.088050314465406%

Valid knn accuracy average   : 42.69791546200833%

                                                                        [AEpoch 164: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.183, Train/loss_triplet_all_epoch=0.00232, Train/loss_recog_epoch=1.190]Epoch 164: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060679, 0.060338, 0.061478
Train average loss UNet            (all)              : 0.182494

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000707, 3.080426, 5.919263
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003295, 2.924226, 4.898167
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002760, 3.051772, 4.846802
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002325, 3.164505, 5.265959
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001431, 3.291641, 5.147270
Train average loss all      (Triplet)                 : 0.002165

== Recognize ==
Train average loss Recognize     : 1.191684
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.184660

Epoch 164:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]          Epoch 165:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.913, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00683, Train/loss_recog_step=1.040, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00683, Train/loss_recog_step=1.040, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]  Epoch 165:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.855, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.943, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.95it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.04it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.61it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.92it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.25it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069271, 0.067868, 0.067217
Valid average loss UNet            (all)              : 0.204356

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.194506, 3.510126, 5.821056
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.737899, 3.841746, 3.919525
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.685743, 3.670604, 3.767712
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.453184, 4.065428, 4.666946
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.321487, 4.181819, 5.219013
Valid average loss all      (Triplet)                 : 0.522941

== Recognize ==
Valid average loss Recognize     : 1.076489
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.727297

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.834051609039307 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.361473560333252 sec. =
Valid knn accuracy bass      : 16.13372093023256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.434241771697998 sec. =
Valid knn accuracy piano     : 24.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.667996644973755 sec. =
Valid knn accuracy guitar    : 44.31818181818182%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.448818683624268 sec. =
Valid knn accuracy residuals : 58.333333333333336%

Valid knn accuracy average   : 44.61475786817785%

                                                                        [AEpoch 165: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00217, Train/loss_recog_epoch=1.190]Epoch 165: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060598, 0.060237, 0.061430
Train average loss UNet            (all)              : 0.182266

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000183, 3.095973, 5.879775
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002052, 2.961351, 5.017954
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002693, 3.084398, 4.937445
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001476, 3.207496, 5.397889
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002319, 3.336881, 5.179695
Train average loss all      (Triplet)                 : 0.001735

== Recognize ==
Train average loss Recognize     : 1.193174
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.184001

Epoch 165:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]          Epoch 166:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.912, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=0.856, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00418, Train/loss_recog_step=0.856, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]  Epoch 166:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.400, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.914, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.680, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.727, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.523, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.76it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.36it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.63it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.42it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068151, 0.067868, 0.066219
Valid average loss UNet            (all)              : 0.202238

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.145505, 3.127479, 5.236912
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.622630, 3.327281, 3.311641
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.548679, 3.193791, 3.274236
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.524262, 3.601084, 3.965632
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.240378, 3.715020, 4.624456
Valid average loss all      (Triplet)                 : 0.461440

== Recognize ==
Valid average loss Recognize     : 1.082603
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.663679

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.63485336303711 sec. =
Valid knn accuracy drums     : 79.55882352941175%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.236056566238403 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.009767770767212 sec. =
Valid knn accuracy piano     : 30.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.90213680267334 sec. =
Valid knn accuracy guitar    : 42.532467532467535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.284186601638794 sec. =
Valid knn accuracy residuals : 58.333333333333336%

Valid knn accuracy average   : 44.759343483693684%

                                                                        [AEpoch 166: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.190]Epoch 166: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060516, 0.060158, 0.061365
Train average loss UNet            (all)              : 0.182039

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001264, 3.021808, 5.740003
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002392, 2.900365, 4.890090
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002339, 3.000367, 4.802286
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001625, 3.100008, 5.206051
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002929, 3.255616, 5.020517
Train average loss all      (Triplet)                 : 0.002070

== Recognize ==
Train average loss Recognize     : 1.195212
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.184110

Epoch 166:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]          Epoch 167:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167:  16%|█▌        | 50/313 [00:45<04:01,  1.09it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167:  32%|███▏      | 100/313 [01:28<03:09,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167:  48%|████▊     | 150/313 [02:12<02:23,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=0.855, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00977, Train/loss_recog_step=0.855, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=1.170, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=1.170, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]  Epoch 167:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.949, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00774, Train/loss_recog_step=1.400, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00774, Train/loss_recog_step=1.400, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.917, Valid/loss_all_step=0.889, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.653, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.664, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.461, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.448, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.12it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.56it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.44it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.51it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067497, 0.067378, 0.065558
Valid average loss UNet            (all)              : 0.200433

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.181266, 3.318938, 5.285662
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.668452, 3.402673, 3.478347
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.640891, 3.378864, 3.370537
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.517948, 3.837994, 4.110977
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.288783, 3.882032, 4.584166
Valid average loss all      (Triplet)                 : 0.507559

== Recognize ==
Valid average loss Recognize     : 1.081147
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.707991

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.542296886444092 sec. =
Valid knn accuracy drums     : 82.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.258004903793335 sec. =
Valid knn accuracy bass      : 18.75%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.399062633514404 sec. =
Valid knn accuracy piano     : 26.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.048319816589355 sec. =
Valid knn accuracy guitar    : 44.31818181818182%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.7364501953125 sec. =
Valid knn accuracy residuals : 60.84905660377359%

Valid knn accuracy average   : 46.6077720087154%

                                                                        [AEpoch 167: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.917, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00207, Train/loss_recog_epoch=1.200]Epoch 167: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.917, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060356, 0.060028, 0.061235
Train average loss UNet            (all)              : 0.181619

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000631, 2.910066, 5.599004
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002392, 2.764304, 4.644516
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003089, 2.851271, 4.553476
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002014, 2.967073, 4.967670
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001681, 3.119626, 4.857916
Train average loss all      (Triplet)                 : 0.001911

== Recognize ==
Train average loss Recognize     : 1.196241
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183531

Epoch 167:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.917, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]          Epoch 168:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.917, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]Epoch 168:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.917, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]Epoch 168:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]Epoch 168:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]Epoch 168:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]Epoch 168:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]Epoch 168:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.856, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]Epoch 168:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0148, Train/loss_recog_step=0.856, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]Epoch 168:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200] Epoch 168:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]Epoch 168:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00261, Train/loss_recog_step=0.951, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]Epoch 168:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.00261, Train/loss_recog_step=0.951, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]Epoch 168:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]  Epoch 168: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]Epoch 168: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=0.964, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.730, Valid/loss_recog_step=1.310, Valid/loss_all_epoch=0.708, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.466, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.05it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.56it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.63it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.25it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068023, 0.067102, 0.064989
Valid average loss UNet            (all)              : 0.200113

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.124756, 3.462044, 5.439038
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.831812, 3.846112, 3.778851
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.712555, 3.684492, 3.551751
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.579162, 4.147604, 4.642085
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.331193, 4.179722, 4.987571
Valid average loss all      (Triplet)                 : 0.585618

== Recognize ==
Valid average loss Recognize     : 1.084861
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.785731

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.678537368774414 sec. =
Valid knn accuracy drums     : 81.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.222232580184937 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.12201452255249 sec. =
Valid knn accuracy piano     : 27.837837837837835%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.69133710861206 sec. =
Valid knn accuracy guitar    : 43.506493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.217545986175537 sec. =
Valid knn accuracy residuals : 58.9622641509434%

Valid knn accuracy average   : 45.49428763530666%

                                                                        [AEpoch 168: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.200]Epoch 168: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060385, 0.059981, 0.061266
Train average loss UNet            (all)              : 0.181631

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000475, 2.986346, 5.618454
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002372, 2.877438, 4.865226
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001864, 2.933405, 4.696950
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001820, 3.078780, 5.154950
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001943, 3.230387, 5.058182
Train average loss all      (Triplet)                 : 0.001700

== Recognize ==
Train average loss Recognize     : 1.198933
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183331

Epoch 168:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]          Epoch 169:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]Epoch 169:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]Epoch 169:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]Epoch 169:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]Epoch 169:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00479, Train/loss_recog_step=1.240, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]Epoch 169:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.00479, Train/loss_recog_step=1.240, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]Epoch 169:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.858, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200] Epoch 169:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0107, Train/loss_recog_step=0.858, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]Epoch 169:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200] Epoch 169:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]Epoch 169:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]Epoch 169:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]Epoch 169:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]Epoch 169: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.410, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]Epoch 169: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.979, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.455, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.98it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.36it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.21it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.04it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.88it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.31it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071292, 0.069857, 0.067936
Valid average loss UNet            (all)              : 0.209086

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.150367, 3.344135, 5.414660
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.658895, 3.634478, 3.643547
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.628929, 3.511568, 3.613775
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.637525, 4.015747, 4.404559
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.316694, 3.932386, 4.588618
Valid average loss all      (Triplet)                 : 0.530918

== Recognize ==
Valid average loss Recognize     : 1.092344
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.740004

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.677173614501953 sec. =
Valid knn accuracy drums     : 81.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.071568250656128 sec. =
Valid knn accuracy bass      : 12.645348837209303%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.255652904510498 sec. =
Valid knn accuracy piano     : 29.324324324324323%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.733891248703003 sec. =
Valid knn accuracy guitar    : 37.82467532467532%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.164162874221802 sec. =
Valid knn accuracy residuals : 52.358490566037744%

Valid knn accuracy average   : 42.72468545750816%

                                                                        [AEpoch 169: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.0017, Train/loss_recog_epoch=1.200]Epoch 169: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060522, 0.060187, 0.061368
Train average loss UNet            (all)              : 0.182077

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001126, 3.203163, 6.108252
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003999, 3.098394, 5.157283
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002069, 3.171269, 5.072555
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002698, 3.262148, 5.474161
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002177, 3.423038, 5.320714
Train average loss all      (Triplet)                 : 0.002445

== Recognize ==
Train average loss Recognize     : 1.202947
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.184523

Epoch 169:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]          Epoch 170:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.925, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00725, Train/loss_recog_step=1.060, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00725, Train/loss_recog_step=1.060, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]  Epoch 170:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.860, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.170, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.951, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=1.400, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.195, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0113, Train/loss_recog_step=1.400, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.919, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.898, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.531, Valid/loss_recog_epoch=1.090, Valid/knn_avr=0.427, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.18it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.51it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.73it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.24it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.33it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.17it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068478, 0.068241, 0.065676
Valid average loss UNet            (all)              : 0.202395

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.125660, 3.127649, 5.052508
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.637442, 3.475723, 3.465278
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.620537, 3.271751, 3.289563
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.785619, 3.989331, 4.218047
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.260256, 3.723392, 4.308333
Valid average loss all      (Triplet)                 : 0.546951

== Recognize ==
Valid average loss Recognize     : 1.084329
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.749346

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.565409421920776 sec. =
Valid knn accuracy drums     : 84.55882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.023008584976196 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.324588298797607 sec. =
Valid knn accuracy piano     : 27.837837837837835%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.900331258773804 sec. =
Valid knn accuracy guitar    : 42.37012987012987%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.993161678314209 sec. =
Valid knn accuracy residuals : 53.77358490566038%

Valid knn accuracy average   : 44.58598220535215%

                                                                        [AEpoch 170: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.919, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.200]Epoch 170: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.919, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060450, 0.060169, 0.061272
Train average loss UNet            (all)              : 0.181891

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001378, 2.958755, 5.713481
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003435, 2.856878, 4.783887
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003815, 2.955210, 4.729542
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001842, 3.004919, 5.023513
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002691, 3.156344, 4.909074
Train average loss all      (Triplet)                 : 0.002614

== Recognize ==
Train average loss Recognize     : 1.201984
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.184505

Epoch 170:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.919, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]          Epoch 171:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.919, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]Epoch 171:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00553, Train/loss_recog_step=0.919, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]Epoch 171:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00298, Train/loss_recog_step=1.060, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]Epoch 171:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00298, Train/loss_recog_step=1.060, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]Epoch 171:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000973, Train/loss_recog_step=1.250, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]Epoch 171:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000973, Train/loss_recog_step=1.250, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]Epoch 171:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]   Epoch 171:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.867, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]Epoch 171:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]Epoch 171:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.180, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]Epoch 171:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00264, Train/loss_recog_step=0.962, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]Epoch 171:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00264, Train/loss_recog_step=0.962, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]Epoch 171:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]  Epoch 171: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]Epoch 171: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.928, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.320, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.080, Valid/knn_avr=0.446, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.78it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.29it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.67it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.40it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.00it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069353, 0.068523, 0.066480
Valid average loss UNet            (all)              : 0.204356

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.145168, 3.443902, 5.934176
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.671198, 3.668858, 3.626913
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.687994, 3.553841, 3.638775
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.503479, 4.163733, 4.769553
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.303680, 4.131840, 4.936087
Valid average loss all      (Triplet)                 : 0.513668

== Recognize ==
Valid average loss Recognize     : 1.095699
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.718024

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.393086910247803 sec. =
Valid knn accuracy drums     : 83.38235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.319885492324829 sec. =
Valid knn accuracy bass      : 11.337209302325581%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.205010890960693 sec. =
Valid knn accuracy piano     : 29.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.232762813568115 sec. =
Valid knn accuracy guitar    : 41.396103896103895%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.77461576461792 sec. =
Valid knn accuracy residuals : 59.11949685534591%

Valid knn accuracy average   : 44.85784340980118%

                                                                        [AEpoch 171: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.928, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.185, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00261, Train/loss_recog_epoch=1.200]Epoch 171: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.928, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060266, 0.059948, 0.061108
Train average loss UNet            (all)              : 0.181322

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000449, 2.904092, 5.576573
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002186, 2.792122, 4.696709
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001814, 2.864415, 4.597640
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002055, 2.937656, 4.893783
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002461, 3.098941, 4.819276
Train average loss all      (Triplet)                 : 0.001863

== Recognize ==
Train average loss Recognize     : 1.209121
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183185

Epoch 171:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.928, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]          Epoch 172:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.928, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]Epoch 172:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0108, Train/loss_recog_step=0.928, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]Epoch 172:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210] Epoch 172:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]Epoch 172:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]Epoch 172:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]Epoch 172:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.866, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]Epoch 172:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.866, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]Epoch 172:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]Epoch 172:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]Epoch 172:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00249, Train/loss_recog_step=0.963, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]Epoch 172:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00249, Train/loss_recog_step=0.963, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]Epoch 172:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]  Epoch 172: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]Epoch 172: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.811, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.514, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.449, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.39it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.83it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  6.00it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.25it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:02<00:00,  4.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067929, 0.066950, 0.065165
Valid average loss UNet            (all)              : 0.200044

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.147489, 3.261211, 5.283203
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.658660, 3.533068, 3.406407
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.600579, 3.341042, 3.427484
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.575487, 3.898803, 4.278968
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.258296, 4.008381, 4.911767
Valid average loss all      (Triplet)                 : 0.496583

== Recognize ==
Valid average loss Recognize     : 1.096517
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.696627

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.497350692749023 sec. =
Valid knn accuracy drums     : 83.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.249744653701782 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.248152732849121 sec. =
Valid knn accuracy piano     : 28.243243243243242%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.045034170150757 sec. =
Valid knn accuracy guitar    : 46.590909090909086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.292494773864746 sec. =
Valid knn accuracy residuals : 56.91823899371069%

Valid knn accuracy average   : 46.31149057747411%

                                                                        [AEpoch 172: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.210]Epoch 172: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060328, 0.060005, 0.061200
Train average loss UNet            (all)              : 0.181533

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001784, 3.035965, 5.800677
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003042, 2.910645, 4.823951
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003144, 3.026272, 4.825260
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002848, 3.080875, 5.123117
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001498, 3.256843, 5.052308
Train average loss all      (Triplet)                 : 0.002446

== Recognize ==
Train average loss Recognize     : 1.211122
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183978

Epoch 172:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]          Epoch 173:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.927, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=1.190, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=1.190, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]  Epoch 173:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.968, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.983, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.750, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.697, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.463, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.14it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.85it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.29it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.71it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.32it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.20it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069504, 0.068320, 0.066889
Valid average loss UNet            (all)              : 0.204713

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.145301, 3.209250, 5.390338
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.652923, 3.453812, 3.402935
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.745063, 3.315291, 3.328024
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.638046, 3.637407, 3.978025
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.299200, 3.741770, 4.356113
Valid average loss all      (Triplet)                 : 0.546450

== Recognize ==
Valid average loss Recognize     : 1.097579
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.751163

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.637550115585327 sec. =
Valid knn accuracy drums     : 83.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.312767267227173 sec. =
Valid knn accuracy bass      : 13.226744186046513%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.275417566299438 sec. =
Valid knn accuracy piano     : 23.64864864864865%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.835535526275635 sec. =
Valid knn accuracy guitar    : 41.396103896103895%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.293545246124268 sec. =
Valid knn accuracy residuals : 50.47169811320755%

Valid knn accuracy average   : 42.395697792330736%

                                                                        [AEpoch 173: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.182, Train/loss_triplet_all_epoch=0.00245, Train/loss_recog_epoch=1.210]Epoch 173: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060207, 0.059872, 0.061051
Train average loss UNet            (all)              : 0.181130

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000868, 2.998502, 5.653253
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002172, 2.894673, 4.910511
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002651, 3.019041, 4.858800
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001195, 3.067758, 5.174429
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002014, 3.254238, 5.103525
Train average loss all      (Triplet)                 : 0.001792

== Recognize ==
Train average loss Recognize     : 1.215382
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.182922

Epoch 173:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]          Epoch 174:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]Epoch 174:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]Epoch 174:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=1.060, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]Epoch 174:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=1.060, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]Epoch 174:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000504, Train/loss_recog_step=1.260, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]Epoch 174:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.000504, Train/loss_recog_step=1.260, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]Epoch 174:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]   Epoch 174:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]Epoch 174:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00635, Train/loss_recog_step=1.190, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]Epoch 174:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00635, Train/loss_recog_step=1.190, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]Epoch 174:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]  Epoch 174:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]Epoch 174:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=1.420, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]Epoch 174: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00205, Train/loss_recog_step=1.420, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]Epoch 174: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.751, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.424, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.94it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.05it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.57it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.01it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.64it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.10it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067821, 0.067062, 0.065301
Valid average loss UNet            (all)              : 0.200185

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099212, 3.121304, 4.973889
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.710694, 3.486036, 3.332815
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.784427, 3.413728, 3.307083
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.519043, 3.517086, 4.139113
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.270376, 3.727675, 4.409467
Valid average loss all      (Triplet)                 : 0.536099

== Recognize ==
Valid average loss Recognize     : 1.098852
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.736283

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.914295196533203 sec. =
Valid knn accuracy drums     : 82.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.340436697006226 sec. =
Valid knn accuracy bass      : 14.244186046511627%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.362241983413696 sec. =
Valid knn accuracy piano     : 27.837837837837835%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.921647071838379 sec. =
Valid knn accuracy guitar    : 38.47402597402597%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.946431875228882 sec. =
Valid knn accuracy residuals : 59.27672955974843%

Valid knn accuracy average   : 44.37832058950713%

                                                                        [AEpoch 174: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00179, Train/loss_recog_epoch=1.220]Epoch 174: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060039, 0.059680, 0.060856
Train average loss UNet            (all)              : 0.180575

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000999, 2.839796, 5.370536
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002577, 2.721516, 4.639580
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001442, 2.803080, 4.488448
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002400, 2.888861, 4.869474
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001710, 3.043194, 4.783152
Train average loss all      (Triplet)                 : 0.001901

== Recognize ==
Train average loss Recognize     : 1.215920
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.182475

Epoch 174:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]          Epoch 175:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]Epoch 175:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]Epoch 175:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]Epoch 175:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]Epoch 175:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00958, Train/loss_recog_step=1.260, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]Epoch 175:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00958, Train/loss_recog_step=1.260, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]Epoch 175:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]  Epoch 175:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.872, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]Epoch 175:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000775, Train/loss_recog_step=1.190, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]Epoch 175:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000775, Train/loss_recog_step=1.190, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]Epoch 175:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00912, Train/loss_recog_step=0.970, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220] Epoch 175:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00912, Train/loss_recog_step=0.970, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]Epoch 175:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=1.420, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220] Epoch 175: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.199, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.0159, Train/loss_recog_step=1.420, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]Epoch 175: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.880, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.736, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.444, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.16it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.97it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.04it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.33it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.27it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069681, 0.069270, 0.065498
Valid average loss UNet            (all)              : 0.204449

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.081079, 3.259150, 5.506704
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.865914, 3.763257, 3.552961
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.666457, 3.518347, 3.561862
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.476810, 3.668822, 4.297682
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.393592, 4.272206, 4.682886
Valid average loss all      (Triplet)                 : 0.569846

== Recognize ==
Valid average loss Recognize     : 1.095443
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.774295

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.801160335540771 sec. =
Valid knn accuracy drums     : 84.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.247652530670166 sec. =
Valid knn accuracy bass      : 14.825581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.991100311279297 sec. =
Valid knn accuracy piano     : 28.10810810810811%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.114961624145508 sec. =
Valid knn accuracy guitar    : 38.311688311688314%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.222949981689453 sec. =
Valid knn accuracy residuals : 53.459119496855344%

Valid knn accuracy average   : 43.82325240357659%

                                                                        [AEpoch 175: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.0019, Train/loss_recog_epoch=1.220]Epoch 175: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060130, 0.059717, 0.060928
Train average loss UNet            (all)              : 0.180775

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000888, 3.115147, 5.929477
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001830, 2.962051, 4.998777
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003439, 3.087691, 4.921278
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000844, 3.158674, 5.266972
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001880, 3.350537, 5.251273
Train average loss all      (Triplet)                 : 0.001708

== Recognize ==
Train average loss Recognize     : 1.217417
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.182483

Epoch 175:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]          Epoch 176:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]Epoch 176:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]Epoch 176:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00196, Train/loss_recog_step=1.060, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]Epoch 176:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00196, Train/loss_recog_step=1.060, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]Epoch 176:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]  Epoch 176:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]Epoch 176:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00169, Train/loss_recog_step=0.866, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]Epoch 176:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00169, Train/loss_recog_step=0.866, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]Epoch 176:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000749, Train/loss_recog_step=1.190, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]Epoch 176:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000749, Train/loss_recog_step=1.190, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]Epoch 176:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.967, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]   Epoch 176:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.967, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]Epoch 176:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=1.430, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]Epoch 176: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00766, Train/loss_recog_step=1.430, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]Epoch 176: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.220, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.977, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.438, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.55it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.80it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.81it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.45it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070072, 0.069260, 0.068121
Valid average loss UNet            (all)              : 0.207452

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088486, 3.264859, 5.663055
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.761976, 3.780667, 3.749457
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.649568, 3.588310, 3.692552
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.642090, 4.002989, 4.638642
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.261658, 4.147934, 4.763526
Valid average loss all      (Triplet)                 : 0.548851

== Recognize ==
Valid average loss Recognize     : 1.099785
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.756303

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.53430724143982 sec. =
Valid knn accuracy drums     : 78.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.279062747955322 sec. =
Valid knn accuracy bass      : 17.441860465116278%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.18140959739685 sec. =
Valid knn accuracy piano     : 29.594594594594593%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.952073097229004 sec. =
Valid knn accuracy guitar    : 36.52597402597403%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.225284814834595 sec. =
Valid knn accuracy residuals : 54.40251572327044%

Valid knn accuracy average   : 43.328283079438116%

                                                                        [AEpoch 176: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00171, Train/loss_recog_epoch=1.220]Epoch 176: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060216, 0.059916, 0.061078
Train average loss UNet            (all)              : 0.181209

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001095, 3.093116, 5.872287
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003510, 2.983513, 5.065499
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002364, 3.107625, 4.988134
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001669, 3.162785, 5.275836
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002967, 3.337367, 5.173542
Train average loss all      (Triplet)                 : 0.002374

== Recognize ==
Train average loss Recognize     : 1.214609
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183583

Epoch 176:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]          Epoch 177:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.187, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.004, Train/loss_recog_step=0.868, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.004, Train/loss_recog_step=0.868, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.190, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177:  80%|███████▉  | 250/313 [03:38<00:54,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=6.43e-5, Train/loss_recog_step=0.935, Valid/loss_all_step=1.130, Valid/loss_unet_all_step=0.246, Valid/loss_triplet_all_step=0.881, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.549, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.433, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.24it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.91it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.66it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.27it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.07it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069133, 0.068011, 0.066665
Valid average loss UNet            (all)              : 0.203809

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.111101, 3.269330, 5.312566
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.689828, 3.626543, 3.574096
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.585677, 3.467720, 3.548317
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.536611, 3.823459, 4.496047
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.334187, 3.832928, 4.522278
Valid average loss all      (Triplet)                 : 0.505915

== Recognize ==
Valid average loss Recognize     : 1.099011
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.709724

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.519602537155151 sec. =
Valid knn accuracy drums     : 81.91176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.235022068023682 sec. =
Valid knn accuracy bass      : 18.313953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.184443950653076 sec. =
Valid knn accuracy piano     : 27.837837837837835%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.946459531784058 sec. =
Valid knn accuracy guitar    : 36.85064935064935%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.773828744888306 sec. =
Valid knn accuracy residuals : 52.83018867924528%

Valid knn accuracy average   : 43.548878812397376%

                                                                        [AEpoch 177: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=6.43e-5, Train/loss_recog_step=0.935, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00237, Train/loss_recog_epoch=1.210]Epoch 177: 100%|██████████| 313/313 [06:06<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=6.43e-5, Train/loss_recog_step=0.935, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060260, 0.059944, 0.061096
Train average loss UNet            (all)              : 0.181300

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.002024, 3.196306, 6.145907
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003882, 3.057295, 5.134117
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003443, 3.189545, 5.106845
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001306, 3.233039, 5.420359
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002273, 3.433451, 5.360113
Train average loss all      (Triplet)                 : 0.002571

== Recognize ==
Train average loss Recognize     : 1.216395
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183870

Epoch 177:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=6.43e-5, Train/loss_recog_step=0.935, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]          Epoch 178:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=6.43e-5, Train/loss_recog_step=0.935, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]Epoch 178:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=6.43e-5, Train/loss_recog_step=0.935, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]Epoch 178:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000359, Train/loss_recog_step=1.070, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]Epoch 178:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000359, Train/loss_recog_step=1.070, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]Epoch 178:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=1.260, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220] Epoch 178:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00198, Train/loss_recog_step=1.260, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]Epoch 178:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]  Epoch 178:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]Epoch 178:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]Epoch 178:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]Epoch 178:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]Epoch 178:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.973, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]Epoch 178:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00582, Train/loss_recog_step=1.430, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]Epoch 178: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00582, Train/loss_recog_step=1.430, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]Epoch 178: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.799, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.710, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.435, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.96it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.81it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.37it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.06it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.26it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.95it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068738, 0.068566, 0.065735
Valid average loss UNet            (all)              : 0.203039

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.123608, 3.348447, 5.226139
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.682901, 3.740143, 3.674853
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.695240, 3.586368, 3.556476
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.574838, 4.002132, 4.641265
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.352463, 4.029903, 4.536839
Valid average loss all      (Triplet)                 : 0.531653

== Recognize ==
Valid average loss Recognize     : 1.097792
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.734692

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.589400291442871 sec. =
Valid knn accuracy drums     : 83.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.940618991851807 sec. =
Valid knn accuracy bass      : 11.19186046511628%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.526444435119629 sec. =
Valid knn accuracy piano     : 26.891891891891888%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.96164083480835 sec. =
Valid knn accuracy guitar    : 43.01948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.281745433807373 sec. =
Valid knn accuracy residuals : 55.81761006289309%

Valid knn accuracy average   : 44.03122741140577%

                                                                        [AEpoch 178: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.220]Epoch 178: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059953, 0.059564, 0.060794
Train average loss UNet            (all)              : 0.180311

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000491, 3.154011, 5.988006
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001521, 3.025778, 5.150341
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001741, 3.157819, 5.075601
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001143, 3.234615, 5.421373
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001608, 3.392735, 5.329704
Train average loss all      (Triplet)                 : 0.001346

== Recognize ==
Train average loss Recognize     : 1.219647
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.181657

Epoch 178:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]          Epoch 179:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00715, Train/loss_recog_step=1.060, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00715, Train/loss_recog_step=1.060, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179:  32%|███▏      | 100/313 [01:29<03:10,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00404, Train/loss_recog_step=1.260, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00404, Train/loss_recog_step=1.260, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=0.869, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00236, Train/loss_recog_step=0.869, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]  Epoch 179:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.735, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.532, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.440, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.97it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.04it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.34it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.05it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070202, 0.068445, 0.067478
Valid average loss UNet            (all)              : 0.206125

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.127966, 3.217299, 5.459454
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.676067, 3.705215, 3.696531
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.709640, 3.514391, 3.360016
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.469054, 3.795199, 4.423858
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.341513, 3.990354, 4.501884
Valid average loss all      (Triplet)                 : 0.506411

== Recognize ==
Valid average loss Recognize     : 1.097004
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.712536

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.81227993965149 sec. =
Valid knn accuracy drums     : 81.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.59666657447815 sec. =
Valid knn accuracy bass      : 12.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.227717399597168 sec. =
Valid knn accuracy piano     : 27.837837837837835%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.694874048233032 sec. =
Valid knn accuracy guitar    : 43.34415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.378141641616821 sec. =
Valid knn accuracy residuals : 57.704402515723274%

Valid knn accuracy average   : 44.630220416013984%

                                                                        [AEpoch 179: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00135, Train/loss_recog_epoch=1.220]Epoch 179: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059914, 0.059538, 0.060741
Train average loss UNet            (all)              : 0.180193

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000853, 3.118134, 5.835531
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002223, 3.023040, 5.114726
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002002, 3.111214, 4.993373
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002343, 3.202148, 5.339666
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001790, 3.345211, 5.218732
Train average loss all      (Triplet)                 : 0.001817

== Recognize ==
Train average loss Recognize     : 1.218433
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.182010

Epoch 179:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]          Epoch 180:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.932, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00421, Train/loss_recog_step=0.870, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00421, Train/loss_recog_step=0.870, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]  Epoch 180:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.971, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.928, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.681, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.713, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.506, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.446, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.12it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.40it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.65it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.68it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.62it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.85it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069653, 0.068467, 0.067093
Valid average loss UNet            (all)              : 0.205214

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.132100, 3.403929, 5.612772
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.669051, 3.748999, 3.755836
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.639578, 3.612247, 3.579552
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.517253, 3.954400, 4.498262
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.330028, 3.904423, 4.670004
Valid average loss all      (Triplet)                 : 0.500680

== Recognize ==
Valid average loss Recognize     : 1.101230
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.705894

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.633932828903198 sec. =
Valid knn accuracy drums     : 82.94117647058825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.318877458572388 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.409713983535767 sec. =
Valid knn accuracy piano     : 31.756756756756754%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.71082878112793 sec. =
Valid knn accuracy guitar    : 40.58441558441558%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.229857206344604 sec. =
Valid knn accuracy residuals : 51.41509433962265%

Valid knn accuracy average   : 44.537163048881304%

                                                                        [AEpoch 180: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00182, Train/loss_recog_epoch=1.220]Epoch 180: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060078, 0.059747, 0.060898
Train average loss UNet            (all)              : 0.180723

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001007, 3.198506, 6.065187
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002713, 3.091494, 5.184005
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003211, 3.183503, 5.116954
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001888, 3.268390, 5.483424
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001947, 3.416222, 5.307590
Train average loss all      (Triplet)                 : 0.002147

== Recognize ==
Train average loss Recognize     : 1.218602
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.182870

Epoch 180:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]          Epoch 181:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]Epoch 181:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]Epoch 181:  16%|█▌        | 50/313 [00:46<04:04,  1.08it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00105, Train/loss_recog_step=1.070, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]Epoch 181:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00105, Train/loss_recog_step=1.070, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]Epoch 181:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]  Epoch 181:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]Epoch 181:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]Epoch 181:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.869, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]Epoch 181:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00486, Train/loss_recog_step=1.200, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]Epoch 181:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00486, Train/loss_recog_step=1.200, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]Epoch 181:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.963, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]  Epoch 181:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.963, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]Epoch 181:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]Epoch 181: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.420, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]Epoch 181: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.944, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.701, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.706, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.501, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.445, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.08it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.83it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.40it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.58it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.36it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069024, 0.068036, 0.065539
Valid average loss UNet            (all)              : 0.202598

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.155508, 3.458651, 5.878361
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.787869, 3.759139, 3.552731
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.490519, 3.497944, 3.619709
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.522438, 4.026446, 4.610237
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.314340, 3.773772, 4.887508
Valid average loss all      (Triplet)                 : 0.515971

== Recognize ==
Valid average loss Recognize     : 1.096282
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.718569

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.444977760314941 sec. =
Valid knn accuracy drums     : 82.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.330936908721924 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.556907415390015 sec. =
Valid knn accuracy piano     : 29.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.966884851455688 sec. =
Valid knn accuracy guitar    : 43.01948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.600723266601562 sec. =
Valid knn accuracy residuals : 56.289308176100626%

Valid knn accuracy average   : 45.24680968572768%

                                                                        [AEpoch 181: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.183, Train/loss_unet_all_epoch=0.181, Train/loss_triplet_all_epoch=0.00215, Train/loss_recog_epoch=1.220]Epoch 181: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059807, 0.059546, 0.060664
Train average loss UNet            (all)              : 0.180017

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001123, 3.140611, 6.029932
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002220, 3.045867, 5.114063
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002205, 3.155360, 5.090602
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001099, 3.208246, 5.364755
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002014, 3.326468, 5.176997
Train average loss all      (Triplet)                 : 0.001797

== Recognize ==
Train average loss Recognize     : 1.218575
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.181814

Epoch 181:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]          Epoch 182:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=1.060, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0174, Train/loss_recog_step=1.060, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=1.260, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.190, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.00462, Train/loss_recog_step=1.260, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]  Epoch 182:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000921, Train/loss_recog_step=1.430, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000921, Train/loss_recog_step=1.430, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=0.952, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.715, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.719, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.516, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.452, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.20it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.34it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.24it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.15it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.25it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068052, 0.067982, 0.065314
Valid average loss UNet            (all)              : 0.201348

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.139676, 3.186818, 4.941664
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.721436, 3.578363, 3.389727
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.617142, 3.363636, 3.286215
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.421714, 3.676606, 4.183205
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.243350, 3.688547, 4.522780
Valid average loss all      (Triplet)                 : 0.477243

== Recognize ==
Valid average loss Recognize     : 1.098479
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.678591

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.422861099243164 sec. =
Valid knn accuracy drums     : 83.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.388946771621704 sec. =
Valid knn accuracy bass      : 14.825581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.191495418548584 sec. =
Valid knn accuracy piano     : 28.783783783783782%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.528407335281372 sec. =
Valid knn accuracy guitar    : 44.48051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.458402633666992 sec. =
Valid knn accuracy residuals : 55.81761006289309%

Valid knn accuracy average   : 45.428557768038445%

                                                                        [AEpoch 182: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0018, Train/loss_recog_epoch=1.220]Epoch 182: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059913, 0.059587, 0.060734
Train average loss UNet            (all)              : 0.180234

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000724, 3.056192, 5.890378
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002763, 2.937549, 4.931456
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003738, 3.057598, 4.939743
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001360, 3.085654, 5.151812
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002004, 3.273698, 5.099425
Train average loss all      (Triplet)                 : 0.002208

== Recognize ==
Train average loss Recognize     : 1.217824
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.182441

Epoch 182:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]          Epoch 183:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]Epoch 183:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]Epoch 183:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]Epoch 183:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]Epoch 183:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00451, Train/loss_recog_step=1.260, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]Epoch 183:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00451, Train/loss_recog_step=1.260, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]Epoch 183:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]  Epoch 183:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.870, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]Epoch 183:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000902, Train/loss_recog_step=1.200, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]Epoch 183:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000902, Train/loss_recog_step=1.200, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]Epoch 183:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=0.965, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]  Epoch 183:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.197, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0153, Train/loss_recog_step=0.965, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]Epoch 183:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220] Epoch 183: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.430, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]Epoch 183: 100%|██████████| 313/313 [04:33<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=0.887, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.644, Valid/loss_recog_step=1.330, Valid/loss_all_epoch=0.679, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.477, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.454, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.15it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  4.93it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.07it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  4.92it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.17it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070190, 0.069069, 0.066310
Valid average loss UNet            (all)              : 0.205569

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.159923, 3.483051, 5.580687
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.783445, 3.854765, 3.761878
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.696777, 3.717309, 3.579336
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.682659, 4.120141, 4.556352
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.334148, 4.086617, 4.803174
Valid average loss all      (Triplet)                 : 0.599056

== Recognize ==
Valid average loss Recognize     : 1.101434
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.804625

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.804584741592407 sec. =
Valid knn accuracy drums     : 86.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.189046382904053 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.349494934082031 sec. =
Valid knn accuracy piano     : 32.2972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.66077470779419 sec. =
Valid knn accuracy guitar    : 42.532467532467535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.051822423934937 sec. =
Valid knn accuracy residuals : 55.188679245283026%

Valid knn accuracy average   : 46.58234818573461%

                                                                        [AEpoch 183: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00221, Train/loss_recog_epoch=1.220]Epoch 183: 100%|██████████| 313/313 [06:07<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059662, 0.059338, 0.060485
Train average loss UNet            (all)              : 0.179484

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000834, 3.095399, 5.786791
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001268, 2.986885, 5.042115
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001480, 3.098814, 5.035789
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002166, 3.166251, 5.306536
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001721, 3.326003, 5.210130
Train average loss all      (Triplet)                 : 0.001480

== Recognize ==
Train average loss Recognize     : 1.220339
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.180965

Epoch 183:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]          Epoch 184:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]Epoch 184:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]Epoch 184:  16%|█▌        | 50/313 [00:46<04:04,  1.07it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=1.070, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]Epoch 184:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00123, Train/loss_recog_step=1.070, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]Epoch 184:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]  Epoch 184:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]Epoch 184:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=0.875, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]Epoch 184:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.0121, Train/loss_recog_step=0.875, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]Epoch 184:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000593, Train/loss_recog_step=1.200, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]Epoch 184:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000593, Train/loss_recog_step=1.200, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]Epoch 184:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=3.8e-5, Train/loss_recog_step=0.970, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]  Epoch 184:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=3.8e-5, Train/loss_recog_step=0.970, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]Epoch 184:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220] Epoch 184: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]Epoch 184: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.805, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.599, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.466, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.21it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.26it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.26it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.30it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.69it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067351, 0.066966, 0.064453
Valid average loss UNet            (all)              : 0.198770

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.168677, 3.379288, 5.692287
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.783382, 3.722957, 3.542583
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.698458, 3.533333, 3.457192
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.550940, 4.005652, 4.493426
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.366989, 3.918755, 4.815717
Valid average loss all      (Triplet)                 : 0.574963

== Recognize ==
Valid average loss Recognize     : 1.106287
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.773733

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.803045749664307 sec. =
Valid knn accuracy drums     : 83.38235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.169686317443848 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.39219069480896 sec. =
Valid knn accuracy piano     : 26.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.969173669815063 sec. =
Valid knn accuracy guitar    : 43.506493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.303255081176758 sec. =
Valid knn accuracy residuals : 55.660377358490564%

Valid knn accuracy average   : 44.915564434393644%

                                                                        [AEpoch 184: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.220]Epoch 184: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059765, 0.059440, 0.060551
Train average loss UNet            (all)              : 0.179757

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000778, 3.184982, 6.074622
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002132, 3.065842, 5.113588
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002588, 3.185793, 5.123562
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002397, 3.270477, 5.468946
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001916, 3.407181, 5.315104
Train average loss all      (Triplet)                 : 0.002025

== Recognize ==
Train average loss Recognize     : 1.226740
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.181781

Epoch 184:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]          Epoch 185:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.941, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.070, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0102, Train/loss_recog_step=1.070, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230] Epoch 185:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.877, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00271, Train/loss_recog_step=1.200, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00271, Train/loss_recog_step=1.200, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00471, Train/loss_recog_step=0.971, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00471, Train/loss_recog_step=0.971, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000153, Train/loss_recog_step=1.440, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000153, Train/loss_recog_step=1.440, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.892, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.774, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.575, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.449, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.19it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.73it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.81it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068523, 0.067672, 0.065021
Valid average loss UNet            (all)              : 0.201216

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.175128, 3.553486, 5.772139
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.723022, 3.845200, 3.743090
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.575880, 3.703697, 3.739616
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.622998, 4.219991, 4.845426
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.340812, 4.063177, 4.958233
Valid average loss all      (Triplet)                 : 0.529264

== Recognize ==
Valid average loss Recognize     : 1.103913
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.730480

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.205286264419556 sec. =
Valid knn accuracy drums     : 84.85294117647058%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.115920543670654 sec. =
Valid knn accuracy bass      : 17.441860465116278%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.124959945678711 sec. =
Valid knn accuracy piano     : 29.18918918918919%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.128101110458374 sec. =
Valid knn accuracy guitar    : 39.61038961038961%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.58272671699524 sec. =
Valid knn accuracy residuals : 61.16352201257862%

Valid knn accuracy average   : 46.45158049074885%

                                                                        [AEpoch 185: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00202, Train/loss_recog_epoch=1.230]Epoch 185: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059536, 0.059199, 0.060378
Train average loss UNet            (all)              : 0.179113

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000733, 3.214022, 6.199532
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001326, 3.066863, 5.136199
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001350, 3.187583, 5.121758
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002064, 3.305548, 5.552587
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001913, 3.383020, 5.299178
Train average loss all      (Triplet)                 : 0.001466

== Recognize ==
Train average loss Recognize     : 1.228426
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.180579

Epoch 185:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]          Epoch 186:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.939, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00473, Train/loss_recog_step=1.270, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00473, Train/loss_recog_step=1.270, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]  Epoch 186:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.875, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.200, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.972, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.184, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.440, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.944, Valid/loss_all_step=0.918, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.679, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.730, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.100, Valid/knn_avr=0.465, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.20it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.63it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.74it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.12it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.075920, 0.074004, 0.073673
Valid average loss UNet            (all)              : 0.223597

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.137493, 3.270026, 5.571906
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.674877, 3.747665, 3.727009
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.685528, 3.621170, 3.579046
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.459037, 3.699559, 4.259113
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.430128, 3.918570, 4.890231
Valid average loss all      (Triplet)                 : 0.517537

== Recognize ==
Valid average loss Recognize     : 1.107046
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.741134

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.606371402740479 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.034345388412476 sec. =
Valid knn accuracy bass      : 16.569767441860463%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.161195039749146 sec. =
Valid knn accuracy piano     : 26.891891891891888%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.699211359024048 sec. =
Valid knn accuracy guitar    : 38.311688311688314%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.011776447296143 sec. =
Valid knn accuracy residuals : 53.61635220125787%

Valid knn accuracy average   : 43.0779399693397%

                                                                        [AEpoch 186: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.944, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.230]Epoch 186: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.944, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059774, 0.059413, 0.060607
Train average loss UNet            (all)              : 0.179794

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000823, 3.299158, 6.155730
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002711, 3.216895, 5.424441
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002683, 3.315481, 5.289619
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002200, 3.407438, 5.716190
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002422, 3.541947, 5.528575
Train average loss all      (Triplet)                 : 0.002202

== Recognize ==
Train average loss Recognize     : 1.227906
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.181996

Epoch 186:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.944, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]          Epoch 187:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.944, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]Epoch 187:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.0106, Train/loss_recog_step=0.944, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]Epoch 187:  16%|█▌        | 50/313 [00:46<04:06,  1.07it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230] Epoch 187:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]Epoch 187:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00593, Train/loss_recog_step=1.280, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]Epoch 187:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.186, Train/loss_triplet_all_step=0.00593, Train/loss_recog_step=1.280, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]Epoch 187:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]  Epoch 187:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.879, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]Epoch 187:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=1.210, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]Epoch 187:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00152, Train/loss_recog_step=1.210, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]Epoch 187:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]  Epoch 187:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]Epoch 187:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00483, Train/loss_recog_step=1.450, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]Epoch 187: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00483, Train/loss_recog_step=1.450, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]Epoch 187: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.854, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.613, Valid/loss_recog_step=1.340, Valid/loss_all_epoch=0.741, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.518, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.431, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.96it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.36it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.84it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.71it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.62it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.91it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069917, 0.068916, 0.068667
Valid average loss UNet            (all)              : 0.207499

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.134623, 3.362234, 5.289236
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.698912, 3.838104, 3.799832
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.756509, 3.729342, 3.625648
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.501415, 3.911965, 4.442812
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.340482, 3.989865, 4.782289
Valid average loss all      (Triplet)                 : 0.523611

== Recognize ==
Valid average loss Recognize     : 1.112148
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.731110

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.525542259216309 sec. =
Valid knn accuracy drums     : 81.32352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.252714157104492 sec. =
Valid knn accuracy bass      : 14.680232558139537%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.353016138076782 sec. =
Valid knn accuracy piano     : 27.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.945652723312378 sec. =
Valid knn accuracy guitar    : 38.961038961038966%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.891287088394165 sec. =
Valid knn accuracy residuals : 54.40251572327044%

Valid knn accuracy average   : 43.414003871383265%

                                                                        [AEpoch 187: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.230]Epoch 187: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.060004, 0.059659, 0.060815
Train average loss UNet            (all)              : 0.180478

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000779, 3.300434, 5.994251
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003351, 3.226958, 5.367212
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003972, 3.360986, 5.362156
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.004169, 3.472143, 5.818403
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003151, 3.555237, 5.496391
Train average loss all      (Triplet)                 : 0.003039

== Recognize ==
Train average loss Recognize     : 1.234321
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.183517

Epoch 187:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]          Epoch 188:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.947, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.070, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00668, Train/loss_recog_step=0.882, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00668, Train/loss_recog_step=0.882, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]  Epoch 188:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.979, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=0.872, Valid/loss_unet_all_step=0.250, Valid/loss_triplet_all_step=0.622, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.524, Valid/loss_recog_epoch=1.110, Valid/knn_avr=0.434, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.72it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.71it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.54it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.65it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.06it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.35it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067926, 0.067277, 0.064454
Valid average loss UNet            (all)              : 0.199657

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.139890, 3.193645, 5.070269
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.767314, 3.549241, 3.368260
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.620138, 3.454072, 3.424570
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.533279, 3.872286, 4.451371
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.340895, 4.068512, 4.753552
Valid average loss all      (Triplet)                 : 0.540646

== Recognize ==
Valid average loss Recognize     : 1.117182
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.740303

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.562716484069824 sec. =
Valid knn accuracy drums     : 79.11764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.046748876571655 sec. =
Valid knn accuracy bass      : 13.80813953488372%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.163252115249634 sec. =
Valid knn accuracy piano     : 29.72972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.893929481506348 sec. =
Valid knn accuracy guitar    : 37.33766233766234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.068938255310059 sec. =
Valid knn accuracy residuals : 54.71698113207547%

Valid knn accuracy average   : 42.942031958634956%

                                                                        [AEpoch 188: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.184, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.00304, Train/loss_recog_epoch=1.230]Epoch 188: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059714, 0.059391, 0.060497
Train average loss UNet            (all)              : 0.179603

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000448, 2.998798, 5.599032
Train average loss bass     (Triplet, dist_p, dist_n) : 0.003212, 2.921486, 4.867538
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002478, 3.002014, 4.826582
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002403, 3.141746, 5.321433
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002159, 3.213455, 5.008316
Train average loss all      (Triplet)                 : 0.002197

== Recognize ==
Train average loss Recognize     : 1.238783
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.181799

Epoch 188:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]          Epoch 189:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.952, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=1.080, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.0035, Train/loss_recog_step=1.080, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00336, Train/loss_recog_step=1.290, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.184, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00336, Train/loss_recog_step=1.290, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]  Epoch 189:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.884, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.210, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.980, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=1.010, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.778, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.541, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.429, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.11it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.73it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.26it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.46it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.71it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067033, 0.066513, 0.064382
Valid average loss UNet            (all)              : 0.197928

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.166217, 3.321091, 5.279636
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.799427, 3.664284, 3.462126
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.540017, 3.441216, 3.532720
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.568568, 4.002688, 4.497177
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.347185, 3.938227, 4.682624
Valid average loss all      (Triplet)                 : 0.547038

== Recognize ==
Valid average loss Recognize     : 1.118107
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.744965

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.571216583251953 sec. =
Valid knn accuracy drums     : 81.47058823529412%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.525771379470825 sec. =
Valid knn accuracy bass      : 13.08139534883721%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.003738641738892 sec. =
Valid knn accuracy piano     : 27.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.05051040649414 sec. =
Valid knn accuracy guitar    : 40.58441558441558%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.081454753875732 sec. =
Valid knn accuracy residuals : 55.81761006289309%

Valid knn accuracy average   : 43.70431535980151%

                                                                        [AEpoch 189: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.182, Train/loss_unet_all_epoch=0.180, Train/loss_triplet_all_epoch=0.0022, Train/loss_recog_epoch=1.240]Epoch 189: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059337, 0.058970, 0.060191
Train average loss UNet            (all)              : 0.178499

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000332, 3.009720, 5.693617
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001064, 2.910843, 4.941052
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001656, 3.015410, 4.889293
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001829, 3.120391, 5.291709
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001145, 3.208387, 5.048613
Train average loss all      (Triplet)                 : 0.001175

== Recognize ==
Train average loss Recognize     : 1.241814
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179673

Epoch 189:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]          Epoch 190:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.886, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.220, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.984, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.984, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.450, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=0.999, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.768, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.745, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.547, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.22it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.48it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.19it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.91it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.39it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.70it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067231, 0.066709, 0.064308
Valid average loss UNet            (all)              : 0.198248

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.152557, 3.232685, 5.195606
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.722550, 3.651282, 3.576036
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.669724, 3.480367, 3.563511
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.637396, 3.996341, 4.491670
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.317789, 3.783239, 4.591553
Valid average loss all      (Triplet)                 : 0.561290

== Recognize ==
Valid average loss Recognize     : 1.118156
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.759538

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.52657961845398 sec. =
Valid knn accuracy drums     : 80.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.29762864112854 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.291732549667358 sec. =
Valid knn accuracy piano     : 28.10810810810811%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.756772756576538 sec. =
Valid knn accuracy guitar    : 45.77922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.987572431564331 sec. =
Valid knn accuracy residuals : 52.20125786163522%

Valid knn accuracy average   : 44.50362706251513%

                                                                        [AEpoch 190: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00117, Train/loss_recog_epoch=1.240]Epoch 190: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059338, 0.058954, 0.060092
Train average loss UNet            (all)              : 0.178384

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000279, 3.123835, 5.805148
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001788, 3.024597, 5.173440
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001436, 3.159186, 5.162245
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001200, 3.258893, 5.565606
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001422, 3.361814, 5.296896
Train average loss all      (Triplet)                 : 0.001160

== Recognize ==
Train average loss Recognize     : 1.244272
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179544

Epoch 190:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]          Epoch 191:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.954, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191:  16%|█▌        | 50/313 [00:47<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=0.886, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=0.886, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000984, Train/loss_recog_step=1.220, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000984, Train/loss_recog_step=1.220, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.981, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]   Epoch 191:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.981, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=1.450, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00385, Train/loss_recog_step=1.450, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.875, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.561, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.445, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.15it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.35it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.70it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.88it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.64it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067913, 0.067154, 0.066311
Valid average loss UNet            (all)              : 0.201377

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.152640, 3.453936, 5.960104
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.683482, 3.816427, 3.779234
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.630852, 3.713256, 3.745774
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.721816, 4.140379, 4.475285
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.397918, 4.150969, 4.906249
Valid average loss all      (Triplet)                 : 0.563369

== Recognize ==
Valid average loss Recognize     : 1.116874
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.764746

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.536322355270386 sec. =
Valid knn accuracy drums     : 77.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.435435056686401 sec. =
Valid knn accuracy bass      : 14.098837209302326%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.190616607666016 sec. =
Valid knn accuracy piano     : 21.891891891891895%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.851806640625 sec. =
Valid knn accuracy guitar    : 40.909090909090914%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.898428440093994 sec. =
Valid knn accuracy residuals : 57.704402515723274%

Valid knn accuracy average   : 42.33260921108403%

                                                                        [AEpoch 191: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00116, Train/loss_recog_epoch=1.240]Epoch 191: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059382, 0.059015, 0.060190
Train average loss UNet            (all)              : 0.178588

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000572, 3.230490, 6.196256
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001882, 3.101310, 5.223653
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001720, 3.216680, 5.216111
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001297, 3.327034, 5.669956
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000925, 3.428843, 5.366726
Train average loss all      (Triplet)                 : 0.001336

== Recognize ==
Train average loss Recognize     : 1.244304
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179924

Epoch 191:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]          Epoch 192:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]Epoch 192:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.955, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]Epoch 192:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]Epoch 192:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.080, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]Epoch 192:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]Epoch 192:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]Epoch 192:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]Epoch 192:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.889, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]Epoch 192:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000819, Train/loss_recog_step=1.220, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]Epoch 192:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000819, Train/loss_recog_step=1.220, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]Epoch 192:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00886, Train/loss_recog_step=0.984, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240] Epoch 192:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.00886, Train/loss_recog_step=0.984, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]Epoch 192:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.460, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]  Epoch 192: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.460, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]Epoch 192: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.986, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.747, Valid/loss_recog_step=1.350, Valid/loss_all_epoch=0.765, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.423, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.80it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.36it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.97it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.46it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.42it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.98it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068101, 0.068100, 0.066668
Valid average loss UNet            (all)              : 0.202869

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.110430, 3.172544, 5.516112
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.670269, 3.626604, 3.625182
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.477616, 3.430018, 3.660836
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.688013, 3.954655, 4.522787
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.314576, 3.703998, 4.751832
Valid average loss all      (Triplet)                 : 0.507980

== Recognize ==
Valid average loss Recognize     : 1.119753
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.710849

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.51878309249878 sec. =
Valid knn accuracy drums     : 81.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.028188705444336 sec. =
Valid knn accuracy bass      : 13.662790697674417%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.289226770401001 sec. =
Valid knn accuracy piano     : 26.891891891891888%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.82507586479187 sec. =
Valid knn accuracy guitar    : 40.74675324675325%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.773123741149902 sec. =
Valid knn accuracy residuals : 58.64779874213837%

Valid knn accuracy average   : 44.225141033338645%

                                                                        [AEpoch 192: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00134, Train/loss_recog_epoch=1.240]Epoch 192: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059459, 0.059091, 0.060240
Train average loss UNet            (all)              : 0.178790

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000632, 3.076562, 5.904371
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004326, 2.999613, 5.025610
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001954, 3.032808, 4.873175
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001693, 3.174253, 5.316847
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001724, 3.273966, 5.119317
Train average loss all      (Triplet)                 : 0.002123

== Recognize ==
Train average loss Recognize     : 1.246817
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.180913

Epoch 192:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]          Epoch 193:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]Epoch 193:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.957, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]Epoch 193:  16%|█▌        | 50/313 [00:48<04:12,  1.04it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00258, Train/loss_recog_step=1.080, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]Epoch 193:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00258, Train/loss_recog_step=1.080, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]Epoch 193:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00508, Train/loss_recog_step=1.290, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]Epoch 193:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.00508, Train/loss_recog_step=1.290, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]Epoch 193:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000303, Train/loss_recog_step=0.889, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]Epoch 193:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000303, Train/loss_recog_step=0.889, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]Epoch 193:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000133, Train/loss_recog_step=1.220, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]Epoch 193:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000133, Train/loss_recog_step=1.220, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]Epoch 193:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.986, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]  Epoch 193:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.194, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.0133, Train/loss_recog_step=0.986, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]Epoch 193:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.460, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250] Epoch 193: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.460, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]Epoch 193: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.959, Valid/loss_all_step=0.961, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=0.721, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.711, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.508, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.442, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.88it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.37it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.86it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.10it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.69it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067065, 0.067365, 0.066745
Valid average loss UNet            (all)              : 0.201175

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.119200, 3.272169, 5.237343
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.765104, 3.690508, 3.637944
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.666149, 3.572786, 3.500196
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.720840, 3.954020, 4.437232
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.308852, 3.901654, 4.944206
Valid average loss all      (Triplet)                 : 0.590785

== Recognize ==
Valid average loss Recognize     : 1.123371
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.791960

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.699172973632812 sec. =
Valid knn accuracy drums     : 79.11764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.970468997955322 sec. =
Valid knn accuracy bass      : 16.27906976744186%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.184581756591797 sec. =
Valid knn accuracy piano     : 25.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.913039922714233 sec. =
Valid knn accuracy guitar    : 42.532467532467535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.022732257843018 sec. =
Valid knn accuracy residuals : 55.81761006289309%

Valid knn accuracy average   : 43.77638591135223%

                                                                        [AEpoch 193: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.959, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00212, Train/loss_recog_epoch=1.250]Epoch 193: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.959, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059503, 0.059167, 0.060413
Train average loss UNet            (all)              : 0.179083

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000641, 3.097500, 5.854714
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004727, 2.998974, 5.017851
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002145, 3.097798, 4.967516
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001572, 3.193491, 5.344881
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002279, 3.304329, 5.162809
Train average loss all      (Triplet)                 : 0.002397

== Recognize ==
Train average loss Recognize     : 1.249378
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.181479

Epoch 193:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.959, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]          Epoch 194:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.959, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]Epoch 194:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.959, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]Epoch 194:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0024, Train/loss_recog_step=1.090, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]Epoch 194:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0024, Train/loss_recog_step=1.090, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]Epoch 194:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=1.300, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]Epoch 194:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00143, Train/loss_recog_step=1.300, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]Epoch 194:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=0.892, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]Epoch 194:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00272, Train/loss_recog_step=0.892, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]Epoch 194:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]  Epoch 194:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]Epoch 194:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=0.989, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]Epoch 194:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00128, Train/loss_recog_step=0.989, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]Epoch 194:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.460, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]  Epoch 194: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.460, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]Epoch 194: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.966, Valid/loss_recog_step=1.360, Valid/loss_all_epoch=0.792, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.591, Valid/loss_recog_epoch=1.120, Valid/knn_avr=0.438, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.01it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.04it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.67it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.35it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.32it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071458, 0.070757, 0.068351
Valid average loss UNet            (all)              : 0.210566

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.132319, 3.463292, 5.410698
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.840021, 3.922221, 3.691302
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.643301, 3.679401, 3.598163
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.499180, 4.040627, 4.901951
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.409046, 4.134195, 4.864081
Valid average loss all      (Triplet)                 : 0.582065

== Recognize ==
Valid average loss Recognize     : 1.126423
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.792630

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.591615200042725 sec. =
Valid knn accuracy drums     : 80.29411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.769638538360596 sec. =
Valid knn accuracy bass      : 13.953488372093023%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.317322254180908 sec. =
Valid knn accuracy piano     : 28.37837837837838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.64713716506958 sec. =
Valid knn accuracy guitar    : 43.506493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.048199892044067 sec. =
Valid knn accuracy residuals : 55.188679245283026%

Valid knn accuracy average   : 44.26423142986135%

                                                                        [AEpoch 194: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.0024, Train/loss_recog_epoch=1.250]Epoch 194: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059391, 0.059039, 0.060131
Train average loss UNet            (all)              : 0.178561

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000465, 3.008414, 5.582809
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001865, 2.928069, 4.955053
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002372, 3.070177, 4.944920
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001958, 3.149627, 5.305464
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001608, 3.244313, 5.090150
Train average loss all      (Triplet)                 : 0.001646

== Recognize ==
Train average loss Recognize     : 1.251984
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.180206

Epoch 194:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]          Epoch 195:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]Epoch 195:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.960, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]Epoch 195:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=1.090, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]Epoch 195:  32%|███▏      | 100/313 [01:32<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00429, Train/loss_recog_step=1.090, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]Epoch 195:  32%|███▏      | 100/313 [01:32<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]  Epoch 195:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]Epoch 195:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=0.891, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]Epoch 195:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0072, Train/loss_recog_step=0.891, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]Epoch 195:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=1.230, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]Epoch 195:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00333, Train/loss_recog_step=1.230, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]Epoch 195:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.989, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250] Epoch 195:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.193, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.0112, Train/loss_recog_step=0.989, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]Epoch 195:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.470, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250] Epoch 195: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.470, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]Epoch 195: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.254, Valid/loss_triplet_all_step=0.931, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.443, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.73it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.27it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.27it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.36it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.44it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066807, 0.066535, 0.064619
Valid average loss UNet            (all)              : 0.197961

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.191076, 3.637478, 5.940201
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.832194, 4.155109, 3.865280
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.494986, 3.760079, 3.924810
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.591172, 4.272540, 4.903231
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.363097, 4.145332, 5.171267
Valid average loss all      (Triplet)                 : 0.559450

== Recognize ==
Valid average loss Recognize     : 1.128324
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.757412

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.747764587402344 sec. =
Valid knn accuracy drums     : 76.91176470588236%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.239006519317627 sec. =
Valid knn accuracy bass      : 13.80813953488372%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.400431871414185 sec. =
Valid knn accuracy piano     : 25.675675675675674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.841631174087524 sec. =
Valid knn accuracy guitar    : 35.22727272727273%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.80603313446045 sec. =
Valid knn accuracy residuals : 53.77358490566038%

Valid knn accuracy average   : 41.07928750987497%

                                                                        [AEpoch 195: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.250]Epoch 195: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059270, 0.058998, 0.060104
Train average loss UNet            (all)              : 0.178371

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000583, 3.223191, 5.966902
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002073, 3.100057, 5.200309
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002458, 3.249271, 5.221005
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001622, 3.324605, 5.574060
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001161, 3.444263, 5.374926
Train average loss all      (Triplet)                 : 0.001613

== Recognize ==
Train average loss Recognize     : 1.252659
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179984

Epoch 195:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]          Epoch 196:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.962, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.896, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00518, Train/loss_recog_step=0.992, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00518, Train/loss_recog_step=0.992, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196:  96%|█████████▌| 300/313 [04:22<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.470, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]  Epoch 196: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.470, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196: 100%|██████████| 313/313 [04:32<00:00,  1.15it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.050, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.818, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.757, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.559, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.411, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.20it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.04it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.37it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.22it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.96it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.074474, 0.074008, 0.071434
Valid average loss UNet            (all)              : 0.219915

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.137867, 3.780819, 6.006717
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.928431, 4.333898, 4.043413
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.943964, 4.279765, 4.056101
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.741729, 4.619053, 5.503630
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.486775, 4.431008, 5.159642
Valid average loss all      (Triplet)                 : 0.744412

== Recognize ==
Valid average loss Recognize     : 1.130281
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.964328

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.493650674819946 sec. =
Valid knn accuracy drums     : 83.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.487362623214722 sec. =
Valid knn accuracy bass      : 13.662790697674417%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.197824716567993 sec. =
Valid knn accuracy piano     : 27.837837837837835%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.014881372451782 sec. =
Valid knn accuracy guitar    : 40.74675324675325%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.971434354782104 sec. =
Valid knn accuracy residuals : 52.67295597484277%

Valid knn accuracy average   : 43.748773433774595%

                                                                        [AEpoch 196: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.250]Epoch 196: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059291, 0.058972, 0.060165
Train average loss UNet            (all)              : 0.178428

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000475, 3.291662, 6.154497
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002562, 3.224572, 5.451480
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001839, 3.350838, 5.406132
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001621, 3.429765, 5.782919
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001421, 3.550721, 5.566967
Train average loss all      (Triplet)                 : 0.001585

== Recognize ==
Train average loss Recognize     : 1.257313
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.180013

Epoch 196:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]          Epoch 197:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00291, Train/loss_recog_step=0.897, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00291, Train/loss_recog_step=0.897, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]  Epoch 197:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.230, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.994, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.994, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00219, Train/loss_recog_step=1.470, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.00219, Train/loss_recog_step=1.470, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.640, Valid/loss_unet_all_step=0.259, Valid/loss_triplet_all_step=1.380, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.964, Valid/loss_unet_all_epoch=0.220, Valid/loss_triplet_all_epoch=0.744, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.437, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.82it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.03it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.18it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.34it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.20it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.47it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069249, 0.068062, 0.067136
Valid average loss UNet            (all)              : 0.204447

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.142763, 3.453520, 5.622105
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.799484, 3.895995, 3.671013
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.811978, 3.849601, 3.700606
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.573699, 4.026563, 4.862213
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.362869, 3.947977, 4.881307
Valid average loss all      (Triplet)                 : 0.615427

== Recognize ==
Valid average loss Recognize     : 1.131227
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.819874

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.723254203796387 sec. =
Valid knn accuracy drums     : 81.61764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.937572717666626 sec. =
Valid knn accuracy bass      : 12.790697674418606%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.937660694122314 sec. =
Valid knn accuracy piano     : 26.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.00737190246582 sec. =
Valid knn accuracy guitar    : 43.18181818181818%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.011824369430542 sec. =
Valid knn accuracy residuals : 52.20125786163522%

Valid knn accuracy average   : 43.28260847966344%

                                                                        [AEpoch 197: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.260]Epoch 197: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059308, 0.058987, 0.060171
Train average loss UNet            (all)              : 0.178466

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000576, 3.259282, 6.049818
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002586, 3.247427, 5.530673
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002307, 3.341492, 5.395976
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002101, 3.434197, 5.794332
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001771, 3.534848, 5.509068
Train average loss all      (Triplet)                 : 0.001909

== Recognize ==
Train average loss Recognize     : 1.258498
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.180376

Epoch 197:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]          Epoch 198:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]Epoch 198:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.964, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]Epoch 198:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=1.090, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]Epoch 198:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00568, Train/loss_recog_step=1.090, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]Epoch 198:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]  Epoch 198:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]Epoch 198:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]Epoch 198:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.897, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]Epoch 198:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=1.230, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]Epoch 198:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00777, Train/loss_recog_step=1.230, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]Epoch 198:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]  Epoch 198:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]Epoch 198:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00449, Train/loss_recog_step=1.470, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]Epoch 198: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00449, Train/loss_recog_step=1.470, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]Epoch 198: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.967, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.820, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.615, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.433, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.87it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.46it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.87it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.47it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066948, 0.066902, 0.065391
Valid average loss UNet            (all)              : 0.199242

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.118103, 3.241146, 5.221390
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.690403, 3.584058, 3.425992
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.701319, 3.529964, 3.422162
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.560158, 3.939434, 4.577071
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.331461, 3.953773, 5.056973
Valid average loss all      (Triplet)                 : 0.539254

== Recognize ==
Valid average loss Recognize     : 1.132552
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.738496

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.835387229919434 sec. =
Valid knn accuracy drums     : 81.76470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.220046281814575 sec. =
Valid knn accuracy bass      : 19.186046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.070506811141968 sec. =
Valid knn accuracy piano     : 27.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.078166961669922 sec. =
Valid knn accuracy guitar    : 42.6948051948052%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.292439222335815 sec. =
Valid knn accuracy residuals : 57.23270440251572%

Valid knn accuracy average   : 45.716192938800894%

                                                                        [AEpoch 198: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.967, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00191, Train/loss_recog_epoch=1.260]Epoch 198: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.967, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059154, 0.058786, 0.059918
Train average loss UNet            (all)              : 0.177858

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000755, 3.087998, 5.734900
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002060, 3.016464, 5.121251
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002077, 3.112905, 5.023937
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002358, 3.219390, 5.431014
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002410, 3.325061, 5.223520
Train average loss all      (Triplet)                 : 0.001957

== Recognize ==
Train average loss Recognize     : 1.259943
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179815

Epoch 198:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.967, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]          Epoch 199:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.967, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]Epoch 199:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.967, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]Epoch 199:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]Epoch 199:  32%|███▏      | 100/313 [01:32<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.090, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]Epoch 199:  32%|███▏      | 100/313 [01:32<03:16,  1.09it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000342, Train/loss_recog_step=1.310, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]Epoch 199:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000342, Train/loss_recog_step=1.310, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]Epoch 199:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]   Epoch 199:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.898, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]Epoch 199:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]Epoch 199:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]Epoch 199:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=0.998, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]Epoch 199:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.0032, Train/loss_recog_step=0.998, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]Epoch 199:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.480, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260] Epoch 199: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.480, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]Epoch 199: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=0.860, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.738, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.539, Valid/loss_recog_epoch=1.130, Valid/knn_avr=0.457, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.23it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.60it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071030, 0.070431, 0.067923
Valid average loss UNet            (all)              : 0.209385

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.110702, 3.383372, 5.443088
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.663080, 3.706172, 3.617337
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.751554, 3.734762, 3.571077
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.717846, 4.117707, 4.856621
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.392952, 4.104716, 4.720953
Valid average loss all      (Triplet)                 : 0.592052

== Recognize ==
Valid average loss Recognize     : 1.136812
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.801437

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.657829761505127 sec. =
Valid knn accuracy drums     : 82.94117647058825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.205823183059692 sec. =
Valid knn accuracy bass      : 15.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.212952375411987 sec. =
Valid knn accuracy piano     : 31.756756756756754%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.893366575241089 sec. =
Valid knn accuracy guitar    : 42.532467532467535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.153005838394165 sec. =
Valid knn accuracy residuals : 56.91823899371069%

Valid knn accuracy average   : 45.99833260186744%

                                                                        [AEpoch 199: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.260]Epoch 199: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059098, 0.058712, 0.059900
Train average loss UNet            (all)              : 0.177711

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000866, 3.105936, 5.799743
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002500, 3.049321, 5.131610
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001971, 3.130406, 5.048309
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001974, 3.278327, 5.581078
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001736, 3.359750, 5.299878
Train average loss all      (Triplet)                 : 0.001781

== Recognize ==
Train average loss Recognize     : 1.261809
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179492

Epoch 199:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]          Epoch 200:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.969, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.182, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00289, Train/loss_recog_step=0.901, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00289, Train/loss_recog_step=0.901, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00485, Train/loss_recog_step=1.240, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.00485, Train/loss_recog_step=1.240, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.999, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]  Epoch 200:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.999, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=1.480, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.011, Train/loss_recog_step=1.480, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.247, Valid/loss_triplet_all_step=0.963, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.460, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.98it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.15it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.70it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.41it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.44it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.50it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067955, 0.066893, 0.066190
Valid average loss UNet            (all)              : 0.201039

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.118224, 3.097205, 5.237723
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.492525, 3.376439, 3.414890
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.655829, 3.486602, 3.350024
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.647355, 3.851028, 4.230857
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.308368, 3.598707, 4.570837
Valid average loss all      (Triplet)                 : 0.497419

== Recognize ==
Valid average loss Recognize     : 1.137368
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.698458

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.627585649490356 sec. =
Valid knn accuracy drums     : 79.26470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.348103046417236 sec. =
Valid knn accuracy bass      : 15.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.187126874923706 sec. =
Valid knn accuracy piano     : 27.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.775922536849976 sec. =
Valid knn accuracy guitar    : 44.31818181818182%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.161325693130493 sec. =
Valid knn accuracy residuals : 53.930817610062896%

Valid knn accuracy average   : 44.18485922679584%

                                                                        [AEpoch 200: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00178, Train/loss_recog_epoch=1.260]Epoch 200: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058961, 0.058684, 0.059812
Train average loss UNet            (all)              : 0.177456

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000742, 3.088416, 5.707588
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002381, 3.056309, 5.247048
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000865, 3.141017, 5.103560
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001409, 3.241131, 5.527907
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001502, 3.341592, 5.292279
Train average loss all      (Triplet)                 : 0.001520

== Recognize ==
Train average loss Recognize     : 1.264722
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178977

Epoch 200:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]          Epoch 201:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]Epoch 201:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]Epoch 201:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00171, Train/loss_recog_step=1.100, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]Epoch 201:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00171, Train/loss_recog_step=1.100, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]Epoch 201:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]  Epoch 201:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]Epoch 201:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]Epoch 201:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.900, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]Epoch 201:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]Epoch 201:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]Epoch 201:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000644, Train/loss_recog_step=1.000, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]Epoch 201:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000644, Train/loss_recog_step=1.000, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]Epoch 201:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.480, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]   Epoch 201: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.480, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]Epoch 201: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.060, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=0.833, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.698, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.497, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.442, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.40it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.96it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.42it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.71it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.93it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069262, 0.067886, 0.065591
Valid average loss UNet            (all)              : 0.202738

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.111178, 3.438428, 5.485151
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.627931, 3.644697, 3.539974
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.857053, 3.805938, 3.496534
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.653621, 4.256372, 4.803575
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.343598, 4.135119, 4.821009
Valid average loss all      (Triplet)                 : 0.582454

== Recognize ==
Valid average loss Recognize     : 1.136674
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.785192

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.49330186843872 sec. =
Valid knn accuracy drums     : 78.08823529411765%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.344757080078125 sec. =
Valid knn accuracy bass      : 16.86046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.517305850982666 sec. =
Valid knn accuracy piano     : 27.16216216216216%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.86575698852539 sec. =
Valid knn accuracy guitar    : 41.396103896103895%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.672448873519897 sec. =
Valid knn accuracy residuals : 53.930817610062896%

Valid knn accuracy average   : 43.48755681574513%

                                                                        [AEpoch 201: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00152, Train/loss_recog_epoch=1.260]Epoch 201: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058819, 0.058461, 0.059612
Train average loss UNet            (all)              : 0.176891

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000945, 3.081830, 5.687734
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000835, 3.012576, 5.205569
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001236, 3.122802, 5.065094
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000989, 3.219296, 5.455067
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002221, 3.352986, 5.332168
Train average loss all      (Triplet)                 : 0.001269

== Recognize ==
Train average loss Recognize     : 1.264676
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178160

Epoch 201:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]          Epoch 202:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.970, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.901, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.999, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.999, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.480, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.480, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.970, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.582, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.435, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.85it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.08it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.16it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.13it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.95it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.41it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070244, 0.070334, 0.068214
Valid average loss UNet            (all)              : 0.208792

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.132509, 3.418632, 5.754290
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.708215, 3.997422, 3.946288
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.785958, 4.045159, 3.813344
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.921097, 4.513780, 5.026297
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.475130, 4.289692, 5.076097
Valid average loss all      (Triplet)                 : 0.665232

== Recognize ==
Valid average loss Recognize     : 1.136876
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.874025

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.64723539352417 sec. =
Valid knn accuracy drums     : 76.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.415816068649292 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.2557532787323 sec. =
Valid knn accuracy piano     : 29.594594594594593%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.720893859863281 sec. =
Valid knn accuracy guitar    : 38.961038961038966%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.114762306213379 sec. =
Valid knn accuracy residuals : 58.490566037735846%

Valid knn accuracy average   : 44.01628506231273%

                                                                        [AEpoch 202: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.970, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00127, Train/loss_recog_epoch=1.260]Epoch 202: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.970, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058754, 0.058473, 0.059646
Train average loss UNet            (all)              : 0.176874

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000869, 3.166061, 5.831961
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001143, 3.050283, 5.217283
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001919, 3.164119, 5.095866
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001325, 3.261026, 5.519108
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002236, 3.391453, 5.391363
Train average loss all      (Triplet)                 : 0.001515

== Recognize ==
Train average loss Recognize     : 1.266651
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178388

Epoch 202:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.970, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]          Epoch 203:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.970, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]Epoch 203:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.192, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0166, Train/loss_recog_step=0.970, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]Epoch 203:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=1.100, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]Epoch 203:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.0122, Train/loss_recog_step=1.100, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]Epoch 203:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270] Epoch 203:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.185, Train/loss_unet_all_step=0.185, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]Epoch 203:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]Epoch 203:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.904, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]Epoch 203:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000565, Train/loss_recog_step=1.240, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]Epoch 203:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000565, Train/loss_recog_step=1.240, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]Epoch 203:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]   Epoch 203:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]Epoch 203:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000191, Train/loss_recog_step=1.490, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]Epoch 203: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000191, Train/loss_recog_step=1.490, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]Epoch 203: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.370, Valid/loss_all_epoch=0.874, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.665, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.91it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.35it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.10it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.10it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.38it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071388, 0.072269, 0.070169
Valid average loss UNet            (all)              : 0.213826

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.130223, 3.488241, 5.799940
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.738751, 4.108270, 4.130904
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.908218, 4.137727, 3.800896
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.737182, 4.524111, 5.356666
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.359421, 4.447458, 5.327030
Valid average loss all      (Triplet)                 : 0.649602

== Recognize ==
Valid average loss Recognize     : 1.141915
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.863428

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.547434329986572 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.064935684204102 sec. =
Valid knn accuracy bass      : 17.587209302325583%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.284055471420288 sec. =
Valid knn accuracy piano     : 25.810810810810807%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.481728076934814 sec. =
Valid knn accuracy guitar    : 39.77272727272727%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.393279075622559 sec. =
Valid knn accuracy residuals : 53.459119496855344%

Valid knn accuracy average   : 43.3259733765438%

                                                                        [AEpoch 203: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00151, Train/loss_recog_epoch=1.270]Epoch 203: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059407, 0.059130, 0.060278
Train average loss UNet            (all)              : 0.178816

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001497, 3.337795, 6.192988
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002903, 3.363251, 5.574672
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002350, 3.409436, 5.456983
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.003303, 3.486930, 5.751463
Train average loss residuals(Triplet, dist_p, dist_n) : 0.003472, 3.625802, 5.651599
Train average loss all      (Triplet)                 : 0.002642

== Recognize ==
Train average loss Recognize     : 1.269262
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.181457

Epoch 203:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]          Epoch 204:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.974, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.183, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204:  96%|█████████▌| 300/313 [04:23<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00183, Train/loss_recog_step=1.500, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00183, Train/loss_recog_step=1.500, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.980, Valid/loss_all_step=1.450, Valid/loss_unet_all_step=0.248, Valid/loss_triplet_all_step=1.200, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.863, Valid/loss_unet_all_epoch=0.214, Valid/loss_triplet_all_epoch=0.650, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.433, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270] 
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.83it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.08it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.66it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.16it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.15it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067213, 0.066147, 0.064277
Valid average loss UNet            (all)              : 0.197638

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.155280, 3.354873, 5.355496
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.707645, 4.006741, 4.004566
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.791413, 3.852671, 3.555604
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.901670, 4.515926, 4.875508
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.303882, 4.319481, 4.929362
Valid average loss all      (Triplet)                 : 0.640391

== Recognize ==
Valid average loss Recognize     : 1.149100
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.838029

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.473172187805176 sec. =
Valid knn accuracy drums     : 80.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.198479890823364 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.269784927368164 sec. =
Valid knn accuracy piano     : 25.135135135135133%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.971724271774292 sec. =
Valid knn accuracy guitar    : 47.88961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.933014869689941 sec. =
Valid knn accuracy residuals : 57.23270440251572%

Valid knn accuracy average   : 44.98787849434418%

                                                                        [AEpoch 204: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.980, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.181, Train/loss_unet_all_epoch=0.179, Train/loss_triplet_all_epoch=0.00264, Train/loss_recog_epoch=1.270]Epoch 204: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.980, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059174, 0.058846, 0.060025
Train average loss UNet            (all)              : 0.178046

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000798, 3.276090, 6.169344
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002482, 3.273840, 5.492278
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001565, 3.347286, 5.384744
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002417, 3.428276, 5.751609
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002008, 3.558274, 5.603394
Train average loss all      (Triplet)                 : 0.001863

== Recognize ==
Train average loss Recognize     : 1.274699
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179908

Epoch 204:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.980, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]          Epoch 205:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.980, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]Epoch 205:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0114, Train/loss_recog_step=0.980, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]Epoch 205:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270] Epoch 205:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]Epoch 205:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00895, Train/loss_recog_step=1.320, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]Epoch 205:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.189, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00895, Train/loss_recog_step=1.320, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]Epoch 205:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]  Epoch 205:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.910, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]Epoch 205:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]Epoch 205:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]Epoch 205:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]Epoch 205:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]Epoch 205:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.500, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]Epoch 205: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.500, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]Epoch 205: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.980, Valid/loss_all_step=1.350, Valid/loss_unet_all_step=0.230, Valid/loss_triplet_all_step=1.120, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.838, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.640, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.86it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.17it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.58it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.20it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067146, 0.066442, 0.065303
Valid average loss UNet            (all)              : 0.198892

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.121543, 3.192576, 5.493179
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.679521, 3.956707, 3.884963
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.620632, 3.424591, 3.350967
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.706608, 4.059897, 4.740492
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.376498, 4.146112, 4.692852
Valid average loss all      (Triplet)                 : 0.554998

== Recognize ==
Valid average loss Recognize     : 1.149073
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.753889

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.61440110206604 sec. =
Valid knn accuracy drums     : 78.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.073925971984863 sec. =
Valid knn accuracy bass      : 12.063953488372094%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.48681902885437 sec. =
Valid knn accuracy piano     : 25.54054054054054%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.122729778289795 sec. =
Valid knn accuracy guitar    : 42.04545454545455%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.408799171447754 sec. =
Valid knn accuracy residuals : 54.71698113207547%

Valid knn accuracy average   : 42.60868005893559%

                                                                        [AEpoch 205: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.980, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.178, Train/loss_triplet_all_epoch=0.00186, Train/loss_recog_epoch=1.270]Epoch 205: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.980, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.059018, 0.058624, 0.059843
Train average loss UNet            (all)              : 0.177485

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000747, 3.203616, 5.956516
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002999, 3.202920, 5.378298
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001933, 3.250546, 5.207791
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001435, 3.323910, 5.603470
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001131, 3.468191, 5.485928
Train average loss all      (Triplet)                 : 0.001729

== Recognize ==
Train average loss Recognize     : 1.278672
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179214

Epoch 205:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.980, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]          Epoch 206:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.980, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]Epoch 206:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00402, Train/loss_recog_step=0.980, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]Epoch 206:  16%|█▌        | 50/313 [00:48<04:16,  1.02it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00997, Train/loss_recog_step=1.110, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]Epoch 206:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00997, Train/loss_recog_step=1.110, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]Epoch 206:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000359, Train/loss_recog_step=1.330, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]Epoch 206:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000359, Train/loss_recog_step=1.330, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]Epoch 206:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]   Epoch 206:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]Epoch 206:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0009, Train/loss_recog_step=1.250, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]Epoch 206:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0009, Train/loss_recog_step=1.250, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]Epoch 206:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280] Epoch 206:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]Epoch 206:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.490, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]Epoch 206: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.490, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]Epoch 206: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.872, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.754, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.555, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.426, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.03it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.97it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.35it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.29it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.19it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.07it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066971, 0.066697, 0.064898
Valid average loss UNet            (all)              : 0.198566

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.164192, 3.311974, 5.544003
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.582077, 3.888114, 3.915337
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.741967, 3.667128, 3.445590
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.792315, 4.268343, 4.830866
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.395157, 4.038856, 4.691510
Valid average loss all      (Triplet)                 : 0.587302

== Recognize ==
Valid average loss Recognize     : 1.148187
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.785868

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.722718954086304 sec. =
Valid knn accuracy drums     : 79.8529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.627721548080444 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.369980335235596 sec. =
Valid knn accuracy piano     : 27.972972972972972%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.901519536972046 sec. =
Valid knn accuracy guitar    : 46.590909090909086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.09714937210083 sec. =
Valid knn accuracy residuals : 55.34591194968554%

Valid knn accuracy average   : 44.626965642658796%

                                                                        [AEpoch 206: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00173, Train/loss_recog_epoch=1.280]Epoch 206: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058873, 0.058563, 0.059655
Train average loss UNet            (all)              : 0.177091

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000432, 3.278844, 6.225360
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001505, 3.222575, 5.471014
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002324, 3.335386, 5.326262
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001701, 3.435761, 5.826085
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001403, 3.544337, 5.607003
Train average loss all      (Triplet)                 : 0.001493

== Recognize ==
Train average loss Recognize     : 1.277751
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178584

Epoch 206:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]          Epoch 207:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]Epoch 207:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]Epoch 207:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00396, Train/loss_recog_step=1.110, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]Epoch 207:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00396, Train/loss_recog_step=1.110, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]Epoch 207:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]  Epoch 207:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]Epoch 207:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]Epoch 207:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]Epoch 207:  64%|██████▍   | 200/313 [02:57<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]Epoch 207:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]Epoch 207:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.0052, Train/loss_recog_step=1.010, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]Epoch 207:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.0052, Train/loss_recog_step=1.010, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]Epoch 207:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.490, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280] Epoch 207: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.490, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]Epoch 207: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.923, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.786, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.446, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.27it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.73it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.77it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.84it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.18it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.45it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070627, 0.068727, 0.067757
Valid average loss UNet            (all)              : 0.207111

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.129553, 3.302274, 5.651179
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.651451, 3.780981, 3.717984
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.793352, 3.673770, 3.551278
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.591507, 3.995422, 4.884332
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.402536, 4.099915, 4.575888
Valid average loss all      (Triplet)                 : 0.572810

== Recognize ==
Valid average loss Recognize     : 1.144594
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.779922

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.370151042938232 sec. =
Valid knn accuracy drums     : 79.26470588235294%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.230477571487427 sec. =
Valid knn accuracy bass      : 17.441860465116278%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.165755987167358 sec. =
Valid knn accuracy piano     : 27.027027027027028%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.073764562606812 sec. =
Valid knn accuracy guitar    : 44.48051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.686544179916382 sec. =
Valid knn accuracy residuals : 55.503144654088054%

Valid knn accuracy average   : 44.743451501820765%

                                                                        [AEpoch 207: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00149, Train/loss_recog_epoch=1.280]Epoch 207: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058786, 0.058447, 0.059620
Train average loss UNet            (all)              : 0.176854

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000836, 3.217693, 6.033132
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002414, 3.189885, 5.411629
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001599, 3.260700, 5.281120
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002292, 3.372420, 5.766062
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001480, 3.481889, 5.477143
Train average loss all      (Triplet)                 : 0.001739

== Recognize ==
Train average loss Recognize     : 1.276534
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178593

Epoch 207:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]          Epoch 208:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208:  16%|█▌        | 50/313 [00:46<04:02,  1.09it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208:  32%|███▏      | 100/313 [01:30<03:11,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00576, Train/loss_recog_step=1.320, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00576, Train/loss_recog_step=1.320, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]  Epoch 208:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.907, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.240, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00114, Train/loss_recog_step=1.490, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00114, Train/loss_recog_step=1.490, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.242, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.780, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.573, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.82it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.49it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.81it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.98it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.16it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068294, 0.067541, 0.065150
Valid average loss UNet            (all)              : 0.200985

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.146317, 3.277087, 5.494544
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.625307, 3.643719, 3.626269
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.714963, 3.534910, 3.398055
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.606342, 3.952976, 4.819559
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.303988, 4.098212, 4.679456
Valid average loss all      (Triplet)                 : 0.536172

== Recognize ==
Valid average loss Recognize     : 1.145288
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.737157

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.837281942367554 sec. =
Valid knn accuracy drums     : 80.88235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.274323225021362 sec. =
Valid knn accuracy bass      : 11.046511627906977%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.276241064071655 sec. =
Valid knn accuracy piano     : 29.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.783989906311035 sec. =
Valid knn accuracy guitar    : 41.883116883116884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.220776557922363 sec. =
Valid knn accuracy residuals : 56.60377358490566%

Valid knn accuracy average   : 43.89396181823201%

                                                                        [AEpoch 208: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00174, Train/loss_recog_epoch=1.280]Epoch 208: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058661, 0.058331, 0.059494
Train average loss UNet            (all)              : 0.176486

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000145, 3.111181, 5.829274
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001905, 3.073204, 5.172990
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002556, 3.138546, 5.108164
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001722, 3.233710, 5.515680
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001106, 3.331985, 5.261949
Train average loss all      (Triplet)                 : 0.001443

== Recognize ==
Train average loss Recognize     : 1.273259
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.177929

Epoch 208:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]          Epoch 209:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.975, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00166, Train/loss_recog_step=0.906, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00166, Train/loss_recog_step=0.906, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]  Epoch 209:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=1.490, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0103, Train/loss_recog_step=1.490, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.974, Valid/loss_all_step=1.110, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=0.877, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.737, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.536, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.439, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.98it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.02it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.71it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.15it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.39it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.13it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067684, 0.067518, 0.065393
Valid average loss UNet            (all)              : 0.200594

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.155936, 3.350714, 5.510506
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.677141, 4.017960, 3.994779
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.693215, 3.734022, 3.612529
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.661197, 4.204701, 5.197311
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.272120, 4.133049, 5.122467
Valid average loss all      (Triplet)                 : 0.552676

== Recognize ==
Valid average loss Recognize     : 1.142696
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.753270

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.816718101501465 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.216095209121704 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.202088594436646 sec. =
Valid knn accuracy piano     : 25.810810810810807%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.664146423339844 sec. =
Valid knn accuracy guitar    : 39.61038961038961%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.216045379638672 sec. =
Valid knn accuracy residuals : 58.17610062893082%

Valid knn accuracy average   : 43.59736718677043%

                                                                        [AEpoch 209: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.974, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00144, Train/loss_recog_epoch=1.270]Epoch 209: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.974, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058356, 0.058071, 0.059246
Train average loss UNet            (all)              : 0.175673

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000157, 3.197908, 6.129029
Train average loss bass     (Triplet, dist_p, dist_n) : 0.000576, 3.117833, 5.310746
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000948, 3.218716, 5.264466
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000378, 3.330215, 5.754824
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001289, 3.467164, 5.502808
Train average loss all      (Triplet)                 : 0.000658

== Recognize ==
Train average loss Recognize     : 1.272933
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176332

Epoch 209:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.974, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]          Epoch 210:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.974, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]Epoch 210:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00591, Train/loss_recog_step=0.974, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]Epoch 210:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=1.110, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]Epoch 210:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00228, Train/loss_recog_step=1.110, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]Epoch 210:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]  Epoch 210:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]Epoch 210:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]Epoch 210:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.906, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]Epoch 210:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=1.250, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]Epoch 210:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00695, Train/loss_recog_step=1.250, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]Epoch 210:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00213, Train/loss_recog_step=1.000, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]Epoch 210:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.00213, Train/loss_recog_step=1.000, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]Epoch 210:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.490, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]  Epoch 210: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.490, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]Epoch 210: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.907, Valid/loss_recog_step=1.380, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.201, Valid/loss_triplet_all_epoch=0.553, Valid/loss_recog_epoch=1.140, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.23it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.99it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.31it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.45it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.11it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.91it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068192, 0.066554, 0.065089
Valid average loss UNet            (all)              : 0.199836

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.165393, 3.347693, 5.493482
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.655352, 3.800131, 3.802533
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.807777, 3.673809, 3.456264
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.640604, 4.068729, 4.696086
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.275308, 3.996312, 4.748453
Valid average loss all      (Triplet)                 : 0.562530

== Recognize ==
Valid average loss Recognize     : 1.145149
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.762366

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.48800277709961 sec. =
Valid knn accuracy drums     : 80.88235294117648%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.13958215713501 sec. =
Valid knn accuracy bass      : 14.244186046511627%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.316638708114624 sec. =
Valid knn accuracy piano     : 29.054054054054053%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.239985942840576 sec. =
Valid knn accuracy guitar    : 42.2077922077922%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.840883016586304 sec. =
Valid knn accuracy residuals : 58.64779874213837%

Valid knn accuracy average   : 45.007236798334546%

                                                                        [AEpoch 210: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.000658, Train/loss_recog_epoch=1.270]Epoch 210: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058942, 0.058634, 0.059662
Train average loss UNet            (all)              : 0.177237

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000849, 3.418041, 6.334109
Train average loss bass     (Triplet, dist_p, dist_n) : 0.004898, 3.442595, 5.772905
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002481, 3.520156, 5.660149
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002180, 3.642130, 6.165439
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001835, 3.747054, 5.888981
Train average loss all      (Triplet)                 : 0.002573

== Recognize ==
Train average loss Recognize     : 1.272753
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.179811

Epoch 210:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]          Epoch 211:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]Epoch 211:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.976, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]Epoch 211:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=1.110, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]Epoch 211:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=1.110, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]Epoch 211:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00221, Train/loss_recog_step=1.320, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]Epoch 211:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.00221, Train/loss_recog_step=1.320, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]Epoch 211:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=0.909, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270] Epoch 211:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.188, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.0128, Train/loss_recog_step=0.909, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]Epoch 211:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270] Epoch 211:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]Epoch 211:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000245, Train/loss_recog_step=1.010, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]Epoch 211:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000245, Train/loss_recog_step=1.010, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]Epoch 211:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.490, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]   Epoch 211: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.490, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]Epoch 211: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.930, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.563, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.450, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.84it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.76it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.40it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.86it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.41it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.17it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067488, 0.066947, 0.064633
Valid average loss UNet            (all)              : 0.199068

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.165006, 3.203132, 5.247234
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.668157, 3.686263, 3.665227
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.808517, 3.589705, 3.326119
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.671107, 3.901550, 4.617667
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.294822, 3.719604, 4.542143
Valid average loss all      (Triplet)                 : 0.579025

== Recognize ==
Valid average loss Recognize     : 1.145840
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.778093

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.618314027786255 sec. =
Valid knn accuracy drums     : 76.91176470588236%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.032536506652832 sec. =
Valid knn accuracy bass      : 17.00581395348837%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.19835090637207 sec. =
Valid knn accuracy piano     : 30.405405405405407%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.259334087371826 sec. =
Valid knn accuracy guitar    : 43.34415584415584%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.112921476364136 sec. =
Valid knn accuracy residuals : 55.9748427672956%

Valid knn accuracy average   : 44.728396535245516%

                                                                        [AEpoch 211: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.180, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00257, Train/loss_recog_epoch=1.270]Epoch 211: 100%|██████████| 313/313 [06:09<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058741, 0.058431, 0.059527
Train average loss UNet            (all)              : 0.176699

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000351, 2.931605, 5.490396
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002407, 2.899831, 4.849326
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002879, 2.996217, 4.812287
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001623, 3.082947, 5.267878
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002111, 3.197386, 5.019496
Train average loss all      (Triplet)                 : 0.001846

== Recognize ==
Train average loss Recognize     : 1.276134
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178545

Epoch 211:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]          Epoch 212:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.977, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212:  16%|█▌        | 50/313 [00:47<04:11,  1.04it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.100, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=1.320, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00268, Train/loss_recog_step=1.320, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]  Epoch 212:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.909, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.490, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.490, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.234, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.778, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.579, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.447, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.88it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.13it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.30it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.16it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.71it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.23it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067284, 0.067507, 0.065010
Valid average loss UNet            (all)              : 0.199802

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.164418, 3.699404, 6.213949
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.780091, 4.328048, 4.286590
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.928815, 4.216760, 3.906190
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.622227, 4.483248, 5.315393
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.344563, 4.369102, 5.153034
Valid average loss all      (Triplet)                 : 0.628989

== Recognize ==
Valid average loss Recognize     : 1.146158
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.828790

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.748200416564941 sec. =
Valid knn accuracy drums     : 78.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.225451231002808 sec. =
Valid knn accuracy bass      : 14.534883720930234%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.899304389953613 sec. =
Valid knn accuracy piano     : 26.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.079195499420166 sec. =
Valid knn accuracy guitar    : 49.188311688311686%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.168518543243408 sec. =
Valid knn accuracy residuals : 60.691823899371066%

Valid knn accuracy average   : 45.834514195585875%

                                                                        [AEpoch 212: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.179, Train/loss_unet_all_epoch=0.177, Train/loss_triplet_all_epoch=0.00185, Train/loss_recog_epoch=1.280]Epoch 212: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058601, 0.058254, 0.059371
Train average loss UNet            (all)              : 0.176226

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000235, 3.229534, 6.056475
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001501, 3.235989, 5.496478
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002431, 3.288014, 5.314453
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000891, 3.388254, 5.823730
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001824, 3.534948, 5.550999
Train average loss all      (Triplet)                 : 0.001418

== Recognize ==
Train average loss Recognize     : 1.275797
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.177643

Epoch 212:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]          Epoch 213:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.978, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00249, Train/loss_recog_step=1.110, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00249, Train/loss_recog_step=1.110, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]  Epoch 213:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.320, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.911, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.500, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.500, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=1.290, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=1.050, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.829, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.629, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.35it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  7.30it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.53it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.36it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068449, 0.068358, 0.066203
Valid average loss UNet            (all)              : 0.203011

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.196958, 3.671796, 5.890373
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.810907, 4.187427, 4.060470
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.939450, 4.214818, 3.835693
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.587461, 4.345865, 5.075421
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.379923, 4.609277, 5.236115
Valid average loss all      (Triplet)                 : 0.644710

== Recognize ==
Valid average loss Recognize     : 1.150709
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.847721

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.602382183074951 sec. =
Valid knn accuracy drums     : 74.41176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.301668643951416 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.238461017608643 sec. =
Valid knn accuracy piano     : 26.08108108108108%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.667479753494263 sec. =
Valid knn accuracy guitar    : 45.2922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.026406526565552 sec. =
Valid knn accuracy residuals : 58.333333333333336%

Valid knn accuracy average   : 44.02135180110556%

                                                                        [AEpoch 213: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00142, Train/loss_recog_epoch=1.280]Epoch 213: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058630, 0.058248, 0.059408
Train average loss UNet            (all)              : 0.176285

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000631, 3.339122, 6.258689
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002656, 3.277951, 5.496325
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002457, 3.386749, 5.425114
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000959, 3.464211, 5.856925
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001251, 3.624750, 5.701118
Train average loss all      (Triplet)                 : 0.001607

== Recognize ==
Train average loss Recognize     : 1.279469
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.177892

Epoch 213:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]          Epoch 214:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.982, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000689, Train/loss_recog_step=0.911, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000689, Train/loss_recog_step=0.911, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]   Epoch 214:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.250, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.500, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.500, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00667, Train/loss_recog_step=0.985, Valid/loss_all_step=1.240, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=1.000, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.848, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.645, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.440, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.25it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.87it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.82it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.96it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.38it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069682, 0.067975, 0.066582
Valid average loss UNet            (all)              : 0.204239

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.155649, 3.588218, 6.058493
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.661712, 4.106359, 4.122713
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.812942, 3.905618, 3.680420
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.465689, 4.086700, 4.959284
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.315219, 4.240885, 4.703246
Valid average loss all      (Triplet)                 : 0.543071

== Recognize ==
Valid average loss Recognize     : 1.153247
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.747310

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.634667873382568 sec. =
Valid knn accuracy drums     : 80.14705882352942%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.237836122512817 sec. =
Valid knn accuracy bass      : 17.441860465116278%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.163216829299927 sec. =
Valid knn accuracy piano     : 24.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.891433954238892 sec. =
Valid knn accuracy guitar    : 41.883116883116884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.799328804016113 sec. =
Valid knn accuracy residuals : 54.71698113207547%

Valid knn accuracy average   : 43.729695352659505%

                                                                        [AEpoch 214: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00667, Train/loss_recog_step=0.985, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 214: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00667, Train/loss_recog_step=0.985, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058510, 0.058224, 0.059327
Train average loss UNet            (all)              : 0.176062

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000724, 3.507880, 6.624264
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002715, 3.377650, 5.637300
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002041, 3.509943, 5.643642
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001448, 3.572618, 6.031683
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001275, 3.731911, 5.865896
Train average loss all      (Triplet)                 : 0.001614

== Recognize ==
Train average loss Recognize     : 1.282679
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.177675

Epoch 214:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00667, Train/loss_recog_step=0.985, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]          Epoch 215:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00667, Train/loss_recog_step=0.985, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00667, Train/loss_recog_step=0.985, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]  Epoch 215:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.110, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.180, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.500, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.500, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00999, Train/loss_recog_step=0.986, Valid/loss_all_step=1.140, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.901, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.747, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.543, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.437, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.09it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.82it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.37it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.59it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.80it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067174, 0.065859, 0.063902
Valid average loss UNet            (all)              : 0.196936

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.116620, 3.278012, 5.582054
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.636099, 3.700947, 3.822660
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.820997, 3.729486, 3.496667
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.612774, 4.144039, 4.791928
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.288365, 3.977930, 4.447630
Valid average loss all      (Triplet)                 : 0.556449

== Recognize ==
Valid average loss Recognize     : 1.154055
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.753385

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.540091276168823 sec. =
Valid knn accuracy drums     : 79.11764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.172261953353882 sec. =
Valid knn accuracy bass      : 14.825581395348838%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.297382354736328 sec. =
Valid knn accuracy piano     : 27.7027027027027%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.830413818359375 sec. =
Valid knn accuracy guitar    : 36.038961038961034%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.261821508407593 sec. =
Valid knn accuracy residuals : 56.132075471698116%

Valid knn accuracy average   : 42.76339353350685%

                                                                        [AEpoch 215: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00999, Train/loss_recog_step=0.986, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00161, Train/loss_recog_epoch=1.280]Epoch 215: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00999, Train/loss_recog_step=0.986, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058443, 0.058124, 0.059281
Train average loss UNet            (all)              : 0.175848

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000604, 3.238026, 6.072804
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001904, 3.179397, 5.354916
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002095, 3.292132, 5.350455
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001923, 3.372453, 5.728369
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000815, 3.494895, 5.485498
Train average loss all      (Triplet)                 : 0.001543

== Recognize ==
Train average loss Recognize     : 1.285114
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.177391

Epoch 215:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00999, Train/loss_recog_step=0.986, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]          Epoch 216:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00999, Train/loss_recog_step=0.986, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00999, Train/loss_recog_step=0.986, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=1.110, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00122, Train/loss_recog_step=1.110, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00378, Train/loss_recog_step=1.330, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00378, Train/loss_recog_step=1.330, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]  Epoch 216:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.914, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.510, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.510, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.150, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.916, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.753, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.556, Valid/loss_recog_epoch=1.150, Valid/knn_avr=0.428, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.29it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.98it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070225, 0.070378, 0.068520
Valid average loss UNet            (all)              : 0.209123

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.126088, 3.431310, 5.605443
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.720963, 4.018802, 4.015131
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.808854, 3.998811, 3.830520
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.732152, 4.480979, 5.008722
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.251237, 4.022254, 4.923435
Valid average loss all      (Triplet)                 : 0.596783

== Recognize ==
Valid average loss Recognize     : 1.155130
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.805906

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.531316757202148 sec. =
Valid knn accuracy drums     : 81.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.275214910507202 sec. =
Valid knn accuracy bass      : 18.313953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.12120509147644 sec. =
Valid knn accuracy piano     : 27.027027027027028%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.940171241760254 sec. =
Valid knn accuracy guitar    : 42.37012987012987%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.188894510269165 sec. =
Valid knn accuracy residuals : 55.9748427672956%

Valid knn accuracy average   : 44.94307298350609%

                                                                        [AEpoch 216: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00154, Train/loss_recog_epoch=1.290]Epoch 216: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058380, 0.058075, 0.059230
Train average loss UNet            (all)              : 0.175685

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000815, 3.182791, 6.049976
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002423, 3.096165, 5.232540
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002101, 3.201408, 5.161414
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001376, 3.281163, 5.564134
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001500, 3.442522, 5.391901
Train average loss all      (Triplet)                 : 0.001647

== Recognize ==
Train average loss Recognize     : 1.286206
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.177332

Epoch 216:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]          Epoch 217:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]Epoch 217:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]Epoch 217:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00225, Train/loss_recog_step=1.120, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]Epoch 217:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00225, Train/loss_recog_step=1.120, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]Epoch 217:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]  Epoch 217:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.181, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]Epoch 217:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.915, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]Epoch 217:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00338, Train/loss_recog_step=0.915, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]Epoch 217:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]  Epoch 217:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]Epoch 217:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]Epoch 217:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]Epoch 217:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.510, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]Epoch 217: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.510, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]Epoch 217: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.996, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.806, Valid/loss_unet_all_epoch=0.209, Valid/loss_triplet_all_epoch=0.597, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.449, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.84it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.44it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.20it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.72it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.01it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.06it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067379, 0.066653, 0.065596
Valid average loss UNet            (all)              : 0.199627

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133370, 3.411207, 5.843942
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.698186, 3.894169, 3.930335
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.772776, 3.794411, 3.749825
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.675761, 4.202642, 4.940838
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.322370, 4.100330, 4.777720
Valid average loss all      (Triplet)                 : 0.582653

== Recognize ==
Valid average loss Recognize     : 1.155744
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.782280

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.527689456939697 sec. =
Valid knn accuracy drums     : 77.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.178362131118774 sec. =
Valid knn accuracy bass      : 14.244186046511627%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.517634391784668 sec. =
Valid knn accuracy piano     : 24.054054054054056%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.088897466659546 sec. =
Valid knn accuracy guitar    : 44.31818181818182%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.909682989120483 sec. =
Valid knn accuracy residuals : 57.07547169811321%

Valid knn accuracy average   : 43.5266140174898%

                                                                        [AEpoch 217: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00165, Train/loss_recog_epoch=1.290]Epoch 217: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058361, 0.058050, 0.059168
Train average loss UNet            (all)              : 0.175579

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000313, 3.288177, 6.236919
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001619, 3.193882, 5.426747
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002328, 3.318215, 5.430417
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000915, 3.430373, 5.884221
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001180, 3.540643, 5.524812
Train average loss all      (Triplet)                 : 0.001294

== Recognize ==
Train average loss Recognize     : 1.287377
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176873

Epoch 217:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]          Epoch 218:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.987, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.330, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218:  64%|██████▍   | 200/313 [02:56<01:39,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218:  80%|███████▉  | 250/313 [03:39<00:55,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.510, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.510, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218: 100%|██████████| 313/313 [04:33<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.943, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.782, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.583, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.435, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.97it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.31it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.77it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.95it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.47it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.92it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070439, 0.068448, 0.067141
Valid average loss UNet            (all)              : 0.206028

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.158478, 3.595151, 6.044838
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.712062, 3.986291, 3.997808
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.945641, 4.170043, 4.000528
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.492711, 4.238859, 5.269894
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.480473, 4.721776, 5.011168
Valid average loss all      (Triplet)                 : 0.615759

== Recognize ==
Valid average loss Recognize     : 1.156171
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.821787

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.641334056854248 sec. =
Valid knn accuracy drums     : 77.79411764705883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.986441135406494 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.44298529624939 sec. =
Valid knn accuracy piano     : 29.864864864864867%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.122568845748901 sec. =
Valid knn accuracy guitar    : 45.77922077922078%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.976176261901855 sec. =
Valid knn accuracy residuals : 57.861635220125784%

Valid knn accuracy average   : 45.34136305109126%

                                                                        [AEpoch 218: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00129, Train/loss_recog_epoch=1.290]Epoch 218: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058226, 0.058016, 0.059083
Train average loss UNet            (all)              : 0.175325

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000288, 3.331687, 6.303106
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002450, 3.261592, 5.528275
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001175, 3.392409, 5.529620
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001645, 3.506499, 5.974463
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001745, 3.606421, 5.658125
Train average loss all      (Triplet)                 : 0.001481

== Recognize ==
Train average loss Recognize     : 1.287240
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176805

Epoch 218:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]          Epoch 219:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]Epoch 219:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]Epoch 219:  16%|█▌        | 50/313 [00:47<04:10,  1.05it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]Epoch 219:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]Epoch 219:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00791, Train/loss_recog_step=1.330, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]Epoch 219:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00791, Train/loss_recog_step=1.330, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]Epoch 219:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]  Epoch 219:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.915, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]Epoch 219:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]Epoch 219:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]Epoch 219:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000946, Train/loss_recog_step=1.020, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]Epoch 219:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000946, Train/loss_recog_step=1.020, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]Epoch 219:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.510, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]   Epoch 219: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.510, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]Epoch 219: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=1.320, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.080, Valid/loss_recog_step=1.390, Valid/loss_all_epoch=0.822, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.616, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.453, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.01it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.93it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.07it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.81it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.66it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069245, 0.067010, 0.066451
Valid average loss UNet            (all)              : 0.202706

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.171095, 3.879414, 6.605734
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.670827, 4.341896, 4.466588
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.988671, 4.479651, 4.264462
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.682481, 4.584315, 5.384374
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.335358, 4.746992, 5.201845
Valid average loss all      (Triplet)                 : 0.623643

== Recognize ==
Valid average loss Recognize     : 1.158261
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.826349

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.859419345855713 sec. =
Valid knn accuracy drums     : 80.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.268852233886719 sec. =
Valid knn accuracy bass      : 11.918604651162791%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.865664005279541 sec. =
Valid knn accuracy piano     : 23.513513513513516%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.086894035339355 sec. =
Valid knn accuracy guitar    : 42.37012987012987%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.23492693901062 sec. =
Valid knn accuracy residuals : 55.0314465408805%

Valid knn accuracy average   : 42.713797738666756%

                                                                        [AEpoch 219: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00148, Train/loss_recog_epoch=1.290]Epoch 219: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058471, 0.058130, 0.059246
Train average loss UNet            (all)              : 0.175847

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000804, 3.536947, 6.667212
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002638, 3.449316, 5.820128
Train average loss piano    (Triplet, dist_p, dist_n) : 0.003209, 3.639560, 5.851218
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000758, 3.700085, 6.280977
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002156, 3.821786, 5.992372
Train average loss all      (Triplet)                 : 0.001920

== Recognize ==
Train average loss Recognize     : 1.287009
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.177766

Epoch 219:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]          Epoch 220:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.988, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.120, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.020, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.191, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.0146, Train/loss_recog_step=1.020, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00121, Train/loss_recog_step=1.510, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00121, Train/loss_recog_step=1.510, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.237, Valid/loss_triplet_all_step=0.956, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.826, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.624, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.427, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.88it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.19it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.25it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.71it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.75it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068985, 0.067770, 0.065964
Valid average loss UNet            (all)              : 0.202719

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.178995, 3.872727, 6.344531
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.807972, 4.454803, 4.440423
Valid average loss piano    (Triplet, dist_p, dist_n) : 1.042226, 4.599015, 4.289238
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.744244, 4.673329, 5.500812
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.302103, 4.513864, 5.618928
Valid average loss all      (Triplet)                 : 0.692205

== Recognize ==
Valid average loss Recognize     : 1.161201
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.894924

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.7761812210083 sec. =
Valid knn accuracy drums     : 82.94117647058825%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.269728660583496 sec. =
Valid knn accuracy bass      : 15.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.202544927597046 sec. =
Valid knn accuracy piano     : 26.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.916786432266235 sec. =
Valid knn accuracy guitar    : 46.590909090909086%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.012202978134155 sec. =
Valid knn accuracy residuals : 56.76100628930818%

Valid knn accuracy average   : 45.75154734564822%

                                                                        [AEpoch 220: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.290]Epoch 220: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058569, 0.058245, 0.059343
Train average loss UNet            (all)              : 0.176156

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000505, 3.455633, 6.416214
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002537, 3.438250, 5.789168
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002819, 3.557548, 5.740121
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002271, 3.647295, 6.228430
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001601, 3.759188, 5.868781
Train average loss all      (Triplet)                 : 0.001955

== Recognize ==
Train average loss Recognize     : 1.292007
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.178111

Epoch 220:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]          Epoch 221:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=1.120, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00388, Train/loss_recog_step=1.120, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]  Epoch 221:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.179, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.918, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.260, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.510, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.510, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.895, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.692, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.458, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.82it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.12it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.49it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.43it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.74it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.65it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067079, 0.066349, 0.065147
Valid average loss UNet            (all)              : 0.198576

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.178953, 3.629757, 5.646821
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.655024, 4.014245, 4.050555
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.909827, 4.051979, 3.754265
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.602919, 4.278326, 5.169702
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.283430, 4.453960, 5.451015
Valid average loss all      (Triplet)                 : 0.586591

== Recognize ==
Valid average loss Recognize     : 1.162120
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.785167

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.523135423660278 sec. =
Valid knn accuracy drums     : 79.11764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.336633205413818 sec. =
Valid knn accuracy bass      : 17.732558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.126036643981934 sec. =
Valid knn accuracy piano     : 29.45945945945946%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.789449214935303 sec. =
Valid knn accuracy guitar    : 47.88961038961039%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.033668756484985 sec. =
Valid knn accuracy residuals : 59.27672955974843%

Valid knn accuracy average   : 46.695200921435344%

                                                                        [AEpoch 221: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00196, Train/loss_recog_epoch=1.290]Epoch 221: 100%|██████████| 313/313 [06:10<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058440, 0.058101, 0.059177
Train average loss UNet            (all)              : 0.175718

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000699, 3.354537, 6.242565
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002472, 3.337524, 5.656806
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002530, 3.447545, 5.578300
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001454, 3.526182, 6.018396
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001848, 3.672552, 5.799603
Train average loss all      (Triplet)                 : 0.001835

== Recognize ==
Train average loss Recognize     : 1.292122
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.177553

Epoch 221:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]          Epoch 222:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]Epoch 222:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.990, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]Epoch 222:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00392, Train/loss_recog_step=1.120, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]Epoch 222:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00392, Train/loss_recog_step=1.120, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]Epoch 222:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]  Epoch 222:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]Epoch 222:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00686, Train/loss_recog_step=0.920, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]Epoch 222:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00686, Train/loss_recog_step=0.920, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]Epoch 222:  64%|██████▍   | 200/313 [02:59<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]  Epoch 222:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]Epoch 222:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]Epoch 222:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]Epoch 222:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.520, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]Epoch 222: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.520, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]Epoch 222: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00542, Train/loss_recog_step=0.993, Valid/loss_all_step=1.190, Valid/loss_unet_all_step=0.236, Valid/loss_triplet_all_step=0.953, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.785, Valid/loss_unet_all_epoch=0.199, Valid/loss_triplet_all_epoch=0.587, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.467, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.12it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.85it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.16it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.31it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.18it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066769, 0.065987, 0.064400
Valid average loss UNet            (all)              : 0.197156

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.229767, 3.881863, 6.196770
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.743046, 4.229225, 4.276102
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.955263, 4.333148, 4.048775
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.601994, 4.494994, 5.223314
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.368372, 4.600295, 5.709970
Valid average loss all      (Triplet)                 : 0.635628

== Recognize ==
Valid average loss Recognize     : 1.165045
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.832783

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.640196323394775 sec. =
Valid knn accuracy drums     : 81.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.271002292633057 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.999281883239746 sec. =
Valid knn accuracy piano     : 26.486486486486488%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.961013078689575 sec. =
Valid knn accuracy guitar    : 44.31818181818182%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.16799020767212 sec. =
Valid knn accuracy residuals : 58.9622641509434%

Valid knn accuracy average   : 45.2700759576066%

                                                                        [AEpoch 222: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00542, Train/loss_recog_step=0.993, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.178, Train/loss_unet_all_epoch=0.176, Train/loss_triplet_all_epoch=0.00183, Train/loss_recog_epoch=1.290]Epoch 222: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00542, Train/loss_recog_step=0.993, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058113, 0.057809, 0.058890
Train average loss UNet            (all)              : 0.174812

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000526, 3.497386, 6.451581
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001829, 3.430873, 5.817039
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001215, 3.552711, 5.823218
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001096, 3.651834, 6.264827
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001114, 3.800561, 6.002456
Train average loss all      (Triplet)                 : 0.001219

== Recognize ==
Train average loss Recognize     : 1.294756
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176031

Epoch 222:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00542, Train/loss_recog_step=0.993, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]          Epoch 223:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00542, Train/loss_recog_step=0.993, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]Epoch 223:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00542, Train/loss_recog_step=0.993, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]Epoch 223:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]  Epoch 223:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]Epoch 223:  32%|███▏      | 100/313 [01:30<03:12,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]Epoch 223:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]Epoch 223:  48%|████▊     | 150/313 [02:14<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]Epoch 223:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.921, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]Epoch 223:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=1.270, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]Epoch 223:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00253, Train/loss_recog_step=1.270, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]Epoch 223:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]  Epoch 223:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]Epoch 223:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=1.520, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]Epoch 223: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00107, Train/loss_recog_step=1.520, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]Epoch 223: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.229, Valid/loss_triplet_all_step=0.978, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.833, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.636, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.01it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.20it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.33it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.83it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.74it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.72it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070342, 0.069164, 0.067295
Valid average loss UNet            (all)              : 0.206801

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.192303, 3.547661, 6.009066
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.756565, 4.013636, 3.940090
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.747141, 3.873330, 3.688544
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.488428, 4.023091, 4.917696
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.403102, 4.285673, 5.299685
Valid average loss all      (Triplet)                 : 0.586250

== Recognize ==
Valid average loss Recognize     : 1.162557
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.793051

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.632066011428833 sec. =
Valid knn accuracy drums     : 83.23529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.100739240646362 sec. =
Valid knn accuracy bass      : 13.08139534883721%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.859513521194458 sec. =
Valid knn accuracy piano     : 24.864864864864867%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.040146350860596 sec. =
Valid knn accuracy guitar    : 39.285714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.117146492004395 sec. =
Valid knn accuracy residuals : 54.40251572327044%

Valid knn accuracy average   : 42.97395686806677%

                                                                        [AEpoch 223: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00122, Train/loss_recog_epoch=1.290]Epoch 223: 100%|██████████| 313/313 [06:08<00:00,  0.85it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058100, 0.057873, 0.058949
Train average loss UNet            (all)              : 0.174923

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000231, 3.368919, 6.338503
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002351, 3.292121, 5.554547
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001220, 3.411210, 5.515268
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001724, 3.530010, 5.990468
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001823, 3.657214, 5.772505
Train average loss all      (Triplet)                 : 0.001473

== Recognize ==
Train average loss Recognize     : 1.295455
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176396

Epoch 223:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]          Epoch 224:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00633, Train/loss_recog_step=1.130, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00633, Train/loss_recog_step=1.130, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224:  32%|███▏      | 100/313 [01:31<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]  Epoch 224:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.922, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.520, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.520, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.921, Valid/loss_recog_step=1.400, Valid/loss_all_epoch=0.793, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.586, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.45it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.12it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.31it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.86it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069378, 0.067952, 0.066959
Valid average loss UNet            (all)              : 0.204289

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.167715, 3.373807, 5.654794
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.778010, 3.806124, 3.794191
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.629293, 3.724866, 3.653936
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.393999, 3.786901, 4.649264
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.310272, 3.913687, 4.811469
Valid average loss all      (Triplet)                 : 0.513437

== Recognize ==
Valid average loss Recognize     : 1.164658
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.717726

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.528597116470337 sec. =
Valid knn accuracy drums     : 80.44117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.343392848968506 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.345403909683228 sec. =
Valid knn accuracy piano     : 25.810810810810807%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.665375232696533 sec. =
Valid knn accuracy guitar    : 41.23376623376623%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.888850688934326 sec. =
Valid knn accuracy residuals : 52.83018867924528%

Valid knn accuracy average   : 42.9410954156263%

                                                                        [AEpoch 224: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00147, Train/loss_recog_epoch=1.300]Epoch 224: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058099, 0.057768, 0.058871
Train average loss UNet            (all)              : 0.174738

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000547, 3.097600, 5.861788
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001664, 3.086895, 5.283759
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001821, 3.161310, 5.122654
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001290, 3.255749, 5.578668
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000649, 3.343676, 5.335486
Train average loss all      (Triplet)                 : 0.001207

== Recognize ==
Train average loss Recognize     : 1.296634
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175945

Epoch 224:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]          Epoch 225:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.992, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00431, Train/loss_recog_step=1.130, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00431, Train/loss_recog_step=1.130, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]  Epoch 225:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.340, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.924, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.270, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.030, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.520, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.520, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=1.000, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.758, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.718, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.513, Valid/loss_recog_epoch=1.160, Valid/knn_avr=0.429, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.26it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.45it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.46it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.92it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.86it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.61it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066876, 0.066462, 0.064808
Valid average loss UNet            (all)              : 0.198146

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.233672, 3.764273, 6.142689
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.711594, 4.182815, 4.319574
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.781010, 4.091392, 3.937413
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.501869, 4.239995, 4.892337
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.312014, 4.348069, 5.447639
Valid average loss all      (Triplet)                 : 0.540435

== Recognize ==
Valid average loss Recognize     : 1.168278
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.738581

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.565393447875977 sec. =
Valid knn accuracy drums     : 80.73529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.335198402404785 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.289761304855347 sec. =
Valid knn accuracy piano     : 27.432432432432428%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.049780368804932 sec. =
Valid knn accuracy guitar    : 43.66883116883117%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.67018985748291 sec. =
Valid knn accuracy residuals : 54.088050314465406%

Valid knn accuracy average   : 44.0628285834194%

                                                                        [AEpoch 225: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00121, Train/loss_recog_epoch=1.300]Epoch 225: 100%|██████████| 313/313 [06:11<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058044, 0.057743, 0.058821
Train average loss UNet            (all)              : 0.174607

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000664, 3.233425, 6.135897
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001811, 3.194736, 5.465242
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000788, 3.261108, 5.342283
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001376, 3.390126, 5.737641
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001251, 3.475106, 5.557184
Train average loss all      (Triplet)                 : 0.001183

== Recognize ==
Train average loss Recognize     : 1.299094
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175790

Epoch 225:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]          Epoch 226:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.995, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.130, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226:  48%|████▊     | 150/313 [02:18<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.350, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226:  48%|████▊     | 150/313 [02:18<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.926, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.926, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00603, Train/loss_recog_step=1.280, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00603, Train/loss_recog_step=1.280, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00674, Train/loss_recog_step=1.030, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00674, Train/loss_recog_step=1.030, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00261, Train/loss_recog_step=1.530, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00261, Train/loss_recog_step=1.530, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=0.836, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.601, Valid/loss_recog_step=1.410, Valid/loss_all_epoch=0.739, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.540, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.441, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.91it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.70it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.79it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.59it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.09it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.070137, 0.069268, 0.067203
Valid average loss UNet            (all)              : 0.206608

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.186335, 3.747757, 6.052485
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.730402, 4.105606, 4.111565
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.831706, 4.163030, 3.979876
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.480470, 4.251769, 5.307669
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.379289, 4.510654, 5.410083
Valid average loss all      (Triplet)                 : 0.570098

== Recognize ==
Valid average loss Recognize     : 1.173364
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.776706

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.667709112167358 sec. =
Valid knn accuracy drums     : 82.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.150523900985718 sec. =
Valid knn accuracy bass      : 13.372093023255813%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.750758171081543 sec. =
Valid knn accuracy piano     : 25.270270270270267%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.716591596603394 sec. =
Valid knn accuracy guitar    : 41.72077922077922%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.330950260162354 sec. =
Valid knn accuracy residuals : 52.67295597484277%

Valid knn accuracy average   : 43.10721969782961%

                                                                        [AEpoch 226: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00118, Train/loss_recog_epoch=1.300]Epoch 226: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057889, 0.057621, 0.058701
Train average loss UNet            (all)              : 0.174211

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000267, 3.278758, 6.275443
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002132, 3.228351, 5.495358
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001477, 3.323610, 5.403605
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000803, 3.437821, 5.885815
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000895, 3.555247, 5.649107
Train average loss all      (Triplet)                 : 0.001133

== Recognize ==
Train average loss Recognize     : 1.304129
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175345

Epoch 226:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]          Epoch 227:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]Epoch 227:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.000, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]Epoch 227:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]Epoch 227:  32%|███▏      | 100/313 [01:33<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]Epoch 227:  32%|███▏      | 100/313 [01:33<03:18,  1.08it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]Epoch 227:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]Epoch 227:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]Epoch 227:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]Epoch 227:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000695, Train/loss_recog_step=1.290, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]Epoch 227:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000695, Train/loss_recog_step=1.290, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]Epoch 227:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00872, Train/loss_recog_step=1.040, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300] Epoch 227:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00872, Train/loss_recog_step=1.040, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]Epoch 227:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.540, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]  Epoch 227: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.540, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]Epoch 227: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.798, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.777, Valid/loss_unet_all_epoch=0.207, Valid/loss_triplet_all_epoch=0.570, Valid/loss_recog_epoch=1.170, Valid/knn_avr=0.431, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.84it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.82it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.57it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.56it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.96it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.99it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068307, 0.067500, 0.066634
Valid average loss UNet            (all)              : 0.202441

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.155650, 3.335778, 5.551490
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.579649, 3.731227, 3.933872
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.813612, 3.837642, 3.534280
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.546167, 3.853658, 4.452951
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.341537, 4.048861, 5.004536
Valid average loss all      (Triplet)                 : 0.528920

== Recognize ==
Valid average loss Recognize     : 1.178899
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.731361

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.751128196716309 sec. =
Valid knn accuracy drums     : 78.67647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.219708681106567 sec. =
Valid knn accuracy bass      : 17.732558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.212444305419922 sec. =
Valid knn accuracy piano     : 25.270270270270267%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.883944511413574 sec. =
Valid knn accuracy guitar    : 43.83116883116883%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.764565706253052 sec. =
Valid knn accuracy residuals : 58.01886792452831%

Valid knn accuracy average   : 44.70586715074752%

                                                                        [AEpoch 227: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00113, Train/loss_recog_epoch=1.300]Epoch 227: 100%|██████████| 313/313 [06:16<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058185, 0.057929, 0.059021
Train average loss UNet            (all)              : 0.175135

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000318, 3.274826, 6.086804
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002210, 3.284968, 5.584591
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002458, 3.378623, 5.526029
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002017, 3.462075, 5.904536
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002171, 3.602480, 5.703798
Train average loss all      (Triplet)                 : 0.001810

== Recognize ==
Train average loss Recognize     : 1.310930
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176945

Epoch 227:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]          Epoch 228:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]Epoch 228:  16%|█▌        | 50/313 [00:51<04:29,  0.98it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]Epoch 228:  16%|█▌        | 50/313 [00:51<04:29,  0.98it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]Epoch 228:  32%|███▏      | 100/313 [01:36<03:25,  1.04it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]Epoch 228:  32%|███▏      | 100/313 [01:36<03:25,  1.04it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=1.360, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]Epoch 228:  48%|████▊     | 150/313 [02:21<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00367, Train/loss_recog_step=1.360, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]Epoch 228:  48%|████▊     | 150/313 [02:21<02:33,  1.06it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]  Epoch 228:  64%|██████▍   | 200/313 [03:06<01:45,  1.07it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]Epoch 228:  64%|██████▍   | 200/313 [03:06<01:45,  1.07it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000279, Train/loss_recog_step=1.290, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]Epoch 228:  80%|███████▉  | 250/313 [03:50<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000279, Train/loss_recog_step=1.290, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]Epoch 228:  80%|███████▉  | 250/313 [03:51<00:58,  1.08it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]   Epoch 228:  96%|█████████▌| 300/313 [04:36<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]Epoch 228:  96%|█████████▌| 300/313 [04:36<00:11,  1.09it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.530, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]Epoch 228: 100%|██████████| 313/313 [04:46<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.530, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]Epoch 228: 100%|██████████| 313/313 [04:46<00:00,  1.09it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00199, Train/loss_recog_step=1.000, Valid/loss_all_step=1.030, Valid/loss_unet_all_step=0.244, Valid/loss_triplet_all_step=0.783, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.731, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.529, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.447, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.67it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.22it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.92it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.21it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.18it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.34it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066528, 0.066210, 0.064368
Valid average loss UNet            (all)              : 0.197106

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.189249, 3.855351, 6.321921
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.719720, 4.093840, 4.123434
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.847139, 4.168256, 3.935108
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.425479, 4.116557, 5.060010
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.272230, 4.660062, 5.465285
Valid average loss all      (Triplet)                 : 0.542487

== Recognize ==
Valid average loss Recognize     : 1.175401
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.739593

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.230133771896362 sec. =
Valid knn accuracy drums     : 81.91176470588235%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.14257001876831 sec. =
Valid knn accuracy bass      : 16.424418604651162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.391055345535278 sec. =
Valid knn accuracy piano     : 25.945945945945947%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.544156789779663 sec. =
Valid knn accuracy guitar    : 39.935064935064936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.243081331253052 sec. =
Valid knn accuracy residuals : 53.930817610062896%

Valid knn accuracy average   : 43.62960236032146%

                                                                        [AEpoch 228: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00199, Train/loss_recog_step=1.000, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.177, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00181, Train/loss_recog_epoch=1.310]Epoch 228: 100%|██████████| 313/313 [06:23<00:00,  0.82it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00199, Train/loss_recog_step=1.000, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.058032, 0.057754, 0.058851
Train average loss UNet            (all)              : 0.174637

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000797, 3.292634, 6.230249
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001886, 3.195884, 5.396642
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001913, 3.298293, 5.394118
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001737, 3.368659, 5.715647
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001241, 3.504777, 5.511675
Train average loss all      (Triplet)                 : 0.001579

== Recognize ==
Train average loss Recognize     : 1.311236
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176216

Epoch 228:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00199, Train/loss_recog_step=1.000, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]          Epoch 229:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00199, Train/loss_recog_step=1.000, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]Epoch 229:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.00199, Train/loss_recog_step=1.000, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]Epoch 229:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=1.140, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]Epoch 229:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00135, Train/loss_recog_step=1.140, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]Epoch 229:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00985, Train/loss_recog_step=1.360, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]Epoch 229:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.187, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00985, Train/loss_recog_step=1.360, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]Epoch 229:  48%|████▊     | 150/313 [02:16<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.929, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310] Epoch 229:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.0105, Train/loss_recog_step=0.929, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]Epoch 229:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310] Epoch 229:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.280, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]Epoch 229:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00369, Train/loss_recog_step=1.040, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]Epoch 229:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00369, Train/loss_recog_step=1.040, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]Epoch 229:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.540, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]  Epoch 229: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.540, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]Epoch 229: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.228, Valid/loss_triplet_all_step=0.809, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.740, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.542, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.85it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.32it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.89it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.77it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.50it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068313, 0.066615, 0.065498
Valid average loss UNet            (all)              : 0.200425

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.205654, 3.557066, 5.712711
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.688184, 3.889412, 3.925328
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.838508, 3.908542, 3.783636
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.480259, 3.972828, 4.786314
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.362374, 4.329817, 4.824169
Valid average loss all      (Triplet)                 : 0.559621

== Recognize ==
Valid average loss Recognize     : 1.177608
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.760046

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.448129653930664 sec. =
Valid knn accuracy drums     : 81.17647058823529%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.673058032989502 sec. =
Valid knn accuracy bass      : 18.6046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.19498348236084 sec. =
Valid knn accuracy piano     : 29.864864864864867%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.108807802200317 sec. =
Valid knn accuracy guitar    : 44.967532467532465%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.327535629272461 sec. =
Valid knn accuracy residuals : 52.04402515723271%

Valid knn accuracy average   : 45.33150884813121%

                                                                        [AEpoch 229: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.175, Train/loss_triplet_all_epoch=0.00158, Train/loss_recog_epoch=1.310]Epoch 229: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057959, 0.057644, 0.058760
Train average loss UNet            (all)              : 0.174364

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000836, 3.186925, 6.050797
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002648, 3.081384, 5.246292
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001594, 3.160936, 5.143051
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000821, 3.265770, 5.552301
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001762, 3.378484, 5.294069
Train average loss all      (Triplet)                 : 0.001568

== Recognize ==
Train average loss Recognize     : 1.309716
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175932

Epoch 229:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]          Epoch 230:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]Epoch 230:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]Epoch 230:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]Epoch 230:  32%|███▏      | 100/313 [01:34<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]Epoch 230:  32%|███▏      | 100/313 [01:34<03:20,  1.06it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00305, Train/loss_recog_step=1.360, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]Epoch 230:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00305, Train/loss_recog_step=1.360, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]Epoch 230:  48%|████▊     | 150/313 [02:18<02:30,  1.08it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]  Epoch 230:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.931, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]Epoch 230:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00348, Train/loss_recog_step=1.290, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]Epoch 230:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.00348, Train/loss_recog_step=1.290, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]Epoch 230:  80%|███████▉  | 250/313 [03:48<00:57,  1.09it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]  Epoch 230:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]Epoch 230:  96%|█████████▌| 300/313 [04:32<00:11,  1.10it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.540, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]Epoch 230: 100%|██████████| 313/313 [04:42<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.540, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]Epoch 230: 100%|██████████| 313/313 [04:42<00:00,  1.11it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.040, Valid/loss_unet_all_step=0.241, Valid/loss_triplet_all_step=0.803, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.760, Valid/loss_unet_all_epoch=0.200, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.453, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.22it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.51it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.68it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.15it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.066681, 0.065994, 0.064097
Valid average loss UNet            (all)              : 0.196772

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.208258, 3.669991, 5.780716
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.802897, 4.078251, 4.036606
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.827193, 4.107882, 3.818001
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.486435, 4.206430, 5.075377
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.402941, 4.503324, 5.358999
Valid average loss all      (Triplet)                 : 0.610233

== Recognize ==
Valid average loss Recognize     : 1.178258
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.807006

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.546239852905273 sec. =
Valid knn accuracy drums     : 78.82352941176471%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.731371879577637 sec. =
Valid knn accuracy bass      : 18.313953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.075885534286499 sec. =
Valid knn accuracy piano     : 28.783783783783782%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.011525869369507 sec. =
Valid knn accuracy guitar    : 44.48051948051948%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.640880107879639 sec. =
Valid knn accuracy residuals : 58.17610062893082%

Valid knn accuracy average   : 45.71557735867417%

                                                                        [AEpoch 230: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00157, Train/loss_recog_epoch=1.310]Epoch 230: 100%|██████████| 313/313 [06:18<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057802, 0.057523, 0.058570
Train average loss UNet            (all)              : 0.173896

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000360, 3.350007, 6.261106
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001507, 3.254952, 5.523336
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001283, 3.335435, 5.436272
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000618, 3.477426, 5.989608
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001565, 3.581615, 5.644153
Train average loss all      (Triplet)                 : 0.001061

== Recognize ==
Train average loss Recognize     : 1.312495
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174957

Epoch 230:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]          Epoch 231:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00092, Train/loss_recog_step=1.140, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00092, Train/loss_recog_step=1.140, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]  Epoch 231:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231:  48%|████▊     | 150/313 [02:13<02:24,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.934, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00827, Train/loss_recog_step=1.290, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00827, Train/loss_recog_step=1.290, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=2.05e-5, Train/loss_recog_step=1.040, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=2.05e-5, Train/loss_recog_step=1.040, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00186, Train/loss_recog_step=1.540, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.179, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00186, Train/loss_recog_step=1.540, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.200, Valid/loss_unet_all_step=0.232, Valid/loss_triplet_all_step=0.967, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.807, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.610, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.457, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.05it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.55it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.93it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.31it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.80it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.31it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069656, 0.068047, 0.065435
Valid average loss UNet            (all)              : 0.203137

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.162415, 3.688959, 5.854885
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.817173, 4.094584, 4.063014
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.846123, 4.061265, 3.876107
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.408484, 3.996531, 4.998500
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.397503, 4.450467, 5.591319
Valid average loss all      (Triplet)                 : 0.598331

== Recognize ==
Valid average loss Recognize     : 1.182786
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.801468

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.402143716812134 sec. =
Valid knn accuracy drums     : 77.94117647058823%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.440783977508545 sec. =
Valid knn accuracy bass      : 18.168604651162788%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.49893856048584 sec. =
Valid knn accuracy piano     : 28.243243243243242%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.84087610244751 sec. =
Valid knn accuracy guitar    : 43.18181818181818%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.680097341537476 sec. =
Valid knn accuracy residuals : 53.459119496855344%

Valid knn accuracy average   : 44.19879240873355%

                                                                        [AEpoch 231: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 231: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057689, 0.057417, 0.058432
Train average loss UNet            (all)              : 0.173538

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000700, 3.321887, 6.168243
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001722, 3.243976, 5.483549
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002205, 3.326841, 5.388535
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000657, 3.437353, 5.856469
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001178, 3.612933, 5.710438
Train average loss all      (Triplet)                 : 0.001260

== Recognize ==
Train average loss Recognize     : 1.314896
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174798

Epoch 231:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]          Epoch 232:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232:  16%|█▌        | 50/313 [00:48<04:13,  1.04it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00836, Train/loss_recog_step=1.370, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.186, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00836, Train/loss_recog_step=1.370, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]  Epoch 232:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.935, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=1.540, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00133, Train/loss_recog_step=1.540, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.300, Valid/loss_unet_all_step=0.238, Valid/loss_triplet_all_step=1.060, Valid/loss_recog_step=1.420, Valid/loss_all_epoch=0.801, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.598, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.442, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.81it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.72it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.44it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.72it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.03it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.24it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.071423, 0.070936, 0.068848
Valid average loss UNet            (all)              : 0.211206

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.216119, 3.591671, 5.682491
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.735665, 4.071433, 4.140931
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.781879, 3.940359, 3.709263
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.359315, 3.808132, 4.925632
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.375422, 4.333381, 4.890758
Valid average loss all      (Triplet)                 : 0.544685

== Recognize ==
Valid average loss Recognize     : 1.183889
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.755891

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.102247714996338 sec. =
Valid knn accuracy drums     : 76.02941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.15563178062439 sec. =
Valid knn accuracy bass      : 15.11627906976744%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.923009157180786 sec. =
Valid knn accuracy piano     : 25.810810810810807%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.900381565093994 sec. =
Valid knn accuracy guitar    : 39.285714285714285%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.921204805374146 sec. =
Valid knn accuracy residuals : 53.144654088050316%

Valid knn accuracy average   : 41.87737400380975%

                                                                        [AEpoch 232: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00126, Train/loss_recog_epoch=1.310]Epoch 232: 100%|██████████| 313/313 [06:12<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057737, 0.057503, 0.058542
Train average loss UNet            (all)              : 0.173782

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000320, 3.395756, 6.384054
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001462, 3.324219, 5.756876
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001604, 3.390281, 5.564411
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000990, 3.522906, 6.023810
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001920, 3.674823, 5.798270
Train average loss all      (Triplet)                 : 0.001307

== Recognize ==
Train average loss Recognize     : 1.318670
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175089

Epoch 232:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]          Epoch 233:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233:  16%|█▌        | 50/313 [00:49<04:21,  1.01it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.0036, Train/loss_recog_step=1.150, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.0036, Train/loss_recog_step=1.150, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320] Epoch 233:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.937, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233:  64%|██████▍   | 200/313 [03:02<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.290, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00749, Train/loss_recog_step=1.540, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.182, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.00749, Train/loss_recog_step=1.540, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.090, Valid/loss_unet_all_step=0.253, Valid/loss_triplet_all_step=0.838, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.756, Valid/loss_unet_all_epoch=0.211, Valid/loss_triplet_all_epoch=0.545, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.419, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.89it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.15it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.16it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.47it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.23it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.67it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067721, 0.066121, 0.064624
Valid average loss UNet            (all)              : 0.198466

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.188026, 3.629853, 6.018171
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.689900, 4.069888, 4.200592
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.740698, 3.991879, 3.921627
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.478017, 3.923178, 4.941955
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.365511, 4.257423, 5.236870
Valid average loss all      (Triplet)                 : 0.553664

== Recognize ==
Valid average loss Recognize     : 1.182371
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.752130

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.560787200927734 sec. =
Valid knn accuracy drums     : 79.70588235294119%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.304652690887451 sec. =
Valid knn accuracy bass      : 13.08139534883721%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.212082624435425 sec. =
Valid knn accuracy piano     : 25.675675675675674%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.503295421600342 sec. =
Valid knn accuracy guitar    : 44.31818181818182%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.85326075553894 sec. =
Valid knn accuracy residuals : 56.132075471698116%

Valid knn accuracy average   : 43.7826421334668%

                                                                        [AEpoch 233: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00131, Train/loss_recog_epoch=1.320]Epoch 233: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057668, 0.057412, 0.058424
Train average loss UNet            (all)              : 0.173503

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000453, 3.324044, 6.209371
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001154, 3.221588, 5.519644
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001394, 3.297383, 5.313020
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001482, 3.425575, 5.782516
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001682, 3.533550, 5.575089
Train average loss all      (Triplet)                 : 0.001229

== Recognize ==
Train average loss Recognize     : 1.319311
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174732

Epoch 233:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]          Epoch 234:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.140, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.360, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.933, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000687, Train/loss_recog_step=1.290, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000687, Train/loss_recog_step=1.290, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]   Epoch 234:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.040, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00706, Train/loss_recog_step=1.540, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.181, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00706, Train/loss_recog_step=1.540, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.160, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=0.924, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.752, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.554, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.438, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.93it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.25it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.30it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.43it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.06it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.13it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068946, 0.067586, 0.065011
Valid average loss UNet            (all)              : 0.201543

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.168307, 3.610198, 5.883206
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.781936, 4.045724, 4.004812
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.802586, 4.059806, 3.831862
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.386616, 3.799248, 4.866214
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.336234, 4.371156, 5.061349
Valid average loss all      (Triplet)                 : 0.560122

== Recognize ==
Valid average loss Recognize     : 1.180864
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.761666

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.67057204246521 sec. =
Valid knn accuracy drums     : 81.61764705882352%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.450063943862915 sec. =
Valid knn accuracy bass      : 15.406976744186046%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.201755046844482 sec. =
Valid knn accuracy piano     : 28.783783783783782%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.06798505783081 sec. =
Valid knn accuracy guitar    : 43.506493506493506%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.150642395019531 sec. =
Valid knn accuracy residuals : 56.60377358490566%

Valid knn accuracy average   : 45.18373493563851%

                                                                        [AEpoch 234: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00123, Train/loss_recog_epoch=1.320]Epoch 234: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057525, 0.057192, 0.058336
Train average loss UNet            (all)              : 0.173052

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000707, 3.443537, 6.481703
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001348, 3.368670, 5.776955
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001337, 3.433457, 5.545126
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000937, 3.545416, 5.971796
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000875, 3.679072, 5.821133
Train average loss all      (Triplet)                 : 0.001063

== Recognize ==
Train average loss Recognize     : 1.314802
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174116

Epoch 234:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]          Epoch 235:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.010, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00191, Train/loss_recog_step=1.140, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.00191, Train/loss_recog_step=1.140, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000247, Train/loss_recog_step=1.360, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000247, Train/loss_recog_step=1.360, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.936, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]   Epoch 235:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.171, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.936, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00304, Train/loss_recog_step=1.550, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00304, Train/loss_recog_step=1.550, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.100, Valid/loss_unet_all_step=0.240, Valid/loss_triplet_all_step=0.857, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.762, Valid/loss_unet_all_epoch=0.202, Valid/loss_triplet_all_epoch=0.560, Valid/loss_recog_epoch=1.180, Valid/knn_avr=0.452, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.14it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.84it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.11it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.23it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  5.61it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.88it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067042, 0.065494, 0.064593
Valid average loss UNet            (all)              : 0.197130

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.149203, 3.458210, 5.585155
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.752751, 3.948460, 3.847787
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.819152, 4.021710, 3.763993
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.502724, 3.937529, 4.744829
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.372359, 4.255119, 4.927094
Valid average loss all      (Triplet)                 : 0.581480

== Recognize ==
Valid average loss Recognize     : 1.188802
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.778610

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.147296667098999 sec. =
Valid knn accuracy drums     : 78.52941176470588%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.275946378707886 sec. =
Valid knn accuracy bass      : 16.13372093023256%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.345374345779419 sec. =
Valid knn accuracy piano     : 26.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.423901796340942 sec. =
Valid knn accuracy guitar    : 47.07792207792208%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.970916986465454 sec. =
Valid knn accuracy residuals : 56.60377358490566%

Valid knn accuracy average   : 44.99328999587756%

                                                                        [AEpoch 235: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00106, Train/loss_recog_epoch=1.310]Epoch 235: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057712, 0.057423, 0.058499
Train average loss UNet            (all)              : 0.173635

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000291, 3.346659, 6.318624
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002573, 3.301752, 5.673647
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001478, 3.359503, 5.458787
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.002103, 3.449646, 5.830278
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001319, 3.575464, 5.648382
Train average loss all      (Triplet)                 : 0.001529

== Recognize ==
Train average loss Recognize     : 1.319963
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175165

Epoch 235:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]          Epoch 236:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]Epoch 236:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]Epoch 236:  16%|█▌        | 50/313 [00:49<04:20,  1.01it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000782, Train/loss_recog_step=1.150, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]Epoch 236:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000782, Train/loss_recog_step=1.150, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]Epoch 236:  32%|███▏      | 100/313 [01:32<03:16,  1.08it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]   Epoch 236:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.370, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]Epoch 236:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]Epoch 236:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.940, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]Epoch 236:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.0018, Train/loss_recog_step=1.300, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]Epoch 236:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.0018, Train/loss_recog_step=1.300, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]Epoch 236:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320] Epoch 236:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]Epoch 236:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00535, Train/loss_recog_step=1.560, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]Epoch 236: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.183, Train/loss_unet_all_step=0.178, Train/loss_triplet_all_step=0.00535, Train/loss_recog_step=1.560, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]Epoch 236: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.120, Valid/loss_unet_all_step=0.231, Valid/loss_triplet_all_step=0.885, Valid/loss_recog_step=1.430, Valid/loss_all_epoch=0.779, Valid/loss_unet_all_epoch=0.197, Valid/loss_triplet_all_epoch=0.581, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.450, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  6.11it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.89it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.95it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.30it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.28it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068274, 0.067597, 0.067176
Valid average loss UNet            (all)              : 0.203046

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.143432, 3.349025, 5.681299
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.786906, 4.125566, 4.095619
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.715145, 3.927831, 3.791533
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.629356, 4.054330, 4.787222
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.329277, 4.184395, 4.988818
Valid average loss all      (Triplet)                 : 0.592167

== Recognize ==
Valid average loss Recognize     : 1.192996
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.795213

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.679834604263306 sec. =
Valid knn accuracy drums     : 77.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.019709825515747 sec. =
Valid knn accuracy bass      : 15.843023255813954%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.338810205459595 sec. =
Valid knn accuracy piano     : 26.62162162162162%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.35636854171753 sec. =
Valid knn accuracy guitar    : 42.532467532467535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.964570760726929 sec. =
Valid knn accuracy residuals : 52.987421383647806%

Valid knn accuracy average   : 43.00867146459254%

                                                                        [AEpoch 236: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.175, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00153, Train/loss_recog_epoch=1.320]Epoch 236: 100%|██████████| 313/313 [06:13<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057924, 0.057645, 0.058712
Train average loss UNet            (all)              : 0.174281

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.001005, 3.412298, 6.435463
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002857, 3.386308, 5.779070
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001954, 3.497498, 5.627050
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001415, 3.589868, 6.057199
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001965, 3.724965, 5.872727
Train average loss all      (Triplet)                 : 0.001921

== Recognize ==
Train average loss Recognize     : 1.324921
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.176202

Epoch 236:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]          Epoch 237:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]Epoch 237:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]Epoch 237:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00636, Train/loss_recog_step=1.150, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]Epoch 237:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00636, Train/loss_recog_step=1.150, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]Epoch 237:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00125, Train/loss_recog_step=1.370, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]Epoch 237:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.00125, Train/loss_recog_step=1.370, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]Epoch 237:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0081, Train/loss_recog_step=0.940, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320] Epoch 237:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.180, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.0081, Train/loss_recog_step=0.940, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]Epoch 237:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00589, Train/loss_recog_step=1.300, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]Epoch 237:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00589, Train/loss_recog_step=1.300, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]Epoch 237:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]  Epoch 237:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]Epoch 237:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.550, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]Epoch 237: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.550, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]Epoch 237: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.250, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.010, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.795, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.592, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.430, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.02it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.18it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.68it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.08it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.08it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.03it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068118, 0.067751, 0.067068
Valid average loss UNet            (all)              : 0.202937

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.133876, 3.090975, 5.169871
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.657066, 3.573742, 3.614504
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.770974, 3.695456, 3.390056
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.571835, 3.708574, 4.340320
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.286388, 3.800988, 4.613031
Valid average loss all      (Triplet)                 : 0.546375

== Recognize ==
Valid average loss Recognize     : 1.188892
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.749313

= T-SNE...
T-SNE was finished!
= T-SNE time is 12.285642623901367 sec. =
Valid knn accuracy drums     : 80.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.174533128738403 sec. =
Valid knn accuracy bass      : 14.38953488372093%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.186146974563599 sec. =
Valid knn accuracy piano     : 27.16216216216216%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.254848718643188 sec. =
Valid knn accuracy guitar    : 41.55844155844156%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.182851314544678 sec. =
Valid knn accuracy residuals : 57.07547169811321%

Valid knn accuracy average   : 44.03712206048758%

                                                                        [AEpoch 237: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00192, Train/loss_recog_epoch=1.320]Epoch 237: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057812, 0.057453, 0.058538
Train average loss UNet            (all)              : 0.173804

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000802, 3.203961, 6.061863
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002631, 3.195091, 5.507353
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002895, 3.284881, 5.314058
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001082, 3.339612, 5.680848
Train average loss residuals(Triplet, dist_p, dist_n) : 0.002086, 3.465837, 5.459021
Train average loss all      (Triplet)                 : 0.001947

== Recognize ==
Train average loss Recognize     : 1.325823
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.175751

Epoch 237:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]          Epoch 238:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238:  16%|█▌        | 50/313 [00:49<04:22,  1.00it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.150, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00155, Train/loss_recog_step=1.370, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.178, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.00155, Train/loss_recog_step=1.370, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000304, Train/loss_recog_step=0.940, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238:  64%|██████▍   | 200/313 [03:02<01:43,  1.10it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000304, Train/loss_recog_step=0.940, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238:  64%|██████▍   | 200/313 [03:02<01:43,  1.10it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000118, Train/loss_recog_step=1.300, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000118, Train/loss_recog_step=1.300, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238:  80%|███████▉  | 250/313 [03:46<00:57,  1.10it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]   Epoch 238:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238:  96%|█████████▌| 300/313 [04:30<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=1.560, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.00276, Train/loss_recog_step=1.560, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238: 100%|██████████| 313/313 [04:40<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.180, Valid/loss_unet_all_step=0.233, Valid/loss_triplet_all_step=0.947, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.749, Valid/loss_unet_all_epoch=0.203, Valid/loss_triplet_all_epoch=0.546, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.440, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]  
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.04it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.94it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:02<00:00,  5.36it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.89it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  7.49it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  7.19it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068610, 0.068659, 0.067403
Valid average loss UNet            (all)              : 0.204673

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.166925, 3.446985, 5.493933
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.785469, 4.022500, 3.969328
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.871099, 4.038343, 3.799031
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.673459, 4.190736, 4.883261
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.317421, 4.262816, 5.172047
Valid average loss all      (Triplet)                 : 0.630104

== Recognize ==
Valid average loss Recognize     : 1.195022
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.834777

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.856600046157837 sec. =
Valid knn accuracy drums     : 79.70588235294119%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.010627746582031 sec. =
Valid knn accuracy bass      : 17.587209302325583%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.251599788665771 sec. =
Valid knn accuracy piano     : 27.837837837837835%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.980360269546509 sec. =
Valid knn accuracy guitar    : 36.85064935064935%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.04134488105774 sec. =
Valid knn accuracy residuals : 56.132075471698116%

Valid knn accuracy average   : 43.62273086309042%

                                                                        [AEpoch 238: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.176, Train/loss_unet_all_epoch=0.174, Train/loss_triplet_all_epoch=0.00195, Train/loss_recog_epoch=1.330]Epoch 238: 100%|██████████| 313/313 [06:17<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057547, 0.057336, 0.058372
Train average loss UNet            (all)              : 0.173256

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000287, 3.191911, 5.987680
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001933, 3.149810, 5.405000
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001495, 3.234735, 5.319963
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001412, 3.312550, 5.626447
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000605, 3.440027, 5.470259
Train average loss all      (Triplet)                 : 0.001197

== Recognize ==
Train average loss Recognize     : 1.325855
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174453

Epoch 238:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]          Epoch 239:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00112, Train/loss_recog_step=1.160, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00112, Train/loss_recog_step=1.160, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239:  32%|███▏      | 100/313 [01:33<03:18,  1.07it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000599, Train/loss_recog_step=1.380, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000599, Train/loss_recog_step=1.380, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]   Epoch 239:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.942, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239:  64%|██████▍   | 200/313 [03:00<01:42,  1.11it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.300, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.173, Train/loss_unet_all_step=0.173, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.560, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.560, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.310, Valid/loss_unet_all_step=0.239, Valid/loss_triplet_all_step=1.070, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.835, Valid/loss_unet_all_epoch=0.205, Valid/loss_triplet_all_epoch=0.630, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.436, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.88it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  7.18it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.47it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.82it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.75it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.90it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067114, 0.065711, 0.064791
Valid average loss UNet            (all)              : 0.197616

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.169487, 3.324581, 5.450750
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.787231, 3.950505, 3.941305
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.885397, 3.948947, 3.695066
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.719854, 4.255062, 4.907325
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.338291, 4.184634, 4.895598
Valid average loss all      (Triplet)                 : 0.658242

== Recognize ==
Valid average loss Recognize     : 1.193038
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.855858

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.581203699111938 sec. =
Valid knn accuracy drums     : 77.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.418801307678223 sec. =
Valid knn accuracy bass      : 17.732558139534884%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.291697263717651 sec. =
Valid knn accuracy piano     : 27.56756756756757%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.354912042617798 sec. =
Valid knn accuracy guitar    : 42.532467532467535%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.055142164230347 sec. =
Valid knn accuracy residuals : 53.301886792452834%

Valid knn accuracy average   : 43.72689600640457%

                                                                        [AEpoch 239: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.0012, Train/loss_recog_epoch=1.330]Epoch 239: 100%|██████████| 313/313 [06:14<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057537, 0.057202, 0.058272
Train average loss UNet            (all)              : 0.173010

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000389, 3.242744, 6.052628
Train average loss bass     (Triplet, dist_p, dist_n) : 0.002305, 3.239102, 5.584005
Train average loss piano    (Triplet, dist_p, dist_n) : 0.001458, 3.299044, 5.419304
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001229, 3.412249, 5.807459
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000985, 3.535489, 5.569975
Train average loss all      (Triplet)                 : 0.001331

== Recognize ==
Train average loss Recognize     : 1.327997
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174341

Epoch 239:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]          Epoch 240:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240:  48%|████▊     | 150/313 [02:17<02:28,  1.09it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240:  48%|████▊     | 150/313 [02:17<02:28,  1.09it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000351, Train/loss_recog_step=0.944, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.170, Train/loss_unet_all_step=0.170, Train/loss_triplet_all_step=0.000351, Train/loss_recog_step=0.944, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]   Epoch 240:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.310, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.177, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240:  96%|█████████▌| 300/313 [04:29<00:11,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.560, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.560, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240: 100%|██████████| 313/313 [04:39<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.470, Valid/loss_unet_all_step=0.235, Valid/loss_triplet_all_step=1.230, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.856, Valid/loss_unet_all_epoch=0.198, Valid/loss_triplet_all_epoch=0.658, Valid/loss_recog_epoch=1.190, Valid/knn_avr=0.437, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.71it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.45it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.23it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  6.28it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.29it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.51it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.068284, 0.067876, 0.067683
Valid average loss UNet            (all)              : 0.203843

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.197402, 3.441914, 5.515559
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.824677, 4.143423, 4.107536
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.903761, 3.970463, 3.646598
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.770332, 4.342713, 5.092810
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.331958, 4.241072, 5.115435
Valid average loss all      (Triplet)                 : 0.678334

== Recognize ==
Valid average loss Recognize     : 1.196563
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.882177

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.622804403305054 sec. =
Valid knn accuracy drums     : 77.3529411764706%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.839351654052734 sec. =
Valid knn accuracy bass      : 15.988372093023257%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.46027398109436 sec. =
Valid knn accuracy piano     : 25.405405405405407%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.42547059059143 sec. =
Valid knn accuracy guitar    : 39.935064935064936%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.337814807891846 sec. =
Valid knn accuracy residuals : 53.459119496855344%

Valid knn accuracy average   : 42.42818062136391%

                                                                        [AEpoch 240: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00133, Train/loss_recog_epoch=1.330]Epoch 240: 100%|██████████| 313/313 [06:15<00:00,  0.83it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057222, 0.056962, 0.058043
Train average loss UNet            (all)              : 0.172227

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000194, 3.238479, 6.038655
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001448, 3.216460, 5.525454
Train average loss piano    (Triplet, dist_p, dist_n) : 0.000863, 3.273335, 5.376256
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.000683, 3.375766, 5.796276
Train average loss residuals(Triplet, dist_p, dist_n) : 0.000469, 3.526352, 5.593693
Train average loss all      (Triplet)                 : 0.000792

== Recognize ==
Train average loss Recognize     : 1.330757
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.173019

Epoch 240:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]          Epoch 241:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.166, Train/loss_unet_all_step=0.166, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241:  16%|█▌        | 50/313 [00:48<04:14,  1.03it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.176, Train/loss_unet_all_step=0.176, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.380, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.172, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=0.945, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00155, Train/loss_recog_step=1.300, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.169, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.00155, Train/loss_recog_step=1.300, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]  Epoch 241:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.050, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000572, Train/loss_recog_step=1.560, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000572, Train/loss_recog_step=1.560, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.430, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=1.180, Valid/loss_recog_step=1.450, Valid/loss_all_epoch=0.882, Valid/loss_unet_all_epoch=0.204, Valid/loss_triplet_all_epoch=0.678, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.424, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]   
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.84it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:01<00:00,  5.87it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  5.55it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:01<00:00,  7.12it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.03it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  6.78it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.069777, 0.068560, 0.067589
Valid average loss UNet            (all)              : 0.205927

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.150790, 3.561229, 5.965806
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.818698, 4.088809, 4.064442
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.885613, 4.167519, 3.933326
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.586987, 4.180463, 5.057034
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.364702, 4.587498, 5.471999
Valid average loss all      (Triplet)                 : 0.626425

== Recognize ==
Valid average loss Recognize     : 1.196531
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.832352

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.617248058319092 sec. =
Valid knn accuracy drums     : 78.38235294117646%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.651249647140503 sec. =
Valid knn accuracy bass      : 13.517441860465116%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.009085893630981 sec. =
Valid knn accuracy piano     : 22.2972972972973%
= T-SNE...
T-SNE was finished!
= T-SNE time is 10.800368547439575 sec. =
Valid knn accuracy guitar    : 40.42207792207792%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.52680253982544 sec. =
Valid knn accuracy residuals : 58.01886792452831%

Valid knn accuracy average   : 42.527607589109024%

                                                                        [AEpoch 241: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.173, Train/loss_unet_all_epoch=0.172, Train/loss_triplet_all_epoch=0.000792, Train/loss_recog_epoch=1.330]Epoch 241: 100%|██████████| 313/313 [06:10<00:00,  0.84it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330] 

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.057438, 0.057093, 0.058183
Train average loss UNet            (all)              : 0.172714

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.000258, 3.374141, 6.357806
Train average loss bass     (Triplet, dist_p, dist_n) : 0.001761, 3.349339, 5.725471
Train average loss piano    (Triplet, dist_p, dist_n) : 0.002016, 3.432361, 5.586355
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.001665, 3.508542, 6.039444
Train average loss residuals(Triplet, dist_p, dist_n) : 0.001092, 3.700132, 5.888372
Train average loss all      (Triplet)                 : 0.001381

== Recognize ==
Train average loss Recognize     : 1.332761
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.174095

Epoch 241:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]          Epoch 242:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]Epoch 242:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.167, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.020, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]Epoch 242:  16%|█▌        | 50/313 [00:49<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]Epoch 242:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.168, Train/loss_unet_all_step=0.168, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.160, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]Epoch 242:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]Epoch 242:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.390, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]Epoch 242:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00287, Train/loss_recog_step=0.949, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]Epoch 242:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.172, Train/loss_triplet_all_step=0.00287, Train/loss_recog_step=0.949, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]Epoch 242:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00209, Train/loss_recog_step=1.310, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]Epoch 242:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.171, Train/loss_unet_all_step=0.169, Train/loss_triplet_all_step=0.00209, Train/loss_recog_step=1.310, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]Epoch 242:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]  Epoch 242:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.175, Train/loss_unet_all_step=0.175, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.060, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]Epoch 242:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.570, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]Epoch 242: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.174, Train/loss_unet_all_step=0.174, Train/loss_triplet_all_step=0.000, Train/loss_recog_step=1.570, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]Epoch 242: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.177, Train/loss_unet_all_step=0.167, Train/loss_triplet_all_step=0.0098, Train/loss_recog_step=1.030, Valid/loss_all_step=1.210, Valid/loss_unet_all_step=0.245, Valid/loss_triplet_all_step=0.964, Valid/loss_recog_step=1.440, Valid/loss_all_epoch=0.832, Valid/loss_unet_all_epoch=0.206, Valid/loss_triplet_all_epoch=0.626, Valid/loss_recog_epoch=1.200, Valid/knn_avr=0.425, Train/loss_all_epoch=0.174, Train/loss_unet_all_epoch=0.173, Train/loss_triplet_all_epoch=0.00138, Train/loss_recog_epoch=1.330]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.90it/s][A
Validation DataLoader 0:   0%|          | 0/11 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 11/11 [00:02<00:00,  5.18it/s][A
Validation DataLoader 1:   0%|          | 0/11 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/11 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 11/11 [00:01<00:00,  6.44it/s][A
Validation DataLoader 2:   0%|          | 0/12 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/12 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 12/12 [00:02<00:00,  5.77it/s][A
Validation DataLoader 3:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 10/10 [00:01<00:00,  6.44it/s][A
Validation DataLoader 4:   0%|          | 0/10 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/10 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 10/10 [00:01<00:00,  5.53it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.067288, 0.066311, 0.065787
Valid average loss UNet            (all)              : 0.199386

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.150226, 3.386714, 5.780752
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.800371, 3.938859, 3.923023
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.733310, 3.869749, 3.739231
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.684293, 4.272088, 4.599396
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.328112, 4.302180, 5.170206
Valid average loss all      (Triplet)                 : 0.614743

== Recognize ==
Valid average loss Recognize     : 1.202201
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.814129

= T-SNE...
T-SNE was finished!
= T-SNE time is 11.69378137588501 sec. =
Valid knn accuracy drums     : 82.05882352941177%
= T-SNE...
T-SNE was finished!
= T-SNE time is 12.44831919670105 sec. =
Valid knn accuracy bass      : 12.936046511627907%
= T-SNE...
T-SNE was finished!
= T-SNE time is 13.184666156768799 sec. =
Valid knn accuracy piano     : 25.945945945945947%
= T-SNE...
T-SNE was finished!
= T-SNE time is 11.410463094711304 sec. =
Valid knn accuracy guitar    : 39.61038961038961%
= T-SNE...
