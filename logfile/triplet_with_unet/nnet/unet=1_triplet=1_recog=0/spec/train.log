
=== Using cuda(utils.func). ===

[2023-11-15 17:36:55,228][utils.utils][INFO] - [rank: 0] Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-11-15 17:36:55,232][utils.utils][INFO] - [rank: 0] Printing config tree with Rich! <cfg.extras.print_config=True>
CONFIG
├── data
│   └── _target_: dataset.TripletDataModule                                     
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: false                                                            
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.NNetForTriplet                                          
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 1                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: true                                                   
│         ckpt_model_path: null                                                 
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── model
│   └── _target_: model.Triplet                                                 
│       optimizer:                                                              
│         _target_: torch.optim.Adam                                            
│         _partial_: true                                                       
│         lr: 0.001                                                             
│         weight_decay: 0.0                                                     
│       scheduler: null                                                         
│       net:                                                                    
│         _target_: model.NNetForTriplet                                        
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         f_size: 2048                                                          
│         mono: true                                                            
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         mel: false                                                            
│         n_mels: 259                                                           
│       ckpt_model_path: null                                                   
│       cfg:                                                                    
│         n_epoch: 400                                                          
│         inst_list:                                                            
│         - drums                                                               
│         - bass                                                                
│         - piano                                                               
│         - guitar                                                              
│         - residuals                                                           
│         dataset_dir: /nas03/assets/Dataset/slakh                              
│         n_dataset_test: 1000                                                  
│         batch_train: 64                                                       
│         batch_test: 64                                                        
│         num_workers: 8                                                        
│         pin_memory: true                                                      
│         datasetname: slakh                                                    
│         load_using_librosa: false                                             
│         mono: true                                                            
│         f_size: 2048                                                          
│         hop_length: 512                                                       
│         seconds_psd_train: 3                                                  
│         seconds_psd_valid: 10                                                 
│         seconds_psd_test: 10                                                  
│         offset_psd_train: 1.5                                                 
│         offset_psd_valid: 5.0                                                 
│         offset_psd_test: 10.0                                                 
│         seconds_triplet_train: 3                                              
│         seconds_triplet_valid: 3                                              
│         offset_triplet_train: 1.5                                             
│         offset_triplet_valid: 1.5                                             
│         seconds_c32_train: 3                                                  
│         seconds_c32_valid: 10                                                 
│         seconds_c32_test: 10                                                  
│         offset_c32_train: 1.5                                                 
│         offset_c32_valid: 5.0                                                 
│         offset_c32_test: 10.0                                                 
│         sr: 44100                                                             
│         mel: false                                                            
│         n_mels: 259                                                           
│         db: true                                                              
│         target: model.NNetForTriplet                                          
│         to1d_mode: mean_linear                                                
│         order: timefreq                                                       
│         margin: 0.2                                                           
│         monitor_es: Valid/knn_avr                                             
│         monitor_mode_es: max                                                  
│         triplet_rate: 1                                                       
│         unet_rate: 1                                                          
│         recog_rate: 0                                                         
│         test_psd_mine: true                                                   
│         ckpt_model_path: null                                                 
│         output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         dirpath: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/2023
│         filename: epoch_{epoch:03d}                                           
│         monitor: Valid/knn_avr                                                
│         verbose: true                                                         
│         save_last: true                                                       
│         save_top_k: -1                                                        
│         mode: max                                                             
│         auto_insert_metric_name: false                                        
│         save_weights_only: false                                              
│         every_n_train_steps: null                                             
│         train_time_interval: null                                             
│         every_n_epochs: null                                                  
│         save_on_train_epoch_end: null                                         
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: Valid/knn_avr                                                
│         min_delta: 0.0                                                        
│         patience: 200                                                         
│         verbose: true                                                         
│         mode: max                                                             
│         strict: true                                                          
│         check_finite: true                                                    
│         stopping_threshold: null                                              
│         divergence_threshold: null                                            
│         check_on_train_epoch_end: null                                        
│       tqdm_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.TQDMProgressBar                 
│         refresh_rate: 50                                                      
│                                                                               
├── logger
│   └── tensorboard:                                                            
│         _target_: pytorch_lightning.loggers.tensorboard.TensorBoardLogger     
│         save_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│         name: lightning_logs                                                  
│         log_graph: false                                                      
│         default_hp_metric: true                                               
│         prefix: ''                                                            
│                                                                               
├── trainer
│   └── _target_: pytorch_lightning.trainer.Trainer                             
│       default_root_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/ru
│       min_epochs: 1                                                           
│       max_epochs: 400                                                         
│       accelerator: auto                                                       
│       devices: 1                                                              
│       precision: 16                                                           
│       num_sanity_val_steps: 0                                                 
│       check_val_every_n_epoch: 1                                              
│       deterministic: false                                                    
│       enable_progress_bar: true                                               
│       log_every_n_steps: 10                                                   
│                                                                               
├── paths
│   └── root_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet       
│       data_dir: /home/imamura23/nas01home/codes/MusicSimilarityWithUNet/datase
│       log_dir: /home/imamura23/nas02home/outputs/                             
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│       work_dir: /nas01/homes/imamura23-1000067/codes/MusicSimilarityWithUNet  
│                                                                               
├── extras
│   └── ignore_warnings: false                                                  
│       enforce_tags: true                                                      
│       print_config: true                                                      
│                                                                               
├── task_name
│   └── triplet_with_unet                                                       
├── train
│   └── n_epoch: 400                                                            
│       inst_list:                                                              
│       - drums                                                                 
│       - bass                                                                  
│       - piano                                                                 
│       - guitar                                                                
│       - residuals                                                             
│       dataset_dir: /nas03/assets/Dataset/slakh                                
│       n_dataset_test: 1000                                                    
│       batch_train: 64                                                         
│       batch_test: 64                                                          
│       num_workers: 8                                                          
│       pin_memory: true                                                        
│       datasetname: slakh                                                      
│       load_using_librosa: false                                               
│       mono: true                                                              
│       f_size: 2048                                                            
│       hop_length: 512                                                         
│       seconds_psd_train: 3                                                    
│       seconds_psd_valid: 10                                                   
│       seconds_psd_test: 10                                                    
│       offset_psd_train: 1.5                                                   
│       offset_psd_valid: 5.0                                                   
│       offset_psd_test: 10.0                                                   
│       seconds_triplet_train: 3                                                
│       seconds_triplet_valid: 3                                                
│       offset_triplet_train: 1.5                                               
│       offset_triplet_valid: 1.5                                               
│       seconds_c32_train: 3                                                    
│       seconds_c32_valid: 10                                                   
│       seconds_c32_test: 10                                                    
│       offset_c32_train: 1.5                                                   
│       offset_c32_valid: 5.0                                                   
│       offset_c32_test: 10.0                                                   
│       sr: 44100                                                               
│       mel: false                                                              
│       n_mels: 259                                                             
│       db: true                                                                
│       target: model.NNetForTriplet                                            
│       to1d_mode: mean_linear                                                  
│       order: timefreq                                                         
│       margin: 0.2                                                             
│       monitor_es: Valid/knn_avr                                               
│       monitor_mode_es: max                                                    
│       triplet_rate: 1                                                         
│       unet_rate: 1                                                            
│       recog_rate: 0                                                           
│       test_psd_mine: true                                                     
│       ckpt_model_path: null                                                   
│       output_dir: /home/imamura23/nas02home/outputs/triplet_with_unet/runs/202
│                                                                               
├── test
│   └── True                                                                    
├── tags
│   └── ['triplet', 'model_2d_to1d640_de5']                                     
├── ckpt_path
│   └── None                                                                    
└── seed
    └── None                                                                    
[2023-11-15 17:36:55,308][source.train][INFO] - [rank: 0] Instantiating datamodule <dataset.TripletDataModule>
[2023-11-15 17:36:55,322][source.train][INFO] - [rank: 0] Instantiating model <model.Triplet>

=== Using cuda(model.csn). ===


=== Using cuda(model.unet5.model_csn_640). ===


=== Using cuda(model.unet5.model_csn_640_de5). ===


=== Using cuda(model.unet5.model_normal). ===


=== Using cuda(model.unet5.model_notcsn_640_de5). ===


=== Using cuda(model.unet5.model_unet5_1d_de5). ===


=== Using cuda(model.waveunet.model_waveunet5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de5). ===


=== Using cuda(model.triplet.model_triplet_csn_640_de1). ===


=== Using cuda(model.triplet.model_triplet_128_de1). ===


=== Using cuda(model.triplet.model_triplet_inst). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_embnet). ===


=== Using cuda(model.triplet.model_triplet_1d_de5_ae_embnet). ===


=== Using cuda(model.to1d.model_linear). ===


=== Using cuda(model.to1d.model_embedding). ===


=== Using cuda(model.triplet.model_triplet_csn640_de5_to1d_embedding). ===


=== Using cuda(model.triplet.model_triplet_to1d_embnet_silence). ===


=== Using cuda(model.triplet.model_triplet_2d_de5_to1d_embnet_lastmean). ===


=== Using cuda(model.triplet.model_nnet_old). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640). ===


=== Using cuda(model.jnet.model_jnet_128_embnet). ===


=== Using cuda(model.triplet.model_triplet_csn640_to1d640_1dde5). ===


=== Using cuda(model.triplet.model_triplet_to1d640_1dde1_embedding). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de5_to1d640_addencoder). ===


=== Using cuda(model.triplet.model_triplet_2d_csn640de1_to1d640). ===


=== Using cuda(model.triplet.model_nnet). ===


=== Using cuda(model.AE.model_ae). ===


=== Using cuda(model.demucs.model_demucs). ===


=== Using cuda(model.demucs.model_hdemucs). ===


=== Using cuda(model.jnet.model_jnet_attention). ===

[2023-11-15 17:36:56,419][torch.distributed.nn.jit.instantiator][INFO] - Created a temporary directory at /tmp/tmpnfddxhex
[2023-11-15 17:36:56,420][torch.distributed.nn.jit.instantiator][INFO] - Writing /tmp/tmpnfddxhex/_remote_module_non_scriptable.py
NNetForTriplet(
  (encoder): UNetEncoder(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(1, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(16, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (encoder2): UNetEncoder2(
    (conv1): Conv2d(
      (conv): Sequential(
        (0): Conv2d(5, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv2): Conv2d(
      (conv): Sequential(
        (0): Conv2d(32, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv3): Conv2d(
      (conv): Sequential(
        (0): Conv2d(64, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv4): Conv2d(
      (conv): Sequential(
        (0): Conv2d(128, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv5): Conv2d(
      (conv): Sequential(
        (0): Conv2d(256, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
    (conv6): Conv2d(
      (conv): Sequential(
        (0): Conv2d(512, 640, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
        (bn): BatchNorm2d(640, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (rl): LeakyReLU(negative_slope=0.2)
      )
    )
  )
  (decoder): UNetDecoder(
    (deconv6_a): ConvTranspose2d(640, 256, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv6_b): Sequential(
      (0): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv5_a): ConvTranspose2d(512, 128, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv5_b): Sequential(
      (0): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv4_a): ConvTranspose2d(256, 64, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv4_b): Sequential(
      (0): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
      (2): Dropout2d(p=0.5, inplace=False)
    )
    (deconv3_a): ConvTranspose2d(128, 32, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv3_b): Sequential(
      (0): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv2_a): ConvTranspose2d(64, 16, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
    (deconv2_b): Sequential(
      (0): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): LeakyReLU(negative_slope=0.2)
    )
    (deconv1_a): ConvTranspose2d(32, 5, kernel_size=(5, 5), stride=(2, 2), padding=(2, 2))
  )
  (to1d): To1D640(
    (to1d): To1D640timefreq(
      (fc1): Linear(in_features=10880, out_features=640, bias=True)
    )
  )
  (sigmoid): Sigmoid()
)
[2023-11-15 17:36:56,474][source.train][INFO] - [rank: 0] Instantiating callbacks...
[2023-11-15 17:36:56,474][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-11-15 17:36:56,477][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-11-15 17:36:56,479][utils.instantiators][INFO] - [rank: 0] Instantiating callback <pytorch_lightning.callbacks.TQDMProgressBar>
[2023-11-15 17:36:56,479][source.train][INFO] - [rank: 0] Instantiating loggers...
[2023-11-15 17:36:56,479][utils.instantiators][INFO] - [rank: 0] Instantiating logger <pytorch_lightning.loggers.tensorboard.TensorBoardLogger>
[2023-11-15 17:36:56,513][source.train][INFO] - [rank: 0] Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-11-15 17:36:56,782][source.train][INFO] - [rank: 0] Logging hyperparameters!
[2023-11-15 17:36:56,937][source.train][INFO] - [rank: 0] Starting training!

----------------------------------------
Use dataset slakh.
The frame size is setted to 2048.
----------------------------------------
	Loading dataset...
	dataset was loaded!
	* Loading time is 0.6076266765594482 sec. *
Training: |          | 0/? [00:00<?, ?it/s]Training:   0%|          | 0/313 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s] Epoch 0:  16%|█▌        | 50/313 [00:54<04:47,  0.92it/s]Epoch 0:  16%|█▌        | 50/313 [00:54<04:47,  0.92it/s, v_num=0, Train/loss_all_step=0.615, Train/loss_unet_all_step=0.260, Train/loss_triplet_all_step=0.355, Train/loss_recog_step=0.761]Epoch 0:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.615, Train/loss_unet_all_step=0.260, Train/loss_triplet_all_step=0.355, Train/loss_recog_step=0.761]Epoch 0:  32%|███▏      | 100/313 [01:38<03:30,  1.01it/s, v_num=0, Train/loss_all_step=0.680, Train/loss_unet_all_step=0.262, Train/loss_triplet_all_step=0.419, Train/loss_recog_step=0.835]Epoch 0:  48%|████▊     | 150/313 [02:20<02:32,  1.07it/s, v_num=0, Train/loss_all_step=0.680, Train/loss_unet_all_step=0.262, Train/loss_triplet_all_step=0.419, Train/loss_recog_step=0.835]Epoch 0:  48%|████▊     | 150/313 [02:20<02:32,  1.07it/s, v_num=0, Train/loss_all_step=0.529, Train/loss_unet_all_step=0.257, Train/loss_triplet_all_step=0.273, Train/loss_recog_step=0.645]Epoch 0:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.529, Train/loss_unet_all_step=0.257, Train/loss_triplet_all_step=0.273, Train/loss_recog_step=0.645]Epoch 0:  64%|██████▍   | 200/313 [03:03<01:43,  1.09it/s, v_num=0, Train/loss_all_step=0.537, Train/loss_unet_all_step=0.237, Train/loss_triplet_all_step=0.301, Train/loss_recog_step=0.798]Epoch 0:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.537, Train/loss_unet_all_step=0.237, Train/loss_triplet_all_step=0.301, Train/loss_recog_step=0.798]Epoch 0:  80%|███████▉  | 250/313 [03:45<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.536, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.293, Train/loss_recog_step=0.682]Epoch 0:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.536, Train/loss_unet_all_step=0.243, Train/loss_triplet_all_step=0.293, Train/loss_recog_step=0.682]Epoch 0:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.572, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=0.941]Epoch 0: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.572, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.343, Train/loss_recog_step=0.941]Epoch 0: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.470, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.675]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.10it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.85it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.68it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.15it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.16it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.21it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.082729, 0.082571, 0.080664
Valid average loss UNet            (all)              : 0.245964

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.093755, 0.320058, 0.615532
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.204083, 0.256947, 0.262481
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.246966, 0.280335, 0.233369
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.235139, 0.246394, 0.211255
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.137021, 0.215041, 0.321240
Valid average loss all      (Triplet)                 : 0.189222

== Recognize ==
Valid average loss Recognize     : 0.750201
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.435185

= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 15.628232955932617 sec. =
Valid knn accuracy drums     : 45.7%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 15.844908237457275 sec. =
Valid knn accuracy bass      : 1.7000000000000002%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 14.895283460617065 sec. =
Valid knn accuracy piano     : 3.0%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 15.206942081451416 sec. =
Valid knn accuracy guitar    : 3.0%
= T-SNE...
ディレクトリを作成します
T-SNE was finished!
= T-SNE time is 14.905122518539429 sec. =
Valid knn accuracy residuals : 11.5%

Valid knn accuracy average   : 12.98%

                                                                        [AEpoch 0: 100%|██████████| 313/313 [06:42<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.470, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.675, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130]Epoch 0: 100%|██████████| 313/313 [06:42<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.470, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.675, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.085517, 0.085458, 0.086253
Train average loss UNet            (all)              : 0.257228

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.352314, 2.163479, 2.184747
Train average loss bass     (Triplet, dist_p, dist_n) : 0.379498, 2.252005, 2.252779
Train average loss piano    (Triplet, dist_p, dist_n) : 0.357964, 2.157815, 2.165409
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.369988, 2.225620, 2.222476
Train average loss residuals(Triplet, dist_p, dist_n) : 0.351894, 2.212731, 2.253333
Train average loss all      (Triplet)                 : 0.361220

== Recognize ==
Train average loss Recognize     : 0.820117
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.618448

Epoch 0:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.470, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.675, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]          Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.470, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.675, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.470, Train/loss_unet_all_step=0.246, Train/loss_triplet_all_step=0.223, Train/loss_recog_step=0.675, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1:  16%|█▌        | 50/313 [00:47<04:09,  1.05it/s, v_num=0, Train/loss_all_step=0.460, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.243, Train/loss_recog_step=0.747, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.460, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.243, Train/loss_recog_step=0.747, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.455, Train/loss_unet_all_step=0.242, Train/loss_triplet_all_step=0.213, Train/loss_recog_step=0.834, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.455, Train/loss_unet_all_step=0.242, Train/loss_triplet_all_step=0.213, Train/loss_recog_step=0.834, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1:  48%|████▊     | 150/313 [02:13<02:25,  1.12it/s, v_num=0, Train/loss_all_step=0.503, Train/loss_unet_all_step=0.241, Train/loss_triplet_all_step=0.262, Train/loss_recog_step=0.657, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.503, Train/loss_unet_all_step=0.241, Train/loss_triplet_all_step=0.262, Train/loss_recog_step=0.657, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1:  64%|██████▍   | 200/313 [02:57<01:40,  1.13it/s, v_num=0, Train/loss_all_step=0.481, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.256, Train/loss_recog_step=0.805, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.481, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.256, Train/loss_recog_step=0.805, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.411, Train/loss_unet_all_step=0.233, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=0.693, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.411, Train/loss_unet_all_step=0.233, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=0.693, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1:  96%|█████████▌| 300/313 [04:24<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.471, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.933, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.471, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.933, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.439, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.688, Valid/loss_all_step=0.438, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.170, Valid/loss_recog_step=0.882, Valid/loss_all_epoch=0.435, Valid/loss_unet_all_epoch=0.246, Valid/loss_triplet_all_epoch=0.189, Valid/loss_recog_epoch=0.750, Valid/knn_avr=0.130, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.16it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.13it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.92it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.20it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:02<00:00,  5.56it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:02<00:00,  5.63it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.081186, 0.080926, 0.080650
Valid average loss UNet            (all)              : 0.242763

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.102919, 0.344611, 0.743657
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.220492, 0.152266, 0.134431
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.274842, 0.234788, 0.172867
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.191864, 0.180587, 0.205233
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.165134, 0.222853, 0.339021
Valid average loss all      (Triplet)                 : 0.198278

== Recognize ==
Valid average loss Recognize     : 0.773657
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.441041

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.143959999084473 sec. =
Valid knn accuracy drums     : 47.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.628331899642944 sec. =
Valid knn accuracy bass      : 0.8999999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.18397855758667 sec. =
Valid knn accuracy piano     : 1.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.027773380279541 sec. =
Valid knn accuracy guitar    : 2.1%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.165891647338867 sec. =
Valid knn accuracy residuals : 15.2%

Valid knn accuracy average   : 13.459999999999999%

                                                                        [AEpoch 1: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.439, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.688, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.618, Train/loss_unet_all_epoch=0.257, Train/loss_triplet_all_epoch=0.361, Train/loss_recog_epoch=0.820]Epoch 1: 100%|██████████| 313/313 [06:31<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.439, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.688, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.077477, 0.077277, 0.078525
Train average loss UNet            (all)              : 0.233278

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.192246, 1.128913, 1.266854
Train average loss bass     (Triplet, dist_p, dist_n) : 0.254796, 1.206290, 1.196897
Train average loss piano    (Triplet, dist_p, dist_n) : 0.262290, 1.214183, 1.205711
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.255845, 1.231628, 1.222339
Train average loss residuals(Triplet, dist_p, dist_n) : 0.252609, 1.201692, 1.199443
Train average loss all      (Triplet)                 : 0.243833

== Recognize ==
Train average loss Recognize     : 0.821601
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.477112

Epoch 1:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.439, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.688, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]          Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.439, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.688, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.439, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.688, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2:  16%|█▌        | 50/313 [00:49<04:18,  1.02it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.226, Train/loss_recog_step=0.753, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.436, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.226, Train/loss_recog_step=0.753, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2:  32%|███▏      | 100/313 [01:33<03:19,  1.07it/s, v_num=0, Train/loss_all_step=0.478, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=0.842, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.478, Train/loss_unet_all_step=0.236, Train/loss_triplet_all_step=0.242, Train/loss_recog_step=0.842, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.490, Train/loss_unet_all_step=0.237, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.634, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.490, Train/loss_unet_all_step=0.237, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.634, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.402, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.804, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.402, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.804, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.416, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=0.688, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.416, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=0.688, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.402, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.941, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.402, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.941, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.479, Train/loss_unet_all_step=0.232, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.663, Valid/loss_all_step=0.479, Valid/loss_unet_all_step=0.276, Valid/loss_triplet_all_step=0.203, Valid/loss_recog_step=0.909, Valid/loss_all_epoch=0.441, Valid/loss_unet_all_epoch=0.243, Valid/loss_triplet_all_epoch=0.198, Valid/loss_recog_epoch=0.774, Valid/knn_avr=0.135, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.34it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.03it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:02<00:00,  5.34it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:02<00:00,  6.05it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:02<00:00,  5.35it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.22it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.078651, 0.078127, 0.078391
Valid average loss UNet            (all)              : 0.235169

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.111154, 0.249583, 0.600291
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.223626, 0.158264, 0.135788
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.255367, 0.222633, 0.172437
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.224433, 0.197375, 0.189224
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.159552, 0.214962, 0.259625
Valid average loss all      (Triplet)                 : 0.203446

== Recognize ==
Valid average loss Recognize     : 0.772432
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.438615

= T-SNE...
T-SNE was finished!
= T-SNE time is 16.564509868621826 sec. =
Valid knn accuracy drums     : 62.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.969656944274902 sec. =
Valid knn accuracy bass      : 0.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.919631242752075 sec. =
Valid knn accuracy piano     : 1.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.743797540664673 sec. =
Valid knn accuracy guitar    : 3.3000000000000003%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.020289897918701 sec. =
Valid knn accuracy residuals : 12.0%

Valid knn accuracy average   : 15.920000000000002%

                                                                        [AEpoch 2: 100%|██████████| 313/313 [06:37<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.479, Train/loss_unet_all_step=0.232, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.663, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.477, Train/loss_unet_all_epoch=0.233, Train/loss_triplet_all_epoch=0.244, Train/loss_recog_epoch=0.822]Epoch 2: 100%|██████████| 313/313 [06:37<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.479, Train/loss_unet_all_step=0.232, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.663, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.076053, 0.075847, 0.077104
Train average loss UNet            (all)              : 0.229005

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.149386, 0.788845, 1.000845
Train average loss bass     (Triplet, dist_p, dist_n) : 0.223137, 0.847147, 0.845288
Train average loss piano    (Triplet, dist_p, dist_n) : 0.224276, 0.866740, 0.863167
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.222057, 0.870712, 0.870911
Train average loss residuals(Triplet, dist_p, dist_n) : 0.221604, 0.852783, 0.854502
Train average loss all      (Triplet)                 : 0.208840

== Recognize ==
Train average loss Recognize     : 0.822774
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.437845

Epoch 2:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.479, Train/loss_unet_all_step=0.232, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.663, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]          Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.479, Train/loss_unet_all_step=0.232, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.663, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.479, Train/loss_unet_all_step=0.232, Train/loss_triplet_all_step=0.247, Train/loss_recog_step=0.663, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.737, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.388, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.737, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.418, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=0.853, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.418, Train/loss_unet_all_step=0.235, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=0.853, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.379, Train/loss_unet_all_step=0.232, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.648, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.379, Train/loss_unet_all_step=0.232, Train/loss_triplet_all_step=0.147, Train/loss_recog_step=0.648, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=0.798, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.405, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=0.798, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3:  80%|███████▉  | 250/313 [03:41<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.228, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.677, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.383, Train/loss_unet_all_step=0.228, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.677, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.434, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.213, Train/loss_recog_step=0.936, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.434, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.213, Train/loss_recog_step=0.936, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.478, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.683, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.263, Valid/loss_triplet_all_step=0.222, Valid/loss_recog_step=0.902, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.235, Valid/loss_triplet_all_epoch=0.203, Valid/loss_recog_epoch=0.772, Valid/knn_avr=0.159, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.28it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.07it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.88it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.06it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.00it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.97it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.089674, 0.089994, 0.092559
Valid average loss UNet            (all)              : 0.272227

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088786, 0.368390, 0.984057
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.239979, 0.224290, 0.191288
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.270017, 0.302958, 0.243204
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.229761, 0.217719, 0.209958
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.161924, 0.289494, 0.345377
Valid average loss all      (Triplet)                 : 0.206999

== Recognize ==
Valid average loss Recognize     : 0.755985
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.479227

= T-SNE...
T-SNE was finished!
= T-SNE time is 17.113445043563843 sec. =
Valid knn accuracy drums     : 60.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.10285234451294 sec. =
Valid knn accuracy bass      : 0.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.872909307479858 sec. =
Valid knn accuracy piano     : 1.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.71552062034607 sec. =
Valid knn accuracy guitar    : 1.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.765461921691895 sec. =
Valid knn accuracy residuals : 11.700000000000001%

Valid knn accuracy average   : 15.02%

                                                                        [AEpoch 3: 100%|██████████| 313/313 [06:38<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.478, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.683, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.438, Train/loss_unet_all_epoch=0.229, Train/loss_triplet_all_epoch=0.209, Train/loss_recog_epoch=0.823]Epoch 3: 100%|██████████| 313/313 [06:38<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.478, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.683, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.075017, 0.074799, 0.076039
Train average loss UNet            (all)              : 0.225855

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.119831, 0.597754, 0.903777
Train average loss bass     (Triplet, dist_p, dist_n) : 0.214236, 0.665039, 0.662562
Train average loss piano    (Triplet, dist_p, dist_n) : 0.213677, 0.682399, 0.682916
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.216595, 0.663902, 0.659007
Train average loss residuals(Triplet, dist_p, dist_n) : 0.213818, 0.681465, 0.680910
Train average loss all      (Triplet)                 : 0.196379

== Recognize ==
Train average loss Recognize     : 0.825113
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.422234

Epoch 3:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.478, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.683, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]          Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.478, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.683, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.478, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.252, Train/loss_recog_step=0.683, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4:  16%|█▌        | 50/313 [00:46<04:05,  1.07it/s, v_num=0, Train/loss_all_step=0.382, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=0.750, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.382, Train/loss_unet_all_step=0.205, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=0.750, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4:  32%|███▏      | 100/313 [01:30<03:12,  1.10it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.214, Train/loss_recog_step=0.834, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.445, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.214, Train/loss_recog_step=0.834, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.411, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=0.637, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.411, Train/loss_unet_all_step=0.229, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=0.637, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.394, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.823, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.394, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.823, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.686, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.194, Train/loss_recog_step=0.686, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.403, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=0.963, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.403, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.182, Train/loss_recog_step=0.963, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.459, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.237, Train/loss_recog_step=0.669, Valid/loss_all_step=0.545, Valid/loss_unet_all_step=0.320, Valid/loss_triplet_all_step=0.226, Valid/loss_recog_step=0.880, Valid/loss_all_epoch=0.479, Valid/loss_unet_all_epoch=0.272, Valid/loss_triplet_all_epoch=0.207, Valid/loss_recog_epoch=0.756, Valid/knn_avr=0.150, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.17it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:02<00:00,  5.42it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.32it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.19it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.00it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.082411, 0.081786, 0.083633
Valid average loss UNet            (all)              : 0.247831

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.099998, 0.269489, 0.786214
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.231247, 0.159038, 0.131535
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.239299, 0.166723, 0.138793
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.192791, 0.161233, 0.171548
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.155885, 0.281671, 0.367715
Valid average loss all      (Triplet)                 : 0.191407

== Recognize ==
Valid average loss Recognize     : 0.781743
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.439238

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.920082330703735 sec. =
Valid knn accuracy drums     : 63.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.251731157302856 sec. =
Valid knn accuracy bass      : 1.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.773141384124756 sec. =
Valid knn accuracy piano     : 1.4000000000000001%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.12614369392395 sec. =
Valid knn accuracy guitar    : 1.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.784746646881104 sec. =
Valid knn accuracy residuals : 9.6%

Valid knn accuracy average   : 15.46%

                                                                        [AEpoch 4: 100%|██████████| 313/313 [06:33<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.459, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.237, Train/loss_recog_step=0.669, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.422, Train/loss_unet_all_epoch=0.226, Train/loss_triplet_all_epoch=0.196, Train/loss_recog_epoch=0.825]Epoch 4: 100%|██████████| 313/313 [06:33<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.459, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.237, Train/loss_recog_step=0.669, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.073936, 0.073710, 0.074873
Train average loss UNet            (all)              : 0.222518

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.102422, 0.495338, 0.850989
Train average loss bass     (Triplet, dist_p, dist_n) : 0.211977, 0.565331, 0.560845
Train average loss piano    (Triplet, dist_p, dist_n) : 0.211561, 0.580857, 0.578499
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.209793, 0.574415, 0.574527
Train average loss residuals(Triplet, dist_p, dist_n) : 0.205593, 0.579066, 0.582401
Train average loss all      (Triplet)                 : 0.189495

== Recognize ==
Train average loss Recognize     : 0.825172
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.412013

Epoch 4:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.459, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.237, Train/loss_recog_step=0.669, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]          Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.459, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.237, Train/loss_recog_step=0.669, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.459, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.237, Train/loss_recog_step=0.669, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.389, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=0.754, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.389, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.185, Train/loss_recog_step=0.754, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5:  32%|███▏      | 100/313 [01:31<03:14,  1.10it/s, v_num=0, Train/loss_all_step=0.415, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=0.852, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.415, Train/loss_unet_all_step=0.231, Train/loss_triplet_all_step=0.184, Train/loss_recog_step=0.852, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5:  48%|████▊     | 150/313 [02:14<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.630, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.630, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5:  64%|██████▍   | 200/313 [02:58<01:41,  1.12it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.815, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.385, Train/loss_unet_all_step=0.211, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.815, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.401, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.694, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.401, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.694, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5:  96%|█████████▌| 300/313 [04:26<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.957, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.425, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.957, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.429, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.681, Valid/loss_all_step=0.477, Valid/loss_unet_all_step=0.293, Valid/loss_triplet_all_step=0.183, Valid/loss_recog_step=0.920, Valid/loss_all_epoch=0.439, Valid/loss_unet_all_epoch=0.248, Valid/loss_triplet_all_epoch=0.191, Valid/loss_recog_epoch=0.782, Valid/knn_avr=0.155, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.31it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:02<00:00,  5.86it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.93it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.14it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.11it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:02<00:00,  5.59it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.081627, 0.081850, 0.083731
Valid average loss UNet            (all)              : 0.247208

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.079953, 0.287243, 0.859917
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.226979, 0.138656, 0.111678
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.233273, 0.163674, 0.132618
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.212660, 0.167284, 0.155371
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.136718, 0.221705, 0.338447
Valid average loss all      (Triplet)                 : 0.187073

== Recognize ==
Valid average loss Recognize     : 0.778867
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.434281

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.89419960975647 sec. =
Valid knn accuracy drums     : 67.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.761154174804688 sec. =
Valid knn accuracy bass      : 0.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.053123235702515 sec. =
Valid knn accuracy piano     : 1.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.984775304794312 sec. =
Valid knn accuracy guitar    : 3.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.362941026687622 sec. =
Valid knn accuracy residuals : 13.700000000000001%

Valid knn accuracy average   : 17.160000000000004%

                                                                        [AEpoch 5: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.429, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.681, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.412, Train/loss_unet_all_epoch=0.223, Train/loss_triplet_all_epoch=0.189, Train/loss_recog_epoch=0.825]Epoch 5: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.429, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.681, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.073094, 0.072917, 0.074136
Train average loss UNet            (all)              : 0.220147

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.089647, 0.454906, 0.833328
Train average loss bass     (Triplet, dist_p, dist_n) : 0.210987, 0.537207, 0.532970
Train average loss piano    (Triplet, dist_p, dist_n) : 0.212381, 0.548638, 0.544389
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.206007, 0.551816, 0.553815
Train average loss residuals(Triplet, dist_p, dist_n) : 0.205749, 0.561185, 0.565418
Train average loss all      (Triplet)                 : 0.186510

== Recognize ==
Train average loss Recognize     : 0.829695
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.406657

Epoch 5:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.429, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.681, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]          Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.429, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.681, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.429, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.205, Train/loss_recog_step=0.681, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.406, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=0.770, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.406, Train/loss_unet_all_step=0.202, Train/loss_triplet_all_step=0.204, Train/loss_recog_step=0.770, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6:  32%|███▏      | 100/313 [01:31<03:15,  1.09it/s, v_num=0, Train/loss_all_step=0.413, Train/loss_unet_all_step=0.227, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.854, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.413, Train/loss_unet_all_step=0.227, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.854, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6:  48%|████▊     | 150/313 [02:15<02:27,  1.10it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.635, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.174, Train/loss_recog_step=0.635, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.387, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.848, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.387, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.848, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.201, Train/loss_recog_step=0.700, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.201, Train/loss_recog_step=0.700, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6:  96%|█████████▌| 300/313 [04:26<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.426, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.206, Train/loss_recog_step=0.980, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.426, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.206, Train/loss_recog_step=0.980, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6: 100%|██████████| 313/313 [04:36<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.393, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.680, Valid/loss_all_step=0.485, Valid/loss_unet_all_step=0.285, Valid/loss_triplet_all_step=0.201, Valid/loss_recog_step=0.915, Valid/loss_all_epoch=0.434, Valid/loss_unet_all_epoch=0.247, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.779, Valid/knn_avr=0.172, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.02it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.99it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:02<00:00,  5.47it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.17it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.25it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.04it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.078110, 0.077649, 0.079749
Valid average loss UNet            (all)              : 0.235508

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.073062, 0.204894, 0.566770
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.207113, 0.122644, 0.116871
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.212809, 0.160112, 0.163946
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.221287, 0.189604, 0.177380
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.230714, 0.332860, 0.325886
Valid average loss all      (Triplet)                 : 0.189721

== Recognize ==
Valid average loss Recognize     : 0.792659
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.425228

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.005187749862671 sec. =
Valid knn accuracy drums     : 69.39999999999999%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.93207311630249 sec. =
Valid knn accuracy bass      : 0.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.914133787155151 sec. =
Valid knn accuracy piano     : 1.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.714336156845093 sec. =
Valid knn accuracy guitar    : 4.3999999999999995%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.90185546875 sec. =
Valid knn accuracy residuals : 16.900000000000002%

Valid knn accuracy average   : 18.560000000000002%

                                                                        [AEpoch 6: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.393, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.680, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.407, Train/loss_unet_all_epoch=0.220, Train/loss_triplet_all_epoch=0.187, Train/loss_recog_epoch=0.830]Epoch 6: 100%|██████████| 313/313 [06:34<00:00,  0.79it/s, v_num=0, Train/loss_all_step=0.393, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.680, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.072635, 0.072386, 0.073669
Train average loss UNet            (all)              : 0.218690

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.087491, 0.421299, 0.808526
Train average loss bass     (Triplet, dist_p, dist_n) : 0.208747, 0.495188, 0.493232
Train average loss piano    (Triplet, dist_p, dist_n) : 0.208045, 0.500507, 0.499592
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.209610, 0.513134, 0.510213
Train average loss residuals(Triplet, dist_p, dist_n) : 0.197746, 0.516612, 0.528242
Train average loss all      (Triplet)                 : 0.183465

== Recognize ==
Train average loss Recognize     : 0.835550
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.402155

Epoch 6:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.393, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.680, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]          Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.393, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.680, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.393, Train/loss_unet_all_step=0.221, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.680, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7:  16%|█▌        | 50/313 [00:47<04:08,  1.06it/s, v_num=0, Train/loss_all_step=0.379, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.741, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.379, Train/loss_unet_all_step=0.201, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.741, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.410, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=0.834, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.410, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.183, Train/loss_recog_step=0.834, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7:  48%|████▊     | 150/313 [02:15<02:27,  1.11it/s, v_num=0, Train/loss_all_step=0.410, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.638, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.410, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.186, Train/loss_recog_step=0.638, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.387, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.801, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.387, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.801, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7:  80%|███████▉  | 250/313 [03:42<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.712, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.357, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.139, Train/loss_recog_step=0.712, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=0.961, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.395, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.177, Train/loss_recog_step=0.961, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7: 100%|██████████| 313/313 [04:35<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.668, Valid/loss_all_step=0.478, Valid/loss_unet_all_step=0.273, Valid/loss_triplet_all_step=0.205, Valid/loss_recog_step=0.919, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.236, Valid/loss_triplet_all_epoch=0.190, Valid/loss_recog_epoch=0.793, Valid/knn_avr=0.186, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.07it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.02it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.71it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.03it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:02<00:00,  5.85it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.32it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.089317, 0.089615, 0.091671
Valid average loss UNet            (all)              : 0.270603

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.067489, 0.215988, 0.642714
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.223905, 0.136112, 0.112893
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.247621, 0.170555, 0.123184
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.204472, 0.166619, 0.162789
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.115319, 0.236013, 0.368262
Valid average loss all      (Triplet)                 : 0.182171

== Recognize ==
Valid average loss Recognize     : 0.770141
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.452774

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.652764558792114 sec. =
Valid knn accuracy drums     : 72.8%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.309644937515259 sec. =
Valid knn accuracy bass      : 1.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.161803722381592 sec. =
Valid knn accuracy piano     : 1.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.29004454612732 sec. =
Valid knn accuracy guitar    : 1.7999999999999998%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.332059144973755 sec. =
Valid knn accuracy residuals : 17.8%

Valid knn accuracy average   : 18.980000000000004%

                                                                        [AEpoch 7: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.668, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.402, Train/loss_unet_all_epoch=0.219, Train/loss_triplet_all_epoch=0.183, Train/loss_recog_epoch=0.836]Epoch 7: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.668, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.072278, 0.072054, 0.073254
Train average loss UNet            (all)              : 0.217587

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.083074, 0.376415, 0.762638
Train average loss bass     (Triplet, dist_p, dist_n) : 0.206218, 0.457792, 0.457609
Train average loss piano    (Triplet, dist_p, dist_n) : 0.207316, 0.460552, 0.457542
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.198856, 0.461577, 0.470527
Train average loss residuals(Triplet, dist_p, dist_n) : 0.189721, 0.505219, 0.532911
Train average loss all      (Triplet)                 : 0.178230

== Recognize ==
Train average loss Recognize     : 0.828093
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.395817

Epoch 7:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.668, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]          Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.668, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.220, Train/loss_triplet_all_step=0.179, Train/loss_recog_step=0.668, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8:  16%|█▌        | 50/313 [00:47<04:09,  1.06it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=0.779, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.378, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.178, Train/loss_recog_step=0.779, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.857, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.226, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.857, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8:  48%|████▊     | 150/313 [02:14<02:26,  1.12it/s, v_num=0, Train/loss_all_step=0.382, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=0.650, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.382, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=0.650, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8:  64%|██████▍   | 200/313 [02:58<01:40,  1.12it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=0.840, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.208, Train/loss_triplet_all_step=0.160, Train/loss_recog_step=0.840, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8:  80%|███████▉  | 250/313 [03:42<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.695, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.373, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.155, Train/loss_recog_step=0.695, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8:  96%|█████████▌| 300/313 [04:25<00:11,  1.13it/s, v_num=0, Train/loss_all_step=0.421, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.202, Train/loss_recog_step=0.948, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.421, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.202, Train/loss_recog_step=0.948, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8: 100%|██████████| 313/313 [04:35<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.674, Valid/loss_all_step=0.522, Valid/loss_unet_all_step=0.325, Valid/loss_triplet_all_step=0.196, Valid/loss_recog_step=0.916, Valid/loss_all_epoch=0.453, Valid/loss_unet_all_epoch=0.271, Valid/loss_triplet_all_epoch=0.182, Valid/loss_recog_epoch=0.770, Valid/knn_avr=0.190, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.21it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:02<00:00,  5.47it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.21it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.20it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  5.11it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:02<00:00,  5.49it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.075528, 0.074862, 0.073694
Valid average loss UNet            (all)              : 0.224084

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.077702, 0.208803, 0.542420
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.223506, 0.163439, 0.140022
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.227642, 0.170888, 0.143528
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.211158, 0.163175, 0.154005
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.125506, 0.219074, 0.372145
Valid average loss all      (Triplet)                 : 0.185535

== Recognize ==
Valid average loss Recognize     : 0.746145
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.409619

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.957051515579224 sec. =
Valid knn accuracy drums     : 72.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.027174949645996 sec. =
Valid knn accuracy bass      : 1.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.041785478591919 sec. =
Valid knn accuracy piano     : 2.0%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.961636066436768 sec. =
Valid knn accuracy guitar    : 3.9%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.8707857131958 sec. =
Valid knn accuracy residuals : 27.700000000000003%

Valid knn accuracy average   : 21.42%

                                                                        [AEpoch 8: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.674, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.396, Train/loss_unet_all_epoch=0.218, Train/loss_triplet_all_epoch=0.178, Train/loss_recog_epoch=0.828]Epoch 8: 100%|██████████| 313/313 [06:32<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.674, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.071950, 0.071673, 0.072965
Train average loss UNet            (all)              : 0.216588

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.071042, 0.363012, 0.789211
Train average loss bass     (Triplet, dist_p, dist_n) : 0.209300, 0.438292, 0.433953
Train average loss piano    (Triplet, dist_p, dist_n) : 0.206494, 0.452553, 0.452287
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.195931, 0.445609, 0.462497
Train average loss residuals(Triplet, dist_p, dist_n) : 0.189440, 0.478630, 0.504020
Train average loss all      (Triplet)                 : 0.175851

== Recognize ==
Train average loss Recognize     : 0.837232
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.392439

Epoch 8:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.674, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]          Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.674, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.399, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.180, Train/loss_recog_step=0.674, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9:  16%|█▌        | 50/313 [00:47<04:11,  1.05it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=0.738, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.200, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=0.738, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9:  32%|███▏      | 100/313 [01:30<03:13,  1.10it/s, v_num=0, Train/loss_all_step=0.402, Train/loss_unet_all_step=0.227, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.845, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.402, Train/loss_unet_all_step=0.227, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.845, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9:  48%|████▊     | 150/313 [02:13<02:24,  1.13it/s, v_num=0, Train/loss_all_step=0.380, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=0.632, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.380, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.158, Train/loss_recog_step=0.632, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9:  64%|██████▍   | 200/313 [02:56<01:39,  1.13it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.855, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.362, Train/loss_unet_all_step=0.206, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.855, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9:  80%|███████▉  | 250/313 [03:40<00:55,  1.13it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.719, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.144, Train/loss_recog_step=0.719, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9:  96%|█████████▌| 300/313 [04:24<00:11,  1.14it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.980, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.390, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.980, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9: 100%|██████████| 313/313 [04:34<00:00,  1.14it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.675, Valid/loss_all_step=0.456, Valid/loss_unet_all_step=0.243, Valid/loss_triplet_all_step=0.213, Valid/loss_recog_step=0.851, Valid/loss_all_epoch=0.410, Valid/loss_unet_all_epoch=0.224, Valid/loss_triplet_all_epoch=0.186, Valid/loss_recog_epoch=0.746, Valid/knn_avr=0.214, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.21it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:02<00:00,  5.88it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.13it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.30it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:02<00:00,  5.55it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.12it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.086833, 0.086656, 0.089538
Valid average loss UNet            (all)              : 0.263027

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.062972, 0.294602, 0.963797
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.221246, 0.115894, 0.094648
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.225191, 0.163503, 0.138312
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.211279, 0.232769, 0.229654
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.108616, 0.241925, 0.392063
Valid average loss all      (Triplet)                 : 0.177356

== Recognize ==
Valid average loss Recognize     : 0.792216
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.440383

= T-SNE...
T-SNE was finished!
= T-SNE time is 14.511521100997925 sec. =
Valid knn accuracy drums     : 73.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.824646711349487 sec. =
Valid knn accuracy bass      : 0.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.170702695846558 sec. =
Valid knn accuracy piano     : 2.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 14.93842625617981 sec. =
Valid knn accuracy guitar    : 4.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.48878264427185 sec. =
Valid knn accuracy residuals : 15.7%

Valid knn accuracy average   : 19.14%

                                                                        [AEpoch 9: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.675, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.392, Train/loss_unet_all_epoch=0.217, Train/loss_triplet_all_epoch=0.176, Train/loss_recog_epoch=0.837]Epoch 9: 100%|██████████| 313/313 [06:30<00:00,  0.80it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.675, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.071625, 0.071389, 0.072604
Train average loss UNet            (all)              : 0.215619

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.065551, 0.338557, 0.783384
Train average loss bass     (Triplet, dist_p, dist_n) : 0.206877, 0.401197, 0.399155
Train average loss piano    (Triplet, dist_p, dist_n) : 0.208369, 0.414593, 0.410038
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.193904, 0.404971, 0.427473
Train average loss residuals(Triplet, dist_p, dist_n) : 0.179039, 0.441928, 0.483290
Train average loss all      (Triplet)                 : 0.172151

== Recognize ==
Train average loss Recognize     : 0.837437
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.387770

Epoch 9:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.675, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]          Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.675, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.675, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10:  16%|█▌        | 50/313 [00:48<04:15,  1.03it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.778, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.368, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.170, Train/loss_recog_step=0.778, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=0.847, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.152, Train/loss_recog_step=0.847, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10:  48%|████▊     | 150/313 [02:16<02:28,  1.10it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.640, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.363, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.640, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10:  64%|██████▍   | 200/313 [03:00<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.369, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=0.830, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.369, Train/loss_unet_all_step=0.204, Train/loss_triplet_all_step=0.165, Train/loss_recog_step=0.830, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.723, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.391, Train/loss_unet_all_step=0.218, Train/loss_triplet_all_step=0.173, Train/loss_recog_step=0.723, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.406, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.979, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.406, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.190, Train/loss_recog_step=0.979, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10: 100%|██████████| 313/313 [04:38<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.365, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.674, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.312, Valid/loss_triplet_all_step=0.191, Valid/loss_recog_step=0.934, Valid/loss_all_epoch=0.440, Valid/loss_unet_all_epoch=0.263, Valid/loss_triplet_all_epoch=0.177, Valid/loss_recog_epoch=0.792, Valid/knn_avr=0.191, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.92it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.09it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  4.97it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:02<00:00,  5.36it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.78it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  4.74it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.079025, 0.079519, 0.083493
Valid average loss UNet            (all)              : 0.242037

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.083322, 0.207028, 0.556025
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.237283, 0.152360, 0.116795
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.217151, 0.140431, 0.125666
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.217317, 0.232714, 0.220977
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.179481, 0.228089, 0.266050
Valid average loss all      (Triplet)                 : 0.194008

== Recognize ==
Valid average loss Recognize     : 0.789167
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.436045

= T-SNE...
T-SNE was finished!
= T-SNE time is 15.380653142929077 sec. =
Valid knn accuracy drums     : 76.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.971741437911987 sec. =
Valid knn accuracy bass      : 0.4%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.549538373947144 sec. =
Valid knn accuracy piano     : 2.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.838775157928467 sec. =
Valid knn accuracy guitar    : 5.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.897134780883789 sec. =
Valid knn accuracy residuals : 21.099999999999998%

Valid knn accuracy average   : 21.140000000000004%

                                                                        [AEpoch 10: 100%|██████████| 313/313 [06:42<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.365, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.674, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.388, Train/loss_unet_all_epoch=0.216, Train/loss_triplet_all_epoch=0.172, Train/loss_recog_epoch=0.837]Epoch 10: 100%|██████████| 313/313 [06:42<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.365, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.674, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.071342, 0.071100, 0.072364
Train average loss UNet            (all)              : 0.214805

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.061694, 0.317792, 0.785806
Train average loss bass     (Triplet, dist_p, dist_n) : 0.207202, 0.374338, 0.370874
Train average loss piano    (Triplet, dist_p, dist_n) : 0.207702, 0.406766, 0.403954
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.185781, 0.371190, 0.405297
Train average loss residuals(Triplet, dist_p, dist_n) : 0.175266, 0.426792, 0.476734
Train average loss all      (Triplet)                 : 0.169065

== Recognize ==
Train average loss Recognize     : 0.838888
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.383870

Epoch 10:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.365, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.674, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]          Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.365, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.674, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.365, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.146, Train/loss_recog_step=0.674, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11:  16%|█▌        | 50/313 [00:48<04:17,  1.02it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=0.747, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.350, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=0.747, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11:  32%|███▏      | 100/313 [01:32<03:17,  1.08it/s, v_num=0, Train/loss_all_step=0.397, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.836, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.397, Train/loss_unet_all_step=0.223, Train/loss_triplet_all_step=0.175, Train/loss_recog_step=0.836, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11:  48%|████▊     | 150/313 [02:17<02:29,  1.09it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.644, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.376, Train/loss_unet_all_step=0.219, Train/loss_triplet_all_step=0.157, Train/loss_recog_step=0.644, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11:  64%|██████▍   | 200/313 [03:01<01:42,  1.10it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.820, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.348, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.145, Train/loss_recog_step=0.820, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11:  80%|███████▉  | 250/313 [03:44<00:56,  1.11it/s, v_num=0, Train/loss_all_step=0.367, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=0.707, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.367, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.150, Train/loss_recog_step=0.707, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11:  96%|█████████▌| 300/313 [04:28<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.415, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=0.975, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.415, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.198, Train/loss_recog_step=0.975, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11: 100%|██████████| 313/313 [04:38<00:00,  1.12it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.676, Valid/loss_all_step=0.503, Valid/loss_unet_all_step=0.274, Valid/loss_triplet_all_step=0.229, Valid/loss_recog_step=0.930, Valid/loss_all_epoch=0.436, Valid/loss_unet_all_epoch=0.242, Valid/loss_triplet_all_epoch=0.194, Valid/loss_recog_epoch=0.789, Valid/knn_avr=0.211, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  2.97it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  5.10it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.17it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  5.24it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:02<00:00,  5.59it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.01it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.076749, 0.076579, 0.078690
Valid average loss UNet            (all)              : 0.232018

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.088351, 0.205614, 0.535678
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.218487, 0.124168, 0.105680
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.230042, 0.167124, 0.137440
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.190551, 0.205077, 0.218950
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.175342, 0.223181, 0.281632
Valid average loss all      (Triplet)                 : 0.184892

== Recognize ==
Valid average loss Recognize     : 0.772866
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.416910

= T-SNE...
T-SNE was finished!
= T-SNE time is 17.107463836669922 sec. =
Valid knn accuracy drums     : 73.6%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.03768253326416 sec. =
Valid knn accuracy bass      : 0.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.179842948913574 sec. =
Valid knn accuracy piano     : 2.9000000000000004%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.201128005981445 sec. =
Valid knn accuracy guitar    : 6.5%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.230041027069092 sec. =
Valid knn accuracy residuals : 27.500000000000004%

Valid knn accuracy average   : 22.140000000000004%

                                                                        [AEpoch 11: 100%|██████████| 313/313 [06:39<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.676, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.384, Train/loss_unet_all_epoch=0.215, Train/loss_triplet_all_epoch=0.169, Train/loss_recog_epoch=0.839]Epoch 11: 100%|██████████| 313/313 [06:39<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.676, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.071126, 0.070945, 0.072165
Train average loss UNet            (all)              : 0.214236

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.058910, 0.305805, 0.762407
Train average loss bass     (Triplet, dist_p, dist_n) : 0.206306, 0.362896, 0.359686
Train average loss piano    (Triplet, dist_p, dist_n) : 0.207428, 0.374641, 0.370458
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.182911, 0.349157, 0.387419
Train average loss residuals(Triplet, dist_p, dist_n) : 0.167355, 0.413310, 0.473443
Train average loss all      (Triplet)                 : 0.166317

== Recognize ==
Train average loss Recognize     : 0.838101
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.380553

Epoch 11:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.676, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]          Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.676, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.420, Train/loss_unet_all_step=0.217, Train/loss_triplet_all_step=0.203, Train/loss_recog_step=0.676, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12:  16%|█▌        | 50/313 [00:47<04:07,  1.06it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=0.740, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.199, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=0.740, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12:  32%|███▏      | 100/313 [01:31<03:14,  1.09it/s, v_num=0, Train/loss_all_step=0.394, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.849, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.394, Train/loss_unet_all_step=0.222, Train/loss_triplet_all_step=0.172, Train/loss_recog_step=0.849, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12:  48%|████▊     | 150/313 [02:15<02:26,  1.11it/s, v_num=0, Train/loss_all_step=0.379, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=0.654, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.379, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.163, Train/loss_recog_step=0.654, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12:  64%|██████▍   | 200/313 [02:59<01:41,  1.11it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.807, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12:  80%|███████▉  | 250/313 [03:43<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.334, Train/loss_unet_all_step=0.203, Train/loss_triplet_all_step=0.130, Train/loss_recog_step=0.807, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12:  80%|███████▉  | 250/313 [03:44<00:56,  1.12it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.727, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.361, Train/loss_unet_all_step=0.214, Train/loss_triplet_all_step=0.148, Train/loss_recog_step=0.727, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12:  96%|█████████▌| 300/313 [04:27<00:11,  1.12it/s, v_num=0, Train/loss_all_step=0.402, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=0.959, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.402, Train/loss_unet_all_step=0.215, Train/loss_triplet_all_step=0.187, Train/loss_recog_step=0.959, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12: 100%|██████████| 313/313 [04:37<00:00,  1.13it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.176, Train/loss_recog_step=0.666, Valid/loss_all_step=0.470, Valid/loss_unet_all_step=0.268, Valid/loss_triplet_all_step=0.202, Valid/loss_recog_step=0.874, Valid/loss_all_epoch=0.417, Valid/loss_unet_all_epoch=0.232, Valid/loss_triplet_all_epoch=0.185, Valid/loss_recog_epoch=0.773, Valid/knn_avr=0.221, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]
Validation: |          | 0/? [00:00<?, ?it/s][A
Validation:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/4 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 4/4 [00:01<00:00,  3.11it/s][A
Validation DataLoader 0:   0%|          | 0/16 [00:00<?, ?it/s]       [A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 1: 100%|██████████| 16/16 [00:03<00:00,  4.92it/s][A
Validation DataLoader 1:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 2: 100%|██████████| 16/16 [00:03<00:00,  5.05it/s][A
Validation DataLoader 2:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 3: 100%|██████████| 16/16 [00:03<00:00,  4.92it/s][A
Validation DataLoader 3:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 4: 100%|██████████| 16/16 [00:03<00:00,  4.94it/s][A
Validation DataLoader 4:   0%|          | 0/16 [00:00<?, ?it/s]         [A
Validation DataLoader 5:   0%|          | 0/16 [00:00<?, ?it/s][A
Validation DataLoader 5: 100%|██████████| 16/16 [00:03<00:00,  5.17it/s][A

== U-Net Loss ==
Valid average loss UNet (anchor, positive, negative)  : 0.078146, 0.078149, 0.081513
Valid average loss UNet            (all)              : 0.237808

== Triplet Loss ==
Valid average loss drums    (Triplet, dist_p, dist_n) : 0.085270, 0.195818, 0.533398
Valid average loss bass     (Triplet, dist_p, dist_n) : 0.242041, 0.186824, 0.186766
Valid average loss piano    (Triplet, dist_p, dist_n) : 0.219247, 0.171075, 0.172171
Valid average loss guitar   (Triplet, dist_p, dist_n) : 0.186847, 0.178968, 0.198202
Valid average loss residuals(Triplet, dist_p, dist_n) : 0.156758, 0.256058, 0.324133
Valid average loss all      (Triplet)                 : 0.187348

== Recognize ==
Valid average loss Recognize     : 0.758023
Valid average accuracy drums     : 95.666664 %
Valid average accuracy bass      : 97.666672 %
Valid average accuracy piano     : 94.666664 %
Valid average accuracy guitar    : 89.333328 %
Valid average accuracy residuals : 90.333328 %

== Valid average loss all : 0.425156

= T-SNE...
T-SNE was finished!
= T-SNE time is 16.290921926498413 sec. =
Valid knn accuracy drums     : 76.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.497902154922485 sec. =
Valid knn accuracy bass      : 1.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.428868532180786 sec. =
Valid knn accuracy piano     : 2.3%
= T-SNE...
T-SNE was finished!
= T-SNE time is 17.387880563735962 sec. =
Valid knn accuracy guitar    : 6.2%
= T-SNE...
T-SNE was finished!
= T-SNE time is 15.950448274612427 sec. =
Valid knn accuracy residuals : 26.6%

Valid knn accuracy average   : 22.52%

                                                                        [AEpoch 12: 100%|██████████| 313/313 [06:43<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.176, Train/loss_recog_step=0.666, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.225, Train/loss_all_epoch=0.381, Train/loss_unet_all_epoch=0.214, Train/loss_triplet_all_epoch=0.166, Train/loss_recog_epoch=0.838]Epoch 12: 100%|██████████| 313/313 [06:43<00:00,  0.78it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.176, Train/loss_recog_step=0.666, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.225, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.833]

== U-Net Loss ==
Train average loss UNet (anchor, positive, negative)  : 0.070771, 0.070569, 0.071805
Train average loss UNet            (all)              : 0.213145

== Triplet Loss ==
Train average loss drums    (Triplet, dist_p, dist_n) : 0.057407, 0.314767, 0.774514
Train average loss bass     (Triplet, dist_p, dist_n) : 0.206705, 0.373280, 0.368989
Train average loss piano    (Triplet, dist_p, dist_n) : 0.204235, 0.374191, 0.373995
Train average loss guitar   (Triplet, dist_p, dist_n) : 0.173143, 0.367023, 0.428134
Train average loss residuals(Triplet, dist_p, dist_n) : 0.165791, 0.402645, 0.466535
Train average loss all      (Triplet)                 : 0.163417

== Recognize ==
Train average loss Recognize     : 0.833444
Train average accuracy drums     : 93.809998 %
Train average accuracy bass      : 96.466667 %
Train average accuracy piano     : 89.813332 %
Train average accuracy guitar    : 88.996666 %
Train average accuracy residuals : 92.686668 %

== Train average loss all : 0.376562

Epoch 12:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.176, Train/loss_recog_step=0.666, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.225, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.833]          Epoch 13:   0%|          | 0/313 [00:00<?, ?it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.176, Train/loss_recog_step=0.666, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.225, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.833]Epoch 13:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.392, Train/loss_unet_all_step=0.216, Train/loss_triplet_all_step=0.176, Train/loss_recog_step=0.666, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.225, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.833]Epoch 13:  16%|█▌        | 50/313 [00:48<04:16,  1.03it/s, v_num=0, Train/loss_all_step=0.364, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.746, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.225, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.833]Epoch 13:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.364, Train/loss_unet_all_step=0.198, Train/loss_triplet_all_step=0.166, Train/loss_recog_step=0.746, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.225, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.833]Epoch 13:  32%|███▏      | 100/313 [01:34<03:21,  1.06it/s, v_num=0, Train/loss_all_step=0.386, Train/loss_unet_all_step=0.224, Train/loss_triplet_all_step=0.162, Train/loss_recog_step=0.864, Valid/loss_all_step=0.518, Valid/loss_unet_all_step=0.279, Valid/loss_triplet_all_step=0.238, Valid/loss_recog_step=0.866, Valid/loss_all_epoch=0.425, Valid/loss_unet_all_epoch=0.238, Valid/loss_triplet_all_epoch=0.187, Valid/loss_recog_epoch=0.758, Valid/knn_avr=0.225, Train/loss_all_epoch=0.377, Train/loss_unet_all_epoch=0.213, Train/loss_triplet_all_epoch=0.163, Train/loss_recog_epoch=0.833]